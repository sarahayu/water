function dS(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const c=Object.getOwnPropertyDescriptor(i,r);c&&Object.defineProperty(t,r,c.get?c:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}})();function wx(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const L8=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),bx=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);bx&&parseFloat(bx[1]);const AS="3.4.14";function pl(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const z0=typeof process!="object"||String(process)!=="[object process]"||process.browser,pS=typeof window<"u"&&typeof window.orientation<"u",Ex=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Ex&&parseFloat(Ex[1]);function kd(t){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kd(t)}function mS(t,e){if(kd(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(kd(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gS(t){var e=mS(t,"string");return kd(e)==="symbol"?e:String(e)}function ae(t,e,n){return e=gS(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class _S{constructor(e,n){ae(this,"name",void 0),ae(this,"workerThread",void 0),ae(this,"isRunning",!0),ae(this,"result",void 0),ae(this,"_resolve",()=>{}),ae(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){pl(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){pl(this.isRunning),this.isRunning=!1,this._reject(e)}}let vg=class{terminate(){}};const xg=new Map;function yS(t){pl(t.source&&!t.url||!t.source&&t.url);let e=xg.get(t.source||t.url);return e||(t.url&&(e=vS(t.url),xg.set(t.url,e)),t.source&&(e=R8(t.source),xg.set(t.source,e))),pl(e),e}function vS(t){if(!t.startsWith("http"))return t;const e=xS(t);return R8(e)}function R8(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function xS(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function D8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t){if(Tx(t))i.add(t);else if(Tx(t.buffer))i.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const r in t)D8(t[r],e,i)}}return n===void 0?Array.from(i):[]}function Tx(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const wg=()=>{};class P1{static isSupported(){return typeof Worker<"u"&&z0||typeof vg<"u"&&!z0}constructor(e){ae(this,"name",void 0),ae(this,"source",void 0),ae(this,"url",void 0),ae(this,"terminated",!1),ae(this,"worker",void 0),ae(this,"onMessage",void 0),ae(this,"onError",void 0),ae(this,"_loadableURL","");const{name:n,source:i,url:r}=e;pl(i||r),this.name=n,this.source=i,this.url=r,this.onMessage=wg,this.onError=c=>console.log(c),this.worker=z0?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=wg,this.onError=wg,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||D8(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=yS({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new vg(i,{eval:!1})}else if(this.source)e=new vg(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class wS{static isSupported(){return P1.isSupported()}constructor(e){ae(this,"name","unnamed"),ae(this,"source",void 0),ae(this,"url",void 0),ae(this,"maxConcurrency",1),ae(this,"maxMobileConcurrency",1),ae(this,"onDebug",()=>{}),ae(this,"reuseWorkers",!0),ae(this,"props",{}),ae(this,"jobQueue",[]),ae(this,"idleQueue",[]),ae(this,"count",0),ae(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(c,p,a)=>c.done(a),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(c,p)=>c.error(p);const r=new Promise(c=>(this.jobQueue.push({name:e,onMessage:n,onError:i,onStart:c}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const i=new _S(n.name,e);e.onMessage=r=>n.onMessage(i,r.type,r.payload),e.onError=r=>n.onError(i,r),n.onStart(i);try{await i.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new P1({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return pS?this.maxMobileConcurrency:this.maxConcurrency}}const bS={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class ul{static isSupported(){return P1.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ul._workerFarm=ul._workerFarm||new ul({}),ul._workerFarm.setProps(e),ul._workerFarm}constructor(e){ae(this,"props",void 0),ae(this,"workerPools",new Map),this.props={...bS},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:i,url:r}=e;let c=this.workerPools.get(n);return c||(c=new wS({name:n,source:i,url:r}),c.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,c)),c}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}ae(ul,"_workerFarm",void 0);const ES="latest";function TS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(!r&&t.id==="compression"&&(r=e.workerUrl),e._workerType==="test"&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let c=t.version;c==="latest"&&(c=ES);const p=c?"@".concat(c):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(p,"/dist/").concat(i)}return pl(r),r}function SS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:AS;pl(t,"no worker provided");const n=t.version;return!(!e||!n)}function MS(t,e){return!ul.isSupported()||!z0&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function IS(t,e,n,i,r){const c=t.id,p=TS(t,n),T=ul.getWorkerFarm(n).getWorkerPool({name:c,url:p});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const k=await T.startJob("process-on-worker",CS.bind(null,r));return k.postMessage("process",{input:e,options:n,context:i}),await(await k.result).result}async function CS(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:c,options:p}=i;try{const a=await t(c,p);e.postMessage("done",{id:r,result:a})}catch(a){const T=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:T})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function kS(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let c=0;c<i.length;++c)if(i[c]!==r[c])return!1;return!0}function PS(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),r=i.reduce((a,T)=>a+T.byteLength,0),c=new Uint8Array(r);let p=0;for(const a of i)c.set(a,p),p+=a.byteLength;return c.buffer}async function LS(t){const e=[];for await(const n of t)e.push(n);return PS(...e)}let RS="";const Sx={};function DS(t){for(const e in Sx)if(t.startsWith(e)){const n=Sx[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(RS).concat(t)),t}function zS(t){return t&&typeof t=="object"&&t.isBuffer}function z8(t){if(zS(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function B8(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function BS(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const OS=t=>typeof t=="boolean",md=t=>typeof t=="function",lA=t=>t!==null&&typeof t=="object",Mx=t=>lA(t)&&t.constructor==={}.constructor,FS=t=>t&&typeof t[Symbol.iterator]=="function",NS=t=>t&&typeof t[Symbol.asyncIterator]=="function",xu=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,wu=t=>typeof Blob<"u"&&t instanceof Blob,US=t=>t&&typeof t=="object"&&t.isBuffer,VS=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||lA(t)&&md(t.tee)&&md(t.cancel)&&md(t.getReader),jS=t=>lA(t)&&md(t.read)&&md(t.pipe)&&OS(t.readable),O8=t=>VS(t)||jS(t),GS=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,HS=/^([-\w.]+\/[-\w.+]+)/;function $S(t){const e=HS.exec(t);return e?e[1]:t}function Ix(t){const e=GS.exec(t);return e?e[1]:""}const F8=/\?.*/;function WS(t){const e=t.match(F8);return e&&e[0]}function Ay(t){return t.replace(F8,"")}function am(t){return xu(t)?t.url:wu(t)?t.name||"":typeof t=="string"?t:""}function py(t){if(xu(t)){const e=t,n=e.headers.get("content-type")||"",i=Ay(e.url);return $S(n)||Ix(i)}return wu(t)?t.type||"":typeof t=="string"?Ix(t):""}function ZS(t){return xu(t)?t.headers["content-length"]||-1:wu(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function N8(t){if(xu(t))return t;const e={},n=ZS(t);n>=0&&(e["content-length"]=String(n));const i=am(t),r=py(t);r&&(e["content-type"]=r);const c=await XS(t);c&&(e["x-first-bytes"]=c),typeof t=="string"&&(t=new TextEncoder().encode(t));const p=new Response(t,{headers:e});return Object.defineProperty(p,"url",{value:i}),p}async function qS(t){if(!t.ok){const e=await QS(t);throw new Error(e)}}async function QS(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function XS(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(i=>{const r=new FileReader;r.onload=c=>{var p;return i(c==null||(p=c.target)===null||p===void 0?void 0:p.result)},r.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),i=YS(n);return"data:base64,".concat(i)}return null}function YS(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}async function Cx(t,e){if(typeof t=="string"){t=DS(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await N8(t)}function KS(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function cA(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||KS()}const QA=globalThis.window||globalThis.self||globalThis.global,$h=globalThis.process||{},U8=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";cA();function JS(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let eM=class{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=JS(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function tM(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function nM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function bg(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const c=t.width*n,p=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(p/2),"px ").concat(Math.floor(c/2),"px;"),"line-height:".concat(p,"px;"),"background:url(".concat(r,");"),"background-size:".concat(c,"px ").concat(p,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let rp;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(rp||(rp={}));const iM=10;function kx(t){return typeof t!="string"?t:(t=t.toUpperCase(),rp[t]||rp.WHITE)}function rM(t,e,n){if(!cA&&typeof t=="string"){if(e){const i=kx(e);t="\x1B[".concat(i,"m").concat(t,"\x1B[39m")}if(n){const i=kx(n);t="\x1B[".concat(i+iM,"m").concat(t,"\x1B[49m")}}return t}function oM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n),r=t;for(const c of i){const p=r[c];typeof p=="function"&&(e.find(a=>c===a)||(r[c]=p.bind(t)))}}function op(t,e){if(!t)throw new Error(e||"Assertion failed")}function uf(){let t;if(cA()&&QA.performance){var e,n;t=QA==null||(e=QA.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in $h){var i;const r=$h==null||(i=$h.hrtime)===null||i===void 0?void 0:i.call($h);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const ff={debug:cA()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},sM={enabled:!0,level:0};function ps(){}const Px={},Lx={once:!0};let my=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=U8,this._startTs=uf(),this._deltaTs=uf(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new eM("__probe-".concat(this.id,"__"),sM),this.timeStamp("".concat(this.id," started")),oM(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((uf()-this._startTs).toPrecision(10))}getDelta(){return Number((uf()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){op(e,n)}warn(e){return this._getLogFunction(0,e,ff.warn,arguments,Lx)}error(e){return this._getLogFunction(0,e,ff.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,ff.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,ff.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,ff.debug||ff.info,arguments,Lx)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||ps,i&&[i],{tag:uM(n)}):ps}image(e){let{logLevel:n,priority:i,image:r,message:c="",scale:p=1}=e;return this._shouldLog(n||i)?cA()?cM({image:r,message:c,scale:p}):lM():ps}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||ps)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=Rx({logLevel:e,message:n,opts:i}),{collapsed:c}=i;return r.method=(c?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||ps)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=V8(e)}_getLogFunction(e,n,i,r,c){if(this._shouldLog(e)){c=Rx({logLevel:e,message:n,args:r,opts:c}),i=i||c.method,op(i),c.total=this.getTotal(),c.delta=this.getDelta(),this._deltaTs=uf();const p=c.tag||c.message;if(c.once&&p)if(!Px[p])Px[p]=uf();else return ps;return n=aM(this.id,c.message,c),i.bind(console,n,...c.args)}return ps}};my.VERSION=U8;function V8(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return op(Number.isFinite(e)&&e>=0),e}function Rx(t){const{logLevel:e,message:n}=t;t.logLevel=V8(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return op(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function aM(t,e,n){if(typeof e=="string"){const i=n.time?nM(tM(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=rM(e,n.color,n.background)}return e}function lM(t){return console.warn("removed"),ps}function cM(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const c=new Image;return c.onload=()=>{const p=bg(c,n,i);console.log(...p)},c.src=e,ps}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...bg(e,n,i)),ps;if(r.toLowerCase()==="canvas"){const c=new Image;return c.onload=()=>console.log(...bg(c,n,i)),c.src=e.toDataURL(),ps}return ps}function uM(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Dx=new my({id:"loaders.gl"});class fM{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class hM{constructor(){ae(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return this.console.error.bind(this.console,...n)}}const j8={fetch:null,mimeType:void 0,nothrow:!1,log:new hM,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:L8,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},dM={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function G8(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const H8=()=>{const t=G8();return t.globalOptions=t.globalOptions||{...j8},t.globalOptions};function AM(t,e,n,i){return n=n||[],n=Array.isArray(n)?n:[n],pM(t,n),gM(e,t,i)}function pM(t,e){zx(t,null,j8,dM,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},c=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};zx(i,n.id,r,c,e)}}function zx(t,e,n,i,r){const c=e||"Top level",p=e?"".concat(e,"."):"";for(const a in t){const T=!e&&lA(t[a]),k=a==="baseUri"&&!e,z=a==="workerUrl"&&e;if(!(a in n)&&!k&&!z){if(a in i)Dx.warn("".concat(c," loader option '").concat(p).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!T){const B=mM(a,r);Dx.warn("".concat(c," loader option '").concat(p).concat(a,"' not recognized. ").concat(B))()}}}}function mM(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const c in r.options){if(t===c)return"Did you mean '".concat(r.id,".").concat(c,"'?");const p=c.toLowerCase();(n.startsWith(p)||p.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(c,"'?"))}return i}function gM(t,e,n){const r={...t.options||{}};return _M(r,n),r.log===null&&(r.log=new fM),Bx(r,H8()),Bx(r,e),r}function Bx(t,e){for(const n in e)if(n in e){const i=e[n];Mx(i)&&Mx(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function _M(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function gy(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function _y(t){var e,n;wx(t,"null loader"),wx(gy(t),"invalid loader");let i;return Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const $8=()=>{const t=G8();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function yM(t){const e=$8();t=Array.isArray(t)?t:[t];for(const n of t){const i=_y(n);e.find(r=>i===r)||e.unshift(i)}}function vM(){return $8()}const xM=new my({id:"loaders.gl"}),wM=/\.([^.]+)$/;async function bM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!W8(t))return null;let r=Ox(t,e,{...n,nothrow:!0},i);if(r)return r;if(wu(t)&&(t=await t.slice(0,10).arrayBuffer(),r=Ox(t,e,n,i)),!r&&!(n!=null&&n.nothrow))throw new Error(Z8(t));return r}function Ox(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!W8(t))return null;if(e&&!Array.isArray(e))return _y(e);let r=[];e&&(r=r.concat(e)),n!=null&&n.ignoreRegisteredLoaders||r.push(...vM()),TM(r);const c=EM(t,r,n,i);if(!c&&!(n!=null&&n.nothrow))throw new Error(Z8(t));return c}function EM(t,e,n,i){const r=am(t),c=py(t),p=Ay(r)||(i==null?void 0:i.url);let a=null,T="";if(n!=null&&n.mimeType&&(a=Eg(e,n==null?void 0:n.mimeType),T="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||SM(e,p),T=T||(a?"matched url ".concat(p):""),a=a||Eg(e,c),T=T||(a?"matched MIME type ".concat(c):""),a=a||IM(e,t),T=T||(a?"matched initial data ".concat(q8(t)):""),a=a||Eg(e,n==null?void 0:n.fallbackMimeType),T=T||(a?"matched fallback MIME type ".concat(c):""),T){var k;xM.log(1,"selectLoader selected ".concat((k=a)===null||k===void 0?void 0:k.name,": ").concat(T,"."))}return a}function W8(t){return!(t instanceof Response&&t.status===204)}function Z8(t){const e=am(t),n=py(t);let i="No valid loader found (";i+=e?"".concat(B8(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?q8(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function TM(t){for(const e of t)_y(e)}function SM(t,e){const n=e&&wM.exec(e),i=n&&n[1];return i?MM(t,i):null}function MM(t,e){e=e.toLowerCase();for(const n of t)for(const i of n.extensions)if(i.toLowerCase()===e)return n;return null}function Eg(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function IM(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(CM(e,n))return n}else if(ArrayBuffer.isView(e)){if(Fx(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&Fx(e,0,n))return n;return null}function CM(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>t.startsWith(i))}function Fx(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(r=>kM(t,e,n,r))}function kM(t,e,n,i){if(i instanceof ArrayBuffer)return kS(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":const r=L1(t,e,i.length);return i===r;default:return!1}}function q8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?L1(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?L1(t,0,e):""}function L1(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let c=0;c<n;c++)r+=String.fromCharCode(i.getUint8(e+c));return r}const PM=256*1024;function*LM(t,e){const n=(e==null?void 0:e.chunkSize)||PM;let i=0;const r=new TextEncoder;for(;i<t.length;){const c=Math.min(t.length-i,n),p=t.slice(i,i+c);i+=c,yield r.encode(p)}}const RM=256*1024;function DM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=RM}=e;let i=0;for(;i<t.byteLength;){const r=Math.min(t.byteLength-i,n),c=new ArrayBuffer(r),p=new Uint8Array(t,i,r);new Uint8Array(c).set(p),i+=r,yield c}}()}const zM=1024*1024;async function*BM(t,e){const n=(e==null?void 0:e.chunkSize)||zM;let i=0;for(;i<t.size;){const r=i+n,c=await t.slice(i,r).arrayBuffer();i=r,yield c}}function Nx(t,e){return L8?OM(t,e):FM(t)}async function*OM(t,e){const n=t.getReader();let i;try{for(;;){const r=i||n.read();e!=null&&e._streamReadAhead&&(i=n.read());const{done:c,value:p}=await r;if(c)return;yield z8(p)}}catch{n.releaseLock()}}async function*FM(t,e){for await(const n of t)yield z8(n)}function NM(t,e){if(typeof t=="string")return LM(t,e);if(t instanceof ArrayBuffer)return DM(t,e);if(wu(t))return BM(t,e);if(O8(t))return Nx(t,e);if(xu(t))return Nx(t.body,e);throw new Error("makeIterator")}const Q8="Cannot convert supplied data type";function UM(t,e,n){if(e.text&&typeof t=="string")return t;if(US(t)&&(t=t.buffer),t instanceof ArrayBuffer){const i=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let i=t.buffer;const r=t.byteLength||t.length;return(t.byteOffset!==0||r!==i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+r)),i}throw new Error(Q8)}async function VM(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||i)return UM(t,e);if(wu(t)&&(t=await N8(t)),xu(t)){const r=t;return await qS(r),e.binary?await r.arrayBuffer():await r.text()}if(O8(t)&&(t=NM(t,n)),FS(t)||NS(t))return LS(t);throw new Error(Q8)}function X8(t,e){const n=H8(),i=t||n;return typeof i.fetch=="function"?i.fetch:lA(i.fetch)?r=>Cx(r,i):e!=null&&e.fetch?e==null?void 0:e.fetch:Cx}function jM(t,e,n){if(n)return n;const i={fetch:X8(e,t),...t};if(i.url){const r=Ay(i.url);i.baseUrl=r,i.queryString=WS(i.url),i.filename=B8(r),i.baseUrl=BS(r)}return Array.isArray(i.loaders)||(i.loaders=null),i}function GM(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...i]:i}return n&&n.length?n:null}async function yy(t,e,n,i){pl(!i||typeof i=="object"),e&&!Array.isArray(e)&&!gy(e)&&(i=void 0,n=e,e=void 0),t=await t,n=n||{};const r=am(t),p=GM(e,i),a=await bM(t,p,n);return a?(n=AM(n,a,p,r),i=jM({url:r,parse:yy,loaders:p},n,i||null),await HM(a,t,n,i)):null}async function HM(t,e,n,i){if(SS(t),xu(e)){const r=e,{ok:c,redirected:p,status:a,statusText:T,type:k,url:z}=r,B=Object.fromEntries(r.headers.entries());i.response={headers:B,ok:c,redirected:p,status:a,statusText:T,type:k,url:z}}if(e=await VM(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,i,t);if(MS(t,n))return await IS(t,e,n,i,yy);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw pl(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function R1(t,e,n,i){!Array.isArray(e)&&!gy(e)&&(n=e,e=void 0);const r=X8(n);let c=t;return typeof t=="string"&&(c=await r(t)),wu(t)&&(c=await r(t)),await yy(c,e,n)}const $M="3.4.8";function Y8(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const WM=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),Ux=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Ux&&parseFloat(Ux[1]);const{_parseImageNode:ZM}=globalThis,D1=typeof Image<"u",z1=typeof ImageBitmap<"u",qM=!!ZM,B1=WM?!0:qM;function QM(t){switch(t){case"auto":return z1||D1||B1;case"imagebitmap":return z1;case"image":return D1;case"data":return B1;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function XM(){if(z1)return"imagebitmap";if(D1)return"image";if(B1)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function YM(t){const e=JM(t);if(!e)throw new Error("Not an image");return e}function KM(t){switch(YM(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function JM(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const eI=/^data:image\/svg\+xml/,tI=/\.svg((\?|#).*)?$/;function vy(t){return t&&(eI.test(t)||tI.test(t))}function nI(t,e){if(vy(e)){let i=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(c){throw new Error(c.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return K8(t,e)}function K8(t,e){if(vy(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function J8(t,e,n){const i=nI(t,n),r=self.URL||self.webkitURL,c=typeof i!="string"&&r.createObjectURL(i);try{return await iI(c||i,e)}finally{c&&r.revokeObjectURL(c)}}async function iI(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((i,r)=>{try{n.onload=()=>i(n),n.onerror=c=>r(new Error("Could not load image ".concat(t,": ").concat(c)))}catch(c){r(c)}})}const rI={};let Vx=!0;async function oI(t,e,n){let i;vy(n)?i=await J8(t,e,n):i=K8(t,n);const r=e&&e.imagebitmap;return await sI(i,r)}async function sI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((aI(e)||!Vx)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Vx=!1}return await createImageBitmap(t)}function aI(t){for(const e in t||rI)return!1;return!0}function lI(t){return!hI(t,"ftyp",4)||!(t[8]&96)?null:cI(t)}function cI(t){switch(uI(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function uI(t,e,n){return String.fromCharCode(...t.slice(e,n))}function fI(t){return[...t].map(e=>e.charCodeAt(0))}function hI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=fI(e);for(let r=0;r<i.length;++r)if(i[r]!==t[r+n])return!1;return!0}const ya=!1,gd=!0;function eE(t){const e=uA(t);return AI(e)||gI(e)||pI(e)||mI(e)||dI(e)}function dI(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=lI(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function AI(t){const e=uA(t);return e.byteLength>=24&&e.getUint32(0,ya)===2303741511?{mimeType:"image/png",width:e.getUint32(16,ya),height:e.getUint32(20,ya)}:null}function pI(t){const e=uA(t);return e.byteLength>=10&&e.getUint32(0,ya)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,gd),height:e.getUint16(8,gd)}:null}function mI(t){const e=uA(t);return e.byteLength>=14&&e.getUint16(0,ya)===16973&&e.getUint32(2,gd)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,gd),height:e.getUint32(22,gd)}:null}function gI(t){const e=uA(t);if(!(e.byteLength>=3&&e.getUint16(0,ya)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:i,sofMarkers:r}=_I();let c=2;for(;c+9<e.byteLength;){const p=e.getUint16(c,ya);if(r.has(p))return{mimeType:"image/jpeg",height:e.getUint16(c+5,ya),width:e.getUint16(c+7,ya)};if(!i.has(p))return null;c+=2,c+=e.getUint16(c,ya)}return null}function _I(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function uA(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function yI(t,e){const{mimeType:n}=eE(t)||{},i=globalThis._parseImageNode;return Y8(i),await i(t,n)}async function vI(t,e,n){e=e||{};const r=(e.image||{}).type||"auto",{url:c}=n||{},p=xI(r);let a;switch(p){case"imagebitmap":a=await oI(t,e,c);break;case"image":a=await J8(t,e,c);break;case"data":a=await yI(t);break;default:Y8(!1)}return r==="data"&&(a=KM(a)),a}function xI(t){switch(t){case"auto":case"data":return XM();default:return QM(t),t}}const wI=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],bI=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],EI={image:{type:"auto",decode:!0}},TI={id:"image",module:"images",name:"Images",version:$M,mimeTypes:bI,extensions:wI,parse:vI,tests:[t=>!!eE(new DataView(t))],options:EI};function tE(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function wl(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||tE()}const B0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},XA=B0.window||B0.self||B0.global,Wh=B0.process||{},nE=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";wl();const Tg=globalThis;function iE(t){if(!t&&!wl())return"Node";if(tE(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":Tg.chrome?"Chrome":Tg.safari?"Safari":Tg.mozInnerScreenX?"Firefox":"Unknown"}function SI(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class MI{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";ae(this,"storage",void 0),ae(this,"id",void 0),ae(this,"config",void 0),this.storage=SI(i),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function II(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function CI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Sg(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const c=t.width*n,p=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(p/2),"px ").concat(Math.floor(c/2),"px;"),"line-height:".concat(p,"px;"),"background:url(".concat(r,");"),"background-size:".concat(c,"px ").concat(p,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let sp;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(sp||(sp={}));function jx(t){return typeof t=="string"?sp[t.toUpperCase()]||sp.WHITE:t}function kI(t,e,n){return!wl&&typeof t=="string"&&(e&&(e=jx(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=jx(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function PI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(c=>r===c)||(t[r]=t[r].bind(t)))}function ap(t,e){if(!t)throw new Error(e||"Assertion failed")}function hf(){let t;if(wl&&"performance"in XA){var e,n;t=XA==null||(e=XA.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Wh){var i;const r=Wh==null||(i=Wh.hrtime)===null||i===void 0?void 0:i.call(Wh);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const df={debug:wl&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},LI={enabled:!0,level:0};function ms(){}const Gx={},Hx={once:!0};class xy{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};ae(this,"id",void 0),ae(this,"VERSION",nE),ae(this,"_startTs",hf()),ae(this,"_deltaTs",hf()),ae(this,"_storage",void 0),ae(this,"userData",{}),ae(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new MI("__probe-".concat(this.id,"__"),LI),this.timeStamp("".concat(this.id," started")),PI(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((hf()-this._startTs).toPrecision(10))}getDelta(){return Number((hf()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){ap(e,n)}warn(e){return this._getLogFunction(0,e,df.warn,arguments,Hx)}error(e){return this._getLogFunction(0,e,df.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,df.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,df.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),c=2;c<i;c++)r[c-2]=arguments[c];return this._getLogFunction(e,n,df.debug||df.info,arguments,Hx)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||ms,i&&[i],{tag:BI(n)}):ms}image(e){let{logLevel:n,priority:i,image:r,message:c="",scale:p=1}=e;return this._shouldLog(n||i)?wl?zI({image:r,message:c,scale:p}):DI():ms}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||ms)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=$x({logLevel:e,message:n,opts:i}),{collapsed:c}=i;return r.method=(c?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||ms)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=rE(e)}_getLogFunction(e,n,i,r,c){if(this._shouldLog(e)){c=$x({logLevel:e,message:n,args:r,opts:c}),i=i||c.method,ap(i),c.total=this.getTotal(),c.delta=this.getDelta(),this._deltaTs=hf();const p=c.tag||c.message;if(c.once)if(!Gx[p])Gx[p]=hf();else return ms;return n=RI(this.id,c.message,c),i.bind(console,n,...c.args)}return ms}}ae(xy,"VERSION",nE);function rE(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return ap(Number.isFinite(e)&&e>=0),e}function $x(t){const{logLevel:e,message:n}=t;t.logLevel=rE(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return ap(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function RI(t,e,n){if(typeof e=="string"){const i=n.time?CI(II(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=kI(e,n.color,n.background)}return e}function DI(t){return console.warn("removed"),ms}function zI(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const c=new Image;return c.onload=()=>{const p=Sg(c,n,i);console.log(...p)},c.src=e,ms}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...Sg(e,n,i)),ms;if(r.toLowerCase()==="canvas"){const c=new Image;return c.onload=()=>console.log(...Sg(c,n,i)),c.src=e.toDataURL(),ms}return ms}function BI(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const ii=new xy({id:"deck"});let O1={};function OI(t){O1=t}function Wr(t,e,n,i){ii.level>0&&O1[t]&&O1[t].call(null,e,n,i)}function FI(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const NI={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:FI,parseTextSync:JSON.parse};function UI(){const t="8.9.22",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(ii.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:ii,_registerLoggers:OI},yM([NI,[TI,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const VI=UI(),Un={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Un,"IDENTITY",{get:()=>(ii.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const wa={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Wx={common:0,meters:1,pixels:2},Zx={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},nn=new xy({id:"luma.gl"});function co(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const jI="Invalid WebGLRenderingContext",GI="Requires WebGL2";function lm(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function On(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function HI(t){return On(t)?t:null}function cm(t){return co(lm(t),jI),t}function uo(t){return co(On(t),GI),t}const ad={};function $I(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function WI(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function ZI(t,e){ad[t]=!0,e!==void 0&&$I(e)}function qI(t){const e=t.getError;t.getError=function(){let i;do i=e.apply(t),i!==0&&(ad[i]=!0);while(i!==0);for(i in ad)if(ad[i])return delete ad[i],parseInt(i,10);return 0}}const fA=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new t.VertexAttrib(n);this.attribs[i]=r}this.maxAttrib=0};fA.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};fA.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const bu=function(e){const n=this;this.gl=e,qI(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(c){return c===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(c){const p=n.currentVertexArrayObject;p.maxAttrib=Math.max(p.maxAttrib,c);const a=p.attribs[c];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(c){const p=n.currentVertexArrayObject;p.maxAttrib=Math.max(p.maxAttrib,c);const a=p.attribs[c];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(c,p){switch(c){case 34962:n.currentArrayBuffer=p;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=p;break}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(c,p){const T=n.currentVertexArrayObject.attribs[c];switch(p){case 34975:return T.buffer;case 34338:return T.enabled;case 34339:return T.size;case 34340:return T.stride;case 34341:return T.type;case 34922:return T.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(c,p,a,T,k,z){const B=n.currentVertexArrayObject;B.maxAttrib=Math.max(B.maxAttrib,c);const D=B.attribs[c];return D.buffer=n.currentArrayBuffer,D.size=p,D.type=a,D.normalized=T,D.stride=k,D.offset=z,D.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{WI("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};bu.prototype.VERTEX_ARRAY_BINDING_OES=34229;bu.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new fA(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};bu.prototype.createVertexArrayOES=function(){const e=new fA(this);return this.vertexArrayObjects.push(e),e};bu.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};bu.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof fA&&e.hasBeenBound&&e.ext===this)};bu.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){ZI(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const c=this.currentVertexArrayObject;if(r===c)return;(!r||c.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(n,34963,c.elementArrayBuffer);let p=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,c.maxAttrib);for(let T=0;T<=a;T++){const k=c.attribs[T],z=r?r.attribs[T]:null;if((!r||k.enabled!==z.enabled)&&(k.enabled?i.enableVertexAttribArray.call(n,T):i.disableVertexAttribArray.call(n,T)),k.enabled){let B=!1;(!r||k.buffer!==z.buffer)&&(p!==k.buffer&&(i.bindBuffer.call(n,34962,k.buffer),p=k.buffer),B=!0),(B||k.cached!==z.cached)&&i.vertexAttribPointer.call(n,T,k.size,k.type,k.normalized,k.stride,k.offset)}}this.currentArrayBuffer!==p&&i.bindBuffer.call(n,34962,this.currentArrayBuffer)};function QI(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const n=t.getExtension;t.getExtension=function(r){const c=n.call(this,r);return c||(r!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new bu(this)),this.__OESVertexArrayObject))}}const qx="OES_element_index",Qx="WEBGL_draw_buffers",XI="EXT_disjoint_timer_query",YI="EXT_disjoint_timer_query_webgl2",KI="EXT_texture_filter_anisotropic",Xx="WEBGL_debug_renderer_info",JI=35723,eC=4352,tC=36795,nC=34047,iC=37445,rC=37446,fi=t=>On(t)?void 0:0,oC={3074:t=>On(t)?void 0:36064,[JI]:t=>On(t)?void 0:eC,35977:fi,32937:fi,[tC]:(t,e)=>{const n=On(t)?t.getExtension(YI):t.getExtension(XI);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[iC]:(t,e)=>{const n=t.getExtension(Xx);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[rC]:(t,e)=>{const n=t.getExtension(Xx);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[nC]:(t,e)=>{const n=t.luma.extensions[KI];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:fi,35071:fi,37447:fi,36063:(t,e)=>{if(!On(t)){const n=t.getExtension(Qx);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:fi,35374:fi,35377:fi,34852:t=>{if(!On(t)){const e=t.getExtension(Qx);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(qx)?2147483647:65535,33001:t=>t.getExtension(qx)?16777216:65535,33e3:t=>16777216,37157:fi,35373:fi,35657:fi,36183:fi,37137:fi,34045:fi,35978:fi,35979:fi,35968:fi,35376:fi,35375:fi,35659:fi,37154:fi,35371:fi,35658:fi,35076:fi,35077:fi,35380:fi};function sC(t,e,n){const i=oC[n],r=typeof i=="function"?i(t,e,n):i;return r!==void 0?r:e(n)}const aC="OES_vertex_array_object",oE="ANGLE_instanced_arrays",lC="WEBGL_draw_buffers",cC="EXT_disjoint_timer_query",uC="EXT_texture_filter_anisotropic",fC="VertexArray requires WebGL2 or OES_vertex_array_object extension";function hC(t,e){return{webgl2:On(t),ext:t.getExtension(e)}}const sE={[aC]:{meta:{suffix:"OES"},createVertexArray:()=>{co(!1,fC)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[oE]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){co(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[lC]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{co(!1)}},[cC]:{meta:{suffix:"EXT"},createQuery:()=>{co(!1)},deleteQuery:()=>{co(!1)},beginQuery:()=>{co(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},Mg={readBuffer:(t,e,n)=>{On(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:c}=hC(t,oE);let p;switch(i){case 35069:p=r?void 0:!1;break;case 35070:p=!r&&!c?0:void 0;break}return p!==void 0?p:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!On(t))switch(i){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>{if(!On(t))switch(r){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,i,r)},getTexParameter(t,e,n,i){switch(i){case 34046:const{extensions:r}=t.luma,c=r[uC];i=c&&c.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,i)},getParameter:sC,hint(t,e,n,i){return e(n,i)}};function dC(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(QI(t),AC(t),mC(t,sE),pC(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=dC;function AC(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function pC(t,e){let{target:n,target2:i}=e;Object.keys(Mg).forEach(r=>{if(typeof Mg[r]=="function"){const c=t[r]?t[r].bind(t):()=>{},p=Mg[r].bind(null,t,c);n[r]=p,i[r]=p}})}function mC(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&gC(t,{extension:n,target:t.luma,target2:t})}function gC(t,e){let{extension:n,target:i,target2:r}=e;const c=sE[n];co(c);const{meta:p={}}=c,{suffix:a=""}=p,T=t.getExtension(n);for(const k of Object.keys(c)){const z="".concat(k).concat(a);let B=null;k==="meta"||typeof t[k]=="function"||(T&&typeof T[z]=="function"?B=function(){return T[z](...arguments)}:typeof c[k]=="function"&&(B=c[k].bind(i))),B&&(i[k]=B,r[k]=B)}}const wy={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},$l=(t,e,n)=>e?t.enable(n):t.disable(n),Yx=(t,e,n)=>t.hint(n,e),Vo=(t,e,n)=>t.pixelStorei(n,e),_C=(t,e)=>{const n=On(t)?36009:36160;return t.bindFramebuffer(n,e)},yC=(t,e)=>t.bindFramebuffer(36008,e);function Zh(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const vC={3042:$l,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:$l,2885:(t,e)=>t.cullFace(e),2929:$l,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:$l,35723:Yx,36006:_C,2886:(t,e)=>t.frontFace(e),33170:Yx,2849:(t,e)=>t.lineWidth(e),32823:$l,32824:"polygonOffset",10752:"polygonOffset",35977:$l,32938:"sampleCoverage",32939:"sampleCoverage",3089:$l,3088:(t,e)=>t.scissor(...e),2960:$l,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Vo,3317:Vo,37440:Vo,37441:Vo,37443:Vo,3330:Vo,3332:Vo,3331:Vo,36010:yC,3314:Vo,32878:Vo,3316:Vo,3315:Vo,32877:Vo,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Zh(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Zh(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Zh(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=Zh(e)&&e.length===3?[...e,...e]:e;const[n,i,r,c,p,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,c,p,a)},stencilOp:(t,e)=>{e=Zh(e)&&e.length===3?[...e,...e]:e;const[n,i,r,c,p,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,c,p,a)},viewport:(t,e)=>t.viewport(...e)};function Ui(t,e,n){return e[t]!==void 0?e[t]:n[t]}const xC={blendEquation:(t,e,n)=>t.blendEquationSeparate(Ui(32777,e,n),Ui(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Ui(32969,e,n),Ui(32968,e,n),Ui(32971,e,n),Ui(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Ui(32824,e,n),Ui(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Ui(32938,e,n),Ui(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Ui(2962,e,n),Ui(2967,e,n),Ui(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Ui(34816,e,n),Ui(36003,e,n),Ui(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Ui(2964,e,n),Ui(2965,e,n),Ui(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Ui(34817,e,n),Ui(34818,e,n),Ui(34819,e,n))},Kx={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:i,[e===1028?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:i,[e===1028?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Aa=(t,e)=>t.isEnabled(e),Jx={3042:Aa,2884:Aa,2929:Aa,3024:Aa,32823:Aa,32926:Aa,32928:Aa,3089:Aa,2960:Aa,35977:Aa};function aE(t){for(const e in t)return!1;return!0}function wC(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function ew(t,e){const n=t[e].bind(t);t[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in t.state.cache?t.state.enable?t.state.cache[r]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function bC(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var c=arguments.length,p=new Array(c),a=0;a<c;a++)p[a]=arguments[a];const{valueChanged:T,oldValue:k}=n(t.state._updateCache,...p);return T&&i(...p),k},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function EC(t){const e=t.useProgram.bind(t);t.useProgram=function(i){t.state.program!==i&&(e(i),t.state.program=i)}}class TC{constructor(e){let{copyState:n=!1,log:i=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?MC(e):Object.assign({},wy),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){co(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];ml(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,i;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const c in e){co(c!==void 0);const p=e[c],a=this.cache[c];wC(p,a)||(n=!0,i=a,r&&!(c in r)&&(r[c]=a),this.cache[c]=p)}return{valueChanged:n,oldValue:i}}}function lE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(co(i!==void 0),!t.state){const{polyfillContext:r}=globalThis;r&&r(t),t.state=new TC(t,{copyState:i}),EC(t);for(const c in Kx){const p=Kx[c];bC(t,c,p)}ew(t,"getParameter"),ew(t,"isEnabled")}return t.state.enable=n,t}function SC(t){t.state||lE(t,{copyState:!1}),t.state.push()}function tw(t){co(t.state),t.state.pop()}function ml(t,e){if(co(lm(t),"setParameters requires a WebGL context"),aE(e))return;const n={};for(const r in e){const c=Number(r),p=vC[r];p&&(typeof p=="string"?n[p]=!0:p(t,e[r],c))}const i=t.state&&t.state.cache;if(i)for(const r in n){const c=xC[r];c(t,e,i)}}function MC(t,e){if(e=e||wy,typeof e=="number"){const r=e,c=Jx[r];return c?c(t,r):t.getParameter(r)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const c=Jx[r];i[r]=c?c(t,Number(r)):t.getParameter(Number(r))}return i}function IC(t){ml(t,wy)}function Ws(t,e,n){if(aE(e))return n(t);const{nocatch:i=!0}=e;SC(t),ml(t,e);let r;if(i)r=n(t),tw(t);else try{r=n(t)}finally{tw(t)}return r}function qf(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,i="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return i?t.drawingBufferWidth/i:1}return 1}function Ig(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=qf(t),r=t.drawingBufferWidth,c=t.drawingBufferHeight;return kC(e,i,r,c,n)}function CC(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function kC(t,e,n,i,r){const c=nw(t[0],e,n);let p=iw(t[1],e,i,r),a=nw(t[0]+1,e,n);const T=a===n-1?a:a-1;a=iw(t[1]+1,e,i,r);let k;return r?(a=a===0?a:a+1,k=p,p=a):k=a===i-1?a:a-1,{x:c,y:p,width:Math.max(T-c+1,1),height:Math.max(k-p+1,1)}}function nw(t,e,n){return Math.min(Math.round(t*e),n-1)}function iw(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const by=wl(),PC=by&&typeof document<"u",cE={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function uE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};co(by,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},cE,t);const{width:e,height:n}=t;function i(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=i;let r;const{canvas:c}=t,p=zC({canvas:c,width:e,height:n,onError:i});return r=DC(p,t),r?(r=Ey(r,t),BC(r),r):null}function Ey(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||OC(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},cE,e);const{manageState:n,debug:i}=e;return n&&lE(t,{copyState:!1,log:function(){for(var r=arguments.length,c=new Array(r),p=0;p<r;p++)c[p]=arguments[p];return nn.log(1,...c)()}}),by&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),nn.level=Math.max(nn.level,1)):nn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function LC(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info"),r=i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),c=i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||e,renderer:c||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function RC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const i=CC(e.useDevicePixels);FC(t,i,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function DC(t,e){const{onError:n}=e;let i=null;const r=T=>i=T.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:c=!0,webgl2:p=!0}=e;let a=null;return p&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),c&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(p&&!c?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function zC(t){let{canvas:e,width:n=800,height:i=600,onError:r}=t,c;return typeof e=="string"?(PC&&document.readyState==="complete"||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),c=document.getElementById(e)):e?c=e:(c=document.createElement("canvas"),c.id="lumagl-canvas",c.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",c.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(c,document.body.firstChild)),c}function BC(t){const e=On(t)?"WebGL2":"WebGL1",n=LC(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";nn.info(1,"".concat(e).concat(r," context ").concat(i))()}function OC(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function FC(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;(!i||!r)&&(nn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const c=t.luma.canvasSizeInfo;if(c.clientWidth!==i||c.clientHeight!==r||c.devicePixelRatio!==e){let p=e;const a=Math.floor(i*p),T=Math.floor(r*p);t.canvas.width=a,t.canvas.height=T,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==T)&&(nn.warn("Device pixel ratio clamped")(),p=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*p),t.canvas.height=Math.floor(r*p)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}function rw(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class ow{constructor(e,n){ae(this,"name",void 0),ae(this,"type",void 0),ae(this,"sampleSize",1),ae(this,"time",void 0),ae(this,"count",void 0),ae(this,"samples",void 0),ae(this,"lastTiming",void 0),ae(this,"lastSampleTime",void 0),ae(this,"lastSampleCount",void 0),ae(this,"_count",0),ae(this,"_time",0),ae(this,"_samples",0),ae(this,"_startTime",0),ae(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=rw(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(rw()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Ty{constructor(e){ae(this,"id",void 0),ae(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof ow?this.stats[n]=e:this.stats[n]=new ow(n,i)),this.stats[n]}}const _d="8.5.20",NC="set luma.log.level=1 (or higher) to trace rendering";class UC{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new Ty({id:e})),this.stats.get(e)}}const iu=new UC;if(globalThis.luma&&globalThis.luma.VERSION!==_d)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(_d));globalThis.luma||(wl()&&nn.log(1,"luma.gl ".concat(_d," - ").concat(NC))(),globalThis.luma=globalThis.luma||{VERSION:_d,version:_d,log:nn,stats:iu,globals:{modules:{},nodeIO:{}}});function VC(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function jC(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Vt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Cg(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const i=t[e];return Vt(i!==void 0,"Accessing undefined constant GL.".concat(e)),i}function sc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const kg={};function mc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";kg[t]=kg[t]||1;const e=kg[t]++;return"".concat(t,"-").concat(e)}function sw(t){return Vt(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function Qf(t){let e=!0;for(const n in t){e=!1;break}return e}function fE(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),c=Object.getPrototypeOf(t);i.forEach(p=>{c.methodName||(c[p]=()=>{throw nn.removed("Calling removed method ".concat(e,".").concat(p,": "),r)(),new Error(p)})})}const Af="Resource subclass must define virtual methods";let bl=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cm(e);const{id:i,userData:r={}}=n;this.gl=e,this.gl2=e,this.id=i||mc(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(i=>i.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=Cg(this.gl,e),Vt(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const c=On(this.gl);if(!((!("webgl2"in r)||c)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const a=r.webgl1,T="webgl2"in r?r.webgl2:r.webgl1;return c?T:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:i}=e,r=this.constructor.PARAMETERS||{},c=On(this.gl),p={},a=n||Object.keys(r);for(const T of a){const k=r[T];if(k&&(!("webgl2"in k)||c)&&(!("extension"in k)||this.gl.getExtension(k.extension))){const B=i?sc(this.gl,T):T;p[B]=this.getParameter(T,e),i&&k.type==="GLenum"&&(p[B]=sc(this.gl,p[B]))}}return p}setParameter(e,n){e=Cg(this.gl,e),Vt(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const c=On(this.gl);if(!((!("webgl2"in r)||c)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");r.type==="GLenum"&&(n=Cg(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,i){return fE(this,e,n,i)}initialize(e){}_createHandle(){throw new Error(Af)}_deleteHandle(){throw new Error(Af)}_bindHandle(e){throw new Error(Af)}_getOptsFromHandle(){throw new Error(Af)}_getParameter(e,n){throw new Error(Af)}_setParameter(e,n){throw new Error(Af)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=iu.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];iu.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const r=iu.get("Memory Usage".concat(i));r.get("GPU Memory").addCount(e),r.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const i=iu.get("Memory Usage".concat(n));i.get("GPU Memory").subtractCount(this.byteLength),i.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const GC="Failed to deduce GL constant from typed array";function F1(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(GC)}}function Pd(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function HC(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:c}=t;const p=n*r;c=c||new Uint8Array(p);for(let a=0;a<i/2;++a){const T=a*p,k=(i-a-1)*p;c.set(e.subarray(T,T+p)),e.copyWithin(T,k,k+p),e.set(c,k)}}function $C(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),c=Math.round(i/2),p=new Uint8Array(r*c*4);for(let a=0;a<c;a++)for(let T=0;T<r;T++)for(let k=0;k<4;k++)p[(a*r+T)*4+k]=e[(a*2*n+T*2)*4+k];return{data:p,width:r,height:c}}function N1(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:c={}}=n;for(const a in i)if(a in e){const k=i[a]?"".concat(t,".").concat(i[a]):"N/A";nn.removed("".concat(t,".").concat(a),k)()}for(const a in r)if(a in e){const T=r[a];nn.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(T))()}let p=null;for(const a in c)if(a in e){const T=c[a];nn.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(T))(),p=p||Object.assign({},e),p[T]=e[a],delete p[a]}return p||e}const WC={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},ZC={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Wo{static getBytesPerElement(e){return Pd(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Vt(e.size),Pd(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new Wo(WC,...n)}constructor(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Wo.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Wo.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=N1("Accessor",e,ZC),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const aw=10,hE={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},qC={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:hE},QC={removedProps:hE};class ni extends bl{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Wo.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Wo.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=N1("Buffer",e,qC),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=N1("Buffer",e,QC),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Wo(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:i=0,srcOffset:r=0}=e,c=e.byteLength||e.length;Vt(n);const p=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(p,this.handle),r!==0||c!==void 0?(uo(this.gl),this.gl.bufferSubData(this.target,i,n,r,c)):this.gl.bufferSubData(p,i,n),this.gl.bindBuffer(p,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:i=0,writeOffset:r=0,size:c}=e;const{gl:p}=this;return uo(p),p.bindBuffer(36662,n.handle),p.bindBuffer(36663,this.handle),p.copyBufferSubData(36662,36663,i,r,c),p.bindBuffer(36662,null),p.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:i=0,length:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};uo(this.gl);const c=Pd(this.accessor.type||5126,{clamped:!1}),p=this._getAvailableElementCount(n),a=i;let T,k;e?(k=e.length,T=k-a):(T=Math.min(p,r||p),k=a+T);const z=Math.min(p,T);return r=r||z,Vt(r<=z),e=e||new c(k),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?r!==void 0?this.gl.bindBufferRange(e,n,this.handle,i,r):(Vt(i===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(aw,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Vt(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,n,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,aw),this.bytesUsed=i,this._trackAllocatedMemory(i);const c=F1(e);return Vt(c),this.setAccessor(new Wo(this.accessor,{type:c})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Vt(e>=0),this._trackDeallocatedMemory();let i=e;e===0&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,n),this.gl.bindBuffer(r,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Pd(this.accessor.type||5126,{clamped:!1}),i=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new Wo(this.accessor,{type:F1(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return nn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return nn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return nn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return nn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Wo(this.accessor,e),this}}const Sy={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},dE={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},AE={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function XC(t,e){const n=Sy[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const i=On(t)&&n.gl2||n.gl1;return typeof i=="string"?t.getExtension(i):i}function YC(t,e){const n=Sy[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const KC=[9729,9728],lw=globalThis.WebGLBuffer||function(){};class Xf extends bl{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:i,linearFiltering:r}=n;let c=!0;return i&&(c=c&&XC(e,i),c=c&&(!r||YC(e,i))),c}constructor(e,n){const{id:i=mc("texture"),handle:r,target:c}=n;super(e,{id:i,handle:r}),this.target=c,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(ne=>this.initialize(Object.assign({},e,{pixels:ne,data:ne}))),this;const i=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(i&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:c=6408,border:p=0,recreate:a=!1,parameters:T={},pixelStore:k={},textureUnit:z=void 0}=e;n||(n=r);let{width:B,height:D,dataFormat:K,type:ee,compressed:le=!1,mipmaps:Ce=!0}=e;const{depth:se=0}=e;return{width:B,height:D,compressed:le,dataFormat:K,type:ee}=this._deduceParameters({format:c,type:ee,dataFormat:K,compressed:le,data:n,width:B,height:D}),this.width=B,this.height=D,this.depth=se,this.format=c,this.type=ee,this.dataFormat=K,this.border=p,this.textureUnit=z,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),Ce&&this._isNPOT()&&(nn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),Ce=!1,this._updateForNPOT(T)),this.mipmaps=Ce,this.setImageData({data:n,width:B,height:D,depth:se,format:c,type:ee,dataFormat:K,border:p,mipmaps:Ce,parameters:k,compressed:le}),Ce&&this.generateMipmap(),this.setParameters(T),a&&(this.data=n),i&&(this._video={video:n,parameters:T,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:i,mipmaps:r=!1}=e;return i!==this.width||n!==this.height?this.initialize({width:i,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(nn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Ws(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:i=null,level:r=0,format:c=this.format,border:p=this.border,offset:a=0,parameters:T={}}=e;let{data:k=null,type:z=this.type,width:B=this.width,height:D=this.height,dataFormat:K=this.dataFormat,compressed:ee=!1}=e;k||(k=i),{type:z,dataFormat:K,compressed:ee,width:B,height:D}=this._deduceParameters({format:c,type:z,dataFormat:K,compressed:ee,data:k,width:B,height:D});const{gl:le}=this;le.bindTexture(this.target,this.handle);let Ce=null;({data:k,dataType:Ce}=this._getDataType({data:k,compressed:ee}));let se,ne=0;if(Ws(this.gl,T,()=>{switch(Ce){case"null":le.texImage2D(n,r,c,B,D,p,K,z,k);break;case"typed-array":le.texImage2D(n,r,c,B,D,p,K,z,k,a);break;case"buffer":se=uo(le),se.bindBuffer(35052,k.handle||k),se.texImage2D(n,r,c,B,D,p,K,z,a),se.bindBuffer(35052,null);break;case"browser-object":On(le)?le.texImage2D(n,r,c,B,D,p,K,z,k):le.texImage2D(n,r,c,K,z,k);break;case"compressed":for(const[te,xe]of k.entries())le.compressedTexImage2D(n,te,xe.format,xe.width,xe.height,p,xe.data),ne+=xe.levelSize;break;default:Vt(!1,"Unknown image data type")}}),Ce==="compressed")this._trackAllocatedMemory(ne,"Texture");else if(k&&k.byteLength)this._trackAllocatedMemory(k.byteLength,"Texture");else{const te=dE[this.dataFormat]||4,xe=AE[this.type]||1;this._trackAllocatedMemory(this.width*this.height*te*xe,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:i=null,data:r=null,x:c=0,y:p=0,width:a=this.width,height:T=this.height,level:k=0,format:z=this.format,type:B=this.type,dataFormat:D=this.dataFormat,compressed:K=!1,offset:ee=0,border:le=this.border,parameters:Ce={}}=e;if({type:B,dataFormat:D,compressed:K,width:a,height:T}=this._deduceParameters({format:z,type:B,dataFormat:D,compressed:K,data:r,width:a,height:T}),Vt(this.depth===0,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const se=r;r=se.data,a=se.shape[0],T=se.shape[1]}r instanceof ni&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),Ws(this.gl,Ce,()=>{if(K)this.gl.compressedTexSubImage2D(n,k,c,p,a,T,z,r);else if(r===null)this.gl.texSubImage2D(n,k,c,p,a,T,D,B,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(n,k,c,p,a,T,D,B,r,ee);else if(r instanceof lw){const se=uo(this.gl);se.bindBuffer(35052,r),se.texSubImage2D(n,k,c,p,a,T,D,B,ee),se.bindBuffer(35052,null)}else On(this.gl)?uo(this.gl).texSubImage2D(n,k,c,p,a,T,D,B,r):this.gl.texSubImage2D(n,k,c,p,D,B,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return nn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:i=!1}=e;return i?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ni?{data:n.handle,dataType:"buffer"}:n instanceof lw?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:i}=e;let{width:r,height:c,dataFormat:p,type:a,compressed:T}=e;const k=Sy[n];return p=p||k&&k.dataFormat,a=a||k&&k.types[0],T=T||k&&k.compressed,{width:r,height:c}=this._deduceImageSize(i,r,c),{dataFormat:p,type:a,compressed:T,width:r,height:c,format:n,data:i}}_deduceImageSize(e,n,i){let r;return typeof ImageData<"u"&&e instanceof ImageData?r={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?r={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?r={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?r={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?r={width:e.videoWidth,height:e.videoHeight}:e?r={width:n,height:i}:r={width:n>=0?n:1,height:i>=0?i:1},Vt(r,"Could not deduced texture size"),Vt(n===void 0||r.width===n,"Deduced texture width does not match supplied width"),Vt(i===void 0||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Vt(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return On(this.gl)||!this.width||!this.height?!1:!sw(this.width)||!sw(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:KC.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let JC="";function ek(t,e){return Vt(typeof t=="string"),t=JC+t,new Promise((n,i)=>{try{const r=new Image;r.onload=()=>n(r),r.onerror=()=>i(new Error("Could not load image ".concat(t,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=t}catch(r){i(r)}})}class ws extends Xf{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Xf.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cm(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:ek(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const U1=[34069,34070,34071,34072,34073,34074];class pE extends Xf{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cm(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:i={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(i)}),this}subImage(e){let{face:n,data:i,x:r=0,y:c=0,mipmapLevel:p=0}=e;return this._subImage({target:n,data:i,x:r,y:c,mipmapLevel:p})}async setCubeMapImageData(e){let{width:n,height:i,pixels:r,data:c,border:p=0,format:a=6408,type:T=5121}=e;const{gl:k}=this,z=r||c,B=await Promise.all(U1.map(D=>{const K=z[D];return Promise.all(Array.isArray(K)?K:[K])}));this.bind(),U1.forEach((D,K)=>{B[K].length>1&&this.opts.mipmaps!==!1&&nn.warn("".concat(this.id," has mipmap and multiple LODs."))(),B[K].forEach((ee,le)=>{n&&i?k.texImage2D(D,le,a,n,i,p,a,T,ee):k.texImage2D(D,le,a,a,T,ee)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:i,height:r,pixels:c,data:p,border:a=0,format:T=6408,type:k=5121}=e,{gl:z}=this,B=c||p;return this.bind(),B instanceof Promise?B.then(D=>this.setImageDataForFace(Object.assign({},e,{face:n,data:D,pixels:D}))):this.width||this.height?z.texImage2D(n,0,T,i,r,a,T,k,B):z.texImage2D(n,0,T,T,k,B),this}}pE.FACES=U1;class tk extends Xf{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return On(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};uo(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:i=6408,width:r,height:c,depth:p=1,border:a=0,format:T,type:k=5121,offset:z=0,data:B,parameters:D={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Ws(this.gl,D,()=>{ArrayBuffer.isView(B)&&this.gl.texImage3D(this.target,n,i,r,c,p,a,T,k,B),B instanceof ni&&(this.gl.bindBuffer(35052,B.handle),this.gl.texImage3D(this.target,n,i,r,c,p,a,T,k,z))}),B&&B.byteLength)this._trackAllocatedMemory(B.byteLength,"Texture");else{const K=dE[this.dataFormat]||4,ee=AE[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*K*ee,"Texture")}return this.loaded=!0,this}}const Xc="EXT_color_buffer_float",cw={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Xc,bpp:2},33327:{gl2:Xc,bpp:4},34842:{gl2:Xc,bpp:8},33326:{gl2:Xc,bpp:4},33328:{gl2:Xc,bpp:8},34836:{gl2:Xc,bpp:16},35898:{gl2:Xc,bpp:4}};function nk(t,e,n){const i=n[e];if(!i)return!1;const r=On(t)&&i.gl2||i.gl1;return typeof r=="string"?t.getExtension(r):r}class vf extends bl{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||nk(e,n,cw)}static getSamplesForFormat(e,n){let{format:i}=n;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:i=1,height:r=1,samples:c=0}=e;return Vt(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),c!==0&&On(this.gl)?this.gl.renderbufferStorageMultisample(36161,c,n,i,r):this.gl.renderbufferStorage(36161,n,i,r),this.format=n,this.width=i,this.height=r,this.samples=c,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*cw[this.format].bpp),this}resize(e){let{width:n,height:i}=e;return n!==this.width||i!==this.height?this.initialize({width:n,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const ik=256,rk=1024,ok=16384,uw=6144,fw=6145,hw=6146,dw=34041,mE="clear: bad arguments";function My(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c={};e&&(c.framebuffer=e);let p=0;n&&(p|=ok,n!==!0&&(c.clearColor=n)),i&&(p|=ik,i!==!0&&(c.clearDepth=i)),r&&(p|=rk,i!==!0&&(c.clearStencil=i)),Vt(p!==0,mE),Ws(t,c,()=>{t.clear(p)})}function sk(t){let{framebuffer:e=null,buffer:n=uw,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};uo(t),Ws(t,{framebuffer:e},()=>{switch(n){case uw:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case fw:t.clearBufferfv(fw,0,[r]);break;case hw:t.clearBufferiv(hw,0,[r]);break;case dw:const[c,p]=r;t.clearBufferfi(dw,0,c,p);break;default:Vt(!1,mE)}})}function ak(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Vt(!1),0}}function um(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:c=36064,target:p=null,sourceWidth:a,sourceHeight:T,sourceType:k}=e;const{framebuffer:z,deleteFramebuffer:B}=lk(t);Vt(z);const{gl:D,handle:K,attachments:ee}=z;a=a||z.width,T=T||z.height,c===36064&&K===null&&(c=1028),Vt(ee[c]),k=k||ee[c].type,p=ck(p,k,r,a,T),k=k||F1(p);const le=D.bindFramebuffer(36160,K);return D.readPixels(n,i,a,T,r,k,p),D.bindFramebuffer(36160,le||null),B&&z.delete(),p}function Aw(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=um(t,{sourceAttachment:e}),{width:r,height:c}=t;for(;c>n;)({data:i,width:r,height:c}=$C({data:i,width:r,height:c}));HC({data:i,width:r,height:c});const p=document.createElement("canvas");p.width=r,p.height=c;const a=p.getContext("2d"),T=a.createImageData(r,c);return T.data.set(i),a.putImageData(T,0,0),p.toDataURL()}function lk(t){return t instanceof fr?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:_k(t),deleteFramebuffer:!0}}function ck(t,e,n,i,r){if(t)return t;e=e||5121;const c=Pd(e,{clamped:!1}),p=ak(n);return new c(i*r*p)}const hi={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function uk(t){const e=new ws(t,{format:6408,type:5126,dataFormat:6408}),n=new fr(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),i===36053}const gE={[hi.WEBGL2]:[!1,!0],[hi.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[hi.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[hi.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[hi.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[hi.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[hi.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[hi.FLOAT_BLEND]:["EXT_float_blend"],[hi.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[hi.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[hi.TEXTURE_FLOAT]:["OES_texture_float",!0],[hi.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[hi.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[hi.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[hi.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[hi.COLOR_ATTACHMENT_RGBA32F]:[uk,"EXT_color_buffer_float"],[hi.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[hi.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[hi.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[hi.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[hi.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[hi.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},fk=2;function _E(t,e){return Iy(t,e)}function Iy(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>yE(t,n))}function hk(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in gE)t.luma.caps[e]===void 0&&(t.luma.caps[e]=yE(t,e));return t.luma.caps}function yE(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=dk(t,e)),t.luma.caps[e]||nn.log(fk,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function dk(t,e){const n=gE[e];Vt(n,e);let i;const r=On(t)&&n[1]||n[0];if(typeof r=="function")i=r(t);else if(Array.isArray(r)){i=!0;for(const c of r)i=i&&!!t.getExtension(c)}else typeof r=="string"?i=!!t.getExtension(r):typeof r=="boolean"?i=r:Vt(!1);return i}const pw="Multiple render targets not supported";class fr extends bl{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=n;let c=!0;return i&&(c=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(c=c&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),c}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new fr(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=uo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=uo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:i=1,attachments:r=null,color:c=!0,depth:p=!0,stencil:a=!1,check:T=!0,readBuffer:k=void 0,drawBuffers:z=void 0}=e;if(Vt(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,r)for(const B in r){const D=r[B];(Array.isArray(D)?D[0]:D).resize({width:n,height:i})}else r=this._createDefaultAttachments(c,p,a,n,i);this.update({clearAttachments:!0,attachments:r,readBuffer:k,drawBuffers:z}),r&&T&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:i,drawBuffers:r,clearAttachments:c=!1,resizeAttachments:p=!0}=e;this.attach(n,{clearAttachments:c,resizeAttachments:p});const{gl:a}=this,T=a.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),a.bindFramebuffer(36160,T||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:i}=e;if(this.handle===null)return Vt(n===void 0&&i===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),i===void 0&&(i=this.gl.drawingBufferHeight),n!==this.width&&i!==this.height&&nn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:n,height:i});return this.width=n,this.height=i,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:i=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={};n&&Object.keys(this.attachments).forEach(p=>{r[p]=null}),Object.assign(r,e);const c=this.gl.bindFramebuffer(36160,this.handle);for(const p in r){Vt(p!==void 0,"Misspelled framebuffer binding point?");const a=Number(p),T=r[a];let k=T;if(!k)this._unattach(a);else if(k instanceof vf)this._attachRenderbuffer({attachment:a,renderbuffer:k});else if(Array.isArray(T)){const[z,B=0,D=0]=T;k=z,this._attachTexture({attachment:a,texture:z,layer:B,level:D})}else this._attachTexture({attachment:a,texture:k,layer:0,level:0});i&&k&&k.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,c||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(p=>!this.attachments[p]).forEach(p=>{delete this.attachments[p]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(pk(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),i}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:i,stencil:r,drawBuffers:c=[]}=e,p=this.gl.bindFramebuffer(36160,this.handle);return(n||i||r)&&My(this.gl,{color:n,depth:i,stencil:r}),c.forEach((a,T)=>{sk(this.gl,{drawBuffer:T,value:a})}),this.gl.bindFramebuffer(36160,p||null),this}readPixels(){return nn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return nn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return nn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return nn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return nn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return nn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:i=0,y:r=0,width:c,height:p}=e;const a=uo(this.gl),T=a.bindFramebuffer(36008,this.handle);return i===0&&r===0&&c===void 0&&p===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,i,r,c,p),a.bindFramebuffer(36008,T),this}getAttachmentParameter(e,n,i){let r=this._getAttachmentParameterFallback(n);return r===null&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=sc(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const c of i){const p=n?sc(this.gl,c):c;r[p]=this.getAttachmentParameter(e,c,n)}return r}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),i={};for(const r of n){const c=Number(r),p=e?sc(this.gl,c):c;i[p]=this.getAttachmentParameters(c,e)}return i}show(){return typeof window<"u"&&window.open(Aw(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>nn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const i=Aw(this,{targetMaxHeight:100});return nn.image({logLevel:e,message:n,image:i},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,i,r,c){let p=null;return e&&(p=p||{},p[36064]=new ws(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:c,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(p[36064])),n&&i?(p=p||{},p[33306]=new vf(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(p[33306])):n?(p=p||{},p[36096]=new vf(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:c}),this.ownResources.push(p[36096])):i&&Vt(!1),p}_unattach(e){const n=this.attachments[e];n&&(n instanceof vf?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,n,36161,i.handle),this.attachments[n]=i}_attachTexture(e){let{attachment:n=36064,texture:i,layer:r,level:c}=e;const{gl:p}=this;switch(p.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:uo(p).framebufferTextureLayer(36160,n,i.target,c,r);break;case 34067:const T=Ak(r);p.framebufferTexture2D(36160,n,T,i.handle,c);break;case 3553:p.framebufferTexture2D(36160,n,3553,i.handle,c);break;default:Vt(!1,"Illegal texture type")}p.bindTexture(i.target,null),this.attachments[n]=i}_setReadBuffer(e){const n=HI(this.gl);n?n.readBuffer(e):Vt(e===36064||e===1029,pw),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,i=uo(n);if(i)i.drawBuffers(e);else{const r=n.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):Vt(e.length===1&&(e[0]===36064||e[0]===1029),pw)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=hk(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function Ak(t){return t<34069?t+34069:t}function pk(t){return(fr.STATUS||{})[t]||"Framebuffer error ".concat(t)}const mk=[36049,36048,33296,33298,33299,33300,33301,33302,33303];fr.ATTACHMENT_PARAMETERS=mk;function gk(t,e){Vt(t instanceof ws||t instanceof pE||t instanceof tk);const n=t.constructor,{gl:i,width:r,height:c,format:p,type:a,dataFormat:T,border:k,mipmaps:z}=t,B=Object.assign({width:r,height:c,format:p,type:a,dataFormat:T,border:k,mipmaps:z},e);return new n(i,B)}function _k(t,e){const{gl:n,width:i,height:r,id:c}=t;return new fr(n,Object.assign({},e,{id:"framebuffer-for-".concat(c),width:i,height:r,attachments:{36064:t}}))}function O0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=t.match(n);return i?i[1]:e}const yk=35632,vk=35633;function xk(t){switch(t){case yk:return"fragment";case vk:return"vertex";default:return"unknown type"}}function wk(t,e,n,i){const r=t.split(/\r?\n/),c={},p={},a=i||O0(e)||"(unnamed)",T="".concat(xk(n)," shader ").concat(a);for(let z=0;z<r.length;z++){const B=r[z];if(B.length<=1)continue;const D=B.split(":"),K=D[0],ee=parseInt(D[2],10);if(isNaN(ee))throw new Error("GLSL compilation error in ".concat(T,": ").concat(t));K!=="WARNING"?c[ee]=B:p[ee]=B}const k=bk(e);return{shaderName:T,errors:mw(c,k),warnings:mw(p,k)}}function mw(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if(!(!t[i+3]&&!t[i+2]&&!t[i+1])&&(n+="".concat(r,`
`),t[i+1])){const c=t[i+1],p=c.split(":",3),a=p[0],T=parseInt(p[1],10)||0,k=c.substring(p.join(":").length+1).trim();n+=vE("^^^ ".concat(a,": ").concat(k,`

`),T)}}return n}function bk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((c,p)=>{const a=String(p+e),T=a.length;return vE(a,r-T)+n+c})}function vE(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}function xE(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const i=parseInt(n[1],10);Number.isFinite(i)&&(e=i)}return e}const Ek="Shader: GLSL source code must be a JavaScript string";class Ld extends bl{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Vt(!1),"unknown"}}constructor(e,n){cm(e),Vt(typeof n.source=="string",Ek);const i=O0(n.source,null)||n.id||mc("unnamed ".concat(Ld.getTypeName(n.shaderType)));super(e,{id:i}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const i=O0(n,null);i&&(this.id=mc(i)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Ld.getTypeName(this.shaderType),":").concat(this.id)}getName(){return O0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:c,warnings:p}=wk(i,this.source,this.shaderType,this.id);throw nn.error("GLSL compilation errors in ".concat(r,`
`).concat(c))(),nn.warn("GLSL compilation warnings in ".concat(r,`
`).concat(p))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Pg extends Ld{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Lg extends Ld{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Tk={5126:_i.bind(null,"uniform1fv",jo,1,jr),35664:_i.bind(null,"uniform2fv",jo,2,jr),35665:_i.bind(null,"uniform3fv",jo,3,jr),35666:_i.bind(null,"uniform4fv",jo,4,jr),5124:_i.bind(null,"uniform1iv",Wl,1,jr),35667:_i.bind(null,"uniform2iv",Wl,2,jr),35668:_i.bind(null,"uniform3iv",Wl,3,jr),35669:_i.bind(null,"uniform4iv",Wl,4,jr),35670:_i.bind(null,"uniform1iv",Wl,1,jr),35671:_i.bind(null,"uniform2iv",Wl,2,jr),35672:_i.bind(null,"uniform3iv",Wl,3,jr),35673:_i.bind(null,"uniform4iv",Wl,4,jr),35674:_i.bind(null,"uniformMatrix2fv",jo,4,al),35675:_i.bind(null,"uniformMatrix3fv",jo,9,al),35676:_i.bind(null,"uniformMatrix4fv",jo,16,al),35678:Cr,35680:Cr,5125:_i.bind(null,"uniform1uiv",YA,1,jr),36294:_i.bind(null,"uniform2uiv",YA,2,jr),36295:_i.bind(null,"uniform3uiv",YA,3,jr),36296:_i.bind(null,"uniform4uiv",YA,4,jr),35685:_i.bind(null,"uniformMatrix2x3fv",jo,6,al),35686:_i.bind(null,"uniformMatrix2x4fv",jo,8,al),35687:_i.bind(null,"uniformMatrix3x2fv",jo,6,al),35688:_i.bind(null,"uniformMatrix3x4fv",jo,12,al),35689:_i.bind(null,"uniformMatrix4x2fv",jo,8,al),35690:_i.bind(null,"uniformMatrix4x3fv",jo,12,al),35678:Cr,35680:Cr,35679:Cr,35682:Cr,36289:Cr,36292:Cr,36293:Cr,36298:Cr,36299:Cr,36300:Cr,36303:Cr,36306:Cr,36307:Cr,36308:Cr,36311:Cr},Sk={},Mk={},Ik={},gw=[0];function Cy(t,e,n,i){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(gw[0]=t,t=gw);const r=t.length;if(r%e&&nn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let c=i[r];c||(c=new n(r),i[r]=c);for(let p=0;p<r;p++)c[p]=t[p];return c}function jo(t,e){return Cy(t,e,Float32Array,Sk)}function Wl(t,e){return Cy(t,e,Int32Array,Mk)}function YA(t,e){return Cy(t,e,Uint32Array,Ik)}function _w(t,e,n){const i=Tk[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function Ck(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function kk(t,e,n){for(const i in t){const r=t[i];if((!n||!!n[i])&&!Pk(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}return!0}function Pk(t){return Array.isArray(t)||ArrayBuffer.isView(t)?Rk(t):isFinite(t)||t===!0||t===!1||t instanceof Xf||t instanceof vf?!0:t instanceof fr?!!t.texture:!1}function Lk(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let r=0,c=n.length;r<c;++r)i[r]=n[r]}else t[e]=n.slice();else t[e]=n}function Rk(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Cr(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function _i(t,e,n,i){let r=null,c=null;return(p,a,T)=>{const k=e(T,n),z=k.length;let B=!1;if(r===null)r=new Float32Array(z),c=z,B=!0;else{Vt(c===z,"Uniform length cannot change.");for(let D=0;D<z;++D)if(k[D]!==r[D]){B=!0;break}}return B&&(i(p,t,a,k),r.set(k)),B}}function jr(t,e,n,i){t[e](n,i)}function al(t,e,n,i){t[e](n,!1,i)}const Dk=5120,zk=5121,Bk=5122,Ok=5123,yw=0,KA=1,Fk=2,Nk=3,JA=4,Uk=5,Vk=6,lr=5126,jk=35664,Gk=35665,Hk=35666,qh=5124,$k=35667,Wk=35668,Zk=35669,Qh=5125,qk=36294,Qk=36295,Xk=36296,Yk=35670,Kk=35671,Jk=35672,eP=35673,tP=35674,nP=35675,iP=35676,rP=35685,oP=35686,sP=35687,aP=35688,lP=35689,cP=35690,V1={[lr]:[lr,1,"float"],[jk]:[lr,2,"vec2"],[Gk]:[lr,3,"vec3"],[Hk]:[lr,4,"vec4"],[qh]:[qh,1,"int"],[$k]:[qh,2,"ivec2"],[Wk]:[qh,3,"ivec3"],[Zk]:[qh,4,"ivec4"],[Qh]:[Qh,1,"uint"],[qk]:[Qh,2,"uvec2"],[Qk]:[Qh,3,"uvec3"],[Xk]:[Qh,4,"uvec4"],[Yk]:[lr,1,"bool"],[Kk]:[lr,2,"bvec2"],[Jk]:[lr,3,"bvec3"],[eP]:[lr,4,"bvec4"],[tP]:[lr,8,"mat2"],[rP]:[lr,8,"mat2x3"],[oP]:[lr,8,"mat2x4"],[nP]:[lr,12,"mat3"],[sP]:[lr,12,"mat3x2"],[aP]:[lr,12,"mat3x4"],[iP]:[lr,16,"mat4"],[lP]:[lr,16,"mat4x2"],[cP]:[lr,16,"mat4x3"]};function uP(t){switch(t){case yw:return yw;case KA:return KA;case Nk:return KA;case Fk:return KA;case JA:return JA;case Uk:return JA;case Vk:return JA;default:return Vt(!1),0}}function vw(t){const e=V1[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function wE(t,e){switch(t){case Dk:case zk:case Bk:case Ok:t=lr;break}for(const n in V1){const[i,r,c]=V1[n];if(i===t&&r===e)return{glType:n,name:c}}return null}class fP{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,i=n.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:c,type:p,size:a}=n.getActiveAttrib(e.handle,r),T=n.getAttribLocation(e.handle,c);T>=0&&this._addAttribute(T,c,p,a)}this.attributeInfos.sort((r,c)=>r.location-c.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!On(n))return;const i=n.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:c,type:p,size:a}=n.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,c,p,a)}this.varyingInfos.sort((r,c)=>r.location-c.location)}_addAttribute(e,n,i,r){const{type:c,components:p}=vw(i),a={type:c,size:r*p};this._inferProperties(e,n,a);const T={location:e,name:n,accessor:new Wo(a)};this.attributeInfos.push(T),this.attributeInfosByLocation[e]=T,this.attributeInfosByName[T.name]=T}_inferProperties(e,n,i){/instance/i.test(n)&&(i.divisor=1)}_addVarying(e,n,i,r){const{type:c,components:p}=vw(i),a=new Wo({type:c,size:r*p}),T={location:e,name:n,accessor:a};this.varyingInfos.push(T),this.varyingInfosByName[T.name]=T}}const xw=4,hP=35981,dP=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class bE extends bl{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",dP),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:i,fs:r,varyings:c,bufferMode:p=hP}=e;return this.hash=n||"",this.vs=typeof i=="string"?new Pg(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs=typeof r=="string"?new Lg(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,Vt(this.vs instanceof Pg),Vt(this.fs instanceof Lg),this.uniforms={},this._textureUniforms={},c&&c.length>0&&(uo(this.gl),this.varyings=c,this.gl2.transformFeedbackVaryings(this.handle,c,p)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new fP(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:i=4,vertexCount:r,offset:c=0,start:p,end:a,isIndexed:T=!1,indexType:k=5123,instanceCount:z=0,isInstanced:B=z>0,vertexArray:D=null,transformFeedback:K,framebuffer:ee,parameters:le={},uniforms:Ce,samplers:se}=e;if((Ce||se)&&(nn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(Ce||{})),nn.priority>=n){const ne=ee?ee.id:"default",te="mode=".concat(sc(this.gl,i)," verts=").concat(r," ")+"instances=".concat(z," indexType=").concat(sc(this.gl,k)," ")+"isInstanced=".concat(B," isIndexed=").concat(T," ")+"Framebuffer=".concat(ne);nn.log(n,te)()}return Vt(D),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||r===0||B&&z===0?!1:(D.bindForDraw(r,z,()=>{if(ee!==void 0&&(le=Object.assign({},le,{framebuffer:ee})),K){const ne=uP(i);K.begin(ne)}this._bindTextures(),Ws(this.gl,le,()=>{T&&B?this.gl2.drawElementsInstanced(i,r,k,c,z):T&&On(this.gl)&&!isNaN(p)&&!isNaN(a)?this.gl2.drawRangeElements(i,p,a,r,k,c):T?this.gl.drawElements(i,r,k,c):B?this.gl2.drawArraysInstanced(i,c,r,z):this.gl.drawArrays(i,c,r)}),K&&K.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};nn.priority>=2&&kk(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const i=e[n],r=this._uniformSetters[n];if(r){let c=i,p=!1;if(c instanceof fr&&(c=c.texture),c instanceof Xf)if(p=this.uniforms[n]!==i,p){r.textureIndex===void 0&&(r.textureIndex=this._textureIndexCounter++);const a=c,{textureIndex:T}=r;a.bind(T),c=T,this._textureUniforms[n]=a}else c=r.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(r(c)||p)&&Lk(this.uniforms,n,i)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const i=this._textureUniforms[n];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),i={};for(const r of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new Pg({handle:r});break;case 35632:i.fs=new Lg({handle:r});break}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=mc(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),nn.time(xw,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),nn.timeEnd(xw,"linkProgram for ".concat(this._getName()))(),e.debug||nn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const i=this.gl.getActiveUniform(this.handle,n),{name:r}=Ck(i.name);let c=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=_w(e,c,i),i.size>1)for(let p=0;p<i.size;p++)c=e.getUniformLocation(this.handle,"".concat(r,"[").concat(p,"]")),this._uniformSetters["".concat(r,"[").concat(p,"]")]=_w(e,c,i)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const AP=34918,pP=34919,mP=35007,gP=36795,_P=35976,yP=35887,vP=36202;class lp extends bl{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=On(e),r=Iy(e,hi.TIMER_QUERY);let c=i||r;for(const p of n)switch(p){case"queries":c=c&&i;break;case"timers":c=c&&r;break;default:Vt(!1)}return c}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(mP)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?vP:yP)}beginTransformFeedbackQuery(){return this.begin(_P)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,pP);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(gP)}getResult(){return this.gl2.getQueryParameter(this.handle,AP)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((i,r)=>{const c=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):n++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(c)};requestAnimationFrame(c)}),this._pollingPromise}_createHandle(){return lp.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class EE extends bl{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return On(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};uo(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Qf(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const i=this._getVaryingIndex(e),{buffer:r,byteSize:c,byteOffset:p}=this._getBufferParams(n);return i<0?(this.unused[e]=r,nn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=n,this.bindOnUse||this._bindBuffer(i,r,p,c),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,i,r;return e instanceof ni?r=e:(r=e.buffer,i=e.byteSize,n=e.byteOffset),(n!==void 0||i!==void 0)&&(n=n||0,i=i||r.byteLength-n),{buffer:r,byteOffset:n,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const c=n&&n.handle;return!c||r===void 0?this.gl.bindBufferBase(35982,e,c):this.gl.bindBufferRange(35982,e,c,i,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let e0=null;function xP(t){return(!e0||e0.byteLength<t)&&(e0=new ArrayBuffer(t)),e0}function wP(t,e){const n=xP(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function bP(t){let{target:e,source:n,start:i=0,count:r=1}=t;const c=n.length,p=r*c;let a=0;for(let T=i;a<c;a++)e[T++]=n[a];for(;a<p;)a<p-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+p-a),a=p);return e}const EP="elements must be GL.ELEMENT_ARRAY_BUFFER";class Go extends bl{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?On(e)||iE()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Go(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Go.MAX_ATTRIBUTES=Go.MAX_ATTRIBUTES||e.getParameter(34921),Go.MAX_ATTRIBUTES}static setConstant(e,n,i){switch(i.constructor){case Float32Array:Go._setConstantFloatArray(e,n,i);break;case Int32Array:Go._setConstantIntArray(e,n,i);break;case Uint32Array:Go._setConstantUintArray(e,n,i);break;default:Vt(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:i})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Go.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Vt(!e||e.target===34963,EP),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,i){if(n.target===34963)return this.setElementBuffer(n,i);const{size:r,type:c,stride:p,offset:a,normalized:T,integer:k,divisor:z}=i,{gl:B,gl2:D}=this;return e=Number(e),this.bind(()=>{B.bindBuffer(34962,n.handle),k?(Vt(On(B)),D.vertexAttribIPointer(e,r,c,p,a)):B.vertexAttribPointer(e,r,c,T,p,a),B.enableVertexAttribArray(e),D.vertexAttribDivisor(e,z||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Go.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const i=this._normalizeConstantArrayValue(n),r=i.byteLength*e,c=i.length*e;let p=!this.buffer;if(this.buffer=this.buffer||new ni(this.gl,r),p=p||this.buffer.reallocate(r),p=p||!this._compareConstantArrayValues(i,this.bufferValue),p){const a=wP(n.constructor,c);bP({target:a,source:i,start:0,count:c}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==n[i])return!1;return!0}static _setConstantFloatArray(e,n,i){switch(i.length){case 1:e.vertexAttrib1fv(n,i);break;case 2:e.vertexAttrib2fv(n,i);break;case 3:e.vertexAttrib3fv(n,i);break;case 4:e.vertexAttrib4fv(n,i);break;default:Vt(!1)}}static _setConstantIntArray(e,n,i){switch(Vt(On(e)),i.length){case 1:e.vertexAttribI1iv(n,i);break;case 2:e.vertexAttribI2iv(n,i);break;case 3:e.vertexAttribI3iv(n,i);break;case 4:e.vertexAttribI4iv(n,i);break;default:Vt(!1)}}static _setConstantUintArray(e,n,i){switch(Vt(On(e)),i.length){case 1:e.vertexAttribI1uiv(n,i);break;case 2:e.vertexAttribI2uiv(n,i);break;case 3:e.vertexAttribI3uiv(n,i);break;case 4:e.vertexAttribI4uiv(n,i);break;default:Vt(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:i}=n;return Vt(Number.isFinite(i)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(i,e);default:return this.gl.getVertexAttrib(i,e)}})}}const TP="VertexArray: attributes must be Buffers or constants (i.e. typed array)",SP=/^(.+)__LOCATION_([0-9]+)$/,MP=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class IP{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;this.id=i,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Go(e),fE(this,"VertexArray","v6.0",MP),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const i=e[n];this._setAttribute(n,i)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,i);const{location:r,accessor:c}=this._resolveLocationAndAccessor(e,n,n.accessor,i);return r>=0&&(this.values[r]=n,this.accessors[r]=c,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,n,c)),this}setConstant(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:r,accessor:c}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},i));return r>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[r]=n,this.accessors[r]=c,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ni(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ni&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ni&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),r=i()}),r}_resolveLocationAndAccessor(e,n,i,r){const c={location:-1,accessor:null},{location:p,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(p)||p<0)return this.unused[e]=n,nn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),c;const T=this._getAttributeInfo(a||p);if(!T)return c;const k=this.accessors[p]||{},z=Wo.resolve(T.accessor,k,i,r),{size:B,type:D}=z;return Vt(Number.isFinite(B)&&Number.isFinite(D)),{location:p,accessor:z}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const i=SP.exec(e),r=i?i[1]:e,c=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+c,name:r}:{location:-1}}_setAttribute(e,n){if(n instanceof ni)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ni){const i=n[0],r=n[1];this.setBuffer(e,i,r)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const i=n;this.setConstant(e,i)}else if(n.buffer instanceof ni){const i=n;this.setBuffer(e,i.buffer,i)}else throw new Error(TP)}_setConstantAttributes(e,n){const i=Math.max(e|0,n|0);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let c=1;c<this.vertexArrayObject.MAX_ATTRIBUTES;c++)r=this.values[c],ArrayBuffer.isView(r)&&this._setConstantAttribute(c,r)}_setConstantAttributeZero(e,n){if(Go.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const i=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,n){Go.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const i=this.values[n],r=this.accessors[n];if(!i)return;const{divisor:c}=r,p=c>0;if(e.isInstanced=e.isInstanced||p,i instanceof ni){const a=i;if(p){const T=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,T)}else{const T=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,T)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return nn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function CP(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let p=0;p<t.length&&p<n;++p)p>0&&(r+=",".concat(p%i===0?" ":"")),r+=Rd(t[p],e);const c=t.length>n?"...":"]";return"".concat(r).concat(c)}function Rd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return CP(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function ww(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;Vt(n);const c=".*_.*",p=".*Matrix",a=n._uniformSetters,T={},k=Object.keys(a).sort();let z=0;for(const K of k)!K.match(c)&&!K.match(p)&&Rg({table:T,header:e,uniforms:i,uniformName:K,undefinedOnly:r})&&z++;for(const K of k)K.match(p)&&Rg({table:T,header:e,uniforms:i,uniformName:K,undefinedOnly:r})&&z++;for(const K of k)T[K]||Rg({table:T,header:e,uniforms:i,uniformName:K,undefinedOnly:r})&&z++;let B=0;const D={};if(!r)for(const K in i){const ee=i[K];T[K]||(B++,D[K]={Type:"NOT USED: ".concat(ee),[e]:Rd(ee)})}return{table:T,count:z,unusedTable:D,unusedCount:B}}function Rg(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:c}=t;const p=i[r],a=kP(p);return!c||!a?(e[r]={[n]:a?Rd(p):"N/A","Uniform Type":a?p:"NOT PROVIDED"},!0):!1}function kP(t){return t!=null}function PP(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=bw(e,e.elements,null,n));const r=e.values;for(const c in r){const p=e._getAttributeInfo(c);if(p){let a="".concat(c,": ").concat(p.name);const T=e.accessors[p.location];T&&(a="".concat(c,": ").concat(LP(p.name,T))),i[a]=bw(e,r[c],T,n)}}return i}function bw(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let c="NOT PROVIDED",p=1,a=0,T=0,k,z,B;if(n&&(c=n.type,p=n.size,c=String(c).replace("Array",""),k=c.indexOf("nt")!==-1),e instanceof ni){const D=e,{data:K,changed:ee}=D.getDebugData();z=ee?"*":"",B=K,T=D.byteLength,a=T/K.BYTES_PER_ELEMENT/p;let le;if(n){const Ce=n.divisor>0;le="".concat(Ce?"I ":"P "," ").concat(a," (x").concat(p,"=").concat(T," bytes ").concat(sc(r,c),")")}else k=!0,le="".concat(T," bytes");return{[i]:"".concat(z).concat(Rd(B,{size:p,isInteger:k})),"Format ":le}}return B=e,p=e.length,c=String(e.constructor.name).replace("Array",""),k=c.indexOf("nt")!==-1,{[i]:"".concat(Rd(B,{size:p,isInteger:k})," (constant)"),"Format ":"".concat(p,"x").concat(c," (constant)")}}function LP(t,e){const{type:n,size:i}=e,r=wE(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function RP(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const r=Ew(i);e["in ".concat(r)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const r=Ew(i);e["out ".concat(r)]={[n]:JSON.stringify(i.accessor)}}return e}function Ew(t){const{type:e,size:n}=t.accessor,i=wE(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const Tw=wl()&&typeof document<"u";let DP=0;class zP{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=Ce=>uE(Ce),onAddHTML:i=null,onInitialize:r=()=>{},onRender:c=()=>{},onFinalize:p=()=>{},onError:a,gl:T=null,glOptions:k={},debug:z=!1,createFramebuffer:B=!1,autoResizeViewport:D=!0,autoResizeDrawingBuffer:K=!0,stats:ee=iu.get("animation-loop-".concat(DP++))}=e;let{useDevicePixels:le=!0}=e;"useDevicePixelRatio"in e&&(nn.deprecated("useDevicePixelRatio","useDevicePixels")(),le=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:i,onInitialize:r,onRender:c,onFinalize:p,onError:a,gl:T,glOptions:k,debug:z,createFramebuffer:B},this.gl=T,this.needsRedraw=null,this.timeline=null,this.stats=ee,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:D,autoResizeDrawingBuffer:K,useDevicePixels:le}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Vt(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=lp.isSupported(this.gl,["timers"])?new lp(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),i!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):n}setViewParameters(){return nn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Tw?new Promise((e,n)=>{if(Tw&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):jC(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):VC(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?Ey(this.props.gl,e):this.onCreateContext(e),!lm(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");IC(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const i=this.props.onAddHTML(n);i&&(n.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&n>0&&(i=e/n),{width:e,height:n,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&RC(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new fr(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const hA="vs",ky="fs";function Xo(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Dg={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function BP(t){const e={};for(const n in t){const i=t[n],r=OP(i);e[n]=r}return e}function OP(t){let e=Sw(t);return e==="object"?t?"type"in t?Object.assign({},t,Dg[t.type]):"value"in t?(e=Sw(t.value),Object.assign({type:e},t,Dg[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Dg[e])}function Sw(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const FP="vs",NP="fs";class Mw{constructor(e){let{name:n,vs:i,fs:r,dependencies:c=[],uniforms:p,getUniforms:a,deprecations:T=[],defines:k={},inject:z={},vertexShader:B,fragmentShader:D}=e;Xo(typeof n=="string"),this.name=n,this.vs=i||B,this.fs=r||D,this.getModuleUniforms=a,this.dependencies=c,this.deprecations=this._parseDeprecationDefinitions(T),this.defines=k,this.injections=UP(z),p&&(this.uniforms=BP(p))}getModuleSource(e){let n;switch(e){case FP:n=this.vs||"";break;case NP:n=this.fs||"";break;default:Xo(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?n.deprecated(i.old,i.new)():n.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},i=this.uniforms;for(const r in i){const c=i[r];r in e&&!c.private?(c.validate&&Xo(c.validate(e[r],c),"".concat(this.name,": invalid ").concat(r)),n[r]=e[r]):n[r]=c.value}return n}}function UP(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];const r=n.slice(0,2);typeof i=="string"&&(i={order:0,injection:i}),e[r][n]=i}return e}function VP(t){return jP(SE(t))}function jP(t){const e={},n={};return TE({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((i,r)=>n[r]-n[i]).map(i=>e[i])}function TE(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const c of e)i[c.name]=c,(r[c.name]===void 0||r[c.name]<n)&&(r[c.name]=n);for(const c of e)c.dependencies&&TE({modules:c.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function SE(t,e){return t.map(n=>(n instanceof Mw||(Xo(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Xo(n.name,"shader module has no name"),n=new Mw(n),n.dependencies=SE(n.dependencies)),n))}function GP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r}const HP=7936,$P=7937,WP=7938,ZP=35724,Py={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},eu={};Object.keys(Py).forEach(t=>{eu[t]=t});function qP(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function QP(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||HP),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||$P);return{gpuVendor:XP(n,i),vendor:n,renderer:i,version:t.getParameter(WP),shadingLanguageVersion:t.getParameter(ZP)}}function XP(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const zg={};function Iw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=Py[e];if(Xo(i,e),!GP(n))return!0;if(e in zg)return zg[e];const r=i[0],c=n.behavior||"enable",p="#extension GL_".concat(r," : ").concat(c,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,p),t.compileShader(a);const T=t.getShaderParameter(a,35713);return t.deleteShader(a),zg[e]=T,T}function YP(t,e){const n=Py[e];Xo(n,e);const i=qP(t)&&n[1]||n[0],r=typeof i=="string"?!!t.getExtension(i):i;return Xo(r===!1||r===!0),r}function t0(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>YP(t,n))}function KP(t){switch(QP(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function JP(t,e,n){let i=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return t0(t,eu.GLSL_FRAG_DEPTH)&&(i+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),t0(t,eu.GLSL_DERIVATIVES)&&Iw(t,eu.GLSL_DERIVATIVES)&&(i+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),t0(t,eu.GLSL_FRAG_DATA)&&Iw(t,eu.GLSL_FRAG_DATA,{behavior:"require"})&&(i+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),t0(t,eu.GLSL_TEXTURE_LOD)&&(i+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),i}const e7=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,t7=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,n7={[hA]:e7,[ky]:t7},F0="__LUMA_INJECT_DECLARATIONS__",Cw=/void\s+main\s*\([^)]*\)\s*\{\n?/,kw=/}\n?[^{}]*$/,Bg=[];function Pw(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=e===hA;for(const c in n){const p=n[c];p.sort((T,k)=>T.order-k.order),Bg.length=p.length;for(let T=0,k=p.length;T<k;++T)Bg[T]=p[T].injection;const a="".concat(Bg.join(`
`),`
`);switch(c){case"vs:#decl":r&&(t=t.replace(F0,a));break;case"vs:#main-start":r&&(t=t.replace(Cw,T=>T+a));break;case"vs:#main-end":r&&(t=t.replace(kw,T=>a+T));break;case"fs:#decl":r||(t=t.replace(F0,a));break;case"fs:#main-start":r||(t=t.replace(Cw,T=>T+a));break;case"fs:#main-end":r||(t=t.replace(kw,T=>a+T));break;default:t=t.replace(c,T=>T+a)}}return t=t.replace(F0,""),i&&(t=t.replace(/\}\s*$/,c=>c+n7[e])),t}function j1(t){const e={};return Xo(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const i in n)e[i]=e[i]?"".concat(e[i],`
`).concat(n[i]):n[i]}),e}function Yf(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const ME=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],i7=[...ME,[Yf("attribute"),"in $1"],[Yf("varying"),"out $1"]],r7=[...ME,[Yf("varying"),"in $1"]],IE=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],o7=[...IE,[Yf("in"),"attribute $1"],[Yf("out"),"varying $1"]],s7=[...IE,[Yf("in"),"varying $1"]],G1="gl_FragColor",H1=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,a7=/void\s+main\s*\([^)]*\)\s*\{\n?/;function l7(t,e,n){switch(e){case 300:return n?cp(t,i7):c7(t);case 100:return n?cp(t,o7):u7(t);default:throw new Error("unknown GLSL version ".concat(e))}}function cp(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}function c7(t){t=cp(t,r7);const e=t.match(H1);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(G1,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(a7,i=>"out vec4 ".concat(n,`;
`).concat(i)).replace(new RegExp("\\b".concat(G1,"\\b"),"g"),n)}return t}function u7(t){t=cp(t,s7);const e=t.match(H1);if(e){const n=e[1];t=t.replace(H1,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),G1)}return t}const f7=`

`.concat(F0,`

`),CE={[hA]:"vertex",[ky]:"fragment"},h7=`precision highp float;

`;function d7(t,e){const{vs:n,fs:i}=e,r=VP(e.modules||[]);return{gl:t,vs:Lw(t,Object.assign({},e,{source:n,type:hA,modules:r})),fs:Lw(t,Object.assign({},e,{source:i,type:ky,modules:r})),getUniforms:A7(r)}}function Lw(t,e){let{id:n,source:i,type:r,modules:c,defines:p={},hookFunctions:a=[],inject:T={},transpileToGLSL100:k=!1,prologue:z=!0,log:B}=e;Xo(typeof i=="string","shader source must be a string");const D=r===hA,K=i.split(`
`);let ee=100,le="",Ce=i;K[0].indexOf("#version ")===0?(ee=300,le=K[0],Ce=K.slice(1).join(`
`)):le="#version ".concat(ee);const se={};c.forEach(nt=>{Object.assign(se,nt.getDefines())}),Object.assign(se,p);let ne=z?"".concat(le,`
`).concat(m7({id:n,source:i,type:r}),`
`).concat(p7({type:r}),`
`).concat(KP(t),`
`).concat(JP(t),`
`).concat(g7(se),`
`).concat(D?"":h7,`
`):"".concat(le,`
`);const te=y7(a),xe={},Le={},Ge={};for(const nt in T){const it=typeof T[nt]=="string"?{injection:T[nt],order:0}:T[nt],dt=nt.match(/^(v|f)s:(#)?([\w-]+)$/);if(dt){const ct=dt[2],Xe=dt[3];ct?Xe==="decl"?Le[nt]=[it]:Ge[nt]=[it]:xe[nt]=[it]}else Ge[nt]=[it]}for(const nt of c){B&&nt.checkDeprecations(Ce,B);const it=nt.getModuleSource(r,ee);ne+=it;const dt=nt.injections[r];for(const ct in dt){const Xe=ct.match(/^(v|f)s:#([\w-]+)$/);if(Xe){const Rt=Xe[2]==="decl"?Le:Ge;Rt[ct]=Rt[ct]||[],Rt[ct].push(dt[ct])}else xe[ct]=xe[ct]||[],xe[ct].push(dt[ct])}}return ne+=f7,ne=Pw(ne,r,Le),ne+=_7(te[r],xe),ne+=Ce,ne=Pw(ne,r,Ge),ne=l7(ne,k?100:ee,D),ne}function A7(t){return function(n){const i={};for(const r of t){const c=r.getUniforms(n,i);Object.assign(i,c)}return i}}function p7(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(CE[e].toUpperCase(),`
`)}function m7(t){let{id:e,source:n,type:i}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(CE[i],`

`):""}function g7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const i in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],`
`))}return e===0&&(n+=`
`),n}function _7(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature,` {
`),r.header&&(n+="  ".concat(r.header)),e[i]){const c=e[i];c.sort((p,a)=>p.order-a.order);for(const p of c)n+="  ".concat(p.injection,`
`)}r.footer&&(n+="  ".concat(r.footer)),n+=`}
`}return n}function y7(t){const e={vs:{},fs:{}};return t.forEach(n=>{let i;typeof n!="string"?(i=n,n=i.hook):i={},n=n.trim();const[r,c]=n.split(":"),p=n.replace(/\(.+/,"");e[r][p]=Object.assign(i,{signature:c})}),e}const v7="void main() {gl_FragColor = vec4(0);}",kE=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,x7=`#version 300 es
`.concat(kE);function PE(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,c]=n;if(!e.includes(i)||!r||!c)return null;const p=c.split(";")[0];return{qualifier:i,type:r,name:p}}function LE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return e===300?x7:e>300?"#version ".concat(e,`
`).concat(kE):v7;const c=E7(n,i);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(i," ").concat(n,`;
out vec4 `).concat(r,`;
void main() {
  `).concat(r," = ").concat(c,`;
}`):"varying ".concat(i," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(c,`;
}`)}function w7(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Xo(!1),null}}function b7(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Xo(!1),null}}function E7(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Xo(!1),null}}const T7=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,S7={name:"fp32",vs:T7,fs:null};function Rw(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Zo={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function M7(t,{precision:e=Zo.precision}={}){return t=I7(t),"".concat(parseFloat(t.toPrecision(e)))}function Kf(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function tc(t,e,n){return k7(t,i=>Math.max(e,Math.min(n,i)))}function Jf(t,e,n){return Kf(t)?t.map((i,r)=>Jf(i,e[r],n)):n*e+(1-n)*t}function Dd(t,e,n){const i=Zo.EPSILON;n&&(Zo.EPSILON=n);try{if(t===e)return!0;if(Kf(t)&&Kf(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!Dd(t[r],e[r]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Zo.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Zo.EPSILON=i}}function I7(t){return Math.round(t/Zo.EPSILON)*Zo.EPSILON}function C7(t){return t.clone?t.clone():new Array(t.length)}function k7(t,e,n){if(Kf(t)){const i=t;n=n||C7(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}function P7(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class RE extends P7(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+n];return this.check()}toArray(e=[],n=0){for(let i=0;i<this.ELEMENTS;++i)e[n+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Kf(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Zo)}formatString(e){let n="";for(let i=0;i<this.ELEMENTS;++i)n+=(i>0?", ":"")+M7(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Dd(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,i){if(i===void 0)return this.lerp(this,e,n);for(let r=0;r<this.ELEMENTS;++r){const c=e[r];this[r]=c+i*(n[r]-c)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),n[i]);return this.check()}add(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=n[i];return this.check()}subtract(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=n[i];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Zo.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),n);return this.check()}get elements(){return this}}function L7(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function $o(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Og(t,e,n=""){if(Zo.debug&&!L7(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class R7 extends RE{get x(){return this[0]}set x(e){this[0]=$o(e)}get y(){return this[1]}set y(e){this[1]=$o(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];n+=r*r}return $o(n)}dot(e){let n=0;for(let i=0;i<this.ELEMENTS;++i)n+=this[i]*e[i];return $o(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=n[i];return this.check()}divide(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=n[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Rw(e>=0&&e<this.ELEMENTS,"index is out of range"),$o(this[e])}setComponent(e,n){return Rw(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var N0=1e-6,eh=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function D7(){var t=new eh(2);return eh!=Float32Array&&(t[0]=0,t[1]=0),t}function Dw(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function z7(t,e){return t[0]=-e[0],t[1]=-e[1],t}function DE(t,e,n,i){var r=e[0],c=e[1];return t[0]=r+i*(n[0]-r),t[1]=c+i*(n[1]-c),t}function B7(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(function(){var t=D7();return function(e,n,i,r,c,p){var a,T;for(n||(n=2),i||(i=0),r?T=Math.min(r*n+i,e.length):T=e.length,a=i;a<T;a+=n)t[0]=e[a],t[1]=e[a+1],c(t,t,p),e[a]=t[0],e[a+1]=t[1];return e}})();function O7(t,e,n){const i=e[0],r=e[1],c=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/c,t[1]=(n[1]*i+n[5]*r)/c,t}function zE(t,e,n){const i=e[0],r=e[1],c=e[2],p=n[3]*i+n[7]*r+n[11]*c||1;return t[0]=(n[0]*i+n[4]*r+n[8]*c)/p,t[1]=(n[1]*i+n[5]*r+n[9]*c)/p,t[2]=(n[2]*i+n[6]*r+n[10]*c)/p,t}function F7(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}function N7(){var t=new eh(3);return eh!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function U7(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function V7(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function j7(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function G7(t,e,n){var i=e[0],r=e[1],c=e[2],p=n[0],a=n[1],T=n[2];return t[0]=r*T-c*a,t[1]=c*p-i*T,t[2]=i*a-r*p,t}function BE(t,e,n){var i=e[0],r=e[1],c=e[2],p=n[3]*i+n[7]*r+n[11]*c+n[15];return p=p||1,t[0]=(n[0]*i+n[4]*r+n[8]*c+n[12])/p,t[1]=(n[1]*i+n[5]*r+n[9]*c+n[13])/p,t[2]=(n[2]*i+n[6]*r+n[10]*c+n[14])/p,t}function H7(t,e,n){var i=e[0],r=e[1],c=e[2];return t[0]=i*n[0]+r*n[3]+c*n[6],t[1]=i*n[1]+r*n[4]+c*n[7],t[2]=i*n[2]+r*n[5]+c*n[8],t}function $7(t,e,n){var i=n[0],r=n[1],c=n[2],p=n[3],a=e[0],T=e[1],k=e[2],z=r*k-c*T,B=c*a-i*k,D=i*T-r*a,K=r*D-c*B,ee=c*z-i*D,le=i*B-r*z,Ce=p*2;return z*=Ce,B*=Ce,D*=Ce,K*=2,ee*=2,le*=2,t[0]=a+z+K,t[1]=T+B+ee,t[2]=k+D+le,t}function W7(t,e,n,i){var r=[],c=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],c[0]=r[0],c[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),c[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=c[0]+n[0],t[1]=c[1]+n[1],t[2]=c[2]+n[2],t}function Z7(t,e,n,i){var r=[],c=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],c[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),c[1]=r[1],c[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=c[0]+n[0],t[1]=c[1]+n[1],t[2]=c[2]+n[2],t}function q7(t,e,n,i){var r=[],c=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],c[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),c[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),c[2]=r[2],t[0]=c[0]+n[0],t[1]=c[1]+n[1],t[2]=c[2]+n[2],t}function Q7(t,e){var n=t[0],i=t[1],r=t[2],c=e[0],p=e[1],a=e[2],T=Math.sqrt(n*n+i*i+r*r),k=Math.sqrt(c*c+p*p+a*a),z=T*k,B=z&&j7(t,e)/z;return Math.acos(Math.min(Math.max(B,-1),1))}var X7=U7;(function(){var t=N7();return function(e,n,i,r,c,p){var a,T;for(n||(n=3),i||(i=0),r?T=Math.min(r*n+i,e.length):T=e.length,a=i;a<T;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],c(t,t,p),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const Fg=[0,0,0];let n0;class Ia extends R7{static get ZERO(){return n0||(n0=new Ia(0,0,0),Object.freeze(n0)),n0}constructor(e=0,n=0,i=0){super(-0,-0,-0),arguments.length===1&&Kf(e)?this.copy(e):(Zo.debug&&($o(e),$o(n),$o(i)),this[0]=e,this[1]=n,this[2]=i)}set(e,n,i){return this[0]=e,this[1]=n,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Zo.debug&&($o(e.x),$o(e.y),$o(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=$o(e)}angle(e){return Q7(this,e)}cross(e){return G7(this,this,e),this.check()}rotateX({radians:e,origin:n=Fg}){return W7(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Fg}){return Z7(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Fg}){return q7(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return BE(this,this,e),this.check()}transformAsVector(e){return zE(this,this,e),this.check()}transformByMatrix3(e){return H7(this,this,e),this.check()}transformByMatrix2(e){return F7(this,this,e),this.check()}transformByQuaternion(e){return $7(this,this,e),this.check()}}class Y7 extends RE{toString(){let e="[";if(Zo.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,i){return this[n*this.RANK+e]=$o(i),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)n[r]=this[i+r];return n}setColumn(e,n){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=n[r];return this}}function K7(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function J7(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],c=e[6],p=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=c,t[11]=e[14],t[12]=r,t[13]=p,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function $1(t,e){var n=e[0],i=e[1],r=e[2],c=e[3],p=e[4],a=e[5],T=e[6],k=e[7],z=e[8],B=e[9],D=e[10],K=e[11],ee=e[12],le=e[13],Ce=e[14],se=e[15],ne=n*a-i*p,te=n*T-r*p,xe=n*k-c*p,Le=i*T-r*a,Ge=i*k-c*a,nt=r*k-c*T,it=z*le-B*ee,dt=z*Ce-D*ee,ct=z*se-K*ee,Xe=B*Ce-D*le,Bt=B*se-K*le,Rt=D*se-K*Ce,jt=ne*Rt-te*Bt+xe*Xe+Le*ct-Ge*dt+nt*it;return jt?(jt=1/jt,t[0]=(a*Rt-T*Bt+k*Xe)*jt,t[1]=(r*Bt-i*Rt-c*Xe)*jt,t[2]=(le*nt-Ce*Ge+se*Le)*jt,t[3]=(D*Ge-B*nt-K*Le)*jt,t[4]=(T*ct-p*Rt-k*dt)*jt,t[5]=(n*Rt-r*ct+c*dt)*jt,t[6]=(Ce*xe-ee*nt-se*te)*jt,t[7]=(z*nt-D*xe+K*te)*jt,t[8]=(p*Bt-a*ct+k*it)*jt,t[9]=(i*ct-n*Bt-c*it)*jt,t[10]=(ee*Ge-le*xe+se*ne)*jt,t[11]=(B*xe-z*Ge-K*ne)*jt,t[12]=(a*dt-p*Xe-T*it)*jt,t[13]=(n*Xe-i*dt+r*it)*jt,t[14]=(le*te-ee*Le-Ce*ne)*jt,t[15]=(z*Le-B*te+D*ne)*jt,t):null}function eL(t){var e=t[0],n=t[1],i=t[2],r=t[3],c=t[4],p=t[5],a=t[6],T=t[7],k=t[8],z=t[9],B=t[10],D=t[11],K=t[12],ee=t[13],le=t[14],Ce=t[15],se=e*p-n*c,ne=e*a-i*c,te=e*T-r*c,xe=n*a-i*p,Le=n*T-r*p,Ge=i*T-r*a,nt=k*ee-z*K,it=k*le-B*K,dt=k*Ce-D*K,ct=z*le-B*ee,Xe=z*Ce-D*ee,Bt=B*Ce-D*le;return se*Bt-ne*Xe+te*ct+xe*dt-Le*it+Ge*nt}function cu(t,e,n){var i=e[0],r=e[1],c=e[2],p=e[3],a=e[4],T=e[5],k=e[6],z=e[7],B=e[8],D=e[9],K=e[10],ee=e[11],le=e[12],Ce=e[13],se=e[14],ne=e[15],te=n[0],xe=n[1],Le=n[2],Ge=n[3];return t[0]=te*i+xe*a+Le*B+Ge*le,t[1]=te*r+xe*T+Le*D+Ge*Ce,t[2]=te*c+xe*k+Le*K+Ge*se,t[3]=te*p+xe*z+Le*ee+Ge*ne,te=n[4],xe=n[5],Le=n[6],Ge=n[7],t[4]=te*i+xe*a+Le*B+Ge*le,t[5]=te*r+xe*T+Le*D+Ge*Ce,t[6]=te*c+xe*k+Le*K+Ge*se,t[7]=te*p+xe*z+Le*ee+Ge*ne,te=n[8],xe=n[9],Le=n[10],Ge=n[11],t[8]=te*i+xe*a+Le*B+Ge*le,t[9]=te*r+xe*T+Le*D+Ge*Ce,t[10]=te*c+xe*k+Le*K+Ge*se,t[11]=te*p+xe*z+Le*ee+Ge*ne,te=n[12],xe=n[13],Le=n[14],Ge=n[15],t[12]=te*i+xe*a+Le*B+Ge*le,t[13]=te*r+xe*T+Le*D+Ge*Ce,t[14]=te*c+xe*k+Le*K+Ge*se,t[15]=te*p+xe*z+Le*ee+Ge*ne,t}function up(t,e,n){var i=n[0],r=n[1],c=n[2],p,a,T,k,z,B,D,K,ee,le,Ce,se;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*c+e[12],t[13]=e[1]*i+e[5]*r+e[9]*c+e[13],t[14]=e[2]*i+e[6]*r+e[10]*c+e[14],t[15]=e[3]*i+e[7]*r+e[11]*c+e[15]):(p=e[0],a=e[1],T=e[2],k=e[3],z=e[4],B=e[5],D=e[6],K=e[7],ee=e[8],le=e[9],Ce=e[10],se=e[11],t[0]=p,t[1]=a,t[2]=T,t[3]=k,t[4]=z,t[5]=B,t[6]=D,t[7]=K,t[8]=ee,t[9]=le,t[10]=Ce,t[11]=se,t[12]=p*i+z*r+ee*c+e[12],t[13]=a*i+B*r+le*c+e[13],t[14]=T*i+D*r+Ce*c+e[14],t[15]=k*i+K*r+se*c+e[15]),t}function Ly(t,e,n){var i=n[0],r=n[1],c=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*c,t[9]=e[9]*c,t[10]=e[10]*c,t[11]=e[11]*c,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function tL(t,e,n,i){var r=i[0],c=i[1],p=i[2],a=Math.hypot(r,c,p),T,k,z,B,D,K,ee,le,Ce,se,ne,te,xe,Le,Ge,nt,it,dt,ct,Xe,Bt,Rt,jt,_n;return a<N0?null:(a=1/a,r*=a,c*=a,p*=a,T=Math.sin(n),k=Math.cos(n),z=1-k,B=e[0],D=e[1],K=e[2],ee=e[3],le=e[4],Ce=e[5],se=e[6],ne=e[7],te=e[8],xe=e[9],Le=e[10],Ge=e[11],nt=r*r*z+k,it=c*r*z+p*T,dt=p*r*z-c*T,ct=r*c*z-p*T,Xe=c*c*z+k,Bt=p*c*z+r*T,Rt=r*p*z+c*T,jt=c*p*z-r*T,_n=p*p*z+k,t[0]=B*nt+le*it+te*dt,t[1]=D*nt+Ce*it+xe*dt,t[2]=K*nt+se*it+Le*dt,t[3]=ee*nt+ne*it+Ge*dt,t[4]=B*ct+le*Xe+te*Bt,t[5]=D*ct+Ce*Xe+xe*Bt,t[6]=K*ct+se*Xe+Le*Bt,t[7]=ee*ct+ne*Xe+Ge*Bt,t[8]=B*Rt+le*jt+te*_n,t[9]=D*Rt+Ce*jt+xe*_n,t[10]=K*Rt+se*jt+Le*_n,t[11]=ee*Rt+ne*jt+Ge*_n,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function OE(t,e,n){var i=Math.sin(n),r=Math.cos(n),c=e[4],p=e[5],a=e[6],T=e[7],k=e[8],z=e[9],B=e[10],D=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=c*r+k*i,t[5]=p*r+z*i,t[6]=a*r+B*i,t[7]=T*r+D*i,t[8]=k*r-c*i,t[9]=z*r-p*i,t[10]=B*r-a*i,t[11]=D*r-T*i,t}function nL(t,e,n){var i=Math.sin(n),r=Math.cos(n),c=e[0],p=e[1],a=e[2],T=e[3],k=e[8],z=e[9],B=e[10],D=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=c*r-k*i,t[1]=p*r-z*i,t[2]=a*r-B*i,t[3]=T*r-D*i,t[8]=c*i+k*r,t[9]=p*i+z*r,t[10]=a*i+B*r,t[11]=T*i+D*r,t}function FE(t,e,n){var i=Math.sin(n),r=Math.cos(n),c=e[0],p=e[1],a=e[2],T=e[3],k=e[4],z=e[5],B=e[6],D=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=c*r+k*i,t[1]=p*r+z*i,t[2]=a*r+B*i,t[3]=T*r+D*i,t[4]=k*r-c*i,t[5]=z*r-p*i,t[6]=B*r-a*i,t[7]=D*r-T*i,t}function iL(t,e){var n=e[0],i=e[1],r=e[2],c=e[3],p=n+n,a=i+i,T=r+r,k=n*p,z=i*p,B=i*a,D=r*p,K=r*a,ee=r*T,le=c*p,Ce=c*a,se=c*T;return t[0]=1-B-ee,t[1]=z+se,t[2]=D-Ce,t[3]=0,t[4]=z-se,t[5]=1-k-ee,t[6]=K+le,t[7]=0,t[8]=D+Ce,t[9]=K-le,t[10]=1-k-B,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rL(t,e,n,i,r,c,p){var a=1/(n-e),T=1/(r-i),k=1/(c-p);return t[0]=c*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c*2*T,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*T,t[10]=(p+c)*k,t[11]=-1,t[12]=0,t[13]=0,t[14]=p*c*2*k,t[15]=0,t}function oL(t,e,n,i,r){var c=1/Math.tan(e/2),p;return t[0]=c/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(p=1/(i-r),t[10]=(r+i)*p,t[14]=2*r*i*p):(t[10]=-1,t[14]=-2*i),t}var sL=oL;function aL(t,e,n,i,r,c,p){var a=1/(e-n),T=1/(i-r),k=1/(c-p);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*T,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*k,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*T,t[14]=(p+c)*k,t[15]=1,t}var lL=aL;function cL(t,e,n,i){var r,c,p,a,T,k,z,B,D,K,ee=e[0],le=e[1],Ce=e[2],se=i[0],ne=i[1],te=i[2],xe=n[0],Le=n[1],Ge=n[2];return Math.abs(ee-xe)<N0&&Math.abs(le-Le)<N0&&Math.abs(Ce-Ge)<N0?K7(t):(z=ee-xe,B=le-Le,D=Ce-Ge,K=1/Math.hypot(z,B,D),z*=K,B*=K,D*=K,r=ne*D-te*B,c=te*z-se*D,p=se*B-ne*z,K=Math.hypot(r,c,p),K?(K=1/K,r*=K,c*=K,p*=K):(r=0,c=0,p=0),a=B*p-D*c,T=D*r-z*p,k=z*c-B*r,K=Math.hypot(a,T,k),K?(K=1/K,a*=K,T*=K,k*=K):(a=0,T=0,k=0),t[0]=r,t[1]=a,t[2]=z,t[3]=0,t[4]=c,t[5]=T,t[6]=B,t[7]=0,t[8]=p,t[9]=k,t[10]=D,t[11]=0,t[12]=-(r*ee+c*le+p*Ce),t[13]=-(a*ee+T*le+k*Ce),t[14]=-(z*ee+B*le+D*Ce),t[15]=1,t)}function uL(){var t=new eh(4);return eh!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function fL(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function dA(t,e,n){var i=e[0],r=e[1],c=e[2],p=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*c+n[12]*p,t[1]=n[1]*i+n[5]*r+n[9]*c+n[13]*p,t[2]=n[2]*i+n[6]*r+n[10]*c+n[14]*p,t[3]=n[3]*i+n[7]*r+n[11]*c+n[15]*p,t}(function(){var t=uL();return function(e,n,i,r,c,p){var a,T;for(n||(n=4),i||(i=0),r?T=Math.min(r*n+i,e.length):T=e.length,a=i;a<T;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],c(t,t,p),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var W1;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(W1||(W1={}));const hL=45*Math.PI/180,dL=1,Ng=.1,Ug=500,AL=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ca extends Y7{static get IDENTITY(){return mL()}static get ZERO(){return pL()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return W1}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,i,r,c,p,a,T,k,z,B,D,K,ee,le,Ce){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=c,this[5]=p,this[6]=a,this[7]=T,this[8]=k,this[9]=z,this[10]=B,this[11]=D,this[12]=K,this[13]=ee,this[14]=le,this[15]=Ce,this.check()}setRowMajor(e,n,i,r,c,p,a,T,k,z,B,D,K,ee,le,Ce){return this[0]=e,this[1]=c,this[2]=k,this[3]=K,this[4]=n,this[5]=p,this[6]=z,this[7]=ee,this[8]=i,this[9]=a,this[10]=B,this[11]=le,this[12]=r,this[13]=T,this[14]=D,this[15]=Ce,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(AL)}fromObject(e){return this.check()}fromQuaternion(e){return iL(this,e),this.check()}frustum(e){const{left:n,right:i,bottom:r,top:c,near:p=Ng,far:a=Ug}=e;return a===1/0?gL(this,n,i,r,c,p):rL(this,n,i,r,c,p,a),this.check()}lookAt(e){const{eye:n,center:i=[0,0,0],up:r=[0,1,0]}=e;return cL(this,n,i,r),this.check()}ortho(e){const{left:n,right:i,bottom:r,top:c,near:p=Ng,far:a=Ug}=e;return lL(this,n,i,r,c,p,a),this.check()}orthographic(e){const{fovy:n=hL,aspect:i=dL,focalDistance:r=1,near:c=Ng,far:p=Ug}=e;zw(n);const a=n/2,T=r*Math.tan(a),k=T*i;return this.ortho({left:-k,right:k,bottom:-T,top:T,near:c,far:p})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:i=1,near:r=.1,far:c=500}=e;return zw(n),sL(this,n,i,r,c),this.check()}determinant(){return eL(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],c=1/i[1],p=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*c,e[2]=this[2]*p,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*c,e[6]=this[6]*p,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*c,e[10]=this[10]*p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],c=1/i[1],p=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*c,e[2]=this[2]*p,e[3]=this[4]*r,e[4]=this[5]*c,e[5]=this[6]*p,e[6]=this[8]*r,e[7]=this[9]*c,e[8]=this[10]*p,e}transpose(){return J7(this,this),this.check()}invert(){return $1(this,this),this.check()}multiplyLeft(e){return cu(this,e,this),this.check()}multiplyRight(e){return cu(this,this,e),this.check()}rotateX(e){return OE(this,this,e),this.check()}rotateY(e){return nL(this,this,e),this.check()}rotateZ(e){return FE(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return tL(this,this,e,n),this.check()}scale(e){return Ly(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return up(this,this,e),this.check()}transform(e,n){return e.length===4?(n=dA(n||[-0,-0,-0,-0],e,this),Og(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:i}=e;let r;switch(i){case 2:r=B7(n||[-0,-0],e,this);break;case 3:r=BE(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Og(r,e.length),r}transformAsVector(e,n){let i;switch(e.length){case 2:i=O7(n||[-0,-0],e,this);break;case 3:i=zE(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Og(i,e.length),i}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,i){return this.identity().translate([e,n,i])}}let i0,r0;function pL(){return i0||(i0=new Ca([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(i0)),i0}function mL(){return r0||(r0=new Ca,Object.freeze(r0)),r0}function zw(t){if(t>Math.PI*2)throw Error("expected radians")}function gL(t,e,n,i,r,c){const p=2*c/(n-e),a=2*c/(r-i),T=(n+e)/(n-e),k=(r+i)/(r-i),z=-1,B=-1,D=-2*c;return t[0]=p,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=T,t[9]=k,t[10]=z,t[11]=B,t[12]=0,t[13]=0,t[14]=D,t[15]=0,t}const Bw=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,_L={lightSources:{}};function Vg(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function yL(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return e?r["lighting_uAmbientLight.color"]=Vg(e):r["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((c,p)=>{r["lighting_uPointLight[".concat(p,"].color")]=Vg(c),r["lighting_uPointLight[".concat(p,"].position")]=c.position,r["lighting_uPointLight[".concat(p,"].attenuation")]=c.attenuation||[1,0,0]}),r.lighting_uPointLightCount=n.length,i.forEach((c,p)=>{r["lighting_uDirectionalLight[".concat(p,"].color")]=Vg(c),r["lighting_uDirectionalLight[".concat(p,"].direction")]=c.direction}),r.lighting_uDirectionalLightCount=i.length,r}function NE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_L;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:i}=t.lightSources||{};return e||n&&n.length>0||i&&i.length>0?Object.assign({},yL({ambientLight:e,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return NE({lightSources:e})}return{}}const UE={name:"lights",vs:Bw,fs:Bw,getUniforms:NE,defines:{MAX_LIGHTS:3}},vL=new Uint8Array([0,255,255,255]),xL={pickingSelectedColor:null,pickingHighlightColor:vL,pickingActive:!1,pickingAttribute:!1};function wL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xL;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const bL=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,EL=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,TL={name:"picking",vs:bL,fs:EL,getUniforms:wL},VE=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,SL={};function ML(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map(c=>c/255)}}function jE(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:SL;if(!("material"in t))return{};const{material:e}=t;return e?ML(e):{lighting_uEnabled:!1}}const IL={name:"gouraud-lighting",dependencies:[UE],vs:VE,defines:{LIGHTING_VERTEX:1},getUniforms:jE},CL={name:"phong-lighting",dependencies:[UE],fs:VE,defines:{LIGHTING_FRAGMENT:1},getUniforms:jE},kL=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,PL={name:"transform",vs:kL,fs:null};class AA{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new AA(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:i="",defines:r={},inject:c={},varyings:p=[],bufferMode:a=35981,transpileToGLSL100:T=!1}=e,k=this._getModuleList(e.modules),z=this._getHash(n),B=this._getHash(i),D=k.map(te=>this._getHash(te.name)).sort(),K=p.map(te=>this._getHash(te)),ee=Object.keys(r).sort(),le=Object.keys(c).sort(),Ce=[],se=[];for(const te of ee)Ce.push(this._getHash(te)),Ce.push(this._getHash(r[te]));for(const te of le)se.push(this._getHash(te)),se.push(this._getHash(c[te]));const ne="".concat(z,"/").concat(B,"D").concat(Ce.join("/"),"M").concat(D.join("/"),"I").concat(se.join("/"),"V").concat(K.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(T?"T":"");if(!this._programCache[ne]){const te=d7(this.gl,{vs:n,fs:i,modules:k,inject:c,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:T});this._programCache[ne]=new bE(this.gl,{hash:ne,vs:te.vs,fs:te.fs,varyings:p,bufferMode:a}),this._getUniforms[ne]=te.getUniforms||(xe=>{}),this._useCounts[ne]=0}return this._useCounts[ne]++,this._programCache[ne]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let c=0,p=this._defaultModules.length;c<p;++c){const a=this._defaultModules[c],T=a.name;n[r++]=a,i[T]=!0}for(let c=0,p=e.length;c<p;++c){const a=e[c],T=a.name;i[T]||(n[r++]=a,i[T]=!0)}return n.length=r,n}}const LL={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function RL(t,e,n){const i={};let r=e.indices;for(const c in e.attributes){const p=e.attributes[c],a=DL(c,n);if(c==="indices")r=p;else if(p.constant)i[a]=p.value;else{const T=p.value,k={...p};delete k.value,i[a]=[new ni(t,T),k],zL(c,k)}}if(r){const c=r.value||r;Vt(c instanceof Uint16Array||c instanceof Uint32Array,'attribute array for "indices" must be of integer type');const p={size:1,isIndexed:r.isIndexed===void 0?!0:r.isIndexed};i.indices=[new ni(t,{data:c,target:34963}),p]}return i}function DL(t,e){const{attributeMap:n=LL}=e||{};return n&&n[t]||t}function zL(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Vt(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const pf=2,BL=1e4,OL="Model needs drawMode and vertexCount",Ow=()=>{},FL={};class fp{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:i=mc("model")}=n;Vt(lm(e)),this.id=i,this.gl=e,this.id=n.id||mc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||AA.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:i,fs:r,modules:c,defines:p,inject:a,varyings:T,bufferMode:k,transpileToGLSL100:z}=e;this.programProps={program:n,vs:i,fs:r,modules:c,defines:p,inject:a,varyings:T,bufferMode:k,transpileToGLSL100:z},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Vt(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),OL)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:i,fs:r,modules:c,defines:p,inject:a,varyings:T,bufferMode:k,transpileToGLSL100:z}=e;this.programProps={program:n,vs:i,fs:r,modules:c,defines:p,inject:a,varyings:T,bufferMode:k,transpileToGLSL100:z},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Vt(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Vt(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=RL(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Qf(e))return this;const n={};for(const i in e){const r=e[i];n[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return My(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:i,uniforms:r={},attributes:c={},transformFeedback:p=this.transformFeedback,parameters:a={},vertexArray:T=this.vertexArray}=e;this.setAttributes(c),this.updateModuleSettings(n),this.setUniforms(r);let k;nn.priority>=pf&&(k=this._logDrawCallStart(pf));const z=this.vertexArray.getDrawParams(),{isIndexed:B=z.isIndexed,indexType:D=z.indexType,indexOffset:K=z.indexOffset,vertexArrayInstanced:ee=z.isInstanced}=this.props;ee&&!this.isInstanced&&nn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:le,instanceCount:Ce}=this,{onBeforeRender:se=Ow,onAfterRender:ne=Ow}=this.props;se(),this.program.setUniforms(this.uniforms);const te=this.program.draw(Object.assign(FL,e,{logPriority:k,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:T,transformFeedback:p,isIndexed:B,indexType:D,isInstanced:le,instanceCount:Ce,offset:B?K:0}));return ne(),nn.priority>=pf&&this._logDrawCallEnd(k,T,i),te}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:c}=e;i&&this._setFeedbackBuffers(i),n&&(c=Object.assign({},c,{35977:n})),r.forEach(p=>p.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:c}))}finally{r.forEach(p=>p.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return nn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:i,fs:r,modules:c,inject:p,defines:a,varyings:T,bufferMode:k,transpileToGLSL100:z}=this.programProps;n=this.programManager.get({vs:i,fs:r,modules:c,inject:p,defines:a,varyings:T,bufferMode:k,transpileToGLSL100:z}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Vt(n instanceof bE,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new IP(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ni&&n.delete()}}_setAnimationProps(e){this.animated&&Vt(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Qf(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new EE(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:BL;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),nn.group(pf,">>> DRAWING MODEL ".concat(this.id),{collapsed:nn.level<=2})(),e}_logDrawCallEnd(e,n,i,r){if(e===void 0)return;const c=PP({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:p,unusedTable:a,unusedCount:T}=ww({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:k,count:z}=ww({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});z>0&&nn.log("MISSING UNIFORMS",Object.keys(k))(),T>0&&nn.log("UNUSED UNIFORMS",Object.keys(a))();const B=RP(this.vertexArray.configuration);nn.table(e,c)(),nn.table(e,p)(),nn.table(e+1,B)(),r&&r.log({logLevel:pf,message:"Rendered to ".concat(r.id)}),nn.groupEnd(pf)()}}class NL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=n;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],i=e?n[e]:null;return i?i instanceof ni?i:i.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,i=this.getBuffer(n);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Vt(On(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const c=this.feedbackMap[r];r in n&&(i[c]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const c=i[r];if(typeof c=="string"){const p=n[c],{byteLength:a,usage:T,accessor:k}=p;i[r]=this._createNewBuffer(r,{byteLength:a,usage:T,accessor:k})}}return i}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:i})}_setupTransformFeedback(e,n){let{model:i}=n;const{program:r}=i;e.transformFeedback=new EE(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:n,feedbackBuffers:i})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const c=this.feedbackMap[r];n[r]=e.feedbackBuffers[c],i[c]=e.sourceBuffers[r],Vt(i[c]instanceof ni)}return{sourceBuffers:n,feedbackBuffers:i}}_createNewBuffer(e,n){const i=new ni(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}const UL="transform_uSampler_",hp="transform_uSize_",Fw="transform_position";function VL(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,p=Object.keys(n).length,a=null;const T={};let k=e,z={};if(p>0||i){const B=k.split(`
`),D=B.slice();if(B.forEach((K,ee,le)=>{if(p>0){const Ce=WL(K,n);if(Ce){const{updatedLine:se,inject:ne}=Ce;D[ee]=se,z=j1([z,ne]),Object.assign(T,Ce.samplerTextureMap),p--}}i&&!a&&(a=$L(K,i))}),i){Vt(r);const K="".concat(hp).concat(i),ee="uniform vec2 ".concat(K,`;
`),le="     vec2 ".concat(Fw," = transform_getPos(").concat(K,`);
     gl_Position = vec4(`).concat(Fw,`, 0, 1.);
`);z=j1([z,{"vs:#decl":ee,"vs:#main-start":le}])}k=D.join(`
`)}return{vs:k,targetTextureType:a,inject:z,samplerTextureMap:T}}function jL(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let c,p;n&&({width:c,height:p}=i,r["".concat(hp).concat(n)]=[c,p]);for(const a in e)({width:c,height:p}=e[a]),r["".concat(hp).concat(a)]=[c,p];return r}function GL(t){return PE(t,["attribute","in"])}function HL(t){const e="".concat(UL).concat(t),n="".concat(hp).concat(t),i="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:i}}function $L(t,e){const n=PE(t,["varying","out"]);return n&&n.name===e?n.type:null}function WL(t,e){const n={},i=GL(t);if(!i)return null;const{type:r,name:c}=i;if(c&&e[c]){const p="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:T,uniformDeclerations:k}=HL(c),z=w7(r),B="  ".concat(r," ").concat(c," = transform_getInput(").concat(a,", ").concat(T,").").concat(z,`;
`);return n[a]=c,{updatedLine:p,inject:{"vs:#decl":k,"vs:#main-start":B},samplerTextureMap:n}}return null}const ZL={10241:9728,10240:9728,10242:33071,10243:33071},qL="transform_output";class QL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:i,framebuffer:r,targetTexture:c}=this.bindings[this.currentIndex],p=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),T=Object.assign({},e.parameters);let k=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){p.transform_elementID=this.elementIDBuffer;for(const B in this.samplerTextureMap){const D=this.samplerTextureMap[B];a[B]=i[D]}this._setSourceTextureParameters();const z=jL({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:c});Object.assign(a,z)}return this.hasTargetTexture&&(k=!1,T.viewport=[0,0,r.width,r.height]),{attributes:p,framebuffer:r,uniforms:a,discard:k,parameters:T}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],i=um(n);if(!e)return i;const r=i.constructor,c=b7(this.targetTextureType),p=new r(i.length*c/4);let a=0;for(let T=0;T<i.length;T+=4)for(let k=0;k<c;k++)p[a++]=i[T+k];return p}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:i}=e;if(i instanceof ws)return i;const r=n[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:i={},_targetTexture:r}=e,c=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:i,targetTexture:c}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((i,r,c)=>{c[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ni(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:n,targetTexture:i})}}_updateBinding(e,n){const{sourceBuffers:i,sourceTextures:r,targetTexture:c}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),c){e.targetTexture=c;const{width:p,height:a}=c,{framebuffer:T}=e;T?(T.update({attachments:{36064:c},resizeAttachments:!1}),T.resize({width:p,height:a})):e.framebuffer=new fr(this.gl,{id:"transform-framebuffer",width:p,height:a,attachments:{36064:c}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const i in n)n[i].setParameters(ZL)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const i=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:i}}_createNewTexture(e){const n=gk(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:c,targetTextureType:p,inject:a,samplerTextureMap:T}=VL({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),k=j1([e.inject||{},a]);this.targetTextureType=p,this.samplerTextureMap=T;const z=e._fs||LE({version:xE(r),input:this.targetTextureVarying,inputType:p,output:qL}),B=this.hasSourceTextures||this.targetTextureVarying?[PL].concat(e.modules||[]):e.modules;return{vs:r,fs:z,modules:B,uniforms:c,inject:k}}}let Ry=class{static isSupported(e){return On(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:i}=this;e&&e.delete(),n&&n.delete(),i&&i.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,i=this._updateDrawOptions(e);n&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=e||i.swap();Vt(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)i.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new fp(n,Object.assign({},e,{fs:e.fs||LE({version:xE(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=r.updateModelProps(n);return n}_buildResourceTransforms(e,n){XL(n)&&(this.bufferTransform=new NL(e,n)),YL(n)&&(this.textureTransform=new QL(e,n)),Vt(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=Object.assign(n,r.getDrawOptions(n));return n}};function XL(t){return!!(!Qf(t.feedbackBuffers)||!Qf(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function YL(t){return!!(!Qf(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const Nw={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class U0{static get DRAW_MODE(){return Nw}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=mc("geometry"),drawMode:i=Nw.TRIANGLES,attributes:r={},indices:c=null,vertexCount:p=null}=e;this.id=n,this.drawMode=i|0,this.attributes={},this.userData={},this._setAttributes(r,c),this.vertexCount=p||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,Vt(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),(i==="POSITION"||i==="positions")&&!r.size&&(r.size=3),i==="indices"?(Vt(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let i=1/0;for(const r in e){const c=e[r],{value:p,size:a,constant:T}=c;!T&&p&&a>=1&&(i=Math.min(i,p.length/a))}return Vt(Number.isFinite(i)),i}}let KL=1,JL=1;class GE{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:c=1}=e,p=KL++,a={time:0,delay:n,duration:i,rate:r,repeat:c};return this._setChannelTime(a,this.time),this.channels.set(p,a),p}removeChannel(e){this.channels.delete(e);for(const[n,i]of this.animations)i.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const r of n)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:c,channel:p}=r;c.setTime(this.getTime(p))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const i=JL++;return this.animations.set(i,{animation:e,channel:n}),e.setTime(this.getTime(n)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const i=n-e.delay,r=e.duration*e.repeat;i>=r?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const eR=[255,255,255],tR=1;let nR=0;class HE{constructor(e={}){ae(this,"id",void 0),ae(this,"color",void 0),ae(this,"intensity",void 0),ae(this,"type","ambient");const{color:n=eR}=e,{intensity:i=tR}=e;this.id=e.id||"ambient-".concat(nR++),this.color=n,this.intensity=i}}const iR=[255,255,255],rR=1,oR=[0,0,-1];let sR=0;class Z1{constructor(e={}){ae(this,"id",void 0),ae(this,"color",void 0),ae(this,"intensity",void 0),ae(this,"type","directional"),ae(this,"direction",void 0),ae(this,"shadow",void 0);const{color:n=iR}=e,{intensity:i=rR}=e,{direction:r=oR}=e,{_shadow:c=!1}=e;this.id=e.id||"directional-".concat(sR++),this.color=n,this.intensity=i,this.type="directional",this.direction=new Ia(r).normalize().toArray(),this.shadow=c}getProjectedLight(e){return this}}class aR{constructor(e,n={id:"pass"}){ae(this,"id",void 0),ae(this,"gl",void 0),ae(this,"props",void 0);const{id:i}=n;this.id=i,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Dy extends aR{constructor(...e){super(...e),ae(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return ml(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:i,viewports:r,views:c,onViewportActive:p,clearStack:a=!0,clearCanvas:T=!0}=e;e.pass=e.pass||"unknown";const k=this.gl;T&&cR(k,n),a&&(this._lastRenderIndex=-1);const z=[];for(const B of r){const D=c&&c[B.id];p==null||p(B);const K=this._getDrawLayerParams(B,e),ee=B.subViewports||[B];for(const le of ee){const Ce=this._drawLayersInViewport(k,{target:n,moduleParameters:i,viewport:le,view:D,pass:e.pass,layers:e.layers},K);z.push(Ce)}}return z}_getDrawLayerParams(e,{layers:n,pass:i,isPicking:r=!1,layerFilter:c,cullRect:p,effects:a,moduleParameters:T},k=!1){const z=[],B=$E(this._lastRenderIndex+1),D={layer:n[0],viewport:e,isPicking:r,renderPass:i,cullRect:p},K={};for(let ee=0;ee<n.length;ee++){const le=n[ee],Ce=this._shouldDrawLayer(le,D,c,K),se={shouldDrawLayer:Ce};Ce&&!k&&(se.layerRenderIndex=B(le,Ce),se.moduleParameters=this._getModuleParameters(le,a,i,T),se.layerParameters=this.getLayerParameters(le,ee,e)),z[ee]=se}return z}_drawLayersInViewport(e,{layers:n,moduleParameters:i,pass:r,target:c,viewport:p,view:a},T){const k=lR(e,{moduleParameters:i,target:c,viewport:p});if(a&&a.props.clear){const B=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;Ws(e,{scissorTest:!0,scissor:k},()=>My(e,B))}const z={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};ml(e,{viewport:k});for(let B=0;B<n.length;B++){const D=n[B],{shouldDrawLayer:K,layerRenderIndex:ee,moduleParameters:le,layerParameters:Ce}=T[B];if(K&&D.props.pickable&&z.pickableCount++,D.isComposite)z.compositeCount++;else if(K){z.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,ee),le.viewport=p;try{D._drawLayer({moduleParameters:le,uniforms:{layerIndex:ee},parameters:Ce})}catch(se){D.raiseError(se,"drawing ".concat(D," to ").concat(r))}}}return z}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,i){return e.props.parameters}_shouldDrawLayer(e,n,i,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let p=e.parent;for(;p;){if(!p.props.visible||!p.filterSubLayer(n))return!1;n.layer=p,p=p.parent}if(i){const a=n.layer.id;if(a in r||(r[a]=i(n)),!r[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,i,r){var c;const p=Object.assign(Object.create(((c=e.internalState)===null||c===void 0?void 0:c.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:qf(this.gl)});if(n)for(const T of n){var a;Object.assign(p,(a=T.getModuleParameters)===null||a===void 0?void 0:a.call(T,e))}return Object.assign(p,this.getModuleParameters(e,n),r)}}function $E(t=0,e={}){const n={},i=(r,c)=>{const p=r.props._offset,a=r.id,T=r.parent&&r.parent.id;let k;if(T&&!(T in e)&&i(r.parent,!1),T in n){const z=n[T]=n[T]||$E(e[T],e);k=z(r,c),n[a]=z}else Number.isFinite(p)?(k=p+(e[T]||0),n[a]=null):k=t;return c&&k>=t&&(t=k+1),e[a]=k,k};return i}function lR(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&n.id!=="default-framebuffer",c=e&&e.devicePixelRatio||qf(t),p=r?n.height:t.drawingBufferHeight,a=i;return[a.x*c,p-(a.y+a.height)*c,a.width*c,a.height*c]}function cR(t,e){const n=e?e.width:t.drawingBufferWidth,i=e?e.height:t.drawingBufferHeight;ml(t,{viewport:[0,0,n,i]}),t.clear(16640)}class uR extends Dy{constructor(e,n){super(e,n),ae(this,"shadowMap",void 0),ae(this,"depthBuffer",void 0),ae(this,"fbo",void 0),this.shadowMap=new ws(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new vf(e,{format:33189,width:1,height:1}),this.fbo=new fr(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Ws(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=qf(this.gl),c=i.width*r,p=i.height*r;(c!==n.width||p!==n.height)&&n.resize({width:c,height:p}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const WE="#define SMOOTH_EDGE_RADIUS 0.5",fR=`
`.concat(WE,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),hR=`
`.concat(WE,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),dR={name:"geometry",vs:fR,fs:hR},AR=Object.keys(Un).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Un[t],";")).join(""),pR=Object.keys(wa).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(wa[t],";")).join(""),mR=Object.keys(Wx).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Wx[t],";")).join(""),gR="".concat(AR,`
`).concat(pR,`
`).concat(mR,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function _R(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function pA(t){let e={},n;return i=>{for(const r in i)if(!_R(i[r],e[r])){n=t(i),e=i;break}return n}}const Uw=[0,0,0,0],yR=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],ZE=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],vR=[0,0,0],qE=[0,0,0],xR=pA(ER);function QE(t,e,n=qE){n.length<3&&(n=[n[0],n[1],0]);let i=n,r,c=!0;switch(e===Un.LNGLAT_OFFSETS||e===Un.METER_OFFSETS?r=n:r=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case wa.WEB_MERCATOR:(e===Un.LNGLAT||e===Un.CARTESIAN)&&(r=[0,0,0],c=!1);break;case wa.WEB_MERCATOR_AUTO_OFFSET:e===Un.LNGLAT?i=r:e===Un.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case wa.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case wa.GLOBE:c=!1,r=null;break;default:c=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:c}}function wR(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:c,viewProjectionMatrix:p}=t,a=Uw,T=Uw,k=t.cameraPosition;const{geospatialOrigin:z,shaderCoordinateOrigin:B,offsetMode:D}=QE(t,e,n);return D&&(T=t.projectPosition(z||B),k=[k[0]-T[0],k[1]-T[1],k[2]-T[2]],T[3]=1,a=dA([],T,p),c=i||c,p=cu([],r,c),p=cu([],p,yR)),{viewMatrix:c,viewProjectionMatrix:p,projectionCenter:a,originCommon:T,cameraPosCommon:k,shaderCoordinateOrigin:B,geospatialOrigin:z}}function bR({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=Un.DEFAULT,coordinateOrigin:r=qE,autoWrapLongitude:c=!1}){i===Un.DEFAULT&&(i=t.isGeospatial?Un.LNGLAT:Un.CARTESIAN);const p=xR({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return p.project_uWrapLongitude=c,p.project_uModelMatrix=n||ZE,p}function ER({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:c,originCommon:p,cameraPosCommon:a,shaderCoordinateOrigin:T,geospatialOrigin:k}=wR(t,n,i),z=t.getDistanceScales(),B=[t.width*e,t.height*e],D=dA([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,K={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:T,project_uCommonOrigin:p.slice(0,3),project_uCenter:r,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:B,project_uDevicePixelRatio:e,project_uFocalDistance:D,project_uCommonUnitsPerMeter:z.unitsPerMeter,project_uCommonUnitsPerWorldUnit:z.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:vR,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:c,project_uModelMatrix:ZE,project_uCameraPosition:a};if(k){const ee=t.getDistanceScales(k);switch(n){case Un.METER_OFFSETS:K.project_uCommonUnitsPerWorldUnit=ee.unitsPerMeter,K.project_uCommonUnitsPerWorldUnit2=ee.unitsPerMeter2;break;case Un.LNGLAT:case Un.LNGLAT_OFFSETS:t._pseudoMeters||(K.project_uCommonUnitsPerMeter=ee.unitsPerMeter),K.project_uCommonUnitsPerWorldUnit=ee.unitsPerDegree,K.project_uCommonUnitsPerWorldUnit2=ee.unitsPerDegree2;break;case Un.CARTESIAN:K.project_uCommonUnitsPerWorldUnit=[1,1,ee.unitsPerMeter[2]],K.project_uCommonUnitsPerWorldUnit2=[0,0,ee.unitsPerMeter2[2]];break}}return K}const TR={};function SR(t=TR){return"viewport"in t?bR(t):{}}const zy={name:"project",dependencies:[S7,dR],vs:gR,getUniforms:SR};function MR(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Ff(t,e){const n=dA([],e,t);return fL(n,n,1/n[3]),n}function Vw(t,e){const n=t%e;return n<0?e+n:n}function q1(t,e,n){return t<e?e:t>n?n:t}function IR(t){return Math.log(t)*Math.LOG2E}const By=Math.log2||IR;function gl(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const $s=Math.PI,XE=$s/4,vs=$s/180,Q1=180/$s,th=512,dp=4003e4,o0=85.051129,CR=1.5;function kR(t){return By(t)}function Ap(t){const[e,n]=t;gl(Number.isFinite(e)),gl(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=e*vs,r=n*vs,c=th*(i+$s)/(2*$s),p=th*($s+Math.log(Math.tan(XE+r*.5)))/(2*$s);return[c,p]}function nh(t){const[e,n]=t,i=e/th*(2*$s)-$s,r=2*(Math.atan(Math.exp(n/th*(2*$s)-$s))-XE);return[i*Q1,r*Q1]}function PR(t){const{latitude:e}=t;gl(Number.isFinite(e));const n=Math.cos(e*vs);return kR(dp*n)-9}function jg(t){const e=Math.cos(t*vs);return th/dp/e}function X1(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;gl(Number.isFinite(e)&&Number.isFinite(n));const r=th,c=Math.cos(e*vs),p=r/360,a=p/c,T=r/dp/c,k={unitsPerMeter:[T,T,T],metersPerUnit:[1/T,1/T,1/T],unitsPerDegree:[p,a,T],degreesPerUnit:[1/p,1/a,1/T]};if(i){const z=vs*Math.tan(e*vs)/c,B=p*z/2,D=r/dp*z,K=D/a*T;k.unitsPerDegree2=[0,B,D],k.unitsPerMeter2=[K,0,K]}return k}function YE(t,e){const[n,i,r]=t,[c,p,a]=e,{unitsPerMeter:T,unitsPerMeter2:k}=X1({longitude:n,latitude:i,highPrecision:!0}),z=Ap(t);z[0]+=c*(T[0]+k[0]*p),z[1]+=p*(T[1]+k[1]*p);const B=nh(z),D=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[B[0],B[1],D]:B}function LR(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:c,center:p}=t,a=MR();up(a,a,[0,0,-r]),OE(a,a,-n*vs),FE(a,a,i*vs);const T=c/e;return Ly(a,a,[T,T,T]),p&&up(a,a,V7([],p)),a}function RR(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:c,center:p,scale:a,nearZMultiplier:T=1,farZMultiplier:k=1}=t;let{fovy:z=pp(CR)}=t;i!==void 0&&(z=pp(i));const B=z*vs,D=r*vs,K=KE(z);let ee=K;p&&(ee+=p[2]*a/Math.cos(D)/n);const le=B*(.5+(c?c[1]:0)/n),Ce=Math.sin(le)*ee/Math.sin(q1(Math.PI/2-D-le,.01,Math.PI-.01)),se=Math.sin(D)*Ce+ee,ne=ee*10,te=Math.min(se*k,ne);return{fov:B,aspect:e/n,focalDistance:K,near:T,far:te}}function pp(t){return 2*Math.atan(.5/t)*Q1}function KE(t){return .5/Math.tan(.5*t*vs)}function JE(t,e){const[n,i,r=0]=t;return gl(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),Ff(e,[n,i,r,1])}function Oy(t,e,n=0){const[i,r,c]=t;if(gl(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(c))return Ff(e,[i,r,c,1]);const p=Ff(e,[i,r,0,1]),a=Ff(e,[i,r,1,1]),T=p[2],k=a[2],z=T===k?0:((n||0)-T)/(k-T);return DE([],p,a,z)}function DR(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:c=24,offset:p=[0,0]}=t,[[a,T],[k,z]]=i,B=zR(t.padding),D=Ap([a,q1(z,-o0,o0)]),K=Ap([k,q1(T,-o0,o0)]),ee=[Math.max(Math.abs(K[0]-D[0]),r),Math.max(Math.abs(K[1]-D[1]),r)],le=[e-B.left-B.right-Math.abs(p[0])*2,n-B.top-B.bottom-Math.abs(p[1])*2];gl(le[0]>0&&le[1]>0);const Ce=le[0]/ee[0],se=le[1]/ee[1],ne=(B.right-B.left)/2/Ce,te=(B.top-B.bottom)/2/se,xe=[(K[0]+D[0])/2+ne,(K[1]+D[1])/2+te],Le=nh(xe),Ge=Math.min(c,By(Math.abs(Math.min(Ce,se))));return gl(Number.isFinite(Ge)),{longitude:Le[0],latitude:Le[1],zoom:Ge}}function zR(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(gl(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const jw=Math.PI/180;function BR(t,e=0){const{width:n,height:i,unproject:r}=t,c={targetZ:e},p=r([0,i],c),a=r([n,i],c);let T,k;const z=t.fovy?.5*t.fovy*jw:Math.atan(.5/t.altitude),B=(90-t.pitch)*jw;return z>B-.01?(T=Gw(t,0,e),k=Gw(t,n,e)):(T=r([0,0],c),k=r([n,0],c)),[p,a,k,T]}function Gw(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=Ff(i,[e,0,1,1]),c=Ff(i,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-r[2])/(c[2]-r[2]),T=DE([],r,c,a),k=nh(T);return k.push(n),k}const Hw=512;function OR(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:c,zoom:p,bearing:a=0}=t;(r<-180||r>180)&&(r=Vw(r+180,360)-180),(a<-180||a>180)&&(a=Vw(a+180,360)-180);const T=By(n/Hw);if(p<=T)p=T,c=0;else{const k=n/2/Math.pow(2,p),z=nh([0,k])[1];if(c<z)c=z;else{const B=nh([0,Hw-k])[1];c>B&&(c=B)}}return{width:e,height:n,longitude:r,latitude:c,zoom:p,pitch:i,bearing:a}}const FR=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,NR=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,UR=pA($R),VR=pA(WR),jR=[0,0,0,1],GR=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function HR(t,e){const[n,i,r]=t,c=Oy([n,i,r],e);return Number.isFinite(r)?c:[c[0],c[1],0]}function $R({viewport:t,center:e}){return new Ca(t.viewProjectionMatrix).invert().transform(e)}function WR({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,c=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(p=>HR(p,i));for(const p of e){const a=p.clone().translate(new Ia(t.center).negate()),T=c.map(z=>a.transform(z)),k=new Ca().ortho({left:Math.min(...T.map(z=>z[0])),right:Math.max(...T.map(z=>z[0])),bottom:Math.min(...T.map(z=>z[1])),top:Math.max(...T.map(z=>z[1])),near:Math.min(...T.map(z=>-z[2])),far:Math.max(...T.map(z=>-z[2]))});n.push(k.multiplyRight(p))}return n}function ZR(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||jR,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=UR({viewport:t.viewport,center:e.project_uCenter}),c=[],p=VR({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const T=p[a],k=T.clone().translate(new Ia(t.viewport.center).negate());e.project_uCoordinateSystem===Un.LNGLAT&&e.project_uProjectionMode===wa.WEB_MERCATOR?(p[a]=k,c[a]=r):(p[a]=T.clone().multiplyRight(GR),c[a]=k.transform(r))}for(let a=0;a<p.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=p[a],i["shadow_uProjectCenters[".concat(a,"]")]=c[a],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:i["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return i}const Gg={name:"shadow",dependencies:[zy],vs:FR,fs:NR,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?ZR(t,e):{}},qR={color:[255,255,255],intensity:1},$w=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],QR=[0,0,0,200/255];class Fy{constructor(e={}){ae(this,"id","lighting-effect"),ae(this,"props",void 0),ae(this,"shadowColor",QR),ae(this,"shadow",void 0),ae(this,"ambientLight",void 0),ae(this,"directionalLights",void 0),ae(this,"pointLights",void 0),ae(this,"shadowPasses",[]),ae(this,"shadowMaps",[]),ae(this,"dummyShadowMap",null),ae(this,"programManager",void 0),ae(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const i=e[n];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:c,views:p}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=AA.getDefaultProgramManager(e),Gg&&this.programManager.addDefaultModule(Gg)),this.dummyShadowMap||(this.dummyShadowMap=new ws(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:i,viewports:r,onViewportActive:c,views:p,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Gg),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const i=new Ca().lookAt({eye:new Ia(n.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const i=new uR(e);this.shadowPasses[n]=i,this.shadowMaps[n]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:i}=this;!e&&n.length===0&&i.length===0&&(this.ambientLight=new HE(qR),this.directionalLights.push(new Z1($w[0]),new Z1($w[1])))}}class XR{constructor(e={}){ae(this,"_pool",[]),ae(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:i=1,type:r,padding:c=0,copy:p=!1,initialize:a=!1,maxCount:T}){const k=r||e&&e.constructor||Float32Array,z=n*i+c;if(ArrayBuffer.isView(e)){if(z<=e.length)return e;if(z*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new k(e.buffer,0,z)}let B=1/0;T&&(B=T*i+c);const D=this._allocate(k,z,a,B);return e&&p?D.set(e):a||D.fill(0,0,4),this._release(e),D}release(e){this._release(e)}_allocate(e,n,i,r){let c=Math.max(Math.ceil(n*this.opts.overAlloc),1);c>r&&(c=r);const p=this._pool,a=e.BYTES_PER_ELEMENT*c,T=p.findIndex(k=>k.byteLength>=a);if(T>=0){const k=new e(p.splice(T,1)[0],0,c);return i&&k.fill(0),k}return new e(c)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:i}=e,{byteLength:r}=i,c=n.findIndex(p=>p.byteLength>=r);c<0?n.push(i):(c>0||n.length<this.opts.poolSize)&&n.splice(c,0,i),n.length>this.opts.poolSize&&n.shift()}}const ih=new XR;function ld(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function YR(t){return[t[12],t[13],t[14]]}function KR(t){return{left:mf(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:mf(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:mf(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:mf(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:mf(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:mf(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const Ww=new Ia;function mf(t,e,n,i){Ww.set(t,e,n);const r=Ww.len();return{distance:i/r,normal:new Ia(-t/r,-e/r,-n/r)}}function JR(t){return t-Math.fround(t)}let Xh;function Hg(t,e){const{size:n=1,startIndex:i=0}=e,r=e.endIndex!==void 0?e.endIndex:t.length,c=(r-i)/n;Xh=ih.allocate(Xh,c,{type:Float32Array,size:n*2});let p=i,a=0;for(;p<r;){for(let T=0;T<n;T++){const k=t[p++];Xh[a+T]=k,Xh[a+T+n]=JR(k)}a+=n*2}return Xh.subarray(0,c*n*2)}function eD(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}const tD=Math.PI/180,nD=ld(),Zw=[0,0,0],iD={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function rD({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:c,near:p,far:a}){const T=t/e,k=n?new Ca().orthographic({fovy:i,aspect:T,focalDistance:r,near:p,far:a}):new Ca().perspective({fovy:i,aspect:T,near:p,far:a});if(c){const{left:z=0,right:B=0,top:D=0,bottom:K=0}=c,ee=tc((z+t-B)/2,0,t)-t/2,le=tc((D+e-K)/2,0,e)-e/2;k[8]-=ee*2/t,k[9]+=le*2/e}return k}class gh{constructor(e={}){ae(this,"id",void 0),ae(this,"x",void 0),ae(this,"y",void 0),ae(this,"width",void 0),ae(this,"height",void 0),ae(this,"padding",void 0),ae(this,"isGeospatial",void 0),ae(this,"zoom",void 0),ae(this,"focalDistance",void 0),ae(this,"position",void 0),ae(this,"modelMatrix",void 0),ae(this,"distanceScales",void 0),ae(this,"scale",void 0),ae(this,"center",void 0),ae(this,"cameraPosition",void 0),ae(this,"projectionMatrix",void 0),ae(this,"viewMatrix",void 0),ae(this,"viewMatrixUncentered",void 0),ae(this,"viewMatrixInverse",void 0),ae(this,"viewProjectionMatrix",void 0),ae(this,"pixelProjectionMatrix",void 0),ae(this,"pixelUnprojectionMatrix",void 0),ae(this,"resolution",void 0),ae(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||iD,this.focalDistance=e.focalDistance||1,this.position=e.position||Zw,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?wa.WEB_MERCATOR:wa.WEB_MERCATOR_AUTO_OFFSET:wa.IDENTITY}equals(e){return e instanceof gh?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Dd(e.projectionMatrix,this.projectionMatrix)&&Dd(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const i=this.projectPosition(e),r=JE(i,this.pixelProjectionMatrix),[c,p]=r,a=n?p:this.height-p;return e.length===2?[c,a]:[c,a,r[2]]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,c,p]=e,a=n?c:this.height-c,T=i&&i*this.distanceScales.unitsPerMeter[2],k=Oy([r,a,p],this.pixelUnprojectionMatrix,T),[z,B,D]=this.unprojectPosition(k);return Number.isFinite(p)?[z,B,D]:Number.isFinite(i)?[z,B,i]:[z,B]}projectPosition(e){const[n,i]=this.projectFlat(e),r=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,i,r]}unprojectPosition(e){const[n,i]=this.unprojectFlat(e),r=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,i,r]}projectFlat(e){if(this.isGeospatial){const n=Ap(e);return n[1]=tc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?nh(e):e}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,0],n),r=this.unproject([this.width,0],n),c=this.unproject([0,this.height],n),p=this.unproject([this.width,this.height],n);return[Math.min(i[0],r[0],c[0],p[0]),Math.min(i[1],r[1],c[1],p[1]),Math.max(i[0],r[0],c[0],p[0]),Math.max(i[1],r[1],c[1],p[1])]}getDistanceScales(e){return e?X1({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,KR(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=PR({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||X1({latitude:i,longitude:n}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:c,modelMatrix:p}=e;let a=Zw;if(c&&(a=p?new Ca(p).transformAsVector(c,[]):c),this.isGeospatial){const T=this.projectPosition([n,i,0]);this.center=new Ia(a).scale(this.distanceScales.unitsPerMeter).add(T)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=nD,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:c,fovy:p=75,near:a=.1,far:T=1e3,padding:k=null,focalDistance:z=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Ca().multiplyRight(n).translate(new Ia(this.center).negate()),this.projectionMatrix=i||rD({width:this.width,height:this.height,orthographic:r,fovyRadians:c||p*tD,focalDistance:z,padding:k,near:a,far:T});const B=ld();cu(B,B,this.projectionMatrix),cu(B,B,this.viewMatrix),this.viewProjectionMatrix=B,this.viewMatrixInverse=$1([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=YR(this.viewMatrixInverse);const D=ld(),K=ld();Ly(D,D,[this.width/2,-this.height/2,1]),up(D,D,[1,-1,0]),cu(K,D,this.viewProjectionMatrix),this.pixelProjectionMatrix=K,this.pixelUnprojectionMatrix=$1(ld(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||ii.warn("Pixel project matrix not invertible")()}}ae(gh,"displayName","Viewport");class rh extends gh{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,pitch:c=0,bearing:p=0,nearZMultiplier:a=.1,farZMultiplier:T=1.01,orthographic:k=!1,projectionMatrix:z,repeat:B=!1,worldOffset:D=0,position:K,padding:ee,legacyMeterSizes:le=!1}=e;let{width:Ce,height:se,altitude:ne=1.5}=e;const te=Math.pow(2,r);Ce=Ce||1,se=se||1;let xe,Le=null;if(z)ne=z[5]/2,xe=pp(ne);else{e.fovy?(xe=e.fovy,ne=KE(xe)):xe=pp(ne);let nt;if(ee){const{top:it=0,bottom:dt=0}=ee;nt=[0,tc((it+se-dt)/2,0,se)-se/2]}Le=RR({width:Ce,height:se,scale:te,center:K&&[0,0,K[2]*jg(n)],offset:nt,pitch:c,fovy:xe,nearZMultiplier:a,farZMultiplier:T})}let Ge=LR({height:se,pitch:c,bearing:p,scale:te,altitude:ne});D&&(Ge=new Ca().translate([512*D,0,0]).multiplyLeft(Ge)),super({...e,width:Ce,height:se,viewMatrix:Ge,longitude:i,latitude:n,zoom:r,...Le,fovy:xe,focalDistance:ne}),ae(this,"longitude",void 0),ae(this,"latitude",void 0),ae(this,"pitch",void 0),ae(this,"bearing",void 0),ae(this,"altitude",void 0),ae(this,"fovy",void 0),ae(this,"orthographic",void 0),ae(this,"_subViewports",void 0),ae(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=i,this.zoom=r,this.pitch=c,this.bearing=p,this.altitude=ne,this.fovy=xe,this.orthographic=k,this._subViewports=B?[]:null,this._pseudoMeters=le,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=n;r<=i;r++){const c=r?new rh({...this,worldOffset:r}):this;this._subViewports.push(c)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,i]=this.projectFlat(e),r=(e[2]||0)*jg(e[1]);return[n,i,r]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,i]=this.unprojectFlat(e),r=(e[2]||0)/jg(i);return[n,i,r]}addMetersToLngLat(e,n){return YE(e,n)}panByPosition(e,n){const i=Oy(n,this.pixelUnprojectionMatrix),r=this.projectFlat(e),c=Dw([],r,z7([],i)),p=Dw([],this.center,c),[a,T]=this.unprojectFlat(p);return{longitude:a,latitude:T}}getBounds(e={}){const n=BR(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:i,height:r}=this,{longitude:c,latitude:p,zoom:a}=DR({width:i,height:r,bounds:e,...n});return new rh({width:i,height:r,longitude:c,latitude:p,zoom:a})}}ae(rh,"displayName","WebMercatorViewport");const qw=[0,0,0];function $g(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof rh){const[r,c,p=0]=t,a=e.getDistanceScales([r,c]);i[2]=p*a.unitsPerMeter[2]}return i}function oD(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:c,fromCoordinateOrigin:p}=t;return r===Un.DEFAULT&&(r=e.isGeospatial?Un.LNGLAT:Un.CARTESIAN),c===void 0&&(c=r),p===void 0&&(p=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:c,fromCoordinateOrigin:p}}function e6(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:c}){let[p,a,T=0]=t;switch(n&&([p,a,T]=dA([],[p,a,T,1],n)),i){case Un.LNGLAT:return $g([p,a,T],e,c);case Un.LNGLAT_OFFSETS:return $g([p+r[0],a+r[1],T+(r[2]||0)],e,c);case Un.METER_OFFSETS:return $g(YE(r,[p,a,T]),e,c);case Un.CARTESIAN:default:return e.isGeospatial?[p+r[0],a+r[1],T+r[2]]:e.projectPosition([p,a,T])}}function sD(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:c,fromCoordinateSystem:p,fromCoordinateOrigin:a}=oD(e),{autoOffset:T=!0}=e,{geospatialOrigin:k=qw,shaderCoordinateOrigin:z=qw,offsetMode:B=!1}=T?QE(n,i,r):{},D=e6(t,{viewport:n,modelMatrix:c,coordinateSystem:p,coordinateOrigin:a,offsetMode:B});if(B){const K=n.projectPosition(k||z);X7(D,D,K)}return D}const du=Math.PI/180,aD=1e3*60*60*24,lD=2440588,cD=2451545,mp=du*23.4397,uD=357.5291,fD=.98560028,hD=280.147,dD=360.9856235;function AD(t,e,n){const i=du*-n,r=du*e,c=mD(t),p=ED(c),a=xD(c,i)-p.rightAscension;return{azimuth:yD(a,r,p.declination),altitude:vD(a,r,p.declination)}}function Qw(t,e,n){const{azimuth:i,altitude:r}=AD(t,e,n);return[Math.sin(i)*Math.cos(r),Math.cos(i)*Math.cos(r),-Math.sin(r)]}function pD(t){return(typeof t=="number"?t:t.getTime())/aD-.5+lD}function mD(t){return pD(t)-cD}function gD(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(mp)-Math.tan(e)*Math.sin(mp),Math.cos(n))}function _D(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(mp)+Math.cos(e)*Math.sin(mp)*Math.sin(n))}function yD(t,e,n){const i=t,r=e,c=n;return Math.atan2(Math.sin(i),Math.cos(i)*Math.sin(r)-Math.tan(c)*Math.cos(r))}function vD(t,e,n){const i=t,r=e,c=n;return Math.asin(Math.sin(r)*Math.sin(c)+Math.cos(r)*Math.cos(c)*Math.cos(i))}function xD(t,e){return du*(hD+dD*t)-e}function wD(t){return du*(uD+fD*t)}function bD(t){const e=t,n=du*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),i=du*102.9372;return e+n+i+Math.PI}function ED(t){const e=wD(t),n=bD(e);return{declination:_D(n,0),rightAscension:gD(n,0)}}class TD extends Z1{constructor(e){super(e),ae(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[r,c,p]=Qw(this.timestamp,0,0);this.direction=[r,-p,c]}else{const{latitude:r,longitude:c}=n;this.direction=Qw(this.timestamp,r,c)}return this}}const Xw={blendFunc:[1,0,32771,0],blendEquation:32774};class t6 extends Dy{constructor(...e){super(...e),ae(this,"pickZ",void 0),ae(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:c,pickingFBO:p,deviceRect:{x:a,y:T,width:k,height:z},cullRect:B,effects:D,pass:K="picking",pickZ:ee,moduleParameters:le}){const Ce=this.gl;this.pickZ=ee;const se=this._resetColorEncoder(ee),ne=Ws(Ce,{scissorTest:!0,scissor:[a,T,k,z],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Xw,blend:!ee},()=>super.render({target:p,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:c,cullRect:B,effects:D==null?void 0:D.filter(xe=>xe.useInPicking),pass:K,isPicking:!0,moduleParameters:le}));return this._colorEncoderState=null,{decodePickingColor:se&&MD.bind(null,se),stats:ne}}shouldDrawLayer(e){const{pickable:n,operation:i}=e.props;return n&&i.includes("draw")||i.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,i){const r={...e.props.parameters},{pickable:c,operation:p}=e.props;return this._colorEncoderState?c&&p.includes("draw")&&(Object.assign(r,Xw),r.blend=!0,r.blendColor=SD(this._colorEncoderState,e,i)):r.blend=!1,p.includes("terrain")&&(r.blend=!1),r}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function SD(t,e,n){const{byLayer:i,byAlpha:r}=t;let c,p=i.get(e);return p?(p.viewports.push(n),c=p.a):(c=i.size+1,c<=255?(p={a:c,layer:e,viewports:[n]},i.set(e,p),r[c]=p):(ii.warn("Too many pickable layers, only picking the first 255")(),c=0)),[0,0,0,c/255]}function MD(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const yf={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},gp=Symbol.for("component"),ac=Symbol.for("propTypes"),Wg=Symbol.for("deprecatedProps"),Nf=Symbol.for("asyncPropDefaults"),Au=Symbol.for("asyncPropOriginal"),nc=Symbol.for("asyncPropResolved");function Ny(t,e=()=>!0){return Array.isArray(t)?n6(t,e,[]):e(t)?[t]:[]}function n6(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?n6(r,e,n):e(r)&&n.push(r)}return n}function ID({target:t,source:e,start:n=0,count:i=1}){const r=e.length,c=i*r;let p=0;for(let a=n;p<r;p++)t[a++]=e[p];for(;p<c;)p<c-p?(t.copyWithin(n+p,n,n+p),p*=2):(t.copyWithin(n+p,n,n+c-p),p=c);return t}class CD{constructor(e,n,i){ae(this,"id",void 0),ae(this,"context",void 0),ae(this,"isLoaded",void 0),ae(this,"persistent",void 0),ae(this,"_loadCount",0),ae(this,"_subscribers",new Set),ae(this,"_data",void 0),ae(this,"_loader",void 0),ae(this,"_error",void 0),ae(this,"_content",void 0),this.id=e,this.context=i,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const i=++this._loadCount;let r=e;typeof e=="string"&&(r=R1(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(c=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=c)}).catch(c=>{this._loadCount===i&&(this.isLoaded=!0,this._error=c||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const c of this._subscribers)c.onChange(this.getData())}}class kD{constructor({gl:e,protocol:n}){ae(this,"protocol",void 0),ae(this,"_context",void 0),ae(this,"_resources",void 0),ae(this,"_consumers",void 0),ae(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}){let c=this._resources[e];c?c.setData(n,i):(c=new CD(e,n,this._context),this._resources[e]=c),c.persistent=r}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const i in n){const r=n[i],c=this._resources[r.resourceId];c&&c.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:i,requestId:r="default"}){const{_resources:c,protocol:p}=this;e.startsWith(p)&&(e=e.replace(p,""),c[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=c[e];if(this._track(i,r,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,i,r){const c=this._consumers,p=c[e]=c[e]||{},a=p[n]||{},T=a.resourceId&&this._resources[a.resourceId];T&&(T.unsubscribe(a),this.prune()),i&&(p[n]=a,a.onChange=r,a.resourceId=i.id,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const PD=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,i6={name:"project32",dependencies:[zy],vs:PD},r6={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...TL},LD=[zy],RD=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function DD(t){const e=AA.getDefaultProgramManager(t);for(const n of LD)e.addDefaultModule(n);for(const n of RD)e.addShaderHook(n);return e}const zD="layerManager.setLayers",BD="layerManager.activateViewport";class OD{constructor(e,{deck:n,stats:i,viewport:r,timeline:c}={}){ae(this,"layers",void 0),ae(this,"context",void 0),ae(this,"resourceManager",void 0),ae(this,"_lastRenderedLayers",[]),ae(this,"_needsRedraw",!1),ae(this,"_needsUpdate",!1),ae(this,"_nextLayers",null),ae(this,"_debug",!1),ae(this,"activateViewport",p=>{Wr(BD,this,p),p&&(this.context.viewport=p)}),this.layers=[],this.resourceManager=new kD({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&DD(e),stats:i||new Ty({id:"deck.gl"}),viewport:r||new gh({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:c||new GE,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);n=n||r}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(i=>n.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Wr(zD,this,n,e),this._lastRenderedLayers=e;const i=Ny(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,i){i.raiseError(n,"".concat(e," of ").concat(i))}_updateLayers(e,n){const i={};for(const p of e)i[p.id]?ii.warn("Multiple old layers with same id ".concat(p.id))():i[p.id]=p;const r=[];this._updateSublayersRecursively(n,i,r),this._finalizeOldLayers(i);let c=!1;for(const p of r)if(p.hasUniformTransition()){c="Uniform transition in ".concat(p);break}this._needsUpdate=c,this.layers=r}_updateSublayersRecursively(e,n,i){for(const r of e){r.context=this.context;const c=n[r.id];c===null&&ii.warn("Multiple new layers with same id ".concat(r.id))(),n[r.id]=null;let p=null;try{this._debug&&c!==r&&r.validateProps(),c?(this._transferLayerState(c,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),p=r.isComposite?r.getSubLayers():null}catch(a){this._handleError("matching",a,r)}p&&this._updateSublayersRecursively(p,n,i)}}_finalizeOldLayers(e){for(const n in e){const i=e[n];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=yf.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=yf.MATCHED,n!==e&&(e.lifecycle=yf.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=yf.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=yf.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function ba(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!ba(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(const c of i)if(!e.hasOwnProperty(c)||!ba(t[c],e[c],n-1))return!1;return!0}return!1}class FD{constructor(e){ae(this,"width",void 0),ae(this,"height",void 0),ae(this,"views",void 0),ae(this,"viewState",void 0),ae(this,"controllers",void 0),ae(this,"timeline",void 0),ae(this,"_viewports",void 0),ae(this,"_viewportMap",void 0),ae(this,"_isUpdating",void 0),ae(this,"_needsRedraw",void 0),ae(this,"_needsUpdate",void 0),ae(this,"_eventManager",void 0),ae(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,i=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,n){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let c=i.length-1;c>=0;--c){const p=i[c];if(p.containsPixel(r)){const a=e.slice();return a[0]-=p.x,a[1]-=p.y,p.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Ny(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!ba(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):ii.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const i=n.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:c=>{var p;return(p=this.getView(e.id))===null||p===void 0?void 0:p.makeViewport({viewState:c,width:this.width,height:this.height})}})}_updateController(e,n,i,r){const c=e.controller;if(c&&i){const p={...n,...c,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!r||r.constructor!==c.type)&&(r=this._createController(e,p)),r&&r.setProps(p),r}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const c=e[r],p=this.getViewState(c),a=c.makeViewport({viewState:p,width:this.width,height:this.height});let T=n[c.id];const k=!!c.controller;k&&!T&&(i=!0),(i||!k)&&T&&(T.finalize(),T=null),this.controllers[c.id]=this._updateController(c,p,a,T),a&&this._viewports.unshift(a)}for(const r in n){const c=n[r];c&&!this.controllers[r]&&c.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((i,r)=>!e[r].equals(n[r]))}}const ND=/([0-9]+\.?[0-9]*)(%|px)/;function Zl(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=ND.exec(t);if(e&&e.length>=3){const n=e[2]==="%",i=parseFloat(e[1]);return{position:n?i/100:i,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function ql(t,e){return t.relative?Math.round(t.position*e):t.position}function vr(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class oh{constructor(e){ae(this,"id",void 0),ae(this,"viewportInstance",void 0),ae(this,"_x",void 0),ae(this,"_y",void 0),ae(this,"_width",void 0),ae(this,"_height",void 0),ae(this,"_padding",void 0),ae(this,"props",void 0);const{id:n,x:i=0,y:r=0,width:c="100%",height:p="100%",padding:a=null,viewportInstance:T}=e||{};vr(!T||T instanceof gh),this.viewportInstance=T,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Zl(i),this._y=Zl(r),this._width=Zl(c),this._height=Zl(p),this._padding=a&&{left:Zl(a.left||0),right:Zl(a.right||0),top:Zl(a.top||0),bottom:Zl(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&ba(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return!r.height||!r.width?null:new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const i in this.props.viewState)i!=="id"&&(n[i]=this.props.viewState[i]);return n}return e}getDimensions({width:e,height:n}){const i={x:ql(this._x,e),y:ql(this._y,n),width:ql(this._width,e),height:ql(this._height,n)};return this._padding&&(i.padding={left:ql(this._padding.left,e),top:ql(this._padding.top,n),right:ql(this._padding.right,e),bottom:ql(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class mA{constructor(e){ae(this,"_inProgress",void 0),ae(this,"_handle",void 0),ae(this,"_timeline",void 0),ae(this,"time",void 0),ae(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,i;this.cancel(),this.settings=e,this._inProgress=!0,(n=(i=this.settings).onStart)===null||n===void 0||n.call(i,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Yw=()=>{},Y1={BREAK:1,SNAP_TO_END:2,IGNORE:3},UD=t=>t,VD=Y1.BREAK;class jD{constructor(e){ae(this,"getControllerState",void 0),ae(this,"props",void 0),ae(this,"propsInTransition",void 0),ae(this,"transition",void 0),ae(this,"onViewStateChange",void 0),ae(this,"onStateChange",void 0),ae(this,"_onTransitionUpdate",n=>{const{time:i,settings:{interpolator:r,startProps:c,endProps:p,duration:a,easing:T}}=n,k=T(i/a),z=r.interpolateProps(c,p,k);this.propsInTransition=this.getControllerState({...this.props,...z}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new mA(e.timeline),this.onViewStateChange=e.onViewStateChange||Yw,this.onStateChange=e.onStateChange||Yw}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:c,endProps:p}=this.transition.settings;r={...i,...c===Y1.SNAP_TO_END?p:this.propsInTransition||i}}this._triggerTransition(r,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:i}=e;return(n>0||n==="auto")&&!!i}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Y1.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const i=this.getControllerState(e),r=this.getControllerState(n).shortestPathFrom(i),c=n.transitionInterpolator,p=c.getDuration?c.getDuration(e,n):n.transitionDuration;if(p===0)return;const a=c.initializeProps(e,r);this.propsInTransition={};const T={duration:p,easing:n.transitionEasing||UD,interpolator:c,interruption:n.transitionInterruption||VD,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(T),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class GD{constructor(e){ae(this,"_propsToCompare",void 0),ae(this,"_propsToExtract",void 0),ae(this,"_requiredProps",void 0);const{compare:n,extract:i,required:r}=e;this._propsToCompare=n,this._propsToExtract=i||n,this._requiredProps=r}arePropsEqual(e,n){for(const i of this._propsToCompare)if(!(i in e)||!(i in n)||!Dd(e[i],n[i]))return!1;return!0}initializeProps(e,n){const i={},r={};for(const c of this._propsToExtract)(c in e||c in n)&&(i[c]=e[c],r[c]=n[c]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const i=e[n];vr(Number.isFinite(i)||Array.isArray(i),"".concat(n," is required for transition"))})}}const HD=["longitude","latitude","zoom","bearing","pitch"],$D=["longitude","latitude","zoom"];class o6 extends GD{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:HD,required:$D},super(i.transitionProps),ae(this,"opts",void 0),this.opts=i}initializeProps(e,n){const i=super.initializeProps(e,n),{makeViewport:r,around:c}=this.opts;if(r&&c){const p=r(e),a=r(n),T=p.unproject(c);i.start.around=c,Object.assign(i.end,{around:a.project(T),aroundPosition:T,width:n.width,height:n.height})}return i}interpolateProps(e,n,i){const r={};for(const c of this._propsToExtract)r[c]=Jf(e[c]||0,n[c]||0,i);if(n.aroundPosition&&this.opts.makeViewport){const c=this.opts.makeViewport({...n,...r});Object.assign(r,c.panByPosition(n.aroundPosition,Jf(e.around,n.around,i)))}return r}}const Ql={transitionDuration:0},WD=300,s0=t=>1-(1-t)*(1-t),gf={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Yc={};class ZD{constructor(e){ae(this,"props",void 0),ae(this,"state",{}),ae(this,"transitionManager",void 0),ae(this,"eventManager",void 0),ae(this,"onViewStateChange",void 0),ae(this,"onStateChange",void 0),ae(this,"makeViewport",void 0),ae(this,"_controllerState",void 0),ae(this,"_events",{}),ae(this,"_interactionState",{isDragging:!1}),ae(this,"_customEvents",[]),ae(this,"_eventStartBlocked",null),ae(this,"_panMove",!1),ae(this,"invertPan",!1),ae(this,"dragMode","rotate"),ae(this,"inertia",0),ae(this,"scrollZoom",!0),ae(this,"dragPan",!0),ae(this,"dragRotate",!0),ae(this,"doubleClickZoom",!0),ae(this,"touchZoom",!0),ae(this,"touchRotate",!1),ae(this,"keyboard",!0),this.transitionManager=new jD({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:i}=this.props,{offsetCenter:r}=e;return[r.x-n,r.y-i]}isPointInBounds(e,n){const{width:i,height:r}=this.props;if(n&&n.handled)return!1;const c=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return c&&n&&n.stopPropagation(),c}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?WD:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:c=!0,doubleClickZoom:p=!0,touchZoom:a=!0,touchRotate:T=!1,keyboard:k=!0}=e,z=!!this.onViewStateChange;this.toggleEvents(gf.WHEEL,z&&i),this.toggleEvents(gf.PAN,z),this.toggleEvents(gf.PINCH,z&&(a||T)),this.toggleEvents(gf.TRIPLE_PAN,z&&T),this.toggleEvents(gf.DOUBLE_TAP,z&&p),this.toggleEvents(gf.KEYBOARD,z&&k),this.scrollZoom=i,this.dragPan=r,this.dragRotate=c,this.doubleClickZoom=p,this.touchZoom=a,this.touchRotate=T,this.keyboard=k}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(i=>{this._events[i]!==n&&(this._events[i]=n,n?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,n=null,i={}){const r={...e.getViewportProps(),...n},c=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),c){const p=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:p})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:n});return this._panMove=i,this.updateViewport(r,Ql,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),i=this.controllerState.pan({pos:n});return this.updateViewport(i,Ql,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],c=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(c,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:s0},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),i=this.controllerState.rotate({pos:n});return this.updateViewport(i,Ql,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],c=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(c,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:s0},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:c}=e;let p=2/(1+Math.exp(-Math.abs(c*i)));c<0&&p!==0&&(p=1/p);const a=this.controllerState.zoom({pos:n,scale:p});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.rotateStart({pos:n});return this.updateViewport(i,Ql,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const i=this.controllerState.rotate({pos:n});return this.updateViewport(i,Ql,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*n/2],c=this.controllerState.rotate({pos:r});this.updateViewport(c,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:s0},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Yc._startPinchRotation=e.rotation,Yc._lastPinchEvent=e,this.updateViewport(i,Ql,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);n=n.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;n=n.rotate({deltaAngleX:Yc._startPinchRotation-i})}return this.updateViewport(n,Ql,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Yc._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:i}=Yc;if(this.touchZoom&&n&&i&&e.scale!==i.scale){const r=this.getCenter(e);let c=this.controllerState.rotateEnd();const p=Math.log2(e.scale),a=(p-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),T=Math.pow(2,p+a*n/2);c=c.zoom({pos:r,scale:T}).zoomEnd(),this.updateViewport(c,{...this._getTransitionProps({around:r}),transitionDuration:n,transitionEasing:s0},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Yc._startPinchRotation=null,Yc._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:n,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:c,rotateSpeedY:p}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let T;const k={};switch(e.srcEvent.code){case"Minus":T=n?a.zoomOut(i).zoomOut(i):a.zoomOut(i),k.isZooming=!0;break;case"Equal":T=n?a.zoomIn(i).zoomIn(i):a.zoomIn(i),k.isZooming=!0;break;case"ArrowLeft":n?(T=a.rotateLeft(c),k.isRotating=!0):(T=a.moveLeft(r),k.isPanning=!0);break;case"ArrowRight":n?(T=a.rotateRight(c),k.isRotating=!0):(T=a.moveRight(r),k.isPanning=!0);break;case"ArrowUp":n?(T=a.rotateUp(p),k.isRotating=!0):(T=a.moveUp(r),k.isPanning=!0);break;case"ArrowDown":n?(T=a.rotateDown(p),k.isRotating=!0):(T=a.moveDown(r),k.isPanning=!0);break;default:return!1}return this.updateViewport(T,this._getTransitionProps(),k),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Ql:e?{...n,transitionInterpolator:new o6({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class qD{constructor(e,n){ae(this,"_viewportProps",void 0),ae(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Kw=5,QD=1.2;class XD extends qD{constructor(e){const{width:n,height:i,latitude:r,longitude:c,zoom:p,bearing:a=0,pitch:T=0,altitude:k=1.5,position:z=[0,0,0],maxZoom:B=20,minZoom:D=0,maxPitch:K=60,minPitch:ee=0,startPanLngLat:le,startZoomLngLat:Ce,startRotatePos:se,startBearing:ne,startPitch:te,startZoom:xe,normalize:Le=!0}=e;vr(Number.isFinite(c)),vr(Number.isFinite(r)),vr(Number.isFinite(p)),super({width:n,height:i,latitude:r,longitude:c,zoom:p,bearing:a,pitch:T,altitude:k,maxZoom:B,minZoom:D,maxPitch:K,minPitch:ee,normalize:Le,position:z},{startPanLngLat:le,startZoomLngLat:Ce,startRotatePos:se,startBearing:ne,startPitch:te,startZoom:xe}),ae(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const c=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(c)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:c,startPitch:p}=this.getState();if(!r||c===void 0||p===void 0)return this;let a;return e?a=this._getNewRotation(e,r,p,c):a={bearing:c+n,pitch:p+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomLngLat:c}=this.getState();if(c||(r=this.getViewportProps().zoom,c=this._unproject(n)||this._unproject(e)),!c)return this;const{maxZoom:p,minZoom:a}=this.getViewportProps();let T=r+Math.log2(i);T=tc(T,a,p);const k=this.makeViewport({...this.getViewportProps(),zoom:T});return this._getUpdatedState({zoom:T,...k.panByPosition(c,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:c}=i;return Math.abs(r-n.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(c-n.longitude)>180&&(i.longitude=c<0?c+360:c-360),i}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=tc(r,i,n);const{maxPitch:c,minPitch:p,pitch:a}=e;e.pitch=tc(a,p,c);const{normalize:T=!0}=e;return T&&Object.assign(e,OR(e)),e}_zoomFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.zoom({pos:[n/2,i/2],scale:e})}_panFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.pan({startPos:[n/2,i/2],pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,i,r){const c=e[0]-n[0],p=e[1]-n[1],a=e[1],T=n[1],{width:k,height:z}=this.getViewportProps(),B=c/k;let D=0;p>0?Math.abs(z-T)>Kw&&(D=p/(T-z)*QD):p<0&&T>Kw&&(D=1-a/T),D=tc(D,-1,1);const{minPitch:K,maxPitch:ee}=this.getViewportProps(),le=r+180*B;let Ce=i;return D>0?Ce=i+D*(ee-i):D<0&&(Ce=i-D*(K-i)),{pitch:Ce,bearing:le}}}class YD extends ZD{constructor(...e){super(...e),ae(this,"ControllerState",XD),ae(this,"transition",{transitionDuration:300,transitionInterpolator:new o6({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),ae(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class s6 extends oh{get ViewportType(){return rh}get ControllerType(){return YD}}ae(s6,"displayName","MapView");const KD=new Fy;function JD(t,e){var n,i;const r=(n=t.order)!==null&&n!==void 0?n:1/0,c=(i=e.order)!==null&&i!==void 0?i:1/0;return r-c}class ez{constructor(){ae(this,"effects",void 0),ae(this,"_resolvedEffects",[]),ae(this,"_defaultEffects",[]),ae(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(i=>i.id===e.id)){const i=n.findIndex(r=>JD(r,e)>0);i<0?n.push(e):n.splice(i,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(ba(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const r of this.effects)n[r.id]=r;const i=[];for(const r of e){const c=n[r.id];c&&c!==r?c.setProps?(c.setProps(r.props),i.push(c)):(c.cleanup(),i.push(r)):i.push(r),delete n[r.id]}for(const r in n)n[r].cleanup();this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(r=>r instanceof Fy)||this._resolvedEffects.push(KD),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class tz extends Dy{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const nz="deckRenderer.renderLayers";class iz{constructor(e){ae(this,"gl",void 0),ae(this,"layerFilter",void 0),ae(this,"drawPickingColors",void 0),ae(this,"drawLayersPass",void 0),ae(this,"pickLayersPass",void 0),ae(this,"renderCount",void 0),ae(this,"_needsRedraw",void 0),ae(this,"renderBuffers",void 0),ae(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new tz(e),this.pickLayersPass=new t6(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||fr.getDefaultFramebuffer(this.gl)};i.effects&&this._preRender(i.effects,i);const r=this.lastPostProcessEffect?this.renderBuffers[0]:i.target,c=n.render({...i,target:r});i.effects&&this._postRender(i.effects,i),this.renderCount++,Wr(nz,this,c,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const i of e)n.preRenderStats[i.id]=i.preRender(this.gl,n),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new fr(this.gl),new fr(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:i}=this,r={...n,inputBuffer:i[0],swapBuffer:i[1],target:null};for(const c of e)if(c.postRender){if(c.id===this.lastPostProcessEffect){r.target=n.target,c.postRender(this.gl,r);break}const p=c.postRender(this.gl,r);r.inputBuffer=p,r.swapBuffer=p===i[0]?i[1]:i[0]}}}const rz={pickedColor:null,pickedObjectIndex:-1};function oz({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:c}){const{x:p,y:a,width:T,height:k}=c;let z=r*r,B=-1,D=0;for(let K=0;K<k;K++){const ee=K+a-i,le=ee*ee;if(le>z)D+=4*T;else for(let Ce=0;Ce<T;Ce++){if(t[D+3]-1>=0){const ne=Ce+p-n,te=ne*ne+le;te<=z&&(z=te,B=D)}D+=4}}if(B>=0){const K=t.slice(B,B+4),ee=e(K);if(ee){const le=Math.floor(B/4/T),Ce=B/4-le*T;return{...ee,pickedColor:K,pickedX:p+Ce,pickedY:a+le}}ii.error("Picked non-existent layer. Is picking buffer corrupt?")()}return rz}function sz({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const c=t.slice(i,i+4),p=c.join(",");if(!n.has(p)){const a=e(c);a?n.set(p,{...a,color:c}):ii.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function a6({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:c}){let p=e[0];e.length>1&&(p=lz((t==null?void 0:t.pickedViewports)||e,{x:i,y:r}));let a;if(p){const T=[i-p.x,r-p.y];c!==void 0&&(T[2]=c),a=p.unproject(T)}return{color:null,layer:null,viewport:p,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function az(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:c,pickedLayer:p,pickedObjectIndex:a}=e,T=p?[p]:[];if(i==="hover"){const B=n.index,D=n.layerId,K=p?p.props.id:null;if(K!==D||a!==B){if(K!==D){const ee=r.find(le=>le.props.id===D);ee&&T.unshift(ee)}n.layerId=K,n.index=a,n.info=null}}const k=a6(t),z=new Map;return z.set(null,k),T.forEach(B=>{let D={...k};B===p&&(D.color=c,D.index=a,D.picked=!0),D=l6({layer:B,info:D,mode:i});const K=D.layer;B===p&&i==="hover"&&(n.info=D),z.set(K.id,D),i==="hover"&&K.updateAutoHighlight(D)}),z}function l6({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function lz(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}class cz{constructor(e){ae(this,"gl",void 0),ae(this,"pickingFBO",void 0),ae(this,"depthFBO",void 0),ae(this,"pickLayersPass",void 0),ae(this,"layerFilter",void 0),ae(this,"lastPickedInfo",void 0),ae(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new t6(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:i,viewports:r},c=this.lastPickedInfo.info){const p=c&&c.layer&&c.layer.id,a=c&&c.viewport&&c.viewport.id,T=p?i.find(D=>D.id===p):null,k=a&&r.find(D=>D.id===a)||r[0],z=k&&k.unproject([e-k.x,n-k.y]);return{...c,...{x:e,y:n,viewport:k,coordinate:z,layer:T}}}_resizeBuffer(){var e,n;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new fr(i),fr.isSupported(i,{colorBufferFloat:!0}))){const r=new fr(i);r.attach({36064:new ws(i,{format:On(i)?34836:6408,type:5126})}),this.depthFBO=r}(e=this.pickingFBO)===null||e===void 0||e.resize({width:i.canvas.width,height:i.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:i,x:r,y:c,radius:p=0,depth:a=1,mode:T="query",unproject3D:k,onViewportActive:z,effects:B}){const D=this._getPickable(e),K=qf(this.gl);if(!D)return{result:[],emptyInfo:a6({viewports:i,x:r,y:c,pixelRatio:K})};this._resizeBuffer();const ee=Ig(this.gl,[r,c],!0),le=[ee.x+Math.floor(ee.width/2),ee.y+Math.floor(ee.height/2)],Ce=Math.round(p*K),{width:se,height:ne}=this.pickingFBO,te=this._getPickingRect({deviceX:le[0],deviceY:le[1],deviceRadius:Ce,deviceWidth:se,deviceHeight:ne}),xe={x:r-p,y:c-p,width:p*2+1,height:p*2+1};let Le;const Ge=[],nt=new Set;for(let it=0;it<a;it++){let dt;if(te){const Xe=this._drawAndSample({layers:D,views:n,viewports:i,onViewportActive:z,deviceRect:te,cullRect:xe,effects:B,pass:"picking:".concat(T)});dt=oz({...Xe,deviceX:le[0],deviceY:le[1],deviceRadius:Ce,deviceRect:te})}else dt={pickedColor:null,pickedObjectIndex:-1};let ct;if(dt.pickedLayer&&k&&this.depthFBO){const{pickedColors:Xe}=this._drawAndSample({layers:[dt.pickedLayer],views:n,viewports:i,onViewportActive:z,deviceRect:{x:dt.pickedX,y:dt.pickedY,width:1,height:1},cullRect:xe,effects:B,pass:"picking:".concat(T,":z")},!0);Xe[3]&&(ct=Xe[0])}dt.pickedLayer&&it+1<a&&(nt.add(dt.pickedLayer),dt.pickedLayer.disablePickingIndex(dt.pickedObjectIndex)),Le=az({pickInfo:dt,lastPickedInfo:this.lastPickedInfo,mode:T,layers:D,viewports:i,x:r,y:c,z:ct,pixelRatio:K});for(const Xe of Le.values())Xe.layer&&Ge.push(Xe);if(!dt.pickedColor)break}for(const it of nt)it.restorePickingColors();return{result:Ge,emptyInfo:Le.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:i,x:r,y:c,width:p=1,height:a=1,mode:T="query",maxObjects:k=null,onViewportActive:z,effects:B}){const D=this._getPickable(e);if(!D)return[];this._resizeBuffer();const K=qf(this.gl),ee=Ig(this.gl,[r,c],!0),le=ee.x,Ce=ee.y+ee.height,se=Ig(this.gl,[r+p,c+a],!0),ne=se.x+se.width,te=se.y,xe={x:le,y:te,width:ne-le,height:Ce-te},Le=this._drawAndSample({layers:D,views:n,viewports:i,onViewportActive:z,deviceRect:xe,cullRect:{x:r,y:c,width:p,height:a},effects:B,pass:"picking:".concat(T)}),Ge=sz(Le),nt=new Map,it=Number.isFinite(k);for(let dt=0;dt<Ge.length&&!(it&&k&&nt.size>=k);dt++){const ct=Ge[dt];let Xe={color:ct.pickedColor,layer:null,index:ct.pickedObjectIndex,picked:!0,x:r,y:c,pixelRatio:K};Xe=l6({layer:ct.pickedLayer,info:Xe,mode:T}),nt.has(Xe.object)||nt.set(Xe.object,Xe)}return Array.from(nt.values())}_drawAndSample({layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:c,cullRect:p,effects:a,pass:T},k=!1){const z=k?this.depthFBO:this.pickingFBO,B={layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:z,deviceRect:c,cullRect:p,effects:a,pass:T,pickZ:k,preRenderStats:{}};for(const ne of a)ne.useInPicking&&(B.preRenderStats[ne.id]=ne.preRender(this.gl,B));const{decodePickingColor:D}=this.pickLayersPass.render(B),{x:K,y:ee,width:le,height:Ce}=c,se=new(k?Float32Array:Uint8Array)(le*Ce*4);return um(z,{sourceX:K,sourceY:ee,sourceWidth:le,sourceHeight:Ce,target:se}),{pickedColors:se,decodePickingColor:D}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:c}){const p=Math.max(0,e-i),a=Math.max(0,n-i),T=Math.min(r,e+i+1)-p,k=Math.min(c,n+i+1)-a;return T<=0||k<=0?null:{x:p,y:a,width:T,height:k}}}const uz={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class fz{constructor(e){ae(this,"el",null),ae(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,uz),n.appendChild(this.el))}setTooltip(e,n,i){const r=this.el;if(r){if(typeof e=="string")r.innerText=e;else if(e)e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className);else{this.isVisible=!1,r.style.display="none";return}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(n,"px, ").concat(i,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(r.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var hz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var c6={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,i,r){var c=["","webkit","Moz","MS","ms","o"],p=n.createElement("div"),a="function",T=Math.round,k=Math.abs,z=Date.now;function B(ue,pe,Ie){return setTimeout(te(ue,Ie),pe)}function D(ue,pe,Ie){return Array.isArray(ue)?(K(ue,Ie[pe],Ie),!0):!1}function K(ue,pe,Ie){var qe;if(ue)if(ue.forEach)ue.forEach(pe,Ie);else if(ue.length!==r)for(qe=0;qe<ue.length;)pe.call(Ie,ue[qe],qe,ue),qe++;else for(qe in ue)ue.hasOwnProperty(qe)&&pe.call(Ie,ue[qe],qe,ue)}function ee(ue,pe,Ie){var qe="DEPRECATED METHOD: "+pe+`
`+Ie+` AT 
`;return function(){var ht=new Error("get-stack-trace"),zt=ht&&ht.stack?ht.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",An=e.console&&(e.console.warn||e.console.log);return An&&An.call(e.console,qe,zt),ue.apply(this,arguments)}}var le;typeof Object.assign!="function"?le=function(pe){if(pe===r||pe===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ie=Object(pe),qe=1;qe<arguments.length;qe++){var ht=arguments[qe];if(ht!==r&&ht!==null)for(var zt in ht)ht.hasOwnProperty(zt)&&(Ie[zt]=ht[zt])}return Ie}:le=Object.assign;var Ce=ee(function(pe,Ie,qe){for(var ht=Object.keys(Ie),zt=0;zt<ht.length;)(!qe||qe&&pe[ht[zt]]===r)&&(pe[ht[zt]]=Ie[ht[zt]]),zt++;return pe},"extend","Use `assign`."),se=ee(function(pe,Ie){return Ce(pe,Ie,!0)},"merge","Use `assign`.");function ne(ue,pe,Ie){var qe=pe.prototype,ht;ht=ue.prototype=Object.create(qe),ht.constructor=ue,ht._super=qe,Ie&&le(ht,Ie)}function te(ue,pe){return function(){return ue.apply(pe,arguments)}}function xe(ue,pe){return typeof ue==a?ue.apply(pe&&pe[0]||r,pe):ue}function Le(ue,pe){return ue===r?pe:ue}function Ge(ue,pe,Ie){K(ct(pe),function(qe){ue.addEventListener(qe,Ie,!1)})}function nt(ue,pe,Ie){K(ct(pe),function(qe){ue.removeEventListener(qe,Ie,!1)})}function it(ue,pe){for(;ue;){if(ue==pe)return!0;ue=ue.parentNode}return!1}function dt(ue,pe){return ue.indexOf(pe)>-1}function ct(ue){return ue.trim().split(/\s+/g)}function Xe(ue,pe,Ie){if(ue.indexOf&&!Ie)return ue.indexOf(pe);for(var qe=0;qe<ue.length;){if(Ie&&ue[qe][Ie]==pe||!Ie&&ue[qe]===pe)return qe;qe++}return-1}function Bt(ue){return Array.prototype.slice.call(ue,0)}function Rt(ue,pe,Ie){for(var qe=[],ht=[],zt=0;zt<ue.length;){var An=pe?ue[zt][pe]:ue[zt];Xe(ht,An)<0&&qe.push(ue[zt]),ht[zt]=An,zt++}return Ie&&(pe?qe=qe.sort(function(pn,gi){return pn[pe]>gi[pe]}):qe=qe.sort()),qe}function jt(ue,pe){for(var Ie,qe,ht=pe[0].toUpperCase()+pe.slice(1),zt=0;zt<c.length;){if(Ie=c[zt],qe=Ie?Ie+ht:pe,qe in ue)return qe;zt++}return r}var _n=1;function Mt(){return _n++}function Sn(ue){var pe=ue.ownerDocument||ue;return pe.defaultView||pe.parentWindow||e}var pt=/mobile|tablet|ip(ad|hone|od)|android/i,It="ontouchstart"in e,Jt=jt(e,"PointerEvent")!==r,kn=It&&pt.test(navigator.userAgent),Mn="touch",ri="pen",oi="mouse",Ri="kinect",Ai=25,Nn=1,Di=2,yn=4,qn=8,Xi=1,pi=2,Si=4,Qr=8,hr=16,Gi=pi|Si,xi=Qr|hr,Dr=Gi|xi,bn=["x","y"],ir=["clientX","clientY"];function Vn(ue,pe){var Ie=this;this.manager=ue,this.callback=pe,this.element=ue.element,this.target=ue.options.inputTarget,this.domHandler=function(qe){xe(ue.options.enable,[ue])&&Ie.handler(qe)},this.init()}Vn.prototype={handler:function(){},init:function(){this.evEl&&Ge(this.element,this.evEl,this.domHandler),this.evTarget&&Ge(this.target,this.evTarget,this.domHandler),this.evWin&&Ge(Sn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&nt(this.element,this.evEl,this.domHandler),this.evTarget&&nt(this.target,this.evTarget,this.domHandler),this.evWin&&nt(Sn(this.element),this.evWin,this.domHandler)}};function zr(ue){var pe,Ie=ue.options.inputClass;return Ie?pe=Ie:Jt?pe=ft:kn?pe=Er:It?pe=q:pe=ln,new pe(ue,ns)}function ns(ue,pe,Ie){var qe=Ie.pointers.length,ht=Ie.changedPointers.length,zt=pe&Nn&&qe-ht===0,An=pe&(yn|qn)&&qe-ht===0;Ie.isFirst=!!zt,Ie.isFinal=!!An,zt&&(ue.session={}),Ie.eventType=pe,Yi(ue,Ie),ue.emit("hammer.input",Ie),ue.recognize(Ie),ue.session.prevInput=Ie}function Yi(ue,pe){var Ie=ue.session,qe=pe.pointers,ht=qe.length;Ie.firstInput||(Ie.firstInput=Br(pe)),ht>1&&!Ie.firstMultiple?Ie.firstMultiple=Br(pe):ht===1&&(Ie.firstMultiple=!1);var zt=Ie.firstInput,An=Ie.firstMultiple,ei=An?An.center:zt.center,pn=pe.center=et(qe);pe.timeStamp=z(),pe.deltaTime=pe.timeStamp-zt.timeStamp,pe.angle=vn(ei,pn),pe.distance=Ki(ei,pn),wr(Ie,pe),pe.offsetDirection=po(pe.deltaX,pe.deltaY);var gi=gt(pe.deltaTime,pe.deltaX,pe.deltaY);pe.overallVelocityX=gi.x,pe.overallVelocityY=gi.y,pe.overallVelocity=k(gi.x)>k(gi.y)?gi.x:gi.y,pe.scale=An?rr(An.pointers,qe):1,pe.rotation=An?dr(An.pointers,qe):0,pe.maxPointers=Ie.prevInput?pe.pointers.length>Ie.prevInput.maxPointers?pe.pointers.length:Ie.prevInput.maxPointers:pe.pointers.length,is(Ie,pe);var In=ue.element;it(pe.srcEvent.target,In)&&(In=pe.srcEvent.target),pe.target=In}function wr(ue,pe){var Ie=pe.center,qe=ue.offsetDelta||{},ht=ue.prevDelta||{},zt=ue.prevInput||{};(pe.eventType===Nn||zt.eventType===yn)&&(ht=ue.prevDelta={x:zt.deltaX||0,y:zt.deltaY||0},qe=ue.offsetDelta={x:Ie.x,y:Ie.y}),pe.deltaX=ht.x+(Ie.x-qe.x),pe.deltaY=ht.y+(Ie.y-qe.y)}function is(ue,pe){var Ie=ue.lastInterval||pe,qe=pe.timeStamp-Ie.timeStamp,ht,zt,An,ei;if(pe.eventType!=qn&&(qe>Ai||Ie.velocity===r)){var pn=pe.deltaX-Ie.deltaX,gi=pe.deltaY-Ie.deltaY,In=gt(qe,pn,gi);zt=In.x,An=In.y,ht=k(In.x)>k(In.y)?In.x:In.y,ei=po(pn,gi),ue.lastInterval=pe}else ht=Ie.velocity,zt=Ie.velocityX,An=Ie.velocityY,ei=Ie.direction;pe.velocity=ht,pe.velocityX=zt,pe.velocityY=An,pe.direction=ei}function Br(ue){for(var pe=[],Ie=0;Ie<ue.pointers.length;)pe[Ie]={clientX:T(ue.pointers[Ie].clientX),clientY:T(ue.pointers[Ie].clientY)},Ie++;return{timeStamp:z(),pointers:pe,center:et(pe),deltaX:ue.deltaX,deltaY:ue.deltaY}}function et(ue){var pe=ue.length;if(pe===1)return{x:T(ue[0].clientX),y:T(ue[0].clientY)};for(var Ie=0,qe=0,ht=0;ht<pe;)Ie+=ue[ht].clientX,qe+=ue[ht].clientY,ht++;return{x:T(Ie/pe),y:T(qe/pe)}}function gt(ue,pe,Ie){return{x:pe/ue||0,y:Ie/ue||0}}function po(ue,pe){return ue===pe?Xi:k(ue)>=k(pe)?ue<0?pi:Si:pe<0?Qr:hr}function Ki(ue,pe,Ie){Ie||(Ie=bn);var qe=pe[Ie[0]]-ue[Ie[0]],ht=pe[Ie[1]]-ue[Ie[1]];return Math.sqrt(qe*qe+ht*ht)}function vn(ue,pe,Ie){Ie||(Ie=bn);var qe=pe[Ie[0]]-ue[Ie[0]],ht=pe[Ie[1]]-ue[Ie[1]];return Math.atan2(ht,qe)*180/Math.PI}function dr(ue,pe){return vn(pe[1],pe[0],ir)+vn(ue[1],ue[0],ir)}function rr(ue,pe){return Ki(pe[0],pe[1],ir)/Ki(ue[0],ue[1],ir)}var or={mousedown:Nn,mousemove:Di,mouseup:yn},Xr="mousedown",_t="mousemove mouseup";function ln(){this.evEl=Xr,this.evWin=_t,this.pressed=!1,Vn.apply(this,arguments)}ne(ln,Vn,{handler:function(pe){var Ie=or[pe.type];Ie&Nn&&pe.button===0&&(this.pressed=!0),Ie&Di&&pe.which!==1&&(Ie=yn),this.pressed&&(Ie&yn&&(this.pressed=!1),this.callback(this.manager,Ie,{pointers:[pe],changedPointers:[pe],pointerType:oi,srcEvent:pe}))}});var an={pointerdown:Nn,pointermove:Di,pointerup:yn,pointercancel:qn,pointerout:qn},mi={2:Mn,3:ri,4:oi,5:Ri},Yr="pointerdown",rn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Yr="MSPointerDown",rn="MSPointerMove MSPointerUp MSPointerCancel");function ft(){this.evEl=Yr,this.evWin=rn,Vn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ne(ft,Vn,{handler:function(pe){var Ie=this.store,qe=!1,ht=pe.type.toLowerCase().replace("ms",""),zt=an[ht],An=mi[pe.pointerType]||pe.pointerType,ei=An==Mn,pn=Xe(Ie,pe.pointerId,"pointerId");zt&Nn&&(pe.button===0||ei)?pn<0&&(Ie.push(pe),pn=Ie.length-1):zt&(yn|qn)&&(qe=!0),!(pn<0)&&(Ie[pn]=pe,this.callback(this.manager,zt,{pointers:Ie,changedPointers:[pe],pointerType:An,srcEvent:pe}),qe&&Ie.splice(pn,1))}});var wi={touchstart:Nn,touchmove:Di,touchend:yn,touchcancel:qn},Co="touchstart",ai="touchstart touchmove touchend touchcancel";function zi(){this.evTarget=Co,this.evWin=ai,this.started=!1,Vn.apply(this,arguments)}ne(zi,Vn,{handler:function(pe){var Ie=wi[pe.type];if(Ie===Nn&&(this.started=!0),!!this.started){var qe=Pn.call(this,pe,Ie);Ie&(yn|qn)&&qe[0].length-qe[1].length===0&&(this.started=!1),this.callback(this.manager,Ie,{pointers:qe[0],changedPointers:qe[1],pointerType:Mn,srcEvent:pe})}}});function Pn(ue,pe){var Ie=Bt(ue.touches),qe=Bt(ue.changedTouches);return pe&(yn|qn)&&(Ie=Rt(Ie.concat(qe),"identifier",!0)),[Ie,qe]}var ko={touchstart:Nn,touchmove:Di,touchend:yn,touchcancel:qn},br="touchstart touchmove touchend touchcancel";function Er(){this.evTarget=br,this.targetIds={},Vn.apply(this,arguments)}ne(Er,Vn,{handler:function(pe){var Ie=ko[pe.type],qe=Or.call(this,pe,Ie);qe&&this.callback(this.manager,Ie,{pointers:qe[0],changedPointers:qe[1],pointerType:Mn,srcEvent:pe})}});function Or(ue,pe){var Ie=Bt(ue.touches),qe=this.targetIds;if(pe&(Nn|Di)&&Ie.length===1)return qe[Ie[0].identifier]=!0,[Ie,Ie];var ht,zt,An=Bt(ue.changedTouches),ei=[],pn=this.target;if(zt=Ie.filter(function(gi){return it(gi.target,pn)}),pe===Nn)for(ht=0;ht<zt.length;)qe[zt[ht].identifier]=!0,ht++;for(ht=0;ht<An.length;)qe[An[ht].identifier]&&ei.push(An[ht]),pe&(yn|qn)&&delete qe[An[ht].identifier],ht++;if(ei.length)return[Rt(zt.concat(ei),"identifier",!0),ei]}var mo=2500,Ji=25;function q(){Vn.apply(this,arguments);var ue=te(this.handler,this);this.touch=new Er(this.manager,ue),this.mouse=new ln(this.manager,ue),this.primaryTouch=null,this.lastTouches=[]}ne(q,Vn,{handler:function(pe,Ie,qe){var ht=qe.pointerType==Mn,zt=qe.pointerType==oi;if(!(zt&&qe.sourceCapabilities&&qe.sourceCapabilities.firesTouchEvents)){if(ht)U.call(this,Ie,qe);else if(zt&&ie.call(this,qe))return;this.callback(pe,Ie,qe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function U(ue,pe){ue&Nn?(this.primaryTouch=pe.changedPointers[0].identifier,W.call(this,pe)):ue&(yn|qn)&&W.call(this,pe)}function W(ue){var pe=ue.changedPointers[0];if(pe.identifier===this.primaryTouch){var Ie={x:pe.clientX,y:pe.clientY};this.lastTouches.push(Ie);var qe=this.lastTouches,ht=function(){var zt=qe.indexOf(Ie);zt>-1&&qe.splice(zt,1)};setTimeout(ht,mo)}}function ie(ue){for(var pe=ue.srcEvent.clientX,Ie=ue.srcEvent.clientY,qe=0;qe<this.lastTouches.length;qe++){var ht=this.lastTouches[qe],zt=Math.abs(pe-ht.x),An=Math.abs(Ie-ht.y);if(zt<=Ji&&An<=Ji)return!0}return!1}var f=jt(p.style,"touchAction"),H=f!==r,ke="compute",Te="auto",we="manipulation",Me="none",Fe="pan-x",rt="pan-y",Ne=xt();function lt(ue,pe){this.manager=ue,this.set(pe)}lt.prototype={set:function(ue){ue==ke&&(ue=this.compute()),H&&this.manager.element.style&&Ne[ue]&&(this.manager.element.style[f]=ue),this.actions=ue.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ue=[];return K(this.manager.recognizers,function(pe){xe(pe.options.enable,[pe])&&(ue=ue.concat(pe.getTouchAction()))}),Tt(ue.join(" "))},preventDefaults:function(ue){var pe=ue.srcEvent,Ie=ue.offsetDirection;if(this.manager.session.prevented){pe.preventDefault();return}var qe=this.actions,ht=dt(qe,Me)&&!Ne[Me],zt=dt(qe,rt)&&!Ne[rt],An=dt(qe,Fe)&&!Ne[Fe];if(ht){var ei=ue.pointers.length===1,pn=ue.distance<2,gi=ue.deltaTime<250;if(ei&&pn&&gi)return}if(!(An&&zt)&&(ht||zt&&Ie&Gi||An&&Ie&xi))return this.preventSrc(pe)},preventSrc:function(ue){this.manager.session.prevented=!0,ue.preventDefault()}};function Tt(ue){if(dt(ue,Me))return Me;var pe=dt(ue,Fe),Ie=dt(ue,rt);return pe&&Ie?Me:pe||Ie?pe?Fe:rt:dt(ue,we)?we:Te}function xt(){if(!H)return!1;var ue={},pe=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ie){ue[Ie]=pe?e.CSS.supports("touch-action",Ie):!0}),ue}var $t=1,Ft=2,en=4,Gt=8,Wt=Gt,dn=16,wn=32;function Ln(ue){this.options=le({},this.defaults,ue||{}),this.id=Mt(),this.manager=null,this.options.enable=Le(this.options.enable,!0),this.state=$t,this.simultaneous={},this.requireFail=[]}Ln.prototype={defaults:{},set:function(ue){return le(this.options,ue),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ue){if(D(ue,"recognizeWith",this))return this;var pe=this.simultaneous;return ue=Qt(ue,this),pe[ue.id]||(pe[ue.id]=ue,ue.recognizeWith(this)),this},dropRecognizeWith:function(ue){return D(ue,"dropRecognizeWith",this)?this:(ue=Qt(ue,this),delete this.simultaneous[ue.id],this)},requireFailure:function(ue){if(D(ue,"requireFailure",this))return this;var pe=this.requireFail;return ue=Qt(ue,this),Xe(pe,ue)===-1&&(pe.push(ue),ue.requireFailure(this)),this},dropRequireFailure:function(ue){if(D(ue,"dropRequireFailure",this))return this;ue=Qt(ue,this);var pe=Xe(this.requireFail,ue);return pe>-1&&this.requireFail.splice(pe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ue){return!!this.simultaneous[ue.id]},emit:function(ue){var pe=this,Ie=this.state;function qe(ht){pe.manager.emit(ht,ue)}Ie<Gt&&qe(pe.options.event+Ot(Ie)),qe(pe.options.event),ue.additionalEvent&&qe(ue.additionalEvent),Ie>=Gt&&qe(pe.options.event+Ot(Ie))},tryEmit:function(ue){if(this.canEmit())return this.emit(ue);this.state=wn},canEmit:function(){for(var ue=0;ue<this.requireFail.length;){if(!(this.requireFail[ue].state&(wn|$t)))return!1;ue++}return!0},recognize:function(ue){var pe=le({},ue);if(!xe(this.options.enable,[this,pe])){this.reset(),this.state=wn;return}this.state&(Wt|dn|wn)&&(this.state=$t),this.state=this.process(pe),this.state&(Ft|en|Gt|dn)&&this.tryEmit(pe)},process:function(ue){},getTouchAction:function(){},reset:function(){}};function Ot(ue){return ue&dn?"cancel":ue&Gt?"end":ue&en?"move":ue&Ft?"start":""}function me(ue){return ue==hr?"down":ue==Qr?"up":ue==pi?"left":ue==Si?"right":""}function Qt(ue,pe){var Ie=pe.manager;return Ie?Ie.get(ue):ue}function Bi(){Ln.apply(this,arguments)}ne(Bi,Ln,{defaults:{pointers:1},attrTest:function(ue){var pe=this.options.pointers;return pe===0||ue.pointers.length===pe},process:function(ue){var pe=this.state,Ie=ue.eventType,qe=pe&(Ft|en),ht=this.attrTest(ue);return qe&&(Ie&qn||!ht)?pe|dn:qe||ht?Ie&yn?pe|Gt:pe&Ft?pe|en:Ft:wn}});function Rn(){Bi.apply(this,arguments),this.pX=null,this.pY=null}ne(Rn,Bi,{defaults:{event:"pan",threshold:10,pointers:1,direction:Dr},getTouchAction:function(){var ue=this.options.direction,pe=[];return ue&Gi&&pe.push(rt),ue&xi&&pe.push(Fe),pe},directionTest:function(ue){var pe=this.options,Ie=!0,qe=ue.distance,ht=ue.direction,zt=ue.deltaX,An=ue.deltaY;return ht&pe.direction||(pe.direction&Gi?(ht=zt===0?Xi:zt<0?pi:Si,Ie=zt!=this.pX,qe=Math.abs(ue.deltaX)):(ht=An===0?Xi:An<0?Qr:hr,Ie=An!=this.pY,qe=Math.abs(ue.deltaY))),ue.direction=ht,Ie&&qe>pe.threshold&&ht&pe.direction},attrTest:function(ue){return Bi.prototype.attrTest.call(this,ue)&&(this.state&Ft||!(this.state&Ft)&&this.directionTest(ue))},emit:function(ue){this.pX=ue.deltaX,this.pY=ue.deltaY;var pe=me(ue.direction);pe&&(ue.additionalEvent=this.options.event+pe),this._super.emit.call(this,ue)}});function Ss(){Bi.apply(this,arguments)}ne(Ss,Bi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Me]},attrTest:function(ue){return this._super.attrTest.call(this,ue)&&(Math.abs(ue.scale-1)>this.options.threshold||this.state&Ft)},emit:function(ue){if(ue.scale!==1){var pe=ue.scale<1?"in":"out";ue.additionalEvent=this.options.event+pe}this._super.emit.call(this,ue)}});function Ms(){Ln.apply(this,arguments),this._timer=null,this._input=null}ne(Ms,Ln,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Te]},process:function(ue){var pe=this.options,Ie=ue.pointers.length===pe.pointers,qe=ue.distance<pe.threshold,ht=ue.deltaTime>pe.time;if(this._input=ue,!qe||!Ie||ue.eventType&(yn|qn)&&!ht)this.reset();else if(ue.eventType&Nn)this.reset(),this._timer=B(function(){this.state=Wt,this.tryEmit()},pe.time,this);else if(ue.eventType&yn)return Wt;return wn},reset:function(){clearTimeout(this._timer)},emit:function(ue){this.state===Wt&&(ue&&ue.eventType&yn?this.manager.emit(this.options.event+"up",ue):(this._input.timeStamp=z(),this.manager.emit(this.options.event,this._input)))}});function Xs(){Bi.apply(this,arguments)}ne(Xs,Bi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Me]},attrTest:function(ue){return this._super.attrTest.call(this,ue)&&(Math.abs(ue.rotation)>this.options.threshold||this.state&Ft)}});function Ae(){Bi.apply(this,arguments)}ne(Ae,Bi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Gi|xi,pointers:1},getTouchAction:function(){return Rn.prototype.getTouchAction.call(this)},attrTest:function(ue){var pe=this.options.direction,Ie;return pe&(Gi|xi)?Ie=ue.overallVelocity:pe&Gi?Ie=ue.overallVelocityX:pe&xi&&(Ie=ue.overallVelocityY),this._super.attrTest.call(this,ue)&&pe&ue.offsetDirection&&ue.distance>this.options.threshold&&ue.maxPointers==this.options.pointers&&k(Ie)>this.options.velocity&&ue.eventType&yn},emit:function(ue){var pe=me(ue.offsetDirection);pe&&this.manager.emit(this.options.event+pe,ue),this.manager.emit(this.options.event,ue)}});function rs(){Ln.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}ne(rs,Ln,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[we]},process:function(ue){var pe=this.options,Ie=ue.pointers.length===pe.pointers,qe=ue.distance<pe.threshold,ht=ue.deltaTime<pe.time;if(this.reset(),ue.eventType&Nn&&this.count===0)return this.failTimeout();if(qe&&ht&&Ie){if(ue.eventType!=yn)return this.failTimeout();var zt=this.pTime?ue.timeStamp-this.pTime<pe.interval:!0,An=!this.pCenter||Ki(this.pCenter,ue.center)<pe.posThreshold;this.pTime=ue.timeStamp,this.pCenter=ue.center,!An||!zt?this.count=1:this.count+=1,this._input=ue;var ei=this.count%pe.taps;if(ei===0)return this.hasRequireFailures()?(this._timer=B(function(){this.state=Wt,this.tryEmit()},pe.interval,this),Ft):Wt}return wn},failTimeout:function(){return this._timer=B(function(){this.state=wn},this.options.interval,this),wn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Wt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Kr(ue,pe){return pe=pe||{},pe.recognizers=Le(pe.recognizers,Kr.defaults.preset),new Js(ue,pe)}Kr.VERSION="2.0.7",Kr.defaults={domEvents:!1,touchAction:ke,enable:!0,inputTarget:null,inputClass:null,preset:[[Xs,{enable:!1}],[Ss,{enable:!1},["rotate"]],[Ae,{direction:Gi}],[Rn,{direction:Gi},["swipe"]],[rs],[rs,{event:"doubletap",taps:2},["tap"]],[Ms]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ys=1,Ks=2;function Js(ue,pe){this.options=le({},Kr.defaults,pe||{}),this.options.inputTarget=this.options.inputTarget||ue,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ue,this.input=zr(this),this.touchAction=new lt(this,this.options.touchAction),ka(this,!0),K(this.options.recognizers,function(Ie){var qe=this.add(new Ie[0](Ie[1]));Ie[2]&&qe.recognizeWith(Ie[2]),Ie[3]&&qe.requireFailure(Ie[3])},this)}Js.prototype={set:function(ue){return le(this.options,ue),ue.touchAction&&this.touchAction.update(),ue.inputTarget&&(this.input.destroy(),this.input.target=ue.inputTarget,this.input.init()),this},stop:function(ue){this.session.stopped=ue?Ks:Ys},recognize:function(ue){var pe=this.session;if(!pe.stopped){this.touchAction.preventDefaults(ue);var Ie,qe=this.recognizers,ht=pe.curRecognizer;(!ht||ht&&ht.state&Wt)&&(ht=pe.curRecognizer=null);for(var zt=0;zt<qe.length;)Ie=qe[zt],pe.stopped!==Ks&&(!ht||Ie==ht||Ie.canRecognizeWith(ht))?Ie.recognize(ue):Ie.reset(),!ht&&Ie.state&(Ft|en|Gt)&&(ht=pe.curRecognizer=Ie),zt++}},get:function(ue){if(ue instanceof Ln)return ue;for(var pe=this.recognizers,Ie=0;Ie<pe.length;Ie++)if(pe[Ie].options.event==ue)return pe[Ie];return null},add:function(ue){if(D(ue,"add",this))return this;var pe=this.get(ue.options.event);return pe&&this.remove(pe),this.recognizers.push(ue),ue.manager=this,this.touchAction.update(),ue},remove:function(ue){if(D(ue,"remove",this))return this;if(ue=this.get(ue),ue){var pe=this.recognizers,Ie=Xe(pe,ue);Ie!==-1&&(pe.splice(Ie,1),this.touchAction.update())}return this},on:function(ue,pe){if(ue!==r&&pe!==r){var Ie=this.handlers;return K(ct(ue),function(qe){Ie[qe]=Ie[qe]||[],Ie[qe].push(pe)}),this}},off:function(ue,pe){if(ue!==r){var Ie=this.handlers;return K(ct(ue),function(qe){pe?Ie[qe]&&Ie[qe].splice(Xe(Ie[qe],pe),1):delete Ie[qe]}),this}},emit:function(ue,pe){this.options.domEvents&&Pa(ue,pe);var Ie=this.handlers[ue]&&this.handlers[ue].slice();if(!(!Ie||!Ie.length)){pe.type=ue,pe.preventDefault=function(){pe.srcEvent.preventDefault()};for(var qe=0;qe<Ie.length;)Ie[qe](pe),qe++}},destroy:function(){this.element&&ka(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ka(ue,pe){var Ie=ue.element;if(Ie.style){var qe;K(ue.options.cssProps,function(ht,zt){qe=jt(Ie.style,zt),pe?(ue.oldCssProps[qe]=Ie.style[qe],Ie.style[qe]=ht):Ie.style[qe]=ue.oldCssProps[qe]||""}),pe||(ue.oldCssProps={})}}function Pa(ue,pe){var Ie=n.createEvent("Event");Ie.initEvent(ue,!0,!0),Ie.gesture=pe,pe.target.dispatchEvent(Ie)}le(Kr,{INPUT_START:Nn,INPUT_MOVE:Di,INPUT_END:yn,INPUT_CANCEL:qn,STATE_POSSIBLE:$t,STATE_BEGAN:Ft,STATE_CHANGED:en,STATE_ENDED:Gt,STATE_RECOGNIZED:Wt,STATE_CANCELLED:dn,STATE_FAILED:wn,DIRECTION_NONE:Xi,DIRECTION_LEFT:pi,DIRECTION_RIGHT:Si,DIRECTION_UP:Qr,DIRECTION_DOWN:hr,DIRECTION_HORIZONTAL:Gi,DIRECTION_VERTICAL:xi,DIRECTION_ALL:Dr,Manager:Js,Input:Vn,TouchAction:lt,TouchInput:Er,MouseInput:ln,PointerEventInput:ft,TouchMouseInput:q,SingleTouchInput:zi,Recognizer:Ln,AttrRecognizer:Bi,Tap:rs,Pan:Rn,Swipe:Ae,Pinch:Ss,Rotate:Xs,Press:Ms,on:Ge,off:nt,each:K,merge:se,extend:Ce,assign:le,inherit:ne,bindFn:te,prefixed:jt});var go=typeof e<"u"?e:typeof self<"u"?self:{};go.Hammer=Kr,typeof r=="function"&&r.amd?r(function(){return Kr}):t.exports?t.exports=Kr:e[i]=Kr})(window,document,"Hammer")})(c6);var gA=c6.exports;const dz=fm(gA),pa=dS({__proto__:null,default:dz},[gA]),u6=1,f6=2,K1=4,Az={mousedown:u6,mousemove:f6,mouseup:K1};function pz(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function mz(t){const e=t.prototype.handler;t.prototype.handler=function(i){const r=this.store;i.button>0&&i.type==="pointerdown"&&(pz(r,c=>c.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}}function gz(t){t.prototype.handler=function(n){let i=Az[n.type];i&u6&&n.button>=0&&(this.pressed=!0),i&f6&&n.which===0&&(i=K1),this.pressed&&(i&K1&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}mz(gA.PointerEventInput);gz(gA.MouseInput);const _z=gA.Manager;class hm{constructor(e,n,i){this.element=e,this.callback=n,this.options={enable:!0,...i}}}const yz=pa?[[pa.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[pa.Rotate,{enable:!1}],[pa.Pinch,{enable:!1}],[pa.Swipe,{enable:!1}],[pa.Pan,{threshold:0,enable:!1}],[pa.Press,{enable:!1}],[pa.Tap,{event:"doubletap",taps:2,enable:!1}],[pa.Tap,{event:"anytap",enable:!1}],[pa.Tap,{enable:!1}]]:null,Jw={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},vz={doubletap:["tap"]},xz={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Uy={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},wz={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},eb={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},bz=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",xf=typeof window<"u"?window:global;let J1=!1;try{const t={get passive(){return J1=!0,!0}};xf.addEventListener("test",null,t),xf.removeEventListener("test",null)}catch{J1=!1}const Ez=bz.indexOf("firefox")!==-1,{WHEEL_EVENTS:Tz}=Uy,tb="wheel",nb=4.000244140625,Sz=40,Mz=.25;class Iz extends hm{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{if(!this.options.enable)return;let c=r.deltaY;xf.WheelEvent&&(Ez&&r.deltaMode===xf.WheelEvent.DOM_DELTA_PIXEL&&(c/=xf.devicePixelRatio),r.deltaMode===xf.WheelEvent.DOM_DELTA_LINE&&(c*=Sz)),c!==0&&c%nb===0&&(c=Math.floor(c/nb)),r.shiftKey&&c&&(c=c*Mz),this.callback({type:tb,center:{x:r.clientX,y:r.clientY},delta:-c,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(Tz),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,J1?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===tb&&(this.options.enable=n)}}const{MOUSE_EVENTS:Cz}=Uy,ib="pointermove",rb="pointerover",ob="pointerout",sb="pointerenter",ab="pointerleave";class kz extends hm{constructor(e,n,i){super(e,n,i),this.handleEvent=c=>{this.handleOverEvent(c),this.handleOutEvent(c),this.handleEnterEvent(c),this.handleLeaveEvent(c),this.handleMoveEvent(c)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(Cz),this.events.forEach(c=>e.addEventListener(c,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===ib&&(this.enableMoveEvent=n),e===rb&&(this.enableOverEvent=n),e===ob&&(this.enableOutEvent=n),e===sb&&(this.enableEnterEvent=n),e===ab&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(rb,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(ob,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(sb,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(ab,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(ib,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:Pz}=Uy,lb="keydown",cb="keyup";class Lz extends hm{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{const c=r.target||r.srcElement;c.tagName==="INPUT"&&c.type==="text"||c.tagName==="TEXTAREA"||(this.enableDownEvent&&r.type==="keydown"&&this.callback({type:lb,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&r.type==="keyup"&&this.callback({type:cb,srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Pz),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===lb&&(this.enableDownEvent=n),e===cb&&(this.enableUpEvent=n)}}const ub="contextmenu";class Rz extends hm{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{this.options.enable&&this.callback({type:ub,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===ub&&(this.options.enable=n)}}const e_=1,_p=2,t_=4,Dz={pointerdown:e_,pointermove:_p,pointerup:t_,mousedown:e_,mousemove:_p,mouseup:t_},zz=1,Bz=2,Oz=3,Fz=0,Nz=1,Uz=2,Vz=1,jz=2,Gz=4;function Hz(t){const e=Dz[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let c=!1,p=!1,a=!1;return e===t_||e===_p&&!Number.isFinite(n)?(c=r===zz,p=r===Bz,a=r===Oz):e===_p?(c=!!(n&Vz),p=!!(n&Gz),a=!!(n&jz)):e===e_&&(c=i===Fz,p=i===Nz,a=i===Uz),{leftButton:c,middleButton:p,rightButton:a}}function $z(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,c=i.height/e.offsetHeight||1,p={x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/c};return{center:n,offsetCenter:p}}const Zg={srcElement:"root",priority:0};class Wz{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let r=n.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,i,r=!1,c=!1){const{handlers:p,handlersByElement:a}=this;let T=Zg;typeof i=="string"||i&&i.addEventListener?T={...Zg,srcElement:i}:i&&(T={...Zg,...i});let k=a.get(T.srcElement);k||(k=[],a.set(T.srcElement,k));const z={type:e,handler:n,srcElement:T.srcElement,priority:T.priority};r&&(z.once=!0),c&&(z.passive=!0),p.push(z),this._active=this._active||!z.passive;let B=k.length-1;for(;B>=0&&!(k[B].priority>=z.priority);)B--;k.splice(B+1,0,z)}remove(e,n){const{handlers:i,handlersByElement:r}=this;for(let c=i.length-1;c>=0;c--){const p=i[c];if(p.type===e&&p.handler===n){i.splice(c,1);const a=r.get(p.srcElement);a.splice(a.indexOf(p),1),a.length===0&&r.delete(p.srcElement)}}this._active=i.some(c=>!c.passive)}_emit(e,n){const i=this.handlersByElement.get(n);if(i){let r=!1;const c=()=>{e.handled=!0},p=()=>{e.handled=!0,r=!0},a=[];for(let T=0;T<i.length;T++){const{type:k,handler:z,once:B}=i[T];if(z({...e,type:k,stopPropagation:c,stopImmediatePropagation:p}),B&&a.push(i[T]),r)break}for(let T=0;T<a.length;T++){const{type:k,handler:z}=a[T];this.remove(k,z)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...Hz(e),...$z(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Zz={events:null,recognizers:null,recognizerOptions:{},Manager:_z,touchAction:"none",tabIndex:0};class qz{constructor(e=null,n){this._onBasicInput=r=>{const{srcEvent:c}=r,p=xz[c.type];p&&this.manager.emit(p,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...Zz,...n},this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,i=n.Manager;this.manager=new i(e,{touchAction:n.touchAction,recognizers:n.recognizers||yz}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(Jw).forEach(r=>{const c=this.manager.get(r);c&&Jw[r].forEach(p=>{c.recognizeWith(p)})});for(const r in n.recognizerOptions){const c=this.manager.get(r);if(c){const p=n.recognizerOptions[r];delete p.enable,c.set(p)}}this.wheelInput=new Iz(e,this._onOtherEvent,{enable:!1}),this.moveInput=new kz(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Lz(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new Rz(e,this._onOtherEvent,{enable:!1});for(const[r,c]of this.events)c.isEmpty()||(this._toggleRecognizer(c.recognizerName,!0),this.manager.on(r,c.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,i){this._addEventHandler(e,n,i,!1)}once(e,n,i){this._addEventHandler(e,n,i,!0)}watch(e,n,i){this._addEventHandler(e,n,i,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==n){r.set({enable:n});const c=vz[e];c&&!this.options.recognizers&&c.forEach(p=>{const a=i.get(p);n?(a.requireFailure(e),r.dropRequireFailure(p)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,i,r,c){if(typeof e!="string"){i=n;for(const z in e)this._addEventHandler(z,e[z],i,r,c);return}const{manager:p,events:a}=this,T=eb[e]||e;let k=a.get(T);k||(k=new Wz(this),a.set(T,k),k.recognizerName=wz[T]||T,p&&p.on(T,k.handleEvent)),k.add(e,n,i,r,c),k.isEmpty()||this._toggleRecognizer(k.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const p in e)this._removeEventHandler(p,e[p]);return}const{events:i}=this,r=eb[e]||e,c=i.get(r);if(c&&(c.remove(e,n),c.isEmpty())){const{recognizerName:p}=c;let a=!1;for(const T of i.values())if(T.recognizerName===p&&!T.isEmpty()){a=!0;break}a||this._toggleRecognizer(p,!1)}}}function Kc(){}const Qz=({isDragging:t})=>t?"grabbing":"grab",h6={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Kc,onResize:Kc,onViewStateChange:Kc,onInteractionStateChange:Kc,onBeforeRender:Kc,onAfterRender:Kc,onLoad:Kc,onError:t=>ii.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Qz,getTooltip:null,debug:!1,drawPickingColors:!1};class dm{constructor(e){ae(this,"props",void 0),ae(this,"width",0),ae(this,"height",0),ae(this,"userData",{}),ae(this,"canvas",null),ae(this,"viewManager",null),ae(this,"layerManager",null),ae(this,"effectManager",null),ae(this,"deckRenderer",null),ae(this,"deckPicker",null),ae(this,"eventManager",null),ae(this,"tooltip",null),ae(this,"metrics",void 0),ae(this,"animationLoop",void 0),ae(this,"stats",void 0),ae(this,"viewState",void 0),ae(this,"cursorState",void 0),ae(this,"_needsRedraw",void 0),ae(this,"_pickRequest",void 0),ae(this,"_lastPointerDownInfo",null),ae(this,"_metricsCounter",void 0),ae(this,"_onPointerMove",n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const r=n.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n}),ae(this,"_onEvent",n=>{const i=Zx[n.type],r=n.offsetCenter;if(!i||!r||!this.layerManager)return;const c=this.layerManager.getLayers(),p=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:c,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:a}=p,T=a&&(a[i.handler]||a.props[i.handler]),k=this.props[i.handler];let z=!1;T&&(z=T.call(a,p,n)),!z&&k&&k(p,n)}),ae(this,"_onPointerDown",n=>{const i=n.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...h6,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&ii.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),iE()==="IE"&&ii.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new Ty({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&ih.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,i,r,c,p,a,T;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(i=this.viewManager)===null||i===void 0||i.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(c=this.deckRenderer)===null||c===void 0||c.finalize(),this.deckRenderer=null,(p=this.deckPicker)===null||p===void 0||p.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(T=this.tooltip)===null||T===void 0||T.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var k;(k=this.canvas.parentElement)===null||k===void 0||k.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&ii.removed("onLayerHover","onHover")(),"onLayerClick"in e&&ii.removed("onLayerClick","onClick")(),e.initialViewState&&!ba(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),c=this.effectManager.needsRedraw(e),p=this.deckRenderer.needsRedraw(e);return n=n||i||r||c||p,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return vr(this.viewManager),this.viewManager.views}getViewports(e){return vr(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,i){vr(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(n).timeStart();const c=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(n).timeEnd(),c}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),vr(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:i}=e;if(n||n===0){const c=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=c}if(i||i===0){var r;const c=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=((r=e.style)===null||r===void 0?void 0:r.position)||"absolute",this.canvas.style.height=c}}_updateCanvasSize(){var e,n;const{canvas:i}=this;if(!i)return;const r=(e=i.clientWidth)!==null&&e!==void 0?e:i.width,c=(n=i.clientHeight)!==null&&n!==void 0?n:i.height;if(r!==this.width||c!==this.height){var p,a;this.width=r,this.height=c,(p=this.viewManager)===null||p===void 0||p.setProps({width:r,height:c}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:c})}}_createAnimationLoop(e){const{width:n,height:i,gl:r,glOptions:c,debug:p,onError:a,onBeforeRender:T,onAfterRender:k,useDevicePixels:z}=e;return new zP({width:n,height:i,useDevicePixels:z,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,gl:r,onCreateContext:B=>uE({...c,...B,canvas:this.canvas,debug:p,onContextLost:()=>this._onContextLost()}),onInitialize:B=>this._setGLContext(B.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:T,onAfterRender:k,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new s6({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let c=r,p=!1;for(const a of i){var n;c=a,p=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||p}if(!p&&this.props.onHover&&this.props.onHover(c,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(c);this.tooltip.setTooltip(a,c.x,c.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,Ey(e,{enable:!0,copyState:!0})),this.tooltip=new fz(this.canvas),ml(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new GE;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new qz(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in Zx)this.eventManager.on(r,this._onEvent);this.viewManager=new FD({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new OD(e,{deck:this,stats:this.stats,viewport:i,timeline:n}),this.effectManager=new ez,this.deckRenderer=new iz(e),this.deckPicker=new cz(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:i}=this.layerManager.context;ml(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),ii.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const i=iu.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}ae(dm,"defaultProps",h6);ae(dm,"VERSION",VI);class qg{constructor(e,n){ae(this,"opts",void 0),ae(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:i}=this.source,{size:r}=n;let c=i;if(i&&i.length!==r){c=new Float32Array(r);const p=n.elementOffset||0;for(let a=0;a<r;++a)c[a]=i[p+a]}return c}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function Xz(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function V0(t){return t.stride||t.size*t.bytesPerElement}function d6(t,e){e.offset&&ii.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=V0(t),i=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,r=e.elementOffset||0,c=i*n+r*t.bytesPerElement+(t.offset||0);return{...e,offset:c,stride:n}}function Yz(t,e){const n=d6(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class Kz{constructor(e,n,i){ae(this,"gl",void 0),ae(this,"id",void 0),ae(this,"size",void 0),ae(this,"settings",void 0),ae(this,"value",void 0),ae(this,"doublePrecision",void 0),ae(this,"_buffer",void 0),ae(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const r=n.logicalType||n.type,c=r===5130;let{defaultValue:p}=n;p=Number.isFinite(p)?[p]:p||new Array(this.size).fill(0);let a;c?a=5126:!r&&n.isIndexed?a=e&&_E(e,hi.ELEMENT_INDEX_UINT32)?5125:5123:a=r||5126;let T=Xz(r||a||5126);this.doublePrecision=c,c&&n.fp64===!1&&(T=Float32Array),this.value=null,this.settings={...n,defaultType:T,defaultValue:p,logicalType:r,type:a,size:this.size,bytesPerElement:T.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ni(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*V0(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),ih.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,c=Yz(this.getAccessor(),n||{});return i[e]=new qg(this,c.high),i["".concat(e,"64Low")]=r?new qg(this,c.low):new Float32Array(this.size),i}if(n){const i=d6(this.getAccessor(),n);return{[e]:new qg(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:i,size:r}=this,c=i*r;if(n&&c&&n.length>=c){const p=new Array(r).fill(1/0),a=new Array(r).fill(-1/0);for(let T=0;T<c;)for(let k=0;k<r;k++){const z=n[T++];z<p[k]&&(p[k]=z),z>a[k]&&(a[k]=z)}e=[p,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let i;ArrayBuffer.isView(e)?i={value:e}:e instanceof ni?i={buffer:e}:i=e;const r={...this.settings,...i};if(n.bufferAccessor=r,n.bounds=null,i.constant){let c=i.value;if(c=this._normalizeValue(c,[],0),this.settings.normalized&&(c=this.normalizeConstant(c)),!(!n.constant||!this._areValuesEqual(c,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=c}else if(i.buffer){const c=i.buffer;n.externalBuffer=c,n.constant=!1,this.value=i.value||null;const p=i.value instanceof Float64Array;r.type=i.type||c.accessor.type,r.bytesPerElement=c.accessor.BYTES_PER_ELEMENT*(p?2:1),r.stride=V0(r)}else if(i.value){this._checkExternalBuffer(i);let c=i.value;n.externalBuffer=null,n.constant=!1,this.value=c,r.bytesPerElement=c.BYTES_PER_ELEMENT,r.stride=V0(r);const{buffer:p,byteOffset:a}=this;this.doublePrecision&&c instanceof Float64Array&&(c=Hg(c,r));const T=c.byteLength+a+r.stride*2;p.byteLength<T&&p.reallocate(T),p.setAccessor(null),p.subData({data:c,offset:a}),r.type=i.type||p.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Hg(n,{size:this.size,startIndex:i,endIndex:r}):n.subarray(i,r),offset:i*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:i}=this,r=i.allocatedValue,c=ih.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=c;const{buffer:p,byteOffset:a}=this;return p.byteLength<c.byteLength+a&&(p.reallocate(c.byteLength+a),n&&r&&p.subData({data:r instanceof Float64Array?Hg(r,this):r,offset:a})),i.allocatedValue=c,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=n.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof i)&&this.settings.normalized&&!("normalized"in e)&&ii.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,i){const{defaultValue:r,size:c}=this.settings;if(Number.isFinite(e))return n[i]=e,n;if(!e){let p=c;for(;--p>=0;)n[i+p]=r[p];return n}switch(c){case 4:n[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:n[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:n[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:n[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let p=c;for(;--p>=0;)n[i+p]=Number.isFinite(e[p])?e[p]:r[p]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==n[r])return!1;return!0}}const fb=[],hb=[];function Vy(t,e=0,n=1/0){let i=fb;const r={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?i=t:t.length>0&&(hb.length=t.length,i=hb):i=fb,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function A6(t){return t&&t[Symbol.asyncIterator]}function p6(t,e){const{size:n,stride:i,offset:r,startIndices:c,nested:p}=e,a=t.BYTES_PER_ELEMENT,T=i?i/a:n,k=r?r/a:0,z=Math.floor((t.length-k)/T);return(B,{index:D,target:K})=>{if(!c){const se=D*T+k;for(let ne=0;ne<n;ne++)K[ne]=t[se+ne];return K}const ee=c[D],le=c[D+1]||z;let Ce;if(p){Ce=new Array(le-ee);for(let se=ee;se<le;se++){const ne=se*T+k;K=new Array(n);for(let te=0;te<n;te++)K[te]=t[ne+te];Ce[se-ee]=K}}else if(T===n)Ce=t.subarray(ee*n+k,le*n+k);else{Ce=new t.constructor((le-ee)*n);let se=0;for(let ne=ee;ne<le;ne++){const te=ne*T+k;for(let xe=0;xe<n;xe++)Ce[se++]=t[te+xe]}}return Ce}}const Jz=[],j0=[[0,1/0]];function eB(t,e){if(t===j0||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],i=t.length;let r=0;for(let c=0;c<i;c++){const p=t[c];p[1]<e[0]?(n.push(p),r=c+1):p[0]>e[1]?n.push(p):e=[Math.min(p[0],e[0]),Math.max(p[1],e[1])]}return n.splice(r,0,e),n}function Qg(t){const{source:e,target:n,start:i=0,size:r,getData:c}=t,p=t.end||n.length,a=e.length,T=p-i;if(a>T){n.set(e.subarray(0,T),i);return}if(n.set(e,i),!c)return;let k=a;for(;k<T;){const z=c(k,e);for(let B=0;B<r;B++)n[i+k]=z[B]||0,k++}}function tB({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:c}){if(!Array.isArray(c))return Qg({source:t,target:e,size:n,getData:i}),e;let p=0,a=0;const T=i&&((z,B)=>i(z+a,B)),k=Math.min(r.length,c.length);for(let z=1;z<k;z++){const B=r[z]*n,D=c[z]*n;Qg({source:t.subarray(p,B),target:e,start:a,end:D,size:n,getData:T}),p=B,a=D}return a<e.length&&Qg({source:[],target:e,start:a,size:n,getData:T}),e}const nB={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function m6(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...nB[n],...e,...t,type:n}}function g6(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function _6(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function y6(t){t.push(t.shift())}function jy(t,e){const{doublePrecision:n,settings:i,value:r,size:c}=t,p=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*c)*p}function v6({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:c=p=>p}){const p=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*p,T=n.byteOffset,k=n.startIndices,z=r&&k,B=jy(n,e),D=n.isConstant;if(!z&&i>=B)return;const K=D?n.value:n.getBuffer().getData({srcByteOffset:T});if(n.settings.normalized&&!D){const se=c;c=(ne,te)=>n.normalizeConstant(se(ne,te))}const ee=D?(se,ne)=>c(K,ne):(se,ne)=>c(K.subarray(se,se+a),ne),le=t.getData({length:i}),Ce=new Float32Array(B);tB({source:le,target:Ce,sourceStartIndices:r,targetStartIndices:k,size:a,getData:ee}),t.byteLength<Ce.byteLength+T&&t.reallocate(Ce.byteLength+T),t.subData({data:Ce,offset:T})}class Gy extends Kz{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:j0}),ae(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,i=this.settings.transition,r=Array.isArray(n)?e[n.find(c=>e[c])]:e[n];return m6(r,i)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:i=0,endRow:r=1/0}=n;this.state.updateRanges=eB(this.state.updateRanges,[i,r])}else this.state.updateRanges=j0}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Jz}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,n.updateRanges!==j0),!0):!1}updateBuffer({numInstances:e,data:n,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:c},settings:{update:p,noAlloc:a}}=this;let T=!0;if(p){for(const[k,z]of c)p.call(r,this,{data:n,startRow:k,endRow:z,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[k,z]of c){const B=Number.isFinite(k)?this.getVertexOffset(k):0,D=Number.isFinite(z)?this.getVertexOffset(z):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:B,endOffset:D})}this._checkAttributeArray()}else T=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),T}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const p=e;vr(ArrayBuffer.isView(p.value),"invalid ".concat(r.accessor));const a=!!p.size&&p.size!==this.size;return i.binaryAccessor=p6(p.value,{size:p.size||this.size,stride:p.stride,offset:p.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const i in e)Object.assign(n,super.getShaderAttributes(i,e[i]));return n}_autoUpdater(e,{data:n,startRow:i,endRow:r,props:c,numInstances:p}){if(e.constant)return;const{settings:a,state:T,value:k,size:z,startIndices:B}=e,{accessor:D,transform:K}=a,ee=T.binaryAccessor||(typeof D=="function"?D:c[D]);vr(typeof ee=="function",'accessor "'.concat(D,'" is not a function'));let le=e.getVertexOffset(i);const{iterable:Ce,objectInfo:se}=Vy(n,i,r);for(const ne of Ce){se.index++;let te=ee(ne,se);if(K&&(te=K.call(this,te)),B){const xe=(se.index<B.length-1?B[se.index+1]:p)-B[se.index];if(te&&Array.isArray(te[0])){let Le=le;for(const Ge of te)e._normalizeValue(Ge,k,Le),Le+=z}else te&&te.length>z?k.set(te,le):(e._normalizeValue(te,se.target,0),ID({target:k,source:se.target,start:le,count:xe}));le+=xe*z}else e._normalizeValue(te,k,le),le+=z}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let i=!0;switch(n){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class iB{constructor({gl:e,attribute:n,timeline:i}){ae(this,"gl",void 0),ae(this,"type","interpolation"),ae(this,"attributeInTransition",void 0),ae(this,"settings",void 0),ae(this,"attribute",void 0),ae(this,"transition",void 0),ae(this,"currentStartIndices",void 0),ae(this,"currentLength",void 0),ae(this,"transform",void 0),ae(this,"buffers",void 0),this.gl=e,this.transition=new mA(i),this.attribute=n,this.attributeInTransition=new Gy(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=oB(e,n);const r={byteLength:0,usage:35050};this.buffers=[new ni(e,r),new ni(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:i,buffers:r,attribute:c}=this;y6(r);const p={numInstances:n,attribute:c,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)v6({buffer:a,...p});this.currentStartIndices=c.startIndices,this.currentLength=jy(c,n),this.attributeInTransition.setData({buffer:r[1],value:c.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/c.size),sourceBuffers:{aFrom:r[0],aTo:g6(i,c)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:i}=this.settings,{time:r}=this.transition;let c=r/n;i&&(c=i(c)),this.transform.run({uniforms:{time:c}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const rB=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function oB(t,e){const n=_6(e.size);return new Ry(t,{vs:rB,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class sB{constructor({gl:e,attribute:n,timeline:i}){ae(this,"gl",void 0),ae(this,"type","spring"),ae(this,"attributeInTransition",void 0),ae(this,"settings",void 0),ae(this,"attribute",void 0),ae(this,"transition",void 0),ae(this,"currentStartIndices",void 0),ae(this,"currentLength",void 0),ae(this,"texture",void 0),ae(this,"framebuffer",void 0),ae(this,"transform",void 0),ae(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new mA(i),this.attribute=n,this.attributeInTransition=new Gy(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=lB(e),this.framebuffer=cB(e,this.texture),this.transform=aB(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new ni(e,r),new ni(e,r),new ni(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:i,buffers:r,attribute:c}=this,p={numInstances:n,attribute:c,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)v6({buffer:a,...p});this.settings=e,this.currentStartIndices=c.startIndices,this.currentLength=jy(c,n),this.attributeInTransition.setData({buffer:r[1],value:c.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/c.size),sourceBuffers:{aTo:g6(i,c)}})}update(){const{buffers:e,transform:n,framebuffer:i,transition:r}=this;if(!r.update())return!1;const p=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:p.stiffness,damping:p.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),y6(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),um(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function aB(t,e,n){const i=_6(e.size);return new Ry(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}function lB(t){return new ws(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function cB(t,e){return new fr(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const uB={interpolation:iB,spring:sB};class fB{constructor(e,{id:n,timeline:i}){ae(this,"id",void 0),ae(this,"isSupported",void 0),ae(this,"gl",void 0),ae(this,"timeline",void 0),ae(this,"transitions",void 0),ae(this,"needsRedraw",void 0),ae(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Ry.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:i}){this.numInstances=i||1;for(const r in e){const c=e[r],p=c.getTransitionSetting(n);p&&this._updateAttribute(r,c,p)}for(const r in this.transitions){const c=e[r];(!c||!c.getTransitionSetting(n))&&this._removeTransition(r)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const i=this.transitions[n];i.inProgress&&(e[n]=i.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,i){const r=this.transitions[e];let c=!r||r.type!==i.type;if(c){if(!this.isSupported){ii.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}r&&this._removeTransition(e);const p=uB[i.type];p?this.transitions[e]=new p({attribute:n,timeline:this.timeline,gl:this.gl}):(ii.error("unsupported transition type '".concat(i.type,"'"))(),c=!1)}(c||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const db="attributeManager.invalidate",hB="attributeManager.updateStart",dB="attributeManager.updateEnd",AB="attribute.updateStart",pB="attribute.allocate",mB="attribute.updateEnd";class gB{constructor(e,{id:n="attribute-manager",stats:i,timeline:r}={}){ae(this,"id",void 0),ae(this,"gl",void 0),ae(this,"attributes",void 0),ae(this,"updateTriggers",void 0),ae(this,"needsRedraw",void 0),ae(this,"userData",void 0),ae(this,"stats",void 0),ae(this,"attributeTransitionManager",void 0),ae(this,"mergeBoundsMemoized",pA(eD)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new fB(e,{id:"".concat(n,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const i=this._invalidateTrigger(e,n);Wr(db,this,e,i)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Wr(db,this,"all")}update({data:e,numInstances:n,startIndices:i=null,transitions:r,props:c={},buffers:p={},context:a={}}){let T=!1;Wr(hB,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const k in this.attributes){const z=this.attributes[k],B=z.settings.accessor;z.startIndices=i,z.numInstances=n,c[k]&&ii.removed("props.".concat(k),"data.attributes.".concat(k))(),z.setExternalBuffer(p[k])||z.setBinaryValue(typeof B=="string"?p[B]:void 0,e.startIndices)||typeof B=="string"&&!p[B]&&z.setConstantValue(c[B])||z.needsUpdate()&&(T=!0,this._updateAttribute({attribute:z,numInstances:n,data:e,props:c,context:a})),this.needsRedraw=this.needsRedraw||z.needsRedraw()}T&&Wr(dB,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(i=>{var r;return(r=this.attributes[i])===null||r===void 0?void 0:r.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const c in n){const p=n[c];p.needsRedraw(e)&&!i.hasAttribute(c)&&(r[c]=p)}return r}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const i={};for(const r in e)n[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,n={}){for(const i in e){const r=e[i];this.attributes[i]=this._createAttribute(i,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,i){const r={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:i.instanced?1:n.divisor||0};return new Gy(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:i,updateTriggers:r}=this,c=r[e];return c&&c.forEach(p=>{const a=i[p];a&&a.setNeedsUpdate(a.id,n)}),c}_updateAttribute(e){const{attribute:n,numInstances:i}=e;if(Wr(AB,n),n.constant){n.setConstantValue(n.value);return}n.allocate(i)&&Wr(pB,n,i),n.updateBuffer(e)&&(this.needsRedraw=!0,Wr(mB,n,i))}}class _B extends mA{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:i,duration:r,easing:c}}=this,p=c(e/r);this._value=Jf(n,i,p)}}const Ab=1e-5;function pb(t,e,n,i,r){const c=e-t,a=(n-e)*r,T=-c*i;return a+T+c+e}function yB(t,e,n,i,r){if(Array.isArray(n)){const c=[];for(let p=0;p<n.length;p++)c[p]=pb(t[p],e[p],n[p],i,r);return c}return pb(t,e,n,i,r)}function mb(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class vB extends mA{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:i,stiffness:r}=this.settings,{_prevValue:c=e,_currValue:p=e}=this;let a=yB(c,p,n,i,r);const T=mb(a,n),k=mb(a,p);T<Ab&&k<Ab&&(a=n,this.end()),this._prevValue=p,this._currValue=a}}const xB={interpolation:_B,spring:vB};class wB{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,i,r){const{transitions:c}=this;if(c.has(e)){const T=c.get(e),{value:k=T.settings.fromValue}=T;n=k,this.remove(e)}if(r=m6(r),!r)return;const p=xB[r.type];if(!p){ii.error("unsupported transition type '".concat(r.type,"'"))();return}const a=new p(this.timeline);a.start({...r,fromValue:n,toValue:i}),c.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,i]of this.transitions)i.update(),e[n]=i.value,i.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function bB(t){const e=t[ac];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function EB(t,e){const n=x6({newProps:t,oldProps:e,propTypes:t[ac],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=SB(t,e);let r=!1;return i||(r=MB(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:IB(t,e),transitionsChanged:TB(t,e)}}function TB(t,e){if(!t.transitions)return!1;const n={},i=t[ac];let r=!1;for(const c in t.transitions){const p=i[c],a=p&&p.type;(a==="number"||a==="color"||a==="array")&&n_(t[c],e[c],p)&&(n[c]=!0,r=!0)}return r?n:!1}function x6({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(r," changed shallowly");for(const c of Object.keys(t))if(!(c in n)){if(!(c in e))return"".concat(r,".").concat(c," added");const p=n_(t[c],e[c],i[c]);if(p)return"".concat(r,".").concat(c," ").concat(p)}for(const c of Object.keys(e))if(!(c in n)){if(!(c in t))return"".concat(r,".").concat(c," dropped");if(!Object.hasOwnProperty.call(t,c)){const p=n_(t[c],e[c],i[c]);if(p)return"".concat(r,".").concat(c," ").concat(p)}}return!1}function n_(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)||!i&&(i=t&&e&&t.equals,i&&!i.call(t,e))?"changed deeply":!i&&e!==t?"changed shallowly":null}function SB(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}function MB(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&gb(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)r!=="all"&&gb(t,e,r)&&(n[r]=!0,i=!0);return i?n:!1}function IB(t,e){if(e===null)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i||i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function gb(t,e,n){let i=t.updateTriggers[n];i=i??{};let r=e.updateTriggers[n];return r=r??{},x6({oldProps:r,newProps:i,triggerName:n})}const CB="count(): argument not an object",kB="count(): argument not a container";function PB(t){if(!RB(t))throw new Error(CB);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(LB(t))return Object.keys(t).length;throw new Error(kB)}function LB(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function RB(t){return t!==null&&typeof t=="object"}function DB(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){const i=n.modules.findIndex(r=>r.name==="project32");i>=0&&n.modules.splice(i,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const i={...t.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];n.inject=i}return n}const zB={10241:9987,10240:9729,10242:33071,10243:33071},i_={};function BB(t,e,n,i){if(n instanceof ws)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let r=null;n.compressed&&(r={10241:n.data.length>1?9985:9729});const c=new ws(e,{...n,parameters:{...zB,...r,...i}});return i_[c.id]=t,c}function OB(t,e){!e||!(e instanceof ws)||i_[e.id]===t&&(e.delete(),delete i_[e.id])}const FB={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||r_(t)&&(t.length===3||t.length===4)},equal(t,e,n){return ba(t,e,1)}},accessor:{validate(t,e){const n=yp(t);return n==="function"||n===yp(e.value)},equal(t,e,n){return typeof e=="function"?!0:ba(t,e,1)}},array:{validate(t,e){return e.optional&&!t||r_(t)},equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?ba(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?ba(t,e,r):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>{const i=n.context;return!i||!i.gl?null:BB(n.id,i.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{OB(n.id,t)}}};function NB(t){const e={},n={},i={};for(const[r,c]of Object.entries(t)){const p=c==null?void 0:c.deprecatedFor;if(p)i[r]=Array.isArray(p)?p:[p];else{const a=UB(r,c);e[r]=a,n[r]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}function UB(t,e){switch(yp(e)){case"object":return Yh(t,e);case"array":return Yh(t,{type:"array",value:e,compare:!1});case"boolean":return Yh(t,{type:"boolean",value:e});case"number":return Yh(t,{type:"number",value:e});case"function":return Yh(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Yh(t,e){return"type"in e?{name:t,...FB[e.type],...e}:"value"in e?{name:t,type:yp(e.value),...e}:{name:t,type:"object",value:e}}function r_(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function yp(t){return r_(t)?"array":t===null?"null":typeof t}function VB(t,e){let n;for(let c=e.length-1;c>=0;c--){const p=e[c];"extensions"in p&&(n=p.extensions)}const i=o_(t.constructor,n),r=Object.create(i);r[gp]=t,r[Au]={},r[nc]={};for(let c=0;c<e.length;++c){const p=e[c];for(const a in p)r[a]=p[a]}return Object.freeze(r),r}const jB="_mergedDefaultProps";function o_(t,e){let n=jB;if(e)for(const r of e){const c=r.constructor;c&&(n+=":".concat(c.extensionName||c.name))}const i=w6(t,n);return i||(t[n]=GB(t,e||[]))}function GB(t,e){if(!t.prototype)return null;const i=Object.getPrototypeOf(t),r=o_(i),c=w6(t,"defaultProps")||{},p=NB(c),a=Object.assign(Object.create(null),r,p.defaultProps),T=Object.assign(Object.create(null),r==null?void 0:r[ac],p.propTypes),k=Object.assign(Object.create(null),r==null?void 0:r[Wg],p.deprecatedProps);for(const z of e){const B=o_(z.constructor);B&&(Object.assign(a,B),Object.assign(T,B[ac]),Object.assign(k,B[Wg]))}return HB(a,t),WB(a,T),$B(a,k),a[ac]=T,a[Wg]=k,e.length===0&&!Hy(t,"_propTypes")&&(t._propTypes=T),a}function HB(t,e){const n=qB(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function $B(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(n);for(const c of e[n])Hy(this,c)||(this[c]=i);ii.deprecated(r,e[n].join("/"))()}})}function WB(t,e){const n={},i={};for(const r in e){const c=e[r],{name:p,value:a}=c;c.async&&(n[p]=a,i[p]=ZB(p))}t[Nf]=n,t[Au]={},Object.defineProperties(t,i)}function ZB(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||A6(e)?this[Au][t]=e:this[nc][t]=e},get(){if(this[nc]){if(t in this[nc])return this[nc][t]||this[Nf][t];if(t in this[Au]){const e=this[gp]&&this[gp].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Nf][t]}}return this[Nf][t]}}}function Hy(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function w6(t,e){return Hy(t,e)&&t[e]}function qB(t){const e=t.componentName;return e||ii.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let QB=0;class $y{constructor(...e){ae(this,"id",void 0),ae(this,"props",void 0),ae(this,"count",void 0),this.props=VB(this,e),this.id=this.props.id,this.count=QB++}clone(e){const{props:n}=this,i={};for(const r in n[Nf])r in n[nc]?i[r]=n[nc][r]:r in n[Au]&&(i[r]=n[Au][r]);return new this.constructor({...n,...i,...e})}}ae($y,"componentName","Component");ae($y,"defaultProps",{});const XB=Object.freeze({});class YB{constructor(e){ae(this,"component",void 0),ae(this,"onAsyncPropUpdated",void 0),ae(this,"asyncProps",void 0),ae(this,"oldProps",void 0),ae(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||XB}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[gp]||this.component;const n=e[nc]||{},i=e[Au]||e,r=e[Nf]||{};for(const c in n){const p=n[c];this._createAsyncPropData(c,r[c]),this._updateAsyncProp(c,p),n[c]=this.getAsyncProp(c)}for(const c in i){const p=i[c];this._createAsyncPropData(c,r[c]),this._updateAsyncProp(c,p)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(A6(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const i=this.asyncProps[e];return n===i.resolvedValue||n===i.lastValue?!1:(i.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(n=this._postProcessValue(i,n),i.resolvedValue=n,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,n,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),r.resolvedValue=n,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;n.then(c=>{this.component&&(c=this._postProcessValue(i,c),this._setAsyncPropValue(e,c,r),this._onResolve(e,c))}).catch(c=>{this._onError(e,c)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const r=i.pendingLoadCount;let c=[],p=0;for await(const a of n){if(!this.component)return;const{dataTransform:T}=this.component.props;T?c=T(a,c):c=c.concat(a),Object.defineProperty(c,"__diff",{enumerable:!1,value:[{startRow:p,endRow:c.length}]}),p=c.length,this._setAsyncPropValue(e,c,r)}this._onResolve(e,c)}_postProcessValue(e,n){const i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(n,i,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const r=this.component&&this.component.props[ac];this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class KB extends YB{constructor({attributeManager:e,layer:n}){super(n),ae(this,"attributeManager",void 0),ae(this,"needsRedraw",void 0),ae(this,"needsUpdate",void 0),ae(this,"subLayers",void 0),ae(this,"usesPickingColorCache",void 0),ae(this,"hasPickingBuffer",void 0),ae(this,"changeFlags",void 0),ae(this,"viewport",void 0),ae(this,"uniformTransitions",void 0),ae(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const i=this.layer,r=i==null?void 0:i.props.fetch;return r?r(n,{propName:e,layer:i}):super._fetch(e,n)}_onResolve(e,n){const i=this.layer;if(i){const r=i.props.onDataLoad;e==="data"&&r&&r(n,{propName:e,layer:i})}}_onError(e,n){const i=this.layer;i&&i.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const JB="layer.changeFlag",eO="layer.initialize",tO="layer.update",nO="layer.finalize",iO="layer.matched",_b=2**24-1,rO=Object.freeze([]),oO=pA(({oldViewport:t,viewport:e})=>t.equals(e));let ma=new Uint8ClampedArray(0);const sO={data:{type:"data",value:rO,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:c})=>{const{resourceManager:p}=n.context;if(r=r||n.getLoadOptions(),i=i||n.props.loaders,c){var a;r={...r,fetch:{...(a=r)===null||a===void 0?void 0:a.fetch,signal:c}}}let T=p.contains(t);return!T&&!r&&(p.add({resourceId:t,data:R1(t,i),persistent:!1}),T=!0),T?p.subscribe({resourceId:t,onChange:k=>{var z;return(z=n.internalState)===null||z===void 0?void 0:z.reloadAsyncProp(e,k)},consumerId:n.id,requestId:e}):R1(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Un.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class _h extends $y{constructor(...e){super(...e),ae(this,"internalState",null),ae(this,"lifecycle",yf.NO_STATE),ae(this,"context",void 0),ae(this,"state",void 0),ae(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){vr(this.internalState);const n=this.internalState.viewport||this.context.viewport,i=e6(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,c,p]=JE(i,n.pixelProjectionMatrix);return e.length===2?[r,c]:[r,c,p]}unproject(e){return vr(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){vr(this.internalState);const i=this.internalState.viewport||this.context.viewport;return sD(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Un.DEFAULT||e===Un.LNGLAT||e===Un.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){vr(e instanceof Uint8Array);const[n,i,r]=e;return n+i*256+r*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:PB(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=DB(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&n)if(Array.isArray(i))for(const r of i)n.invalidateAll(r);else n.invalidateAll();if(n){const{props:r}=e,c=this.internalState.hasPickingBuffer,p=Number.isInteger(r.highlightedObjectIndex)||r.pickable||r.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(c!==p){this.internalState.hasPickingBuffer=p;const{pickingColors:a,instancePickingColors:T}=n.attributes,k=a||T;k&&(p&&k.constant&&(k.constant=!1,n.invalidate(k.id)),!k.value&&!p&&(k.constant=!0,k.value=[0,0,0]))}}}finalizeState(e){for(const i of this.getModels())i.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:i}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,n){var i,r;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((i=(r=this.props).onError)!==null&&i!==void 0&&i.call(r,e))){var c,p;(c=this.context)===null||c===void 0||(p=c.onError)===null||p===void 0||p.call(c,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!oO({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:n.data,numInstances:i,startIndices:r,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const c=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(c)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),i=Object.create(this.props);for(const r in n)Object.defineProperty(i,r,{value:n[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const i=Math.floor(ma.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>_b&&ii.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),ma=ih.allocate(ma,n,{size:3,copy:!0,maxCount:Math.max(n,_b)});const r=Math.floor(ma.length/3),c=[];for(let p=i;p<r;p++)this.encodePickingColor(p,c),ma[p*3+0]=c[0],ma[p*3+1]=c[1],ma[p*3+2]=c[2]}e.value=ma.subarray(0,n*3)}_setModelAttributes(e,n){const i=this.getAttributeManager(),r=e.userData.excludeAttributes||{},c=i.getShaderAttributes(n,r);e.setAttributes(c)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:i,instancePickingColors:r}=this.getAttributeManager().attributes,c=i||r,p=c&&n.attributes&&n.attributes[c.id];if(p&&p.value){const a=p.value,T=this.encodePickingColor(e);for(let k=0;k<n.length;k++){const z=c.getVertexOffset(k);a[z]===T[0]&&a[z+1]===T[1]&&a[z+2]===T[2]&&this._disablePickingIndex(k)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i;if(!r)return;const c=r.getVertexOffset(e),p=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(p-c),offset:c})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==ma.buffer&&(i.value=ma.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){vr(!this.internalState),vr(Number.isFinite(this.props.coordinateSystem)),Wr(eO,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new KB({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(ii.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new wB(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Wr(iO,this,this===e);const{state:n,internalState:i}=e;this!==e&&(this.internalState=i,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Wr(tO,this,e),!e)return;const n=this.props,i=this.context,r=this.internalState,c=i.viewport,p=this._updateUniformTransition();r.propsInTransition=p,i.viewport=r.viewport||c,this.props=p;try{const a=this._getUpdateParams(),T=this.getModels();if(i.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const z of this.props.extensions)z.updateState.call(this,a,z);const k=this.getModels()[0]!==T[0];this._postUpdate(a,k)}finally{i.viewport=c,this.props=n,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){Wr(nO,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,c=this.context;this.props=this.internalState.propsInTransition||r;const p=this.props.opacity;n.opacity=Math.pow(p,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,T=a&&a(n)||[0,0];ml(c.gl,{polygonOffset:T}),Ws(c.gl,i,()=>{const k={moduleParameters:e,uniforms:n,parameters:i,context:c};for(const z of this.props.extensions)z.draw.call(this,k,z);this.draw(k)})}finally{this.props=r}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const r in e)if(e[r]){let c=!1;switch(r){case"dataChanged":const p=e[r],a=n[r];p&&Array.isArray(a)&&(n.dataChanged=Array.isArray(p)?a.concat(p):p,c=!0);default:n[r]||(n[r]=e[r],c=!0)}c&&Wr(JB,this,r,e)}const i=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=i,n.somethingChanged=i||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const i=EB(e,n);if(i.updateTriggersChanged)for(const c in i.updateTriggersChanged)i.updateTriggersChanged[c]&&this.invalidateAttribute(c);if(i.transitionsChanged)for(const c in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(c,n[c],e[c],(r=e.transitions)===null||r===void 0?void 0:r[c])}return this.setChangeFlags(i)}validateProps(){bB(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(n.pickingHighlightColor=i(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new gB(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:c}=this.state;c==null||c.setInstanceCount(this.getNumInstances());const{autoHighlight:p,highlightedObjectIndex:a,highlightColor:T}=i;if(n||r.autoHighlight!==p||r.highlightedObjectIndex!==a||r.highlightColor!==T){const k={};p||(k.pickingSelectedColor=null),Array.isArray(T)&&(k.pickingHighlightColor=T),(n||a!==r.highlightedObjectIndex)&&(k.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(k)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),r=i?i.getNeedsRedraw(e):!1;if(n=n||r,n)for(const c of this.props.extensions)c.onNeedsRedraw.call(this,c);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}ae(_h,"defaultProps",sO);ae(_h,"layerName","Layer");const aO="compositeLayer.renderLayers";class _A extends _h{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||n}getSubLayerRow(e,n,i){return e.__source={parent:this,object:n,index:i},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(n.index=i.__source.index,e(i.__source.object,n)):e(i,r)}return e}getSubLayerProps(e={}){var n;const{opacity:i,pickable:r,visible:c,parameters:p,getPolygonOffset:a,highlightedObjectIndex:T,autoHighlight:k,highlightColor:z,coordinateSystem:B,coordinateOrigin:D,wrapLongitude:K,positionFormat:ee,modelMatrix:le,extensions:Ce,fetch:se,operation:ne,_subLayerProps:te}=this.props,xe={id:"",updateTriggers:{},opacity:i,pickable:r,visible:c,parameters:p,getPolygonOffset:a,highlightedObjectIndex:T,autoHighlight:k,highlightColor:z,coordinateSystem:B,coordinateOrigin:D,wrapLongitude:K,positionFormat:ee,modelMatrix:le,extensions:Ce,fetch:se,operation:ne},Le=te&&e.id&&te[e.id],Ge=Le&&Le.updateTriggers,nt=e.id||"sublayer";if(Le){const it=this.props[ac],dt=e.type?e.type._propTypes:{};for(const ct in Le){const Xe=dt[ct]||it[ct];Xe&&Xe.type==="accessor"&&(Le[ct]=this.getSubLayerAccessor(Le[ct]))}}Object.assign(xe,e,Le),xe.id="".concat(this.props.id,"-").concat(nt),xe.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...Ge};for(const it of Ce){const dt=it.getSubLayerProps.call(this,it);dt&&Object.assign(xe,dt,{updateTriggers:Object.assign(xe.updateTriggers,dt.updateTriggers)})}return xe}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();if(r){const c=this.renderLayers();i=Ny(c,Boolean),this.internalState.subLayers=i}Wr(aO,this,r,i);for(const c of i)c.parent=this}}ae(_A,"layerName","CompositeLayer");class lO{constructor(e){ae(this,"opts",void 0),ae(this,"typedArrayManager",void 0),ae(this,"indexStarts",[0]),ae(this,"vertexStarts",[0]),ae(this,"vertexCount",0),ae(this,"instanceCount",0),ae(this,"attributes",void 0),ae(this,"_attributeDefs",void 0),ae(this,"data",void 0),ae(this,"getGeometry",void 0),ae(this,"geometryBuffer",void 0),ae(this,"buffers",void 0),ae(this,"positionSize",void 0),ae(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=ih,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:i={},getGeometry:r,geometryBuffer:c,positionFormat:p,dataChanged:a,normalize:T=!0}=this.opts;if(this.data=n,this.getGeometry=r,this.positionSize=c&&c.size||(p==="XY"?2:3),this.buffers=i,this.normalize=T,c&&(vr(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(c),T||(i.positions=c)),this.geometryBuffer=i.positions,Array.isArray(a))for(const k of a)this._rebuildGeometry(k);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?p6(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:i,buffers:r,_attributeDefs:c,typedArrayManager:p}=this;for(const a in c)if(a in r)p.release(i[a]),i[a]=null;else{const T=c[a];T.copy=n,i[a]=p.allocate(i[a],e,T)}}_forEachGeometry(e,n,i){const{data:r,getGeometry:c}=this,{iterable:p,objectInfo:a}=Vy(r,n,i);for(const T of p){a.index++;const k=c?c(T,a):null;e(k,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:i,instanceCount:r}=this;const{data:c,geometryBuffer:p}=this,{startRow:a=0,endRow:T=1/0}=e||{},k={};if(e||(n=[0],i=[0]),this.normalize||!p)this._forEachGeometry((B,D)=>{const K=B&&this.normalizeGeometry(B);k[D]=K,i[D+1]=i[D]+(K?this.getGeometrySize(K):0)},a,T),r=i[i.length-1];else if(i=c.startIndices,r=i[c.length]||0,ArrayBuffer.isView(p))r=r||p.length/this.positionSize;else if(p instanceof ni){const B=p.accessor.stride||this.positionSize*4;r=r||p.byteLength/B}else if(p.buffer){const B=p.stride||this.positionSize*4;r=r||p.buffer.byteLength/B}else if(p.value){const B=p.value,D=p.stride/B.BYTES_PER_ELEMENT||this.positionSize;r=r||B.length/D}this._allocate(r,!!e),this.indexStarts=n,this.vertexStarts=i,this.instanceCount=r;const z={};this._forEachGeometry((B,D)=>{const K=k[D]||B;z.vertexStart=i[D],z.indexStart=n[D];const ee=D<i.length-1?i[D+1]:r;z.geometrySize=ee-i[D],z.geometryIndex=D,this.updateGeometryAttributes(K,z)},a,T),this.vertexCount=n[n.length-1]}}function cO(t){let e=1/0,n=1/0,i=1/0,r=-1/0,c=-1/0,p=-1/0;const a=t.POSITION?t.POSITION.value:[],T=a&&a.length;for(let k=0;k<T;k+=3){const z=a[k],B=a[k+1],D=a[k+2];e=z<e?z:e,n=B<n?B:n,i=D<i?D:i,r=z>r?z:r,c=B>c?B:c,p=D>p?D:p}return[[e,n,i],[r,c,p]]}function uO(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class wf{constructor(e,n){ae(this,"fields",void 0),ae(this,"metadata",void 0),uO(Array.isArray(e)),fO(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];for(const p of i)e[p]=!0;const c=this.fields.filter(p=>e[p.name]);return new wf(c,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];const r=n.map(c=>this.fields[c]).filter(Boolean);return new wf(r,this.metadata)}assign(e){let n,i=this.metadata;if(e instanceof wf){const p=e;n=p.fields,i=yb(yb(new Map,this.metadata),p.metadata)}else n=e;const r=Object.create(null);for(const p of this.fields)r[p.name]=p;for(const p of n)r[p.name]=p;const c=Object.values(r);return new wf(c,i)}}function fO(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function yb(t,e){return new Map([...t||new Map,...e||new Map])}class yd{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;ae(this,"name",void 0),ae(this,"type",void 0),ae(this,"nullable",void 0),ae(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new yd(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Vi=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),b6,E6,T6;class Wy{static isNull(e){return e&&e.typeId===Vi.Null}static isInt(e){return e&&e.typeId===Vi.Int}static isFloat(e){return e&&e.typeId===Vi.Float}static isBinary(e){return e&&e.typeId===Vi.Binary}static isUtf8(e){return e&&e.typeId===Vi.Utf8}static isBool(e){return e&&e.typeId===Vi.Bool}static isDecimal(e){return e&&e.typeId===Vi.Decimal}static isDate(e){return e&&e.typeId===Vi.Date}static isTime(e){return e&&e.typeId===Vi.Time}static isTimestamp(e){return e&&e.typeId===Vi.Timestamp}static isInterval(e){return e&&e.typeId===Vi.Interval}static isList(e){return e&&e.typeId===Vi.List}static isStruct(e){return e&&e.typeId===Vi.Struct}static isUnion(e){return e&&e.typeId===Vi.Union}static isFixedSizeBinary(e){return e&&e.typeId===Vi.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Vi.FixedSizeList}static isMap(e){return e&&e.typeId===Vi.Map}static isDictionary(e){return e&&e.typeId===Vi.Dictionary}get typeId(){return Vi.NONE}compareTo(e){return this===e}}b6=Symbol.toStringTag;class yh extends Wy{constructor(e,n){super(),ae(this,"isSigned",void 0),ae(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Vi.Int}get[b6](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class hO extends yh{constructor(){super(!0,8)}}class dO extends yh{constructor(){super(!0,16)}}class AO extends yh{constructor(){super(!0,32)}}class pO extends yh{constructor(){super(!1,8)}}class mO extends yh{constructor(){super(!1,16)}}class gO extends yh{constructor(){super(!1,32)}}const S6={HALF:16,SINGLE:32,DOUBLE:64};E6=Symbol.toStringTag;class M6 extends Wy{constructor(e){super(),ae(this,"precision",void 0),this.precision=e}get typeId(){return Vi.Float}get[E6](){return"Float"}toString(){return"Float".concat(this.precision)}}class _O extends M6{constructor(){super(S6.SINGLE)}}class yO extends M6{constructor(){super(S6.DOUBLE)}}T6=Symbol.toStringTag;class vO extends Wy{constructor(e,n){super(),ae(this,"listSize",void 0),ae(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Vi.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[T6](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function xO(t){switch(t.constructor){case Int8Array:return new hO;case Uint8Array:return new pO;case Int16Array:return new dO;case Uint16Array:return new mO;case Int32Array:return new AO;case Uint32Array:return new gO;case Float32Array:return new _O;case Float64Array:return new yO;default:throw new Error("array type not supported")}}const wO=/^[og]\s*(.+)?/,bO=/^mtllib /,EO=/^usemtl /;class Zy{constructor(e){let{index:n,name:i="",mtllib:r,smooth:c,groupStart:p}=e;this.index=n,this.name=i,this.mtllib=r,this.smooth=c,this.groupStart=p,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new Zy({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class TO{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);const r=new Zy({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:i!==void 0?i.smooth:this.smooth,groupStart:i!==void 0?i.groupEnd:0});return this.materials.push(r),r}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let i=this.materials.length-1;i>=0;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class SO{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new TO(e),this.object.fromDeclaration=n,i&&i.name&&typeof i.clone=="function"){const r=i.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/3)*3}parseNormalIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/3)*3}parseUVIndex(e,n){const i=parseInt(e);return(i>=0?i-1:i+n/2)*2}addVertex(e,n,i){const r=this.vertices,c=this.object.geometry.vertices;c.push(r[e+0],r[e+1],r[e+2]),c.push(r[n+0],r[n+1],r[n+2]),c.push(r[i+0],r[i+1],r[i+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,i){const r=this.normals,c=this.object.geometry.normals;c.push(r[e+0],r[e+1],r[e+2]),c.push(r[n+0],r[n+1],r[n+2]),c.push(r[i+0],r[i+1],r[i+2])}addColor(e,n,i){const r=this.colors,c=this.object.geometry.colors;c.push(r[e+0],r[e+1],r[e+2]),c.push(r[n+0],r[n+1],r[n+2]),c.push(r[i+0],r[i+1],r[i+2])}addUV(e,n,i){const r=this.uvs,c=this.object.geometry.uvs;c.push(r[e+0],r[e+1]),c.push(r[n+0],r[n+1]),c.push(r[i+0],r[i+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,i,r,c,p,a,T,k){const z=this.vertices.length;let B=this.parseVertexIndex(e,z),D=this.parseVertexIndex(n,z),K=this.parseVertexIndex(i,z);if(this.addVertex(B,D,K),r!==void 0&&r!==""){const ee=this.uvs.length;B=this.parseUVIndex(r,ee),D=this.parseUVIndex(c,ee),K=this.parseUVIndex(p,ee),this.addUV(B,D,K)}if(a!==void 0&&a!==""){const ee=this.normals.length;B=this.parseNormalIndex(a,ee),D=a===T?B:this.parseNormalIndex(T,ee),K=a===k?B:this.parseNormalIndex(k,ee),this.addNormal(B,D,K)}this.colors.length>0&&this.addColor(B,D,K)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const i of e)this.addVertexPoint(this.parseVertexIndex(i,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const i=this.vertices.length,r=this.uvs.length;for(const c of e)this.addVertexLine(this.parseVertexIndex(c,i));for(const c of n)this.addUVLine(this.parseUVIndex(c,r))}}function MO(t){const e=new SO;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let i="",r="",c=0,p=[];const a=typeof"".trimLeft=="function";for(let z=0,B=n.length;z<B;z++)if(i=n[z],i=a?i.trimLeft():i.trim(),c=i.length,c!==0&&(r=i.charAt(0),r!=="#"))if(r==="v"){const D=i.split(/\s+/);switch(D[0]){case"v":e.vertices.push(parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3])),D.length>=7&&e.colors.push(parseFloat(D[4]),parseFloat(D[5]),parseFloat(D[6]));break;case"vn":e.normals.push(parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]));break;case"vt":e.uvs.push(parseFloat(D[1]),parseFloat(D[2]));break}}else if(r==="f"){const K=i.substr(1).trim().split(/\s+/),ee=[];for(let Ce=0,se=K.length;Ce<se;Ce++){const ne=K[Ce];if(ne.length>0){const te=ne.split("/");ee.push(te)}}const le=ee[0];for(let Ce=1,se=ee.length-1;Ce<se;Ce++){const ne=ee[Ce],te=ee[Ce+1];e.addFace(le[0],ne[0],te[0],le[1],ne[1],te[1],le[2],ne[2],te[2])}}else if(r==="l"){const D=i.substring(1).trim().split(" ");let K;const ee=[];if(i.indexOf("/")===-1)K=D;else{K=[];for(let le=0,Ce=D.length;le<Ce;le++){const se=D[le].split("/");se[0]!==""&&K.push(se[0]),se[1]!==""&&ee.push(se[1])}}e.addLineGeometry(K,ee)}else if(r==="p"){const K=i.substr(1).trim().split(" ");e.addPointGeometry(K)}else if((p=wO.exec(i))!==null){const D=(" "+p[0].substr(1).trim()).substr(1);e.startObject(D)}else if(EO.test(i))e.object.startMaterial(i.substring(7).trim(),e.materialLibraries);else if(bO.test(i))e.materialLibraries.push(i.substring(7).trim());else if(r==="s"){if(p=i.split(" "),p.length>1){const K=p[1].trim().toLowerCase();e.object.smooth=K!=="0"&&K!=="off"}else e.object.smooth=!0;const D=e.object.currentMaterial();D&&(D.smooth=e.object.smooth)}else{if(i==="\0")continue;throw new Error('Unexpected line: "'.concat(i,'"'))}e.finalize();const T=[],k=[];for(const z of e.objects){const{geometry:B}=z;if(B.vertices.length===0)continue;const D={header:{vertexCount:B.vertices.length/3},attributes:{}};switch(B.type){case"Points":D.mode=0;break;case"Line":D.mode=1;break;default:D.mode=4;break}D.attributes.POSITION={value:new Float32Array(B.vertices),size:3},B.normals.length>0&&(D.attributes.NORMAL={value:new Float32Array(B.normals),size:3}),B.colors.length>0&&(D.attributes.COLOR_0={value:new Float32Array(B.colors),size:3}),B.uvs.length>0&&(D.attributes.TEXCOORD_0={value:new Float32Array(B.uvs),size:2}),D.materials=[];for(const K of z.materials){const ee={name:K.name,flatShading:!K.smooth};D.materials.push(ee),k.push(ee)}D.name=z.name,T.push(D)}return{meshes:T,materials:k}}function IO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const r in e)n=n||new Map,r!=="value"&&n.set(r,JSON.stringify(e[r]));const i=[];for(const r in t){const c=t[r],p=CO(r,c);i.push(p)}return new wf(i,n)}function CO(t,e){const n=new Map;for(const c in e)c!=="value"&&n.set(c,JSON.stringify(e[c]));const i=xO(e.value);return!("size"in e)||e.size===1?new yd(t,i,!1,n):new yd(t,new vO(e.size,new yd("value",i)),!1,n)}function vb(t,e){const{meshes:n}=MO(t),i=n.reduce((a,T)=>a+T.header.vertexCount,0),r=kO(n,i),c={vertexCount:i,boundingBox:cO(r)},p=IO(r,{mode:4,boundingBox:c.boundingBox});return{loaderData:{header:{}},schema:p,header:c,mode:4,attributes:r}}function kO(t,e){const n=new Float32Array(e*3);let i,r,c,p=0;for(const T of t){const{POSITION:k,NORMAL:z,COLOR_0:B,TEXCOORD_0:D}=T.attributes;n.set(k.value,p*3),z&&(i=i||new Float32Array(e*3),i.set(z.value,p*3)),B&&(r=r||new Float32Array(e*3),r.set(B.value,p*3)),D&&(c=c||new Float32Array(e*2),c.set(D.value,p*2)),p+=k.value.length/3}const a={};return a.POSITION={value:n,size:3},i&&(a.NORMAL={value:i,size:3}),r&&(a.COLOR_0={value:r,size:3}),c&&(a.TEXCOORD_0={value:c,size:2}),a}const PO="3.4.14",LO={name:"OBJ",id:"obj",module:"obj",version:PO,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:RO,options:{obj:{}}};function RO(t){return t[0]==="v"}const DO={...LO,parse:async(t,e)=>vb(new TextDecoder().decode(t)),parseTextSync:(t,e)=>vb(t)},I6={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function C6(t,e,n={}){return zO(t,n)!==e?(OO(t,n),!0):!1}function zO(t,e={}){return Math.sign(BO(t,e))}function BO(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let c=0;for(let p=n,a=i-r;p<i;p+=r)c+=(t[p]-t[a])*(t[p+1]+t[a+1]),a=p;return c/2}function OO(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,c=(i-n)/r,p=Math.floor(c/2);for(let a=0;a<p;++a){const T=n+a*r,k=n+(c-1-a)*r;for(let z=0;z<r;++z){const B=t[T+z];t[T+z]=t[k+z],t[k+z]=B}}}function ru(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let c=0;c<n;c++)if(t[i-n+c]!==e[c]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function FO(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function s_(t,e,n,i,r=[]){const c=i+e*n;for(let p=0;p<n;p++)r[p]=t[c+p];return r}function NO(t,e,n,i,r=[]){let c,p;if(n&8)c=(i[3]-t[1])/(e[1]-t[1]),p=3;else if(n&4)c=(i[1]-t[1])/(e[1]-t[1]),p=1;else if(n&2)c=(i[2]-t[0])/(e[0]-t[0]),p=2;else if(n&1)c=(i[0]-t[0])/(e[0]-t[0]),p=0;else return null;for(let a=0;a<t.length;a++)r[a]=(p&1)===a?i[p]:c*(e[a]-t[a])+t[a];return r}function UO(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}const xb=0,VO=1;function a0(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function k6(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:c=[0,0],edgeTypes:p=!1}=n||{},a=[],T=[{pos:t,types:p?new Array(t.length/i).fill(VO):null,holes:e||[]}],k=[[],[]];let z=[];for(;T.length;){const{pos:B,types:D,holes:K}=T.shift();GO(B,i,K[0]||B.length,k),z=jO(k[0],r,c,z);const ee=UO(k[1],z);if(ee){let le=wb(B,D,i,0,K[0]||B.length,z,ee);const Ce={pos:le[0].pos,types:le[0].types,holes:[]},se={pos:le[1].pos,types:le[1].types,holes:[]};T.push(Ce,se);for(let ne=0;ne<K.length;ne++)le=wb(B,D,i,K[ne],K[ne+1]||B.length,z,ee),le[0]&&(Ce.holes.push(Ce.pos.length),Ce.pos=a0(Ce.pos,le[0].pos),p&&(Ce.types=a0(Ce.types,le[0].types))),le[1]&&(se.holes.push(se.pos.length),se.pos=a0(se.pos,le[1].pos),p&&(se.types=a0(se.types,le[1].types)))}else{const le={positions:B};p&&(le.edgeTypes=D),K.length&&(le.holeIndices=K),a.push(le)}}return a}function wb(t,e,n,i,r,c,p){const a=(r-i)/n,T=[],k=[],z=[],B=[],D=[];let K,ee,le;const Ce=s_(t,a-1,n,i);let se=Math.sign(p&8?Ce[1]-c[3]:Ce[0]-c[2]),ne=e&&e[a-1],te=0,xe=0;for(let Le=0;Le<a;Le++)K=s_(t,Le,n,i,K),ee=Math.sign(p&8?K[1]-c[3]:K[0]-c[2]),le=e&&e[i/n+Le],ee&&se&&se!==ee&&(NO(Ce,K,p,c,D),ru(T,D)&&z.push(ne),ru(k,D)&&B.push(ne)),ee<=0?(ru(T,K)&&z.push(le),te-=ee):z.length&&(z[z.length-1]=xb),ee>=0?(ru(k,K)&&B.push(le),xe+=ee):B.length&&(B[B.length-1]=xb),FO(Ce,K),se=ee,ne=le;return[te?{pos:T,types:e&&z}:null,xe?{pos:k,types:e&&B}:null]}function jO(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],c=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=c,i[2]=r+e,i[3]=c+e,i}function GO(t,e,n,i){let r=1/0,c=-1/0,p=1/0,a=-1/0;for(let T=0;T<n;T+=e){const k=t[T],z=t[T+1];r=k<r?k:r,c=k>c?k:c,p=z<p?z:p,a=z>a?z:a}return i[0][0]=r,i[0][1]=p,i[1][0]=c,i[1][1]=a,i}const HO=85.051129;function $O(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:c=!1}=n||{};e=e||[];const p=[],a=[];let T=0,k=0;for(let B=0;B<=e.length;B++){const D=e[B]||t.length,K=k,ee=WO(t,i,T,D);for(let le=ee;le<D;le++)p[k++]=t[le];for(let le=T;le<ee;le++)p[k++]=t[le];qO(p,i,K,k),ZO(p,i,K,k,n==null?void 0:n.maxLatitude),T=D,a[B]=k}a.pop();const z=k6(p,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:c});if(r)for(const B of z)QO(B.positions,i);return z}function WO(t,e,n,i){let r=-1,c=-1;for(let p=n+1;p<i;p+=e){const a=Math.abs(t[p]);a>r&&(r=a,c=p-1)}return c}function ZO(t,e,n,i,r=HO){const c=t[n],p=t[i-e];if(Math.abs(c-p)>180){const a=s_(t,0,e,n);a[0]+=Math.round((p-c)/360)*360,ru(t,a),a[1]=Math.sign(a[1])*r,ru(t,a),a[0]=c,ru(t,a)}}function qO(t,e,n,i){let r=t[0],c;for(let p=n;p<i;p+=e){c=t[p];const a=c-r;(a>180||a<-180)&&(c-=Math.round(a/360)*360),t[p]=r=c}}function QO(t,e){let n;const i=t.length/e;for(let c=0;c<i&&(n=t[c*e],(n+180)%360===0);c++);const r=-Math.round(n/360)*360;if(r!==0)for(let c=0;c<i;c++)t[c*e]+=r}var qy={exports:{}};qy.exports=Am;qy.exports.default=Am;function Am(t,e,n){n=n||2;var i=e&&e.length,r=i?e[0]*n:t.length,c=P6(t,0,r,n,!0),p=[];if(!c||c.next===c.prev)return p;var a,T,k,z,B,D,K;if(i&&(c=eF(t,e,c,n)),t.length>80*n){a=k=t[0],T=z=t[1];for(var ee=n;ee<r;ee+=n)B=t[ee],D=t[ee+1],B<a&&(a=B),D<T&&(T=D),B>k&&(k=B),D>z&&(z=D);K=Math.max(k-a,z-T),K=K!==0?32767/K:0}return zd(c,p,n,a,T,K,0),p}function P6(t,e,n,i,r){var c,p;if(r===c_(t,e,n,i)>0)for(c=e;c<n;c+=i)p=bb(c,t[c],t[c+1],p);else for(c=n-i;c>=e;c-=i)p=bb(c,t[c],t[c+1],p);return p&&pm(p,p.next)&&(Od(p),p=p.next),p}function pu(t,e){if(!t)return t;e||(e=t);var n=t,i;do if(i=!1,!n.steiner&&(pm(n,n.next)||ki(n.prev,n,n.next)===0)){if(Od(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function zd(t,e,n,i,r,c,p){if(t){!p&&c&&oF(t,i,r,c);for(var a=t,T,k;t.prev!==t.next;){if(T=t.prev,k=t.next,c?YO(t,i,r,c):XO(t)){e.push(T.i/n|0),e.push(t.i/n|0),e.push(k.i/n|0),Od(t),t=k.next,a=k.next;continue}if(t=k,t===a){p?p===1?(t=KO(pu(t),e,n),zd(t,e,n,i,r,c,2)):p===2&&JO(t,e,n,i,r,c):zd(pu(t),e,n,i,r,c,1);break}}}}function XO(t){var e=t.prev,n=t,i=t.next;if(ki(e,n,i)>=0)return!1;for(var r=e.x,c=n.x,p=i.x,a=e.y,T=n.y,k=i.y,z=r<c?r<p?r:p:c<p?c:p,B=a<T?a<k?a:k:T<k?T:k,D=r>c?r>p?r:p:c>p?c:p,K=a>T?a>k?a:k:T>k?T:k,ee=i.next;ee!==e;){if(ee.x>=z&&ee.x<=D&&ee.y>=B&&ee.y<=K&&bf(r,a,c,T,p,k,ee.x,ee.y)&&ki(ee.prev,ee,ee.next)>=0)return!1;ee=ee.next}return!0}function YO(t,e,n,i){var r=t.prev,c=t,p=t.next;if(ki(r,c,p)>=0)return!1;for(var a=r.x,T=c.x,k=p.x,z=r.y,B=c.y,D=p.y,K=a<T?a<k?a:k:T<k?T:k,ee=z<B?z<D?z:D:B<D?B:D,le=a>T?a>k?a:k:T>k?T:k,Ce=z>B?z>D?z:D:B>D?B:D,se=a_(K,ee,e,n,i),ne=a_(le,Ce,e,n,i),te=t.prevZ,xe=t.nextZ;te&&te.z>=se&&xe&&xe.z<=ne;){if(te.x>=K&&te.x<=le&&te.y>=ee&&te.y<=Ce&&te!==r&&te!==p&&bf(a,z,T,B,k,D,te.x,te.y)&&ki(te.prev,te,te.next)>=0||(te=te.prevZ,xe.x>=K&&xe.x<=le&&xe.y>=ee&&xe.y<=Ce&&xe!==r&&xe!==p&&bf(a,z,T,B,k,D,xe.x,xe.y)&&ki(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;te&&te.z>=se;){if(te.x>=K&&te.x<=le&&te.y>=ee&&te.y<=Ce&&te!==r&&te!==p&&bf(a,z,T,B,k,D,te.x,te.y)&&ki(te.prev,te,te.next)>=0)return!1;te=te.prevZ}for(;xe&&xe.z<=ne;){if(xe.x>=K&&xe.x<=le&&xe.y>=ee&&xe.y<=Ce&&xe!==r&&xe!==p&&bf(a,z,T,B,k,D,xe.x,xe.y)&&ki(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function KO(t,e,n){var i=t;do{var r=i.prev,c=i.next.next;!pm(r,c)&&L6(r,i,i.next,c)&&Bd(r,c)&&Bd(c,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(c.i/n|0),Od(i),Od(i.next),i=t=c),i=i.next}while(i!==t);return pu(i)}function JO(t,e,n,i,r,c){var p=t;do{for(var a=p.next.next;a!==p.prev;){if(p.i!==a.i&&lF(p,a)){var T=R6(p,a);p=pu(p,p.next),T=pu(T,T.next),zd(p,e,n,i,r,c,0),zd(T,e,n,i,r,c,0);return}a=a.next}p=p.next}while(p!==t)}function eF(t,e,n,i){var r=[],c,p,a,T,k;for(c=0,p=e.length;c<p;c++)a=e[c]*i,T=c<p-1?e[c+1]*i:t.length,k=P6(t,a,T,i,!1),k===k.next&&(k.steiner=!0),r.push(aF(k));for(r.sort(tF),c=0;c<r.length;c++)n=nF(r[c],n);return n}function tF(t,e){return t.x-e.x}function nF(t,e){var n=iF(t,e);if(!n)return e;var i=R6(n,t);return pu(i,i.next),pu(n,n.next)}function iF(t,e){var n=e,i=t.x,r=t.y,c=-1/0,p;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var a=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>c&&(c=a,p=n.x<n.next.x?n:n.next,a===i))return p}n=n.next}while(n!==e);if(!p)return null;var T=p,k=p.x,z=p.y,B=1/0,D;n=p;do i>=n.x&&n.x>=k&&i!==n.x&&bf(r<z?i:c,r,k,z,r<z?c:i,r,n.x,n.y)&&(D=Math.abs(r-n.y)/(i-n.x),Bd(n,t)&&(D<B||D===B&&(n.x>p.x||n.x===p.x&&rF(p,n)))&&(p=n,B=D)),n=n.next;while(n!==T);return p}function rF(t,e){return ki(t.prev,t,e.prev)<0&&ki(e.next,t,t.next)<0}function oF(t,e,n,i){var r=t;do r.z===0&&(r.z=a_(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,sF(r)}function sF(t){var e,n,i,r,c,p,a,T,k=1;do{for(n=t,t=null,c=null,p=0;n;){for(p++,i=n,a=0,e=0;e<k&&(a++,i=i.nextZ,!!i);e++);for(T=k;a>0||T>0&&i;)a!==0&&(T===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,T--),c?c.nextZ=r:t=r,r.prevZ=c,c=r;n=i}c.nextZ=null,k*=2}while(p>1);return t}function a_(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function aF(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function bf(t,e,n,i,r,c,p,a){return(r-p)*(e-a)>=(t-p)*(c-a)&&(t-p)*(i-a)>=(n-p)*(e-a)&&(n-p)*(c-a)>=(r-p)*(i-a)}function lF(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!cF(t,e)&&(Bd(t,e)&&Bd(e,t)&&uF(t,e)&&(ki(t.prev,t,e.prev)||ki(t,e.prev,e))||pm(t,e)&&ki(t.prev,t,t.next)>0&&ki(e.prev,e,e.next)>0)}function ki(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function pm(t,e){return t.x===e.x&&t.y===e.y}function L6(t,e,n,i){var r=c0(ki(t,e,n)),c=c0(ki(t,e,i)),p=c0(ki(n,i,t)),a=c0(ki(n,i,e));return!!(r!==c&&p!==a||r===0&&l0(t,n,e)||c===0&&l0(t,i,e)||p===0&&l0(n,t,i)||a===0&&l0(n,e,i))}function l0(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function c0(t){return t>0?1:t<0?-1:0}function cF(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&L6(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Bd(t,e){return ki(t.prev,t,t.next)<0?ki(t,e,t.next)>=0&&ki(t,t.prev,e)>=0:ki(t,e,t.prev)<0||ki(t,t.next,e)<0}function uF(t,e){var n=t,i=!1,r=(t.x+e.x)/2,c=(t.y+e.y)/2;do n.y>c!=n.next.y>c&&n.next.y!==n.y&&r<(n.next.x-n.x)*(c-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function R6(t,e){var n=new l_(t.i,t.x,t.y),i=new l_(e.i,e.x,e.y),r=t.next,c=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,c.next=i,i.prev=c,i}function bb(t,e,n,i){var r=new l_(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Od(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function l_(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Am.deviation=function(t,e,n,i){var r=e&&e.length,c=r?e[0]*n:t.length,p=Math.abs(c_(t,0,c,n));if(r)for(var a=0,T=e.length;a<T;a++){var k=e[a]*n,z=a<T-1?e[a+1]*n:t.length;p-=Math.abs(c_(t,k,z,n))}var B=0;for(a=0;a<i.length;a+=3){var D=i[a]*n,K=i[a+1]*n,ee=i[a+2]*n;B+=Math.abs((t[D]-t[ee])*(t[K+1]-t[D+1])-(t[D]-t[K])*(t[ee+1]-t[D+1]))}return p===0&&B===0?0:Math.abs((B-p)/p)};function c_(t,e,n,i){for(var r=0,c=e,p=n-i;c<n;c+=i)r+=(t[p]-t[c])*(t[c+1]+t[p+1]),p=c;return r}Am.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var c=0;c<t[r].length;c++)for(var p=0;p<e;p++)n.vertices.push(t[r][c][p]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var fF=qy.exports;const hF=fm(fF),u0=I6.CLOCKWISE,Eb=I6.COUNTER_CLOCKWISE,ic={isClosed:!0};function dF(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function cd(t){return"positions"in t?t.positions:t}function G0(t){return"holeIndices"in t?t.holeIndices:null}function AF(t){return Array.isArray(t[0])}function pF(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function mF(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function gF(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}function Tb(t,e,n,i,r){let c=e;const p=n.length;for(let a=0;a<p;a++)for(let T=0;T<i;T++)t[c++]=n[a][T]||0;if(!mF(n))for(let a=0;a<i;a++)t[c++]=n[0][a]||0;return ic.start=e,ic.end=c,ic.size=i,C6(t,r,ic),c}function Sb(t,e,n,i,r=0,c,p){c=c||n.length;const a=c-r;if(a<=0)return e;let T=e;for(let k=0;k<a;k++)t[T++]=n[r+k];if(!gF(n,i,r,c))for(let k=0;k<i;k++)t[T++]=n[r+k];return ic.start=e,ic.end=T,ic.size=i,C6(t,p,ic),T}function _F(t,e){dF(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:c}=t;if(c){let p=0;for(let a=0;a<=c.length;a++)p=Sb(n,p,r,e,c[a-1],c[a],a===0?u0:Eb),i.push(p);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!AF(t))return Sb(n,0,t,e,0,n.length,u0),n;if(!pF(t)){let r=0;for(const[c,p]of t.entries())r=Tb(n,r,p,e,c===0?u0:Eb),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return Tb(n,0,t,e,u0),n}function Xg(t,e,n){const i=t.length/3;let r=0;for(let c=0;c<i;c++){const p=(c+1)%i;r+=t[c*3+e]*t[p*3+n],r-=t[p*3+e]*t[c*3+n]}return Math.abs(r/2)}function Mb(t,e,n,i){const r=t.length/3;for(let c=0;c<r;c++){const p=c*3,a=t[p+0],T=t[p+1],k=t[p+2];t[p+e]=a,t[p+n]=T,t[p+i]=k}}function yF(t,e,n,i){let r=G0(t);r&&(r=r.map(a=>a/e));let c=cd(t);const p=i&&e===3;if(n){const a=c.length;c=c.slice();const T=[];for(let k=0;k<a;k+=e){T[0]=c[k],T[1]=c[k+1],p&&(T[2]=c[k+2]);const z=n(T);c[k]=z[0],c[k+1]=z[1],p&&(c[k+2]=z[2])}}if(p){const a=Xg(c,0,1),T=Xg(c,0,2),k=Xg(c,1,2);if(!a&&!T&&!k)return[];a>T&&a>k||(T>k?(n||(c=c.slice()),Mb(c,0,2,1)):(n||(c=c.slice()),Mb(c,2,0,1)))}return hF(c,r,e)}class vF extends lO{constructor(e){const{fp64:n,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=_F(e,this.positionSize);return this.opts.resolution?k6(cd(n),G0(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?$O(cd(n),G0(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(Ib(e)){let n=0;for(const i of e)n+=this.getGeometrySize(i);return n}return cd(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&Ib(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:i,indexStart:r}){const{attributes:c,indexStarts:p,typedArrayManager:a}=this;let T=c.indices;if(!T||!e)return;let k=r;const z=yF(e,this.positionSize,this.opts.preproject,this.opts.full3d);T=a.allocate(T,r+z.length,{copy:!0});for(let B=0;B<z.length;B++)T[k++]=z[B]+i;p[n+1]=r+z.length,c.indices=T}_updatePositions(e,{vertexStart:n,geometrySize:i}){const{attributes:{positions:r},positionSize:c}=this;if(!r||!e)return;const p=cd(e);for(let a=n,T=0;T<i;a++,T++){const k=p[T*c],z=p[T*c+1],B=c>2?p[T*c+2]:0;r[a*3]=k,r[a*3+1]=z,r[a*3+2]=B}}_updateVertexValid(e,{vertexStart:n,geometrySize:i}){const{positionSize:r}=this,c=this.attributes.vertexValid,p=e&&G0(e);if(e&&e.edgeTypes?c.set(e.edgeTypes,n):c.fill(1,n,n+i),p)for(let a=0;a<p.length;a++)c[n+p[a]/r-1]=0;c[n+i-1]=0}}function Ib(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const D6=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,xF=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(D6,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),wF=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(D6,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),bF=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,vp=[0,0,0,255],EF={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:vp},getLineColor:{type:"accessor",value:vp},material:!0},f0={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class mm extends _h{constructor(...e){super(...e),ae(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?xF:wF,fs:bF,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[i6,IL,r6]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:i}=this.props;const{_full3d:r}=this.props;n.isGeospatial&&i===Un.DEFAULT&&(i=Un.LNGLAT);let c;i===Un.LNGLAT&&(r?c=n.projectPosition.bind(n):c=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new vF({preproject:c,fp64:this.use64bitPositions(),IndexType:!e||Iy(e,hi.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const p=this.getAttributeManager(),a=!0;p.remove(["instancePickingColors"]),p.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:a},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:f0,accessor:"getPolygon",update:this.calculatePositions,noAlloc:a,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:a},elevations:{size:1,transition:f0,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:f0,accessor:"getFillColor",defaultValue:vp,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:f0,accessor:"getLineColor",defaultValue:vp,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(T,{index:k,target:z})=>this.encodePickingColor(T&&T.__source?T.__source.index:k,z),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(c=>c.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:i,wireframe:r,elevationScale:c}=this.props,{topModel:p,sideModel:a,polygonTesselator:T}=this.state,k={...e,extruded:!!n,elevationScale:c};a&&(a.setInstanceCount(T.instanceCount-1),a.setUniforms(k),r&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),i&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),p&&(p.setVertexCount(T.vertexCount),p.setUniforms(k).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:i,changeFlags:r}=e,c=this.getAttributeManager();if(r.extensionsChanged||n.filled!==i.filled||n.extruded!==i.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(T=>T.delete()),this.setState(this._getModels(this.context.gl)),c.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:c}=this.state,p=e.data.attributes||{};c.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:p.getPolygon,buffers:p,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:e._full3d}),this.setState({numInstances:c.instanceCount,startIndices:c.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:i,extruded:r}=this.props;let c,p;if(i){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,c=new fp(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(p=new fp(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new U0({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),p.userData.excludeAttributes={indices:!0}),{models:[p,c].filter(Boolean),topModel:c,sideModel:p}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}ae(mm,"defaultProps",EF);ae(mm,"layerName","SolidPolygonLayer");var z6={exports:{}},Fn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yA=Symbol.for("react.element"),TF=Symbol.for("react.portal"),SF=Symbol.for("react.fragment"),MF=Symbol.for("react.strict_mode"),IF=Symbol.for("react.profiler"),CF=Symbol.for("react.provider"),kF=Symbol.for("react.context"),PF=Symbol.for("react.forward_ref"),LF=Symbol.for("react.suspense"),RF=Symbol.for("react.memo"),DF=Symbol.for("react.lazy"),Cb=Symbol.iterator;function zF(t){return t===null||typeof t!="object"?null:(t=Cb&&t[Cb]||t["@@iterator"],typeof t=="function"?t:null)}var B6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O6=Object.assign,F6={};function vh(t,e,n){this.props=t,this.context=e,this.refs=F6,this.updater=n||B6}vh.prototype.isReactComponent={};vh.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vh.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function N6(){}N6.prototype=vh.prototype;function Qy(t,e,n){this.props=t,this.context=e,this.refs=F6,this.updater=n||B6}var Xy=Qy.prototype=new N6;Xy.constructor=Qy;O6(Xy,vh.prototype);Xy.isPureReactComponent=!0;var kb=Array.isArray,U6=Object.prototype.hasOwnProperty,Yy={current:null},V6={key:!0,ref:!0,__self:!0,__source:!0};function j6(t,e,n){var i,r={},c=null,p=null;if(e!=null)for(i in e.ref!==void 0&&(p=e.ref),e.key!==void 0&&(c=""+e.key),e)U6.call(e,i)&&!V6.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var T=Array(a),k=0;k<a;k++)T[k]=arguments[k+2];r.children=T}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:yA,type:t,key:c,ref:p,props:r,_owner:Yy.current}}function BF(t,e){return{$$typeof:yA,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ky(t){return typeof t=="object"&&t!==null&&t.$$typeof===yA}function OF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Pb=/\/+/g;function Yg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?OF(""+t.key):e.toString(36)}function H0(t,e,n,i,r){var c=typeof t;(c==="undefined"||c==="boolean")&&(t=null);var p=!1;if(t===null)p=!0;else switch(c){case"string":case"number":p=!0;break;case"object":switch(t.$$typeof){case yA:case TF:p=!0}}if(p)return p=t,r=r(p),t=i===""?"."+Yg(p,0):i,kb(r)?(n="",t!=null&&(n=t.replace(Pb,"$&/")+"/"),H0(r,e,n,"",function(k){return k})):r!=null&&(Ky(r)&&(r=BF(r,n+(!r.key||p&&p.key===r.key?"":(""+r.key).replace(Pb,"$&/")+"/")+t)),e.push(r)),1;if(p=0,i=i===""?".":i+":",kb(t))for(var a=0;a<t.length;a++){c=t[a];var T=i+Yg(c,a);p+=H0(c,e,n,T,r)}else if(T=zF(t),typeof T=="function")for(t=T.call(t),a=0;!(c=t.next()).done;)c=c.value,T=i+Yg(c,a++),p+=H0(c,e,n,T,r);else if(c==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return p}function h0(t,e,n){if(t==null)return t;var i=[],r=0;return H0(t,i,"","",function(c){return e.call(n,c,r++)}),i}function FF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ho={current:null},$0={transition:null},NF={ReactCurrentDispatcher:ho,ReactCurrentBatchConfig:$0,ReactCurrentOwner:Yy};Fn.Children={map:h0,forEach:function(t,e,n){h0(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return h0(t,function(){e++}),e},toArray:function(t){return h0(t,function(e){return e})||[]},only:function(t){if(!Ky(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Fn.Component=vh;Fn.Fragment=SF;Fn.Profiler=IF;Fn.PureComponent=Qy;Fn.StrictMode=MF;Fn.Suspense=LF;Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NF;Fn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=O6({},t.props),r=t.key,c=t.ref,p=t._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,p=Yy.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(T in e)U6.call(e,T)&&!V6.hasOwnProperty(T)&&(i[T]=e[T]===void 0&&a!==void 0?a[T]:e[T])}var T=arguments.length-2;if(T===1)i.children=n;else if(1<T){a=Array(T);for(var k=0;k<T;k++)a[k]=arguments[k+2];i.children=a}return{$$typeof:yA,type:t.type,key:r,ref:c,props:i,_owner:p}};Fn.createContext=function(t){return t={$$typeof:kF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:CF,_context:t},t.Consumer=t};Fn.createElement=j6;Fn.createFactory=function(t){var e=j6.bind(null,t);return e.type=t,e};Fn.createRef=function(){return{current:null}};Fn.forwardRef=function(t){return{$$typeof:PF,render:t}};Fn.isValidElement=Ky;Fn.lazy=function(t){return{$$typeof:DF,_payload:{_status:-1,_result:t},_init:FF}};Fn.memo=function(t,e){return{$$typeof:RF,type:t,compare:e===void 0?null:e}};Fn.startTransition=function(t){var e=$0.transition;$0.transition={};try{t()}finally{$0.transition=e}};Fn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Fn.useCallback=function(t,e){return ho.current.useCallback(t,e)};Fn.useContext=function(t){return ho.current.useContext(t)};Fn.useDebugValue=function(){};Fn.useDeferredValue=function(t){return ho.current.useDeferredValue(t)};Fn.useEffect=function(t,e){return ho.current.useEffect(t,e)};Fn.useId=function(){return ho.current.useId()};Fn.useImperativeHandle=function(t,e,n){return ho.current.useImperativeHandle(t,e,n)};Fn.useInsertionEffect=function(t,e){return ho.current.useInsertionEffect(t,e)};Fn.useLayoutEffect=function(t,e){return ho.current.useLayoutEffect(t,e)};Fn.useMemo=function(t,e){return ho.current.useMemo(t,e)};Fn.useReducer=function(t,e,n){return ho.current.useReducer(t,e,n)};Fn.useRef=function(t){return ho.current.useRef(t)};Fn.useState=function(t){return ho.current.useState(t)};Fn.useSyncExternalStore=function(t,e,n){return ho.current.useSyncExternalStore(t,e,n)};Fn.useTransition=function(){return ho.current.useTransition()};Fn.version="18.2.0";z6.exports=Fn;var Dt=z6.exports;const ud=fm(Dt),UF=typeof window<"u"?Dt.useLayoutEffect:Dt.useEffect,VF=UF;function xp(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const jF={position:"absolute",zIndex:-1};function G6(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>G6(n,e));if(gm(t)){if(GF(t))return e.style=jF,Dt.cloneElement(t,e);if(HF(t))return Dt.cloneElement(t,e)}return t}function gm(t){return t&&typeof t=="object"&&"type"in t||!1}function GF(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function HF(t){const e=t.type;return e&&e.deckGLViewProps}function u_(t){if(typeof t=="function")return Dt.createElement(oh,{},t);if(Array.isArray(t))return t.map(u_);if(gm(t)){if(t.type===Dt.Fragment)return u_(t.props.children);if(xp(t.type,oh))return t}return t}function $F({children:t,layers:e=[],views:n=null}){const i=[],r=[],c={};return Dt.Children.forEach(u_(t),p=>{if(gm(p)){const a=p.type;if(xp(a,_h)){const T=WF(a,p.props);r.push(T)}else i.push(p);if(xp(a,oh)&&a!==oh&&p.props.id){const T=new a(p.props);c[T.id]=T}}else p&&i.push(p)}),Object.keys(c).length>0&&(Array.isArray(n)?n.forEach(p=>{c[p.id]=p}):n&&(c[n.id]=n),n=Object.values(c)),e=r.length>0?[...r,...e]:e,{layers:e,children:i,views:n}}function WF(t,e){const n={},i=t.defaultProps||{};for(const r in e)i[r]!==e[r]&&(n[r]=e[r]);return new t(n)}function ZF({children:t,deck:e,ContextProvider:n}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const r={},c=i.views[0].id;for(const p of t){let a=c,T=p;gm(p)&&xp(p.type,oh)&&(a=p.props.id||c,T=p.props.children);const k=i.getViewport(a),z=i.getViewState(a);if(k){z.padding=k.padding;const{x:B,y:D,width:K,height:ee}=k;T=G6(T,{x:B,y:D,width:K,height:ee,viewport:k,viewState:z}),r[a]||(r[a]={viewport:k,children:[]}),r[a].children.push(T)}}return Object.keys(r).map(p=>{const{viewport:a,children:T}=r[p],{x:k,y:z,width:B,height:D}=a,K={position:"absolute",left:k,top:z,width:B,height:D},ee="view-".concat(p),le=Dt.createElement("div",{key:ee,id:ee,style:K},...T);if(n){const Ce={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:se=>{se.viewId=p,e._onViewStateChange(se)}};return Dt.createElement(n,{key:ee,value:Ce},le)}return le})}const qF={mixBlendMode:null};function QF({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const c in n)c in qF?r[c]=n[c]:i[c]=n[c];return{containerStyle:i,canvasStyle:r}}function XF(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function H6(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function YF(t,e,n){const i=new e({...n,_customRender:r=>{t.redrawReason=r;const c=i.getViewports();t.lastRenderedViewports!==c?t.forceUpdate():H6(t)}});return i}const $6=Dt.forwardRef((t,e)=>{const[n,i]=Dt.useState(0),c=Dt.useRef({control:null,version:n,forceUpdate:()=>i(Le=>Le+1)}).current,p=Dt.useRef(null),a=Dt.useRef(null),T=Dt.useMemo(()=>$F(t),[t.layers,t.views,t.children]);let k=!0;const z=Le=>{var Ge;return k&&t.viewState?(c.viewStateUpdateRequested=Le,null):(c.viewStateUpdateRequested=null,(Ge=t.onViewStateChange)===null||Ge===void 0?void 0:Ge.call(t,Le))},B=Le=>{if(k)c.interactionStateUpdateRequested=Le;else{var Ge;c.interactionStateUpdateRequested=null,(Ge=t.onInteractionStateChange)===null||Ge===void 0||Ge.call(t,Le)}},D=Dt.useMemo(()=>{const Le={...t,style:null,width:"100%",height:"100%",parent:p.current,canvas:a.current,layers:T.layers,views:T.views,onViewStateChange:z,onInteractionStateChange:B};return delete Le._customRender,c.deck&&c.deck.setProps(Le),Le},[t]);Dt.useEffect(()=>{const Le=t.Deck||dm;return c.deck=YF(c,Le,{...D,parent:p.current,canvas:a.current}),()=>{var Ge;return(Ge=c.deck)===null||Ge===void 0?void 0:Ge.finalize()}},[]),VF(()=>{H6(c);const{viewStateUpdateRequested:Le,interactionStateUpdateRequested:Ge}=c;Le&&z(Le),Ge&&B(Ge)}),Dt.useImperativeHandle(e,()=>XF(c),[]);const K=c.deck&&c.deck.isInitialized?c.deck.getViewports():void 0,{ContextProvider:ee,width:le,height:Ce,id:se,style:ne}=t,{containerStyle:te,canvasStyle:xe}=Dt.useMemo(()=>QF({width:le,height:Ce,style:ne}),[le,Ce,ne]);if(!c.viewStateUpdateRequested&&c.lastRenderedViewports===K||c.version!==n){c.lastRenderedViewports=K,c.version=n;const Le=ZF({children:T.children,deck:c.deck,ContextProvider:ee}),Ge=Dt.createElement("canvas",{key:"canvas",id:se||"deckgl-overlay",ref:a,style:xe});c.control=Dt.createElement("div",{id:"".concat(se||"deckgl","-wrapper"),ref:p,style:te},[Ge,Le])}return k=!1,c.control});$6.defaultProps=dm.defaultProps;const KF=$6;var W6={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(hz,function(){var n,i,r;function c(a,T){if(!n)n=T;else if(!i)i=T;else{var k="var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk);",z={};n(z),r=T(z),typeof window<"u"&&(r.workerUrl=window.URL.createObjectURL(new Blob([k],{type:"text/javascript"})))}}c(["exports"],function(a){var T=k;function k(l,o,u,g){this.cx=3*l,this.bx=3*(u-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(g-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=o,this.p2x=u,this.p2y=g}function z(l,o,u,g){const b=new T(l,o,u,g);return function(S){return b.solve(S)}}k.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,o){if(o===void 0&&(o=1e-6),l<0)return 0;if(l>1)return 1;for(var u=l,g=0;g<8;g++){var b=this.sampleCurveX(u)-l;if(Math.abs(b)<o)return u;var S=this.sampleCurveDerivativeX(u);if(Math.abs(S)<1e-6)break;u-=b/S}var C=0,R=1;for(u=l,g=0;g<20&&(b=this.sampleCurveX(u),!(Math.abs(b-l)<o));g++)l>b?C=u:R=u,u=.5*(R-C)+C;return u},solve:function(l,o){return this.sampleCurveY(this.solveCurveX(l,o))}};const B=z(.25,.1,.25,1);function D(l,o,u){return Math.min(u,Math.max(o,l))}function K(l,o,u){const g=u-o,b=((l-o)%g+g)%g+o;return b===o?u:b}function ee(l,...o){for(const u of o)for(const g in u)l[g]=u[g];return l}let le=1;function Ce(l,o){l.forEach(u=>{o[u]&&(o[u]=o[u].bind(o))})}function se(l,o,u){const g={};for(const b in l)g[b]=o.call(u||this,l[b],b,l);return g}function ne(l,o,u){const g={};for(const b in l)o.call(u||this,l[b],b,l)&&(g[b]=l[b]);return g}function te(l){return Array.isArray(l)?l.map(te):typeof l=="object"&&l?se(l,te):l}const xe={};function Le(l){xe[l]||(typeof console<"u"&&console.warn(l),xe[l]=!0)}function Ge(l,o,u){return(u.y-l.y)*(o.x-l.x)>(o.y-l.y)*(u.x-l.x)}function nt(l){let o=0;for(let u,g,b=0,S=l.length,C=S-1;b<S;C=b++)u=l[b],g=l[C],o+=(g.x-u.x)*(u.y+g.y);return o}function it(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function dt(l){const o={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,g,b,S)=>{const C=b||S;return o[g]=!C||C.toLowerCase(),""}),o["max-age"]){const u=parseInt(o["max-age"],10);isNaN(u)?delete o["max-age"]:o["max-age"]=u}return o}let ct,Xe,Bt=null;function Rt(l){if(Bt==null){const o=l.navigator?l.navigator.userAgent:null;Bt=!!l.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Bt}function jt(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap}const _n={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(l){const o=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(l,o=0){const u=window.document.createElement("canvas"),g=u.getContext("2d");if(!g)throw new Error("failed to create canvas 2d context");return u.width=l.width,u.height=l.height,g.drawImage(l,0,0,l.width,l.height),g.getImageData(-o,-o,l.width+2*o,l.height+2*o)},resolveURL:l=>(ct||(ct=document.createElement("a")),ct.href=l,ct.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Xe==null&&(Xe=matchMedia("(prefers-reduced-motion: reduce)")),Xe.matches)}};var Mt=Sn;function Sn(l,o){this.x=l,this.y=o}Sn.prototype={clone:function(){return new Sn(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,o){return this.clone()._rotateAround(l,o)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var o=l.x-this.x,u=l.y-this.y;return o*o+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,o){return Math.atan2(this.x*o-this.y*l,this.x*l+this.y*o)},_matMult:function(l){var o=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=o,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var o=Math.cos(l),u=Math.sin(l),g=u*this.x+o*this.y;return this.x=o*this.x-u*this.y,this.y=g,this},_rotateAround:function(l,o){var u=Math.cos(l),g=Math.sin(l),b=o.y+g*(this.x-o.x)+u*(this.y-o.y);return this.x=o.x+u*(this.x-o.x)-g*(this.y-o.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Sn.convert=function(l){return l instanceof Sn?l:Array.isArray(l)?new Sn(l[0],l[1]):l};const pt={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},It="mapbox-tiles";let Jt,kn,Mn=500,ri=50;function oi(){typeof caches>"u"||Jt||(Jt=caches.open(It))}let Ri=1/0;const Ai={supported:!1,testSupport:function(l){!yn&&Di&&(qn?Xi(l):Nn=l)}};let Nn,Di,yn=!1,qn=!1;function Xi(l){const o=l.createTexture();l.bindTexture(l.TEXTURE_2D,o);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,Di),l.isContextLost())return;Ai.supported=!0}catch{}l.deleteTexture(o),yn=!0}typeof document<"u"&&(Di=document.createElement("img"),Di.onload=function(){Nn&&Xi(Nn),Nn=null,qn=!0},Di.onerror=function(){yn=!0,Nn=null},Di.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const pi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(pi);class Si extends Error{constructor(o,u,g,b){super(`AJAXError: ${u} (${o}): ${g}`),this.status=o,this.statusText=u,this.url=g,this.body=b}}const Qr=it()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function hr(l,o){const u=new AbortController,g=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:Qr(),signal:u.signal});let b=!1,S=!1;return l.type==="json"&&g.headers.set("Accept","application/json"),((C,R,F)=>{if(S)return;const j=Date.now();fetch(g).then(Z=>Z.ok?((Y,re,fe)=>{(l.type==="arrayBuffer"?Y.arrayBuffer():l.type==="json"?Y.json():Y.text()).then(he=>{S||(re&&fe&&function(Pe,Se,Ue){if(oi(),!Jt)return;const Qe={status:Se.status,statusText:Se.statusText,headers:new Headers};Se.headers.forEach((We,at)=>Qe.headers.set(at,We));const Oe=dt(Se.headers.get("Cache-Control")||"");Oe["no-store"]||(Oe["max-age"]&&Qe.headers.set("Expires",new Date(Ue+1e3*Oe["max-age"]).toUTCString()),new Date(Qe.headers.get("Expires")).getTime()-Ue<42e4||function(We,at){if(kn===void 0)try{new Response(new ReadableStream),kn=!0}catch{kn=!1}kn?at(We.body):We.blob().then(at)}(Se,We=>{const at=new Response(We,Qe);oi(),Jt&&Jt.then(st=>st.put(function(Lt){const Nt=Lt.indexOf("?");return Nt<0?Lt:Lt.slice(0,Nt)}(Pe.url),at)).catch(st=>Le(st.message))}))}(g,re,fe),b=!0,o(null,he,Y.headers.get("Cache-Control"),Y.headers.get("Expires")))}).catch(he=>{S||o(new Error(he.message))})})(Z,null,j):Z.blob().then(Y=>o(new Si(Z.status,Z.statusText,l.url,Y)))).catch(Z=>{Z.code!==20&&o(new Error(Z.message))})})(),{cancel:()=>{S=!0,b||u.abort()}}}const Gi=function(l,o){if(/:\/\//.test(l.url)&&!/^https?:|^file:/.test(l.url)){if(it()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,o);if(!it()){const g=l.url.substring(0,l.url.indexOf("://"));return(pt.REGISTERED_PROTOCOLS[g]||hr)(l,o)}}if(!(/^file:/.test(u=l.url)||/^file:/.test(Qr())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return hr(l,o);if(it()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,o,void 0,!0)}var u;return function(g,b){const S=new XMLHttpRequest;S.open(g.method||"GET",g.url,!0),g.type==="arrayBuffer"&&(S.responseType="arraybuffer");for(const C in g.headers)S.setRequestHeader(C,g.headers[C]);return g.type==="json"&&(S.responseType="text",S.setRequestHeader("Accept","application/json")),S.withCredentials=g.credentials==="include",S.onerror=()=>{b(new Error(S.statusText))},S.onload=()=>{if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let C=S.response;if(g.type==="json")try{C=JSON.parse(S.response)}catch(R){return b(R)}b(null,C,S.getResponseHeader("Cache-Control"),S.getResponseHeader("Expires"))}else{const C=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});b(new Si(S.status,S.statusText,g.url,C))}},S.send(g.body),{cancel:()=>S.abort()}}(l,o)},xi=function(l,o){return Gi(ee(l,{type:"arrayBuffer"}),o)};function Dr(l){const o=window.document.createElement("a");return o.href=l,o.protocol===window.document.location.protocol&&o.host===window.document.location.host}const bn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ir,Vn;ir=[],Vn=0;const zr=function(l,o){if(Ai.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),Vn>=pt.MAX_PARALLEL_IMAGE_REQUESTS){const S={requestParameters:l,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return ir.push(S),S}Vn++;let u=!1;const g=()=>{if(!u)for(u=!0,Vn--;ir.length&&Vn<pt.MAX_PARALLEL_IMAGE_REQUESTS;){const S=ir.shift(),{requestParameters:C,callback:R,cancelled:F}=S;F||(S.cancel=zr(C,R).cancel)}},b=xi(l,(S,C,R,F)=>{g(),S?o(S):C&&function(j,Z){typeof createImageBitmap=="function"?function(Y,re){const fe=new Blob([new Uint8Array(Y)],{type:"image/png"});createImageBitmap(fe).then(he=>{re(null,he)}).catch(he=>{re(new Error(`Could not load image because of ${he.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(j,Z):function(Y,re){const fe=new Image;fe.onload=()=>{re(null,fe),URL.revokeObjectURL(fe.src),fe.onload=null,window.requestAnimationFrame(()=>{fe.src=bn})},fe.onerror=()=>re(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const he=new Blob([new Uint8Array(Y)],{type:"image/png"});fe.src=Y.byteLength?URL.createObjectURL(he):bn}(j,Z)}(C,(j,Z)=>{j!=null?o(j):Z!=null&&o(null,Z,{cacheControl:R,expires:F})})});return{cancel:()=>{b.cancel(),g()}}};function ns(l,o,u){u[l]&&u[l].indexOf(o)!==-1||(u[l]=u[l]||[],u[l].push(o))}function Yi(l,o,u){if(u&&u[l]){const g=u[l].indexOf(o);g!==-1&&u[l].splice(g,1)}}class wr{constructor(o,u={}){ee(this,u),this.type=o}}class is extends wr{constructor(o,u={}){super("error",ee({error:o},u))}}class Br{on(o,u){return this._listeners=this._listeners||{},ns(o,u,this._listeners),this}off(o,u){return Yi(o,u,this._listeners),Yi(o,u,this._oneTimeListeners),this}once(o,u){return this._oneTimeListeners=this._oneTimeListeners||{},ns(o,u,this._oneTimeListeners),this}fire(o,u){typeof o=="string"&&(o=new wr(o,u||{}));const g=o.type;if(this.listens(g)){o.target=this;const b=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const R of b)R.call(this,o);const S=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const R of S)Yi(g,R,this._oneTimeListeners),R.call(this,o);const C=this._eventedParent;C&&(ee(o,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(o))}else o instanceof is&&console.error(o.error);return this}listens(o){return this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o)}setEventedParent(o,u){return this._eventedParent=o,this._eventedParentData=u,this}}var et={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class gt{constructor(o,u,g,b){this.message=(o?`${o}: `:"")+g,b&&(this.identifier=b),u!=null&&u.__line__&&(this.line=u.__line__)}}function po(l){const o=l.value;return o?[new gt(l.key,o,"constants have been deprecated as of v8")]:[]}function Ki(l,...o){for(const u of o)for(const g in u)l[g]=u[g];return l}function vn(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function dr(l){if(Array.isArray(l))return l.map(dr);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const o={};for(const u in l)o[u]=dr(l[u]);return o}return vn(l)}class rr extends Error{constructor(o,u){super(u),this.message=u,this.key=o}}class or{constructor(o,u=[]){this.parent=o,this.bindings={};for(const[g,b]of u)this.bindings[g]=b}concat(o){return new or(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const Xr={kind:"null"},_t={kind:"number"},ln={kind:"string"},an={kind:"boolean"},mi={kind:"color"},Yr={kind:"object"},rn={kind:"value"},ft={kind:"collator"},wi={kind:"formatted"},Co={kind:"padding"},ai={kind:"resolvedImage"};function zi(l,o){return{kind:"array",itemType:l,N:o}}function Pn(l){if(l.kind==="array"){const o=Pn(l.itemType);return typeof l.N=="number"?`array<${o}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${o}>`}return l.kind}const ko=[Xr,_t,ln,an,mi,wi,Yr,zi(rn),Co,ai];function br(l,o){if(o.kind==="error")return null;if(l.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!br(l.itemType,o.itemType))&&(typeof l.N!="number"||l.N===o.N))return null}else{if(l.kind===o.kind)return null;if(l.kind==="value"){for(const u of ko)if(!br(u,o))return null}}return`Expected ${Pn(l)} but found ${Pn(o)} instead.`}function Er(l,o){return o.some(u=>u.kind===l.kind)}function Or(l,o){return o.some(u=>u==="null"?l===null:u==="array"?Array.isArray(l):u==="object"?l&&!Array.isArray(l)&&typeof l=="object":u===typeof l)}var mo,Ji={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function q(l){return(l=Math.round(l))<0?0:l>255?255:l}function U(l){return q(l[l.length-1]==="%"?parseFloat(l)/100*255:parseInt(l))}function W(l){return(o=l[l.length-1]==="%"?parseFloat(l)/100:parseFloat(l))<0?0:o>1?1:o;var o}function ie(l,o,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?l+(o-l)*u*6:2*u<1?o:3*u<2?l+(o-l)*(2/3-u)*6:l}try{mo={}.parseCSSColor=function(l){var o,u=l.replace(/ /g,"").toLowerCase();if(u in Ji)return Ji[u].slice();if(u[0]==="#")return u.length===4?(o=parseInt(u.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:u.length===7&&(o=parseInt(u.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var g=u.indexOf("("),b=u.indexOf(")");if(g!==-1&&b+1===u.length){var S=u.substr(0,g),C=u.substr(g+1,b-(g+1)).split(","),R=1;switch(S){case"rgba":if(C.length!==4)return null;R=W(C.pop());case"rgb":return C.length!==3?null:[U(C[0]),U(C[1]),U(C[2]),R];case"hsla":if(C.length!==4)return null;R=W(C.pop());case"hsl":if(C.length!==3)return null;var F=(parseFloat(C[0])%360+360)%360/360,j=W(C[1]),Z=W(C[2]),Y=Z<=.5?Z*(j+1):Z+j-Z*j,re=2*Z-Y;return[q(255*ie(re,Y,F+1/3)),q(255*ie(re,Y,F)),q(255*ie(re,Y,F-1/3)),R];default:return null}}return null}}catch{}class f{constructor(o,u,g,b=1){this.r=o,this.g=u,this.b=g,this.a=b}static parse(o){if(!o)return;if(o instanceof f)return o;if(typeof o!="string")return;const u=mo(o);return u?new f(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[o,u,g,b]=this.toArray();return`rgba(${Math.round(o)},${Math.round(u)},${Math.round(g)},${b})`}toArray(){const{r:o,g:u,b:g,a:b}=this;return b===0?[0,0,0,0]:[255*o/b,255*u/b,255*g/b,b]}}f.black=new f(0,0,0,1),f.white=new f(1,1,1,1),f.transparent=new f(0,0,0,0),f.red=new f(1,0,0,1);class H{constructor(o,u,g){this.sensitivity=o?u?"variant":"case":u?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,u){return this.collator.compare(o,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ke{constructor(o,u,g,b,S){this.text=o,this.image=u,this.scale=g,this.fontStack=b,this.textColor=S}}class Te{constructor(o){this.sections=o}static fromString(o){return new Te([new ke(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||o.image&&o.image.name.length!==0)}static factory(o){return o instanceof Te?o:Te.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}}class we{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof we)return o;if(typeof o=="number")return new we([o,o,o,o]);if(Array.isArray(o)&&!(o.length<1||o.length>4)){for(const u of o)if(typeof u!="number")return;switch(o.length){case 1:o=[o[0],o[0],o[0],o[0]];break;case 2:o=[o[0],o[1],o[0],o[1]];break;case 3:o=[o[0],o[1],o[2],o[1]]}return new we(o)}}toString(){return JSON.stringify(this.values)}}class Me{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Me({name:o,available:!1}):null}}function Fe(l,o,u,g){return typeof l=="number"&&l>=0&&l<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof u=="number"&&u>=0&&u<=255?g===void 0||typeof g=="number"&&g>=0&&g<=1?null:`Invalid rgba value [${[l,o,u,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof g=="number"?[l,o,u,g]:[l,o,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function rt(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof f||l instanceof H||l instanceof Te||l instanceof we||l instanceof Me)return!0;if(Array.isArray(l)){for(const o of l)if(!rt(o))return!1;return!0}if(typeof l=="object"){for(const o in l)if(!rt(l[o]))return!1;return!0}return!1}function Ne(l){if(l===null)return Xr;if(typeof l=="string")return ln;if(typeof l=="boolean")return an;if(typeof l=="number")return _t;if(l instanceof f)return mi;if(l instanceof H)return ft;if(l instanceof Te)return wi;if(l instanceof we)return Co;if(l instanceof Me)return ai;if(Array.isArray(l)){const o=l.length;let u;for(const g of l){const b=Ne(g);if(u){if(u===b)continue;u=rn;break}u=b}return zi(u||rn,o)}return Yr}function lt(l){const o=typeof l;return l===null?"":o==="string"||o==="number"||o==="boolean"?String(l):l instanceof f||l instanceof Te||l instanceof we||l instanceof Me?l.toString():JSON.stringify(l)}class Tt{constructor(o,u){this.type=o,this.value=u}static parse(o,u){if(o.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!rt(o[1]))return u.error("invalid value");const g=o[1];let b=Ne(g);const S=u.expectedType;return b.kind!=="array"||b.N!==0||!S||S.kind!=="array"||typeof S.N=="number"&&S.N!==0||(b=S),new Tt(b,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class xt{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const $t={string:ln,number:_t,boolean:an,object:Yr};class Ft{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");let g,b=1;const S=o[0];if(S==="array"){let R,F;if(o.length>2){const j=o[1];if(typeof j!="string"||!(j in $t)||j==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);R=$t[j],b++}else R=rn;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return u.error('The length argument to "array" must be a positive integer literal',2);F=o[2],b++}g=zi(R,F)}else{if(!$t[S])throw new Error(`Types doesn't contain name = ${S}`);g=$t[S]}const C=[];for(;b<o.length;b++){const R=u.parse(o[b],b,rn);if(!R)return null;C.push(R)}return new Ft(g,C)}evaluate(o){for(let u=0;u<this.args.length;u++){const g=this.args[u].evaluate(o);if(!br(this.type,Ne(g)))return g;if(u===this.args.length-1)throw new xt(`Expected value to be of type ${Pn(this.type)}, but found ${Pn(Ne(g))} instead.`)}throw new Error}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const en={"to-boolean":an,"to-color":mi,"to-number":_t,"to-string":ln};class Gt{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");const g=o[0];if(!en[g])throw new Error(`Can't parse ${g} as it is not part of the known types`);if((g==="to-boolean"||g==="to-string")&&o.length!==2)return u.error("Expected one argument.");const b=en[g],S=[];for(let C=1;C<o.length;C++){const R=u.parse(o[C],C,rn);if(!R)return null;S.push(R)}return new Gt(b,S)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let u,g;for(const b of this.args){if(u=b.evaluate(o),g=null,u instanceof f)return u;if(typeof u=="string"){const S=o.parseColor(u);if(S)return S}else if(Array.isArray(u)&&(g=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:Fe(u[0],u[1],u[2],u[3]),!g))return new f(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new xt(g||`Could not parse color from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}if(this.type.kind==="padding"){let u;for(const g of this.args){u=g.evaluate(o);const b=we.parse(u);if(b)return b}throw new xt(`Could not parse padding from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}if(this.type.kind==="number"){let u=null;for(const g of this.args){if(u=g.evaluate(o),u===null)return 0;const b=Number(u);if(!isNaN(b))return b}throw new xt(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?Te.fromString(lt(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?Me.fromString(lt(this.args[0].evaluate(o))):lt(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const Wt=["Unknown","Point","LineString","Polygon"];class dn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Wt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(o){let u=this._parseColorCache[o];return u||(u=this._parseColorCache[o]=f.parse(o)),u}}class wn{constructor(o,u,g,b){this.name=o,this.type=u,this._evaluate=g,this.args=b}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}static parse(o,u){const g=o[0],b=wn.definitions[g];if(!b)return u.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const S=Array.isArray(b)?b[0]:b.type,C=Array.isArray(b)?[[b[1],b[2]]]:b.overloads,R=C.filter(([j])=>!Array.isArray(j)||j.length===o.length-1);let F=null;for(const[j,Z]of R){F=new ht(u.registry,u.path,null,u.scope);const Y=[];let re=!1;for(let fe=1;fe<o.length;fe++){const he=o[fe],Pe=Array.isArray(j)?j[fe-1]:j.type,Se=F.parse(he,1+Y.length,Pe);if(!Se){re=!0;break}Y.push(Se)}if(!re)if(Array.isArray(j)&&j.length!==Y.length)F.error(`Expected ${j.length} arguments, but found ${Y.length} instead.`);else{for(let fe=0;fe<Y.length;fe++){const he=Array.isArray(j)?j[fe]:j.type,Pe=Y[fe];F.concat(fe+1).checkSubtype(he,Pe.type)}if(F.errors.length===0)return new wn(g,S,Z,Y)}}if(R.length===1)u.errors.push(...F.errors);else{const j=(R.length?R:C).map(([Y])=>{return re=Y,Array.isArray(re)?`(${re.map(Pn).join(", ")})`:`(${Pn(re.type)}...)`;var re}).join(" | "),Z=[];for(let Y=1;Y<o.length;Y++){const re=u.parse(o[Y],1+Z.length);if(!re)return null;Z.push(Pn(re.type))}u.error(`Expected arguments of type ${j}, but found (${Z.join(", ")}) instead.`)}return null}static register(o,u){wn.definitions=u;for(const g in u)o[g]=wn}}class Ln{constructor(o,u,g){this.type=ft,this.locale=g,this.caseSensitive=o,this.diacriticSensitive=u}static parse(o,u){if(o.length!==2)return u.error("Expected one argument.");const g=o[1];if(typeof g!="object"||Array.isArray(g))return u.error("Collator options argument must be an object.");const b=u.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,an);if(!b)return null;const S=u.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,an);if(!S)return null;let C=null;return g.locale&&(C=u.parse(g.locale,1,ln),!C)?null:new Ln(b,S,C)}evaluate(o){return new H(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}}const Ot=8192;function me(l,o){l[0]=Math.min(l[0],o[0]),l[1]=Math.min(l[1],o[1]),l[2]=Math.max(l[2],o[0]),l[3]=Math.max(l[3],o[1])}function Qt(l,o){return!(l[0]<=o[0]||l[2]>=o[2]||l[1]<=o[1]||l[3]>=o[3])}function Bi(l,o){const u=(180+l[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,b=Math.pow(2,o.z);return[Math.round(u*b*Ot),Math.round(g*b*Ot)]}function Rn(l,o,u){const g=l[0]-o[0],b=l[1]-o[1],S=l[0]-u[0],C=l[1]-u[1];return g*C-S*b==0&&g*S<=0&&b*C<=0}function Ss(l,o){let u=!1;for(let C=0,R=o.length;C<R;C++){const F=o[C];for(let j=0,Z=F.length;j<Z-1;j++){if(Rn(l,F[j],F[j+1]))return!1;(b=F[j])[1]>(g=l)[1]!=(S=F[j+1])[1]>g[1]&&g[0]<(S[0]-b[0])*(g[1]-b[1])/(S[1]-b[1])+b[0]&&(u=!u)}}var g,b,S;return u}function Ms(l,o){for(let u=0;u<o.length;u++)if(Ss(l,o[u]))return!0;return!1}function Xs(l,o,u,g){const b=g[0]-u[0],S=g[1]-u[1],C=(l[0]-u[0])*S-b*(l[1]-u[1]),R=(o[0]-u[0])*S-b*(o[1]-u[1]);return C>0&&R<0||C<0&&R>0}function Ae(l,o,u){for(const j of u)for(let Z=0;Z<j.length-1;++Z)if((R=[(C=j[Z+1])[0]-(S=j[Z])[0],C[1]-S[1]])[0]*(F=[(b=o)[0]-(g=l)[0],b[1]-g[1]])[1]-R[1]*F[0]!=0&&Xs(g,b,S,C)&&Xs(S,C,g,b))return!0;var g,b,S,C,R,F;return!1}function rs(l,o){for(let u=0;u<l.length;++u)if(!Ss(l[u],o))return!1;for(let u=0;u<l.length-1;++u)if(Ae(l[u],l[u+1],o))return!1;return!0}function Kr(l,o){for(let u=0;u<o.length;u++)if(rs(l,o[u]))return!0;return!1}function Ys(l,o,u){const g=[];for(let b=0;b<l.length;b++){const S=[];for(let C=0;C<l[b].length;C++){const R=Bi(l[b][C],u);me(o,R),S.push(R)}g.push(S)}return g}function Ks(l,o,u){const g=[];for(let b=0;b<l.length;b++){const S=Ys(l[b],o,u);g.push(S)}return g}function Js(l,o,u,g){if(l[0]<u[0]||l[0]>u[2]){const b=.5*g;let S=l[0]-u[0]>b?-g:u[0]-l[0]>b?g:0;S===0&&(S=l[0]-u[2]>b?-g:u[2]-l[0]>b?g:0),l[0]+=S}me(o,l)}function ka(l,o,u,g){const b=Math.pow(2,g.z)*Ot,S=[g.x*Ot,g.y*Ot],C=[];for(const R of l)for(const F of R){const j=[F.x+S[0],F.y+S[1]];Js(j,o,u,b),C.push(j)}return C}function Pa(l,o,u,g){const b=Math.pow(2,g.z)*Ot,S=[g.x*Ot,g.y*Ot],C=[];for(const F of l){const j=[];for(const Z of F){const Y=[Z.x+S[0],Z.y+S[1]];me(o,Y),j.push(Y)}C.push(j)}if(o[2]-o[0]<=b/2){(R=o)[0]=R[1]=1/0,R[2]=R[3]=-1/0;for(const F of C)for(const j of F)Js(j,o,u,b)}var R;return C}class go{constructor(o,u){this.type=an,this.geojson=o,this.geometries=u}static parse(o,u){if(o.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(rt(o[1])){const g=o[1];if(g.type==="FeatureCollection")for(let b=0;b<g.features.length;++b){const S=g.features[b].geometry.type;if(S==="Polygon"||S==="MultiPolygon")return new go(g,g.features[b].geometry)}else if(g.type==="Feature"){const b=g.geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new go(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new go(g,g)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(u,g){const b=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],C=u.canonicalID();if(g.type==="Polygon"){const R=Ys(g.coordinates,S,C),F=ka(u.geometry(),b,S,C);if(!Qt(b,S))return!1;for(const j of F)if(!Ss(j,R))return!1}if(g.type==="MultiPolygon"){const R=Ks(g.coordinates,S,C),F=ka(u.geometry(),b,S,C);if(!Qt(b,S))return!1;for(const j of F)if(!Ms(j,R))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(u,g){const b=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],C=u.canonicalID();if(g.type==="Polygon"){const R=Ys(g.coordinates,S,C),F=Pa(u.geometry(),b,S,C);if(!Qt(b,S))return!1;for(const j of F)if(!rs(j,R))return!1}if(g.type==="MultiPolygon"){const R=Ks(g.coordinates,S,C),F=Pa(u.geometry(),b,S,C);if(!Qt(b,S))return!1;for(const j of F)if(!Kr(j,R))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ue(l){if(l instanceof wn&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof go)return!1;let o=!0;return l.eachChild(u=>{o&&!ue(u)&&(o=!1)}),o}function pe(l){if(l instanceof wn&&l.name==="feature-state")return!1;let o=!0;return l.eachChild(u=>{o&&!pe(u)&&(o=!1)}),o}function Ie(l,o){if(l instanceof wn&&o.indexOf(l.name)>=0)return!1;let u=!0;return l.eachChild(g=>{u&&!Ie(g,o)&&(u=!1)}),u}class qe{constructor(o,u){this.type=u.type,this.name=o,this.boundExpression=u}static parse(o,u){if(o.length!==2||typeof o[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const g=o[1];return u.scope.has(g)?new qe(g,u.scope.get(g)):u.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}}class ht{constructor(o,u=[],g,b=new or,S=[]){this.registry=o,this.path=u,this.key=u.map(C=>`[${C}]`).join(""),this.scope=b,this.errors=S,this.expectedType=g}parse(o,u,g,b,S={}){return u?this.concat(u,g,b)._parse(o,S):this._parse(o,S)}_parse(o,u){function g(b,S,C){return C==="assert"?new Ft(S,[b]):C==="coerce"?new Gt(S,[b]):b}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const b=o[0];if(typeof b!="string")return this.error(`Expression name must be a string, but found ${typeof b} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const S=this.registry[b];if(S){let C=S.parse(o,this);if(!C)return null;if(this.expectedType){const R=this.expectedType,F=C.type;if(R.kind!=="string"&&R.kind!=="number"&&R.kind!=="boolean"&&R.kind!=="object"&&R.kind!=="array"||F.kind!=="value")if(R.kind!=="color"&&R.kind!=="formatted"&&R.kind!=="resolvedImage"||F.kind!=="value"&&F.kind!=="string")if(R.kind!=="padding"||F.kind!=="value"&&F.kind!=="number"&&F.kind!=="array"){if(this.checkSubtype(R,F))return null}else C=g(C,R,u.typeAnnotation||"coerce");else C=g(C,R,u.typeAnnotation||"coerce");else C=g(C,R,u.typeAnnotation||"assert")}if(!(C instanceof Tt)&&C.type.kind!=="resolvedImage"&&zt(C)){const R=new dn;try{C=new Tt(C.type,C.evaluate(R))}catch(F){return this.error(F.message),null}}return C}return this.error(`Unknown expression "${b}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,u,g){const b=typeof o=="number"?this.path.concat(o):this.path,S=g?this.scope.concat(g):this.scope;return new ht(this.registry,b,u||null,S,this.errors)}error(o,...u){const g=`${this.key}${u.map(b=>`[${b}]`).join("")}`;this.errors.push(new rr(g,o))}checkSubtype(o,u){const g=br(o,u);return g&&this.error(g),g}}function zt(l){if(l instanceof qe)return zt(l.boundExpression);if(l instanceof wn&&l.name==="error"||l instanceof Ln||l instanceof go)return!1;const o=l instanceof Gt||l instanceof Ft;let u=!0;return l.eachChild(g=>{u=o?u&&zt(g):u&&g instanceof Tt}),!!u&&ue(l)&&Ie(l,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function An(l,o){const u=l.length-1;let g,b,S=0,C=u,R=0;for(;S<=C;)if(R=Math.floor((S+C)/2),g=l[R],b=l[R+1],g<=o){if(R===u||o<b)return R;S=R+1}else{if(!(g>o))throw new xt("Input is not a number.");C=R-1}return 0}class ei{constructor(o,u,g){this.type=o,this.input=u,this.labels=[],this.outputs=[];for(const[b,S]of g)this.labels.push(b),this.outputs.push(S)}static parse(o,u){if(o.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return u.error("Expected an even number of arguments.");const g=u.parse(o[1],1,_t);if(!g)return null;const b=[];let S=null;u.expectedType&&u.expectedType.kind!=="value"&&(S=u.expectedType);for(let C=1;C<o.length;C+=2){const R=C===1?-1/0:o[C],F=o[C+1],j=C,Z=C+1;if(typeof R!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(b.length&&b[b.length-1][0]>=R)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);const Y=u.parse(F,Z,S);if(!Y)return null;S=S||Y.type,b.push([R,Y])}return new ei(S,g,b)}evaluate(o){const u=this.labels,g=this.outputs;if(u.length===1)return g[0].evaluate(o);const b=this.input.evaluate(o);if(b<=u[0])return g[0].evaluate(o);const S=u.length;return b>=u[S-1]?g[S-1].evaluate(o):g[An(u,b)].evaluate(o)}eachChild(o){o(this.input);for(const u of this.outputs)o(u)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function pn(l,o,u){return l*(1-u)+o*u}var gi=Object.freeze({__proto__:null,number:pn,color:function(l,o,u){return new f(pn(l.r,o.r,u),pn(l.g,o.g,u),pn(l.b,o.b,u),pn(l.a,o.a,u))},array:function(l,o,u){return l.map((g,b)=>pn(g,o[b],u))},padding:function(l,o,u){const g=l.values,b=o.values;return new we([pn(g[0],b[0],u),pn(g[1],b[1],u),pn(g[2],b[2],u),pn(g[3],b[3],u)])}});const In=.95047,Tl=1.08883,Sl=4/29,Ml=6/29,Mu=3*Ml*Ml,Eh=Math.PI/180,Iu=180/Math.PI;function La(l){return l>.008856451679035631?Math.pow(l,1/3):l/Mu+Sl}function Ra(l){return l>Ml?l*l*l:Mu*(l-Sl)}function wc(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function bc(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function Dn(l){const o=bc(l.r),u=bc(l.g),g=bc(l.b),b=La((.4124564*o+.3575761*u+.1804375*g)/In),S=La((.2126729*o+.7151522*u+.072175*g)/1);return{l:116*S-16,a:500*(b-S),b:200*(S-La((.0193339*o+.119192*u+.9503041*g)/Tl)),alpha:l.a}}function Ec(l){let o=(l.l+16)/116,u=isNaN(l.a)?o:o+l.a/500,g=isNaN(l.b)?o:o-l.b/200;return o=1*Ra(o),u=In*Ra(u),g=Tl*Ra(g),new f(wc(3.2404542*u-1.5371385*o-.4985314*g),wc(-.969266*u+1.8760108*o+.041556*g),wc(.0556434*u-.2040259*o+1.0572252*g),l.alpha)}function Cu(l,o,u){const g=o-l;return l+u*(g>180||g<-180?g-360*Math.round(g/360):g)}const Da={forward:Dn,reverse:Ec,interpolate:function(l,o,u){return{l:pn(l.l,o.l,u),a:pn(l.a,o.a,u),b:pn(l.b,o.b,u),alpha:pn(l.alpha,o.alpha,u)}}},za={forward:function(l){const{l:o,a:u,b:g}=Dn(l),b=Math.atan2(g,u)*Iu;return{h:b<0?b+360:b,c:Math.sqrt(u*u+g*g),l:o,alpha:l.a}},reverse:function(l){const o=l.h*Eh,u=l.c;return Ec({l:l.l,a:Math.cos(o)*u,b:Math.sin(o)*u,alpha:l.alpha})},interpolate:function(l,o,u){return{h:Cu(l.h,o.h,u),c:pn(l.c,o.c,u),l:pn(l.l,o.l,u),alpha:pn(l.alpha,o.alpha,u)}}};var ku=Object.freeze({__proto__:null,lab:Da,hcl:za});class Zn{constructor(o,u,g,b,S){this.type=o,this.operator=u,this.interpolation=g,this.input=b,this.labels=[],this.outputs=[];for(const[C,R]of S)this.labels.push(C),this.outputs.push(R)}static interpolationFactor(o,u,g,b){let S=0;if(o.name==="exponential")S=Po(u,o.base,g,b);else if(o.name==="linear")S=Po(u,1,g,b);else if(o.name==="cubic-bezier"){const C=o.controlPoints;S=new T(C[0],C[1],C[2],C[3]).solve(Po(u,1,g,b))}return S}static parse(o,u){let[g,b,S,...C]=o;if(!Array.isArray(b)||b.length===0)return u.error("Expected an interpolation type expression.",1);if(b[0]==="linear")b={name:"linear"};else if(b[0]==="exponential"){const j=b[1];if(typeof j!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);b={name:"exponential",base:j}}else{if(b[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(b[0])}`,1,0);{const j=b.slice(1);if(j.length!==4||j.some(Z=>typeof Z!="number"||Z<0||Z>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);b={name:"cubic-bezier",controlPoints:j}}}if(o.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(S=u.parse(S,2,_t),!S)return null;const R=[];let F=null;g==="interpolate-hcl"||g==="interpolate-lab"?F=mi:u.expectedType&&u.expectedType.kind!=="value"&&(F=u.expectedType);for(let j=0;j<C.length;j+=2){const Z=C[j],Y=C[j+1],re=j+3,fe=j+4;if(typeof Z!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',re);if(R.length&&R[R.length-1][0]>=Z)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',re);const he=u.parse(Y,fe,F);if(!he)return null;F=F||he.type,R.push([Z,he])}return F.kind==="number"||F.kind==="color"||F.kind==="padding"||F.kind==="array"&&F.itemType.kind==="number"&&typeof F.N=="number"?new Zn(F,g,b,S,R):u.error(`Type ${Pn(F)} is not interpolatable.`)}evaluate(o){const u=this.labels,g=this.outputs;if(u.length===1)return g[0].evaluate(o);const b=this.input.evaluate(o);if(b<=u[0])return g[0].evaluate(o);const S=u.length;if(b>=u[S-1])return g[S-1].evaluate(o);const C=An(u,b),R=Zn.interpolationFactor(this.interpolation,b,u[C],u[C+1]),F=g[C].evaluate(o),j=g[C+1].evaluate(o);return this.operator==="interpolate"?gi[this.type.kind.toLowerCase()](F,j,R):this.operator==="interpolate-hcl"?za.reverse(za.interpolate(za.forward(F),za.forward(j),R)):Da.reverse(Da.interpolate(Da.forward(F),Da.forward(j),R))}eachChild(o){o(this.input);for(const u of this.outputs)o(u)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function Po(l,o,u,g){const b=g-u,S=l-u;return b===0?0:o===1?S/b:(Math.pow(o,S)-1)/(Math.pow(o,b)-1)}class Oi{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expectected at least one argument.");let g=null;const b=u.expectedType;b&&b.kind!=="value"&&(g=b);const S=[];for(const R of o.slice(1)){const F=u.parse(R,1+S.length,g,void 0,{typeAnnotation:"omit"});if(!F)return null;g=g||F.type,S.push(F)}if(!g)throw new Error("No output type");const C=b&&S.some(R=>br(b,R.type));return new Oi(C?rn:g,S)}evaluate(o){let u,g=null,b=0;for(const S of this.args)if(b++,g=S.evaluate(o),g&&g instanceof Me&&!g.available&&(u||(u=g.name),g=null,b===this.args.length&&(g=u)),g!==null)break;return g}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}class ea{constructor(o,u){this.type=u.type,this.bindings=[].concat(o),this.result=u}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const u of this.bindings)o(u[1]);o(this.result)}static parse(o,u){if(o.length<4)return u.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const g=[];for(let S=1;S<o.length-1;S+=2){const C=o[S];if(typeof C!="string")return u.error(`Expected string, but found ${typeof C} instead.`,S);if(/[^a-zA-Z0-9_]/.test(C))return u.error("Variable names must contain only alphanumeric characters or '_'.",S);const R=u.parse(o[S+1],S+1);if(!R)return null;g.push([C,R])}const b=u.parse(o[o.length-1],o.length-1,u.expectedType,g);return b?new ea(g,b):null}outputDefined(){return this.result.outputDefined()}}class Il{constructor(o,u,g){this.type=o,this.index=u,this.input=g}static parse(o,u){if(o.length!==3)return u.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const g=u.parse(o[1],1,_t),b=u.parse(o[2],2,zi(u.expectedType||rn));return g&&b?new Il(b.type.itemType,g,b):null}evaluate(o){const u=this.index.evaluate(o),g=this.input.evaluate(o);if(u<0)throw new xt(`Array index out of bounds: ${u} < 0.`);if(u>=g.length)throw new xt(`Array index out of bounds: ${u} > ${g.length-1}.`);if(u!==Math.floor(u))throw new xt(`Array index must be an integer, but found ${u} instead.`);return g[u]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}}class ta{constructor(o,u){this.type=an,this.needle=o,this.haystack=u}static parse(o,u){if(o.length!==3)return u.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const g=u.parse(o[1],1,rn),b=u.parse(o[2],2,rn);return g&&b?Er(g.type,[an,ln,_t,Xr,rn])?new ta(g,b):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pn(g.type)} instead`):null}evaluate(o){const u=this.needle.evaluate(o),g=this.haystack.evaluate(o);if(!g)return!1;if(!Or(u,["boolean","string","number","null"]))throw new xt(`Expected first argument to be of type boolean, string, number or null, but found ${Pn(Ne(u))} instead.`);if(!Or(g,["string","array"]))throw new xt(`Expected second argument to be of type array or string, but found ${Pn(Ne(g))} instead.`);return g.indexOf(u)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}}class Cl{constructor(o,u,g){this.type=_t,this.needle=o,this.haystack=u,this.fromIndex=g}static parse(o,u){if(o.length<=2||o.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const g=u.parse(o[1],1,rn),b=u.parse(o[2],2,rn);if(!g||!b)return null;if(!Er(g.type,[an,ln,_t,Xr,rn]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pn(g.type)} instead`);if(o.length===4){const S=u.parse(o[3],3,_t);return S?new Cl(g,b,S):null}return new Cl(g,b)}evaluate(o){const u=this.needle.evaluate(o),g=this.haystack.evaluate(o);if(!Or(u,["boolean","string","number","null"]))throw new xt(`Expected first argument to be of type boolean, string, number or null, but found ${Pn(Ne(u))} instead.`);if(!Or(g,["string","array"]))throw new xt(`Expected second argument to be of type array or string, but found ${Pn(Ne(g))} instead.`);if(this.fromIndex){const b=this.fromIndex.evaluate(o);return g.indexOf(u,b)}return g.indexOf(u)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}}class Tc{constructor(o,u,g,b,S,C){this.inputType=o,this.type=u,this.input=g,this.cases=b,this.outputs=S,this.otherwise=C}static parse(o,u){if(o.length<5)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return u.error("Expected an even number of arguments.");let g,b;u.expectedType&&u.expectedType.kind!=="value"&&(b=u.expectedType);const S={},C=[];for(let j=2;j<o.length-1;j+=2){let Z=o[j];const Y=o[j+1];Array.isArray(Z)||(Z=[Z]);const re=u.concat(j);if(Z.length===0)return re.error("Expected at least one branch label.");for(const he of Z){if(typeof he!="number"&&typeof he!="string")return re.error("Branch labels must be numbers or strings.");if(typeof he=="number"&&Math.abs(he)>Number.MAX_SAFE_INTEGER)return re.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof he=="number"&&Math.floor(he)!==he)return re.error("Numeric branch labels must be integer values.");if(g){if(re.checkSubtype(g,Ne(he)))return null}else g=Ne(he);if(S[String(he)]!==void 0)return re.error("Branch labels must be unique.");S[String(he)]=C.length}const fe=u.parse(Y,j,b);if(!fe)return null;b=b||fe.type,C.push(fe)}const R=u.parse(o[1],1,rn);if(!R)return null;const F=u.parse(o[o.length-1],o.length-1,b);return F?R.type.kind!=="value"&&u.concat(1).checkSubtype(g,R.type)?null:new Tc(g,b,R,S,C,F):null}evaluate(o){const u=this.input.evaluate(o);return(Ne(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}}class Sc{constructor(o,u,g){this.type=o,this.branches=u,this.otherwise=g}static parse(o,u){if(o.length<4)return u.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return u.error("Expected an odd number of arguments.");let g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const b=[];for(let C=1;C<o.length-1;C+=2){const R=u.parse(o[C],C,an);if(!R)return null;const F=u.parse(o[C+1],C+1,g);if(!F)return null;b.push([R,F]),g=g||F.type}const S=u.parse(o[o.length-1],o.length-1,g);if(!S)return null;if(!g)throw new Error("Can't infer output type");return new Sc(g,b,S)}evaluate(o){for(const[u,g]of this.branches)if(u.evaluate(o))return g.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[u,g]of this.branches)o(u),o(g);o(this.otherwise)}outputDefined(){return this.branches.every(([o,u])=>u.outputDefined())&&this.otherwise.outputDefined()}}class Ba{constructor(o,u,g,b){this.type=o,this.input=u,this.beginIndex=g,this.endIndex=b}static parse(o,u){if(o.length<=2||o.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const g=u.parse(o[1],1,rn),b=u.parse(o[2],2,_t);if(!g||!b)return null;if(!Er(g.type,[zi(rn),ln,rn]))return u.error(`Expected first argument to be of type array or string, but found ${Pn(g.type)} instead`);if(o.length===4){const S=u.parse(o[3],3,_t);return S?new Ba(g.type,g,b,S):null}return new Ba(g.type,g,b)}evaluate(o){const u=this.input.evaluate(o),g=this.beginIndex.evaluate(o);if(!Or(u,["string","array"]))throw new xt(`Expected first argument to be of type array or string, but found ${Pn(Ne(u))} instead.`);if(this.endIndex){const b=this.endIndex.evaluate(o);return u.slice(g,b)}return u.slice(g)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}}function Oa(l,o){return l==="=="||l==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function os(l,o,u,g){return g.compare(o,u)===0}function Is(l,o,u){const g=l!=="=="&&l!=="!=";return class Z6{constructor(S,C,R){this.type=an,this.lhs=S,this.rhs=C,this.collator=R,this.hasUntypedArgument=S.type.kind==="value"||C.type.kind==="value"}static parse(S,C){if(S.length!==3&&S.length!==4)return C.error("Expected two or three arguments.");const R=S[0];let F=C.parse(S[1],1,rn);if(!F)return null;if(!Oa(R,F.type))return C.concat(1).error(`"${R}" comparisons are not supported for type '${Pn(F.type)}'.`);let j=C.parse(S[2],2,rn);if(!j)return null;if(!Oa(R,j.type))return C.concat(2).error(`"${R}" comparisons are not supported for type '${Pn(j.type)}'.`);if(F.type.kind!==j.type.kind&&F.type.kind!=="value"&&j.type.kind!=="value")return C.error(`Cannot compare types '${Pn(F.type)}' and '${Pn(j.type)}'.`);g&&(F.type.kind==="value"&&j.type.kind!=="value"?F=new Ft(j.type,[F]):F.type.kind!=="value"&&j.type.kind==="value"&&(j=new Ft(F.type,[j])));let Z=null;if(S.length===4){if(F.type.kind!=="string"&&j.type.kind!=="string"&&F.type.kind!=="value"&&j.type.kind!=="value")return C.error("Cannot use collator to compare non-string types.");if(Z=C.parse(S[3],3,ft),!Z)return null}return new Z6(F,j,Z)}evaluate(S){const C=this.lhs.evaluate(S),R=this.rhs.evaluate(S);if(g&&this.hasUntypedArgument){const F=Ne(C),j=Ne(R);if(F.kind!==j.kind||F.kind!=="string"&&F.kind!=="number")throw new xt(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${F.kind}, ${j.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const F=Ne(C),j=Ne(R);if(F.kind!=="string"||j.kind!=="string")return o(S,C,R)}return this.collator?u(S,C,R,this.collator.evaluate(S)):o(S,C,R)}eachChild(S){S(this.lhs),S(this.rhs),this.collator&&S(this.collator)}outputDefined(){return!0}}}const Pu=Is("==",function(l,o,u){return o===u},os),kl=Is("!=",function(l,o,u){return o!==u},function(l,o,u,g){return!os(0,o,u,g)}),Cs=Is("<",function(l,o,u){return o<u},function(l,o,u,g){return g.compare(o,u)<0}),ss=Is(">",function(l,o,u){return o>u},function(l,o,u,g){return g.compare(o,u)>0}),Lu=Is("<=",function(l,o,u){return o<=u},function(l,o,u,g){return g.compare(o,u)<=0}),Ru=Is(">=",function(l,o,u){return o>=u},function(l,o,u,g){return g.compare(o,u)>=0});class Fa{constructor(o,u,g,b,S){this.type=ln,this.number=o,this.locale=u,this.currency=g,this.minFractionDigits=b,this.maxFractionDigits=S}static parse(o,u){if(o.length!==3)return u.error("Expected two arguments.");const g=u.parse(o[1],1,_t);if(!g)return null;const b=o[2];if(typeof b!="object"||Array.isArray(b))return u.error("NumberFormat options argument must be an object.");let S=null;if(b.locale&&(S=u.parse(b.locale,1,ln),!S))return null;let C=null;if(b.currency&&(C=u.parse(b.currency,1,ln),!C))return null;let R=null;if(b["min-fraction-digits"]&&(R=u.parse(b["min-fraction-digits"],1,_t),!R))return null;let F=null;return b["max-fraction-digits"]&&(F=u.parse(b["max-fraction-digits"],1,_t),!F)?null:new Fa(g,S,C,R,F)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}}class Pl{constructor(o){this.type=wi,this.sections=o}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");const g=o[1];if(!Array.isArray(g)&&typeof g=="object")return u.error("First argument must be an image or text section.");const b=[];let S=!1;for(let C=1;C<=o.length-1;++C){const R=o[C];if(S&&typeof R=="object"&&!Array.isArray(R)){S=!1;let F=null;if(R["font-scale"]&&(F=u.parse(R["font-scale"],1,_t),!F))return null;let j=null;if(R["text-font"]&&(j=u.parse(R["text-font"],1,zi(ln)),!j))return null;let Z=null;if(R["text-color"]&&(Z=u.parse(R["text-color"],1,mi),!Z))return null;const Y=b[b.length-1];Y.scale=F,Y.font=j,Y.textColor=Z}else{const F=u.parse(o[C],1,rn);if(!F)return null;const j=F.type.kind;if(j!=="string"&&j!=="value"&&j!=="null"&&j!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");S=!0,b.push({content:F,scale:null,font:null,textColor:null})}}return new Pl(b)}evaluate(o){return new Te(this.sections.map(u=>{const g=u.content.evaluate(o);return Ne(g)===ai?new ke("",g,null,null,null):new ke(lt(g),null,u.scale?u.scale.evaluate(o):null,u.font?u.font.evaluate(o).join(","):null,u.textColor?u.textColor.evaluate(o):null)}))}eachChild(o){for(const u of this.sections)o(u.content),u.scale&&o(u.scale),u.font&&o(u.font),u.textColor&&o(u.textColor)}outputDefined(){return!1}}class Mc{constructor(o){this.type=ai,this.input=o}static parse(o,u){if(o.length!==2)return u.error("Expected two arguments.");const g=u.parse(o[1],1,ln);return g?new Mc(g):u.error("No image name provided.")}evaluate(o){const u=this.input.evaluate(o),g=Me.fromString(u);return g&&o.availableImages&&(g.available=o.availableImages.indexOf(u)>-1),g}eachChild(o){o(this.input)}outputDefined(){return!1}}class Ll{constructor(o){this.type=_t,this.input=o}static parse(o,u){if(o.length!==2)return u.error(`Expected 1 argument, but found ${o.length-1} instead.`);const g=u.parse(o[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${Pn(g.type)} instead.`):new Ll(g):null}evaluate(o){const u=this.input.evaluate(o);if(typeof u=="string"||Array.isArray(u))return u.length;throw new xt(`Expected value to be of type string or array, but found ${Pn(Ne(u))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}}const na={"==":Pu,"!=":kl,">":ss,"<":Cs,">=":Ru,"<=":Lu,array:Ft,at:Il,boolean:Ft,case:Sc,coalesce:Oi,collator:Ln,format:Pl,image:Mc,in:ta,"index-of":Cl,interpolate:Zn,"interpolate-hcl":Zn,"interpolate-lab":Zn,length:Ll,let:ea,literal:Tt,match:Tc,number:Ft,"number-format":Fa,object:Ft,slice:Ba,step:ei,string:Ft,"to-boolean":Gt,"to-color":Gt,"to-number":Gt,"to-string":Gt,var:qe,within:go};function Du(l,[o,u,g,b]){o=o.evaluate(l),u=u.evaluate(l),g=g.evaluate(l);const S=b?b.evaluate(l):1,C=Fe(o,u,g,S);if(C)throw new xt(C);return new f(o/255*S,u/255*S,g/255*S,S)}function zu(l,o){return l in o}function Rl(l,o){const u=o[l];return u===void 0?null:u}function ks(l){return{type:l}}function Bu(l){return{result:"success",value:l}}function ia(l){return{result:"error",value:l}}function Yn(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function Na(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function En(l){return!!l.expression&&l.expression.interpolated}function Bn(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function Qn(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function jn(l){return l}function Ua(l,o){const u=o.type==="color",g=l.stops&&typeof l.stops[0][0]=="object",b=g||!(g||l.property!==void 0),S=l.type||(En(o)?"exponential":"interval");if(u||o.type==="padding"){const j=u?f.parse:we.parse;(l=Ki({},l)).stops&&(l.stops=l.stops.map(Z=>[Z[0],j(Z[1])])),l.default=j(l.default?l.default:o.default)}if(l.colorSpace&&l.colorSpace!=="rgb"&&!ku[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let C,R,F;if(S==="exponential")C=Fu;else if(S==="interval")C=ra;else if(S==="categorical"){C=Ou,R=Object.create(null);for(const j of l.stops)R[j[0]]=j[1];F=typeof l.stops[0][0]}else{if(S!=="identity")throw new Error(`Unknown function type "${S}"`);C=Ic}if(g){const j={},Z=[];for(let fe=0;fe<l.stops.length;fe++){const he=l.stops[fe],Pe=he[0].zoom;j[Pe]===void 0&&(j[Pe]={zoom:Pe,type:l.type,property:l.property,default:l.default,stops:[]},Z.push(Pe)),j[Pe].stops.push([he[0].value,he[1]])}const Y=[];for(const fe of Z)Y.push([j[fe].zoom,Ua(j[fe],o)]);const re={name:"linear"};return{kind:"composite",interpolationType:re,interpolationFactor:Zn.interpolationFactor.bind(void 0,re),zoomStops:Y.map(fe=>fe[0]),evaluate:({zoom:fe},he)=>Fu({stops:Y,base:l.base},o,fe).evaluate(fe,he)}}if(b){const j=S==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:Zn.interpolationFactor.bind(void 0,j),zoomStops:l.stops.map(Z=>Z[0]),evaluate:({zoom:Z})=>C(l,o,Z,R,F)}}return{kind:"source",evaluate(j,Z){const Y=Z&&Z.properties?Z.properties[l.property]:void 0;return Y===void 0?as(l.default,o.default):C(l,o,Y,R,F)}}}function as(l,o,u){return l!==void 0?l:o!==void 0?o:u!==void 0?u:void 0}function Ou(l,o,u,g,b){return as(typeof u===b?g[u]:void 0,l.default,o.default)}function ra(l,o,u){if(Bn(u)!=="number")return as(l.default,o.default);const g=l.stops.length;if(g===1||u<=l.stops[0][0])return l.stops[0][1];if(u>=l.stops[g-1][0])return l.stops[g-1][1];const b=An(l.stops.map(S=>S[0]),u);return l.stops[b][1]}function Fu(l,o,u){const g=l.base!==void 0?l.base:1;if(Bn(u)!=="number")return as(l.default,o.default);const b=l.stops.length;if(b===1||u<=l.stops[0][0])return l.stops[0][1];if(u>=l.stops[b-1][0])return l.stops[b-1][1];const S=An(l.stops.map(Z=>Z[0]),u),C=function(Z,Y,re,fe){const he=fe-re,Pe=Z-re;return he===0?0:Y===1?Pe/he:(Math.pow(Y,Pe)-1)/(Math.pow(Y,he)-1)}(u,g,l.stops[S][0],l.stops[S+1][0]),R=l.stops[S][1],F=l.stops[S+1][1];let j=gi[o.type]||jn;if(l.colorSpace&&l.colorSpace!=="rgb"){const Z=ku[l.colorSpace];j=(Y,re)=>Z.reverse(Z.interpolate(Z.forward(Y),Z.forward(re),C))}return typeof R.evaluate=="function"?{evaluate(...Z){const Y=R.evaluate.apply(void 0,Z),re=F.evaluate.apply(void 0,Z);if(Y!==void 0&&re!==void 0)return j(Y,re,C)}}:j(R,F,C)}function Ic(l,o,u){switch(o.type){case"color":u=f.parse(u);break;case"formatted":u=Te.fromString(u.toString());break;case"resolvedImage":u=Me.fromString(u.toString());break;case"padding":u=we.parse(u);break;default:Bn(u)===o.type||o.type==="enum"&&o.values[u]||(u=void 0)}return as(u,l.default,o.default)}wn.register(na,{error:[{kind:"error"},[ln],(l,[o])=>{throw new xt(o.evaluate(l))}],typeof:[ln,[rn],(l,[o])=>Pn(Ne(o.evaluate(l)))],"to-rgba":[zi(_t,4),[mi],(l,[o])=>o.evaluate(l).toArray()],rgb:[mi,[_t,_t,_t],Du],rgba:[mi,[_t,_t,_t,_t],Du],has:{type:an,overloads:[[[ln],(l,[o])=>zu(o.evaluate(l),l.properties())],[[ln,Yr],(l,[o,u])=>zu(o.evaluate(l),u.evaluate(l))]]},get:{type:rn,overloads:[[[ln],(l,[o])=>Rl(o.evaluate(l),l.properties())],[[ln,Yr],(l,[o,u])=>Rl(o.evaluate(l),u.evaluate(l))]]},"feature-state":[rn,[ln],(l,[o])=>Rl(o.evaluate(l),l.featureState||{})],properties:[Yr,[],l=>l.properties()],"geometry-type":[ln,[],l=>l.geometryType()],id:[rn,[],l=>l.id()],zoom:[_t,[],l=>l.globals.zoom],"heatmap-density":[_t,[],l=>l.globals.heatmapDensity||0],"line-progress":[_t,[],l=>l.globals.lineProgress||0],accumulated:[rn,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[_t,ks(_t),(l,o)=>{let u=0;for(const g of o)u+=g.evaluate(l);return u}],"*":[_t,ks(_t),(l,o)=>{let u=1;for(const g of o)u*=g.evaluate(l);return u}],"-":{type:_t,overloads:[[[_t,_t],(l,[o,u])=>o.evaluate(l)-u.evaluate(l)],[[_t],(l,[o])=>-o.evaluate(l)]]},"/":[_t,[_t,_t],(l,[o,u])=>o.evaluate(l)/u.evaluate(l)],"%":[_t,[_t,_t],(l,[o,u])=>o.evaluate(l)%u.evaluate(l)],ln2:[_t,[],()=>Math.LN2],pi:[_t,[],()=>Math.PI],e:[_t,[],()=>Math.E],"^":[_t,[_t,_t],(l,[o,u])=>Math.pow(o.evaluate(l),u.evaluate(l))],sqrt:[_t,[_t],(l,[o])=>Math.sqrt(o.evaluate(l))],log10:[_t,[_t],(l,[o])=>Math.log(o.evaluate(l))/Math.LN10],ln:[_t,[_t],(l,[o])=>Math.log(o.evaluate(l))],log2:[_t,[_t],(l,[o])=>Math.log(o.evaluate(l))/Math.LN2],sin:[_t,[_t],(l,[o])=>Math.sin(o.evaluate(l))],cos:[_t,[_t],(l,[o])=>Math.cos(o.evaluate(l))],tan:[_t,[_t],(l,[o])=>Math.tan(o.evaluate(l))],asin:[_t,[_t],(l,[o])=>Math.asin(o.evaluate(l))],acos:[_t,[_t],(l,[o])=>Math.acos(o.evaluate(l))],atan:[_t,[_t],(l,[o])=>Math.atan(o.evaluate(l))],min:[_t,ks(_t),(l,o)=>Math.min(...o.map(u=>u.evaluate(l)))],max:[_t,ks(_t),(l,o)=>Math.max(...o.map(u=>u.evaluate(l)))],abs:[_t,[_t],(l,[o])=>Math.abs(o.evaluate(l))],round:[_t,[_t],(l,[o])=>{const u=o.evaluate(l);return u<0?-Math.round(-u):Math.round(u)}],floor:[_t,[_t],(l,[o])=>Math.floor(o.evaluate(l))],ceil:[_t,[_t],(l,[o])=>Math.ceil(o.evaluate(l))],"filter-==":[an,[ln,rn],(l,[o,u])=>l.properties()[o.value]===u.value],"filter-id-==":[an,[rn],(l,[o])=>l.id()===o.value],"filter-type-==":[an,[ln],(l,[o])=>l.geometryType()===o.value],"filter-<":[an,[ln,rn],(l,[o,u])=>{const g=l.properties()[o.value],b=u.value;return typeof g==typeof b&&g<b}],"filter-id-<":[an,[rn],(l,[o])=>{const u=l.id(),g=o.value;return typeof u==typeof g&&u<g}],"filter->":[an,[ln,rn],(l,[o,u])=>{const g=l.properties()[o.value],b=u.value;return typeof g==typeof b&&g>b}],"filter-id->":[an,[rn],(l,[o])=>{const u=l.id(),g=o.value;return typeof u==typeof g&&u>g}],"filter-<=":[an,[ln,rn],(l,[o,u])=>{const g=l.properties()[o.value],b=u.value;return typeof g==typeof b&&g<=b}],"filter-id-<=":[an,[rn],(l,[o])=>{const u=l.id(),g=o.value;return typeof u==typeof g&&u<=g}],"filter->=":[an,[ln,rn],(l,[o,u])=>{const g=l.properties()[o.value],b=u.value;return typeof g==typeof b&&g>=b}],"filter-id->=":[an,[rn],(l,[o])=>{const u=l.id(),g=o.value;return typeof u==typeof g&&u>=g}],"filter-has":[an,[rn],(l,[o])=>o.value in l.properties()],"filter-has-id":[an,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[an,[zi(ln)],(l,[o])=>o.value.indexOf(l.geometryType())>=0],"filter-id-in":[an,[zi(rn)],(l,[o])=>o.value.indexOf(l.id())>=0],"filter-in-small":[an,[ln,zi(rn)],(l,[o,u])=>u.value.indexOf(l.properties()[o.value])>=0],"filter-in-large":[an,[ln,zi(rn)],(l,[o,u])=>function(g,b,S,C){for(;S<=C;){const R=S+C>>1;if(b[R]===g)return!0;b[R]>g?C=R-1:S=R+1}return!1}(l.properties()[o.value],u.value,0,u.value.length-1)],all:{type:an,overloads:[[[an,an],(l,[o,u])=>o.evaluate(l)&&u.evaluate(l)],[ks(an),(l,o)=>{for(const u of o)if(!u.evaluate(l))return!1;return!0}]]},any:{type:an,overloads:[[[an,an],(l,[o,u])=>o.evaluate(l)||u.evaluate(l)],[ks(an),(l,o)=>{for(const u of o)if(u.evaluate(l))return!0;return!1}]]},"!":[an,[an],(l,[o])=>!o.evaluate(l)],"is-supported-script":[an,[ln],(l,[o])=>{const u=l.globals&&l.globals.isSupportedScript;return!u||u(o.evaluate(l))}],upcase:[ln,[ln],(l,[o])=>o.evaluate(l).toUpperCase()],downcase:[ln,[ln],(l,[o])=>o.evaluate(l).toLowerCase()],concat:[ln,ks(rn),(l,o)=>o.map(u=>lt(u.evaluate(l))).join("")],"resolved-locale":[ln,[ft],(l,[o])=>o.evaluate(l).resolvedLocale()]});class Va{constructor(o,u){this.expression=o,this._warningHistory={},this._evaluator=new dn,this._defaultValue=u?function(g){return g.type==="color"&&Qn(g.default)?new f(0,0,0,0):g.type==="color"?f.parse(g.default)||null:g.type==="padding"?we.parse(g.default)||null:g.default===void 0?null:g.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(o,u,g,b,S,C){return this._evaluator.globals=o,this._evaluator.feature=u,this._evaluator.featureState=g,this._evaluator.canonical=b,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=C,this.expression.evaluate(this._evaluator)}evaluate(o,u,g,b,S,C){this._evaluator.globals=o,this._evaluator.feature=u||null,this._evaluator.featureState=g||null,this._evaluator.canonical=b,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=C||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new xt(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(R.message)),this._defaultValue}}}function ja(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in na}function oa(l,o){const u=new ht(na,[],o?function(b){const S={color:mi,string:ln,number:_t,enum:ln,boolean:an,formatted:wi,padding:Co,resolvedImage:ai};return b.type==="array"?zi(S[b.value]||rn,b.length):S[b.type]}(o):void 0),g=u.parse(l,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?Bu(new Va(g,o)):ia(u.errors)}class Ps{constructor(o,u){this.kind=o,this._styleExpression=u,this.isStateDependent=o!=="constant"&&!pe(u.expression)}evaluateWithoutErrorHandling(o,u,g,b,S,C){return this._styleExpression.evaluateWithoutErrorHandling(o,u,g,b,S,C)}evaluate(o,u,g,b,S,C){return this._styleExpression.evaluate(o,u,g,b,S,C)}}class Ga{constructor(o,u,g,b){this.kind=o,this.zoomStops=g,this._styleExpression=u,this.isStateDependent=o!=="camera"&&!pe(u.expression),this.interpolationType=b}evaluateWithoutErrorHandling(o,u,g,b,S,C){return this._styleExpression.evaluateWithoutErrorHandling(o,u,g,b,S,C)}evaluate(o,u,g,b,S,C){return this._styleExpression.evaluate(o,u,g,b,S,C)}interpolationFactor(o,u,g){return this.interpolationType?Zn.interpolationFactor(this.interpolationType,o,u,g):0}}function Ha(l,o){const u=oa(l,o);if(u.result==="error")return u;const g=u.value.expression,b=ue(g);if(!b&&!Yn(o))return ia([new rr("","data expressions not supported")]);const S=Ie(g,["zoom"]);if(!S&&!Na(o))return ia([new rr("","zoom expressions not supported")]);const C=Dl(g);return C||S?C instanceof rr?ia([C]):C instanceof Zn&&!En(o)?ia([new rr("",'"interpolate" expressions cannot be used with this property')]):Bu(C?new Ga(b?"camera":"composite",u.value,C.labels,C instanceof Zn?C.interpolation:void 0):new Ps(b?"constant":"source",u.value)):ia([new rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Gn{constructor(o,u){this._parameters=o,this._specification=u,Ki(this,Ua(this._parameters,this._specification))}static deserialize(o){return new Gn(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function Dl(l){let o=null;if(l instanceof ea)o=Dl(l.result);else if(l instanceof Oi){for(const u of l.args)if(o=Dl(u),o)break}else(l instanceof ei||l instanceof Zn)&&l.input instanceof wn&&l.input.name==="zoom"&&(o=l);return o instanceof rr||l.eachChild(u=>{const g=Dl(u);g instanceof rr?o=g:!o&&g?o=new rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&g&&o!==g&&(o=new rr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}function Jr(l){const o=l.key,u=l.value,g=l.valueSpec||{},b=l.objectElementValidators||{},S=l.style,C=l.styleSpec;let R=[];const F=Bn(u);if(F!=="object")return[new gt(o,u,`object expected, ${F} found`)];for(const j in u){const Z=j.split(".")[0],Y=g[Z]||g["*"];let re;if(b[Z])re=b[Z];else if(g[Z])re=Tr;else if(b["*"])re=b["*"];else{if(!g["*"]){R.push(new gt(o,u[j],`unknown property "${j}"`));continue}re=Tr}R=R.concat(re({key:(o&&`${o}.`)+j,value:u[j],valueSpec:Y,style:S,styleSpec:C,object:u,objectKey:j},u))}for(const j in g)b[j]||g[j].required&&g[j].default===void 0&&u[j]===void 0&&R.push(new gt(o,u,`missing required property "${j}"`));return R}function Nu(l){const o=l.value,u=l.valueSpec,g=l.style,b=l.styleSpec,S=l.key,C=l.arrayElementValidator||Tr;if(Bn(o)!=="array")return[new gt(S,o,`array expected, ${Bn(o)} found`)];if(u.length&&o.length!==u.length)return[new gt(S,o,`array length ${u.length} expected, length ${o.length} found`)];if(u["min-length"]&&o.length<u["min-length"])return[new gt(S,o,`array length at least ${u["min-length"]} expected, length ${o.length} found`)];let R={type:u.value,values:u.values};b.$version<7&&(R.function=u.function),Bn(u.value)==="object"&&(R=u.value);let F=[];for(let j=0;j<o.length;j++)F=F.concat(C({array:o,arrayIndex:j,value:o[j],valueSpec:R,style:g,styleSpec:b,key:`${S}[${j}]`}));return F}function Cc(l){const o=l.key,u=l.value,g=l.valueSpec;let b=Bn(u);return b==="number"&&u!=u&&(b="NaN"),b!=="number"?[new gt(o,u,`number expected, ${b} found`)]:"minimum"in g&&u<g.minimum?[new gt(o,u,`${u} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&u>g.maximum?[new gt(o,u,`${u} is greater than the maximum value ${g.maximum}`)]:[]}function Uu(l){const o=l.valueSpec,u=vn(l.value.type);let g,b,S,C={};const R=u!=="categorical"&&l.value.property===void 0,F=!R,j=Bn(l.value.stops)==="array"&&Bn(l.value.stops[0])==="array"&&Bn(l.value.stops[0][0])==="object",Z=Jr({key:l.key,value:l.value,valueSpec:l.styleSpec.function,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(fe){if(u==="identity")return[new gt(fe.key,fe.value,'identity function may not have a "stops" property')];let he=[];const Pe=fe.value;return he=he.concat(Nu({key:fe.key,value:Pe,valueSpec:fe.valueSpec,style:fe.style,styleSpec:fe.styleSpec,arrayElementValidator:Y})),Bn(Pe)==="array"&&Pe.length===0&&he.push(new gt(fe.key,Pe,"array must have at least one stop")),he},default:function(fe){return Tr({key:fe.key,value:fe.value,valueSpec:o,style:fe.style,styleSpec:fe.styleSpec})}}});return u==="identity"&&R&&Z.push(new gt(l.key,l.value,'missing required property "property"')),u==="identity"||l.value.stops||Z.push(new gt(l.key,l.value,'missing required property "stops"')),u==="exponential"&&l.valueSpec.expression&&!En(l.valueSpec)&&Z.push(new gt(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(F&&!Yn(l.valueSpec)?Z.push(new gt(l.key,l.value,"property functions not supported")):R&&!Na(l.valueSpec)&&Z.push(new gt(l.key,l.value,"zoom functions not supported"))),u!=="categorical"&&!j||l.value.property!==void 0||Z.push(new gt(l.key,l.value,'"property" property is required')),Z;function Y(fe){let he=[];const Pe=fe.value,Se=fe.key;if(Bn(Pe)!=="array")return[new gt(Se,Pe,`array expected, ${Bn(Pe)} found`)];if(Pe.length!==2)return[new gt(Se,Pe,`array length 2 expected, length ${Pe.length} found`)];if(j){if(Bn(Pe[0])!=="object")return[new gt(Se,Pe,`object expected, ${Bn(Pe[0])} found`)];if(Pe[0].zoom===void 0)return[new gt(Se,Pe,"object stop key must have zoom")];if(Pe[0].value===void 0)return[new gt(Se,Pe,"object stop key must have value")];if(S&&S>vn(Pe[0].zoom))return[new gt(Se,Pe[0].zoom,"stop zoom values must appear in ascending order")];vn(Pe[0].zoom)!==S&&(S=vn(Pe[0].zoom),b=void 0,C={}),he=he.concat(Jr({key:`${Se}[0]`,value:Pe[0],valueSpec:{zoom:{}},style:fe.style,styleSpec:fe.styleSpec,objectElementValidators:{zoom:Cc,value:re}}))}else he=he.concat(re({key:`${Se}[0]`,value:Pe[0],valueSpec:{},style:fe.style,styleSpec:fe.styleSpec},Pe));return ja(dr(Pe[1]))?he.concat([new gt(`${Se}[1]`,Pe[1],"expressions are not allowed in function stops.")]):he.concat(Tr({key:`${Se}[1]`,value:Pe[1],valueSpec:o,style:fe.style,styleSpec:fe.styleSpec}))}function re(fe,he){const Pe=Bn(fe.value),Se=vn(fe.value),Ue=fe.value!==null?fe.value:he;if(g){if(Pe!==g)return[new gt(fe.key,Ue,`${Pe} stop domain type must match previous stop domain type ${g}`)]}else g=Pe;if(Pe!=="number"&&Pe!=="string"&&Pe!=="boolean")return[new gt(fe.key,Ue,"stop domain value must be a number, string, or boolean")];if(Pe!=="number"&&u!=="categorical"){let Qe=`number expected, ${Pe} found`;return Yn(o)&&u===void 0&&(Qe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new gt(fe.key,Ue,Qe)]}return u!=="categorical"||Pe!=="number"||isFinite(Se)&&Math.floor(Se)===Se?u!=="categorical"&&Pe==="number"&&b!==void 0&&Se<b?[new gt(fe.key,Ue,"stop domain values must appear in ascending order")]:(b=Se,u==="categorical"&&Se in C?[new gt(fe.key,Ue,"stop domain values must be unique")]:(C[Se]=!0,[])):[new gt(fe.key,Ue,`integer expected, found ${Se}`)]}}function Ls(l){const o=(l.expressionContext==="property"?Ha:oa)(dr(l.value),l.valueSpec);if(o.result==="error")return o.value.map(g=>new gt(`${l.key}${g.key}`,l.value,g.message));const u=o.value.expression||o.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!u.outputDefined())return[new gt(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!pe(u))return[new gt(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter"&&!pe(u))return[new gt(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!Ie(u,["zoom","feature-state"]))return[new gt(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!ue(u))return[new gt(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function $a(l){const o=l.key,u=l.value,g=l.valueSpec,b=[];return Array.isArray(g.values)?g.values.indexOf(vn(u))===-1&&b.push(new gt(o,u,`expected one of [${g.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(g.values).indexOf(vn(u))===-1&&b.push(new gt(o,u,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(u)} found`)),b}function Mi(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const o of l.slice(1))if(!Mi(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}const kc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function _o(l){if(l==null)return{filter:()=>!0,needGeometry:!1};Mi(l)||(l=Wa(l));const o=oa(l,kc);if(o.result==="error")throw new Error(o.value.map(u=>`${u.key}: ${u.message}`).join(", "));return{filter:(u,g,b)=>o.value.evaluate(u,g,{},b),needGeometry:zl(l)}}function Vu(l,o){return l<o?-1:l>o?1:0}function zl(l){if(!Array.isArray(l))return!1;if(l[0]==="within")return!0;for(let o=1;o<l.length;o++)if(zl(l[o]))return!0;return!1}function Wa(l){if(!l)return!0;const o=l[0];return l.length<=1?o!=="any":o==="=="?Ar(l[1],l[2],"=="):o==="!="?eo(Ar(l[1],l[2],"==")):o==="<"||o===">"||o==="<="||o===">="?Ar(l[1],l[2],o):o==="any"?(u=l.slice(1),["any"].concat(u.map(Wa))):o==="all"?["all"].concat(l.slice(1).map(Wa)):o==="none"?["all"].concat(l.slice(1).map(Wa).map(eo)):o==="in"?Za(l[1],l.slice(2)):o==="!in"?eo(Za(l[1],l.slice(2))):o==="has"?Rs(l[1]):o==="!has"?eo(Rs(l[1])):o!=="within"||l;var u}function Ar(l,o,u){switch(l){case"$type":return[`filter-type-${u}`,o];case"$id":return[`filter-id-${u}`,o];default:return[`filter-${u}`,l,o]}}function Za(l,o){if(o.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(u=>typeof u!=typeof o[0])?["filter-in-large",l,["literal",o.sort(Vu)]]:["filter-in-small",l,["literal",o]]}}function Rs(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function eo(l){return["!",l]}function Lo(l){return Mi(dr(l.value))?Ls(Ki({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):sa(l)}function sa(l){const o=l.value,u=l.key;if(Bn(o)!=="array")return[new gt(u,o,`array expected, ${Bn(o)} found`)];const g=l.styleSpec;let b,S=[];if(o.length<1)return[new gt(u,o,"filter array must have at least 1 element")];switch(S=S.concat($a({key:`${u}[0]`,value:o[0],valueSpec:g.filter_operator,style:l.style,styleSpec:l.styleSpec})),vn(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&vn(o[1])==="$type"&&S.push(new gt(u,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&S.push(new gt(u,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(b=Bn(o[1]),b!=="string"&&S.push(new gt(`${u}[1]`,o[1],`string expected, ${b} found`)));for(let C=2;C<o.length;C++)b=Bn(o[C]),vn(o[1])==="$type"?S=S.concat($a({key:`${u}[${C}]`,value:o[C],valueSpec:g.geometry_type,style:l.style,styleSpec:l.styleSpec})):b!=="string"&&b!=="number"&&b!=="boolean"&&S.push(new gt(`${u}[${C}]`,o[C],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let C=1;C<o.length;C++)S=S.concat(sa({key:`${u}[${C}]`,value:o[C],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":b=Bn(o[1]),o.length!==2?S.push(new gt(u,o,`filter array for "${o[0]}" operator must have 2 elements`)):b!=="string"&&S.push(new gt(`${u}[1]`,o[1],`string expected, ${b} found`));break;case"within":b=Bn(o[1]),o.length!==2?S.push(new gt(u,o,`filter array for "${o[0]}" operator must have 2 elements`)):b!=="object"&&S.push(new gt(`${u}[1]`,o[1],`object expected, ${b} found`))}return S}function qa(l,o){const u=l.key,g=l.style,b=l.styleSpec,S=l.value,C=l.objectKey,R=b[`${o}_${l.layerType}`];if(!R)return[];const F=C.match(/^(.*)-transition$/);if(o==="paint"&&F&&R[F[1]]&&R[F[1]].transition)return Tr({key:u,value:S,valueSpec:b.transition,style:g,styleSpec:b});const j=l.valueSpec||R[C];if(!j)return[new gt(u,S,`unknown property "${C}"`)];let Z;if(Bn(S)==="string"&&Yn(j)&&!j.tokens&&(Z=/^{([^}]+)}$/.exec(S)))return[new gt(u,S,`"${C}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Z[1])} }\`.`)];const Y=[];return l.layerType==="symbol"&&(C==="text-field"&&g&&!g.glyphs&&Y.push(new gt(u,S,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&Qn(dr(S))&&vn(S.type)==="identity"&&Y.push(new gt(u,S,'"text-font" does not support identity functions'))),Y.concat(Tr({key:l.key,value:S,valueSpec:j,style:g,styleSpec:b,expressionContext:"property",propertyType:o,propertyKey:C}))}function Pc(l){return qa(l,"paint")}function ju(l){return qa(l,"layout")}function Bl(l){let o=[];const u=l.value,g=l.key,b=l.style,S=l.styleSpec;u.type||u.ref||o.push(new gt(g,u,'either "type" or "ref" is required'));let C=vn(u.type);const R=vn(u.ref);if(u.id){const F=vn(u.id);for(let j=0;j<l.arrayIndex;j++){const Z=b.layers[j];vn(Z.id)===F&&o.push(new gt(g,u.id,`duplicate layer id "${u.id}", previously used at line ${Z.id.__line__}`))}}if("ref"in u){let F;["type","source","source-layer","filter","layout"].forEach(j=>{j in u&&o.push(new gt(g,u[j],`"${j}" is prohibited for ref layers`))}),b.layers.forEach(j=>{vn(j.id)===R&&(F=j)}),F?F.ref?o.push(new gt(g,u.ref,"ref cannot reference another ref layer")):C=vn(F.type):o.push(new gt(g,u.ref,`ref layer "${R}" not found`))}else if(C!=="background")if(u.source){const F=b.sources&&b.sources[u.source],j=F&&vn(F.type);F?j==="vector"&&C==="raster"?o.push(new gt(g,u.source,`layer "${u.id}" requires a raster source`)):j==="raster"&&C!=="raster"?o.push(new gt(g,u.source,`layer "${u.id}" requires a vector source`)):j!=="vector"||u["source-layer"]?j==="raster-dem"&&C!=="hillshade"?o.push(new gt(g,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):C!=="line"||!u.paint||!u.paint["line-gradient"]||j==="geojson"&&F.lineMetrics||o.push(new gt(g,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new gt(g,u,`layer "${u.id}" must specify a "source-layer"`)):o.push(new gt(g,u.source,`source "${u.source}" not found`))}else o.push(new gt(g,u,'missing required property "source"'));return o=o.concat(Jr({key:g,value:u,valueSpec:S.layer,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Tr({key:`${g}.type`,value:u.type,valueSpec:S.layer.type,style:l.style,styleSpec:l.styleSpec,object:u,objectKey:"type"}),filter:Lo,layout:F=>Jr({layer:u,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":j=>ju(Ki({layerType:C},j))}}),paint:F=>Jr({layer:u,key:F.key,value:F.value,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":j=>Pc(Ki({layerType:C},j))}})}})),o}function aa(l){const o=l.value,u=l.key,g=Bn(o);return g!=="string"?[new gt(u,o,`string expected, ${g} found`)]:[]}const Gu={promoteId:function({key:l,value:o}){if(Bn(o)==="string")return aa({key:l,value:o});{const u=[];for(const g in o)u.push(...aa({key:`${l}.${g}`,value:o[g]}));return u}}};function la(l){const o=l.value,u=l.key,g=l.styleSpec,b=l.style;if(!o.type)return[new gt(u,o,'"type" is required')];const S=vn(o.type);let C;switch(S){case"vector":case"raster":case"raster-dem":return C=Jr({key:u,value:o,valueSpec:g[`source_${S.replace("-","_")}`],style:l.style,styleSpec:g,objectElementValidators:Gu}),C;case"geojson":if(C=Jr({key:u,value:o,valueSpec:g.source_geojson,style:b,styleSpec:g,objectElementValidators:Gu}),o.cluster)for(const R in o.clusterProperties){const[F,j]=o.clusterProperties[R],Z=typeof F=="string"?[F,["accumulated"],["get",R]]:F;C.push(...Ls({key:`${u}.${R}.map`,value:j,expressionContext:"cluster-map"})),C.push(...Ls({key:`${u}.${R}.reduce`,value:Z,expressionContext:"cluster-reduce"}))}return C;case"video":return Jr({key:u,value:o,valueSpec:g.source_video,style:b,styleSpec:g});case"image":return Jr({key:u,value:o,valueSpec:g.source_image,style:b,styleSpec:g});case"canvas":return[new gt(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return $a({key:`${u}.type`,value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:b,styleSpec:g})}}function ca(l){const o=l.value,u=l.styleSpec,g=u.light,b=l.style;let S=[];const C=Bn(o);if(o===void 0)return S;if(C!=="object")return S=S.concat([new gt("light",o,`object expected, ${C} found`)]),S;for(const R in o){const F=R.match(/^(.*)-transition$/);S=S.concat(F&&g[F[1]]&&g[F[1]].transition?Tr({key:R,value:o[R],valueSpec:u.transition,style:b,styleSpec:u}):g[R]?Tr({key:R,value:o[R],valueSpec:g[R],style:b,styleSpec:u}):[new gt(R,o[R],`unknown property "${R}"`)])}return S}function Hi(l){const o=l.value,u=l.styleSpec,g=u.terrain,b=l.style;let S=[];const C=Bn(o);if(o===void 0)return S;if(C!=="object")return S=S.concat([new gt("terrain",o,`object expected, ${C} found`)]),S;for(const R in o)S=S.concat(g[R]?Tr({key:R,value:o[R],valueSpec:g[R],style:b,styleSpec:u}):[new gt(R,o[R],`unknown property "${R}"`)]);return S}const yo={"*":()=>[],array:Nu,boolean:function(l){const o=l.value,u=l.key,g=Bn(o);return g!=="boolean"?[new gt(u,o,`boolean expected, ${g} found`)]:[]},number:Cc,color:function(l){const o=l.key,u=l.value,g=Bn(u);return g!=="string"?[new gt(o,u,`color expected, ${g} found`)]:mo(u)===null?[new gt(o,u,`color expected, "${u}" found`)]:[]},constants:po,enum:$a,filter:Lo,function:Uu,layer:Bl,object:Jr,source:la,light:ca,terrain:Hi,string:aa,formatted:function(l){return aa(l).length===0?[]:Ls(l)},resolvedImage:function(l){return aa(l).length===0?[]:Ls(l)},padding:function(l){const o=l.key,u=l.value;if(Bn(u)==="array"){if(u.length<1||u.length>4)return[new gt(o,u,`padding requires 1 to 4 values; ${u.length} values found`)];const g={type:"number"};let b=[];for(let S=0;S<u.length;S++)b=b.concat(Tr({key:`${o}[${S}]`,value:u[S],valueSpec:g}));return b}return Cc({key:o,value:u,valueSpec:{}})}};function Tr(l){const o=l.value,u=l.valueSpec,g=l.styleSpec;return u.expression&&Qn(vn(o))?Uu(l):u.expression&&ja(dr(o))?Ls(l):u.type&&yo[u.type]?yo[u.type](l):Jr(Ki({},l,{valueSpec:u.type?g[u.type]:u}))}function Qa(l){const o=l.value,u=l.key,g=aa(l);return g.length||(o.indexOf("{fontstack}")===-1&&g.push(new gt(u,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&g.push(new gt(u,o,'"glyphs" url must include a "{range}" token'))),g}function ls(l,o=et){let u=[];return u=u.concat(Tr({key:"",value:l,valueSpec:o.$root,styleSpec:o,style:l,objectElementValidators:{glyphs:Qa,"*":()=>[]}})),l.constants&&(u=u.concat(po({key:"constants",value:l.constants,style:l,styleSpec:o}))),Hu(u)}function Hu(l){return[].concat(l).sort((o,u)=>o.line-u.line)}function Ro(l){return function(...o){return Hu(l.apply(this,o))}}ls.source=Ro(la),ls.light=Ro(ca),ls.terrain=Ro(Hi),ls.layer=Ro(Bl),ls.filter=Ro(Lo),ls.paintProperty=Ro(Pc),ls.layoutProperty=Ro(ju);const Xa=ls,Lc=Xa.light,Th=Xa.paintProperty,Sh=Xa.layoutProperty;function ua(l,o){let u=!1;if(o&&o.length)for(const g of o)l.fire(new is(new Error(g.message))),u=!0;return u}class fa{constructor(o,u,g){const b=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;const C=new Int32Array(this.arrayBuffer);o=C[0],this.d=(u=C[1])+2*(g=C[2]);for(let F=0;F<this.d*this.d;F++){const j=C[3+F],Z=C[3+F+1];b.push(j===Z?null:C.subarray(j,Z))}const R=C[3+b.length+1];this.keys=C.subarray(C[3+b.length],R),this.bboxes=C.subarray(R),this.insert=this._insertReadonly}else{this.d=u+2*g;for(let C=0;C<this.d*this.d;C++)b.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=o,this.padding=g,this.scale=u/o,this.uid=0;const S=g/u*o;this.min=-S,this.max=o+S}insert(o,u,g,b,S){this._forEachCell(u,g,b,S,this._insertCell,this.uid++,void 0,void 0),this.keys.push(o),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(b),this.bboxes.push(S)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(o,u,g,b,S,C){this.cells[S].push(C)}query(o,u,g,b,S){const C=this.min,R=this.max;if(o<=C&&u<=C&&R<=g&&R<=b&&!S)return Array.prototype.slice.call(this.keys);{const F=[];return this._forEachCell(o,u,g,b,this._queryCell,F,{},S),F}}_queryCell(o,u,g,b,S,C,R,F){const j=this.cells[S];if(j!==null){const Z=this.keys,Y=this.bboxes;for(let re=0;re<j.length;re++){const fe=j[re];if(R[fe]===void 0){const he=4*fe;(F?F(Y[he+0],Y[he+1],Y[he+2],Y[he+3]):o<=Y[he+2]&&u<=Y[he+3]&&g>=Y[he+0]&&b>=Y[he+1])?(R[fe]=!0,C.push(Z[fe])):R[fe]=!1}}}}_forEachCell(o,u,g,b,S,C,R,F){const j=this._convertToCellCoord(o),Z=this._convertToCellCoord(u),Y=this._convertToCellCoord(g),re=this._convertToCellCoord(b);for(let fe=j;fe<=Y;fe++)for(let he=Z;he<=re;he++){const Pe=this.d*he+fe;if((!F||F(this._convertFromCellCoord(fe),this._convertFromCellCoord(he),this._convertFromCellCoord(fe+1),this._convertFromCellCoord(he+1)))&&S.call(this,o,u,g,b,Pe,C,R,F))return}}_convertFromCellCoord(o){return(o-this.padding)/this.scale}_convertToCellCoord(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const o=this.cells,u=3+this.cells.length+1+1;let g=0;for(let C=0;C<this.cells.length;C++)g+=this.cells[C].length;const b=new Int32Array(u+g+this.keys.length+this.bboxes.length);b[0]=this.extent,b[1]=this.n,b[2]=this.padding;let S=u;for(let C=0;C<o.length;C++){const R=o[C];b[3+C]=S,b.set(R,S),S+=R.length}return b[3+o.length]=S,b.set(this.keys,S),S+=this.keys.length,b[3+o.length+1]=S,b.set(this.bboxes,S),S+=this.bboxes.length,b.buffer}static serialize(o,u){const g=o.toArrayBuffer();return u&&u.push(g),{buffer:g}}static deserialize(o){return new fa(o.buffer)}}const to={};function Pt(l,o,u={}){if(to[l])throw new Error(`${l} is already registered.`);Object.defineProperty(o,"_classRegistryKey",{value:l,writeable:!1}),to[l]={klass:o,omit:u.omit||[],shallow:u.shallow||[]}}Pt("Object",Object),Pt("TransferableGridIndex",fa),Pt("Color",f),Pt("Error",Error),Pt("AJAXError",Si),Pt("ResolvedImage",Me),Pt("StylePropertyFunction",Gn),Pt("StyleExpression",Va,{omit:["_evaluator"]}),Pt("ZoomDependentExpression",Ga),Pt("ZoomConstantExpression",Ps),Pt("CompoundExpression",wn,{omit:["_evaluate"]});for(const l in na)na[l]._classRegistryKey||Pt(`Expression_${l}`,na[l]);function $u(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Ds(l,o){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob)return l;if($u(l)||jt(l))return o&&o.push(l),l;if(ArrayBuffer.isView(l)){const u=l;return o&&o.push(u.buffer),u}if(l instanceof ImageData)return o&&o.push(l.data.buffer),l;if(Array.isArray(l)){const u=[];for(const g of l)u.push(Ds(g,o));return u}if(typeof l=="object"){const u=l.constructor,g=u._classRegistryKey;if(!g)throw new Error("can't serialize object of unregistered class");if(!to[g])throw new Error(`${g} is not registered.`);const b=u.serialize?u.serialize(l,o):{};if(u.serialize){if(o&&b===o[o.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const S in l){if(!l.hasOwnProperty(S)||to[g].omit.indexOf(S)>=0)continue;const C=l[S];b[S]=to[g].shallow.indexOf(S)>=0?C:Ds(C,o)}l instanceof Error&&(b.message=l.message)}if(b.$name)throw new Error("$name property is reserved for worker serialization logic.");return g!=="Object"&&(b.$name=g),b}throw new Error("can't serialize object of type "+typeof l)}function cs(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||$u(l)||jt(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(cs);if(typeof l=="object"){const o=l.$name||"Object";if(!to[o])throw new Error(`can't deserialize unregistered class ${o}`);const{klass:u}=to[o];if(!u)throw new Error(`can't deserialize unregistered class ${o}`);if(u.deserialize)return u.deserialize(l);const g=Object.create(u.prototype);for(const b of Object.keys(l)){if(b==="$name")continue;const S=l[b];g[b]=to[o].shallow.indexOf(b)>=0?S:cs(S)}return g}throw new Error("can't deserialize object of type "+typeof l)}class Rc{constructor(){this.first=!0}update(o,u){const g=Math.floor(o);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=o,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=u),o!==this.lastZoom&&(this.lastZoom=o,this.lastFloorZoom=g,!0))}}const St={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function Ol(l){for(const o of l)if(Fl(o.charCodeAt(0)))return!0;return!1}function Wu(l){for(const o of l)if(!Dc(o.charCodeAt(0)))return!1;return!0}function Dc(l){return!(St.Arabic(l)||St["Arabic Supplement"](l)||St["Arabic Extended-A"](l)||St["Arabic Presentation Forms-A"](l)||St["Arabic Presentation Forms-B"](l))}function Fl(l){return!(l!==746&&l!==747&&(l<4352||!(St["Bopomofo Extended"](l)||St.Bopomofo(l)||St["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||St["CJK Compatibility Ideographs"](l)||St["CJK Compatibility"](l)||St["CJK Radicals Supplement"](l)||St["CJK Strokes"](l)||!(!St["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||St["CJK Unified Ideographs Extension A"](l)||St["CJK Unified Ideographs"](l)||St["Enclosed CJK Letters and Months"](l)||St["Hangul Compatibility Jamo"](l)||St["Hangul Jamo Extended-A"](l)||St["Hangul Jamo Extended-B"](l)||St["Hangul Jamo"](l)||St["Hangul Syllables"](l)||St.Hiragana(l)||St["Ideographic Description Characters"](l)||St.Kanbun(l)||St["Kangxi Radicals"](l)||St["Katakana Phonetic Extensions"](l)||St.Katakana(l)&&l!==12540||!(!St["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!St["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||St["Unified Canadian Aboriginal Syllabics"](l)||St["Unified Canadian Aboriginal Syllabics Extended"](l)||St["Vertical Forms"](l)||St["Yijing Hexagram Symbols"](l)||St["Yi Syllables"](l)||St["Yi Radicals"](l))))}function vo(l){return!(Fl(l)||function(o){return!!(St["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||St["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||St["Letterlike Symbols"](o)||St["Number Forms"](o)||St["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||St["Control Pictures"](o)&&o!==9251||St["Optical Character Recognition"](o)||St["Enclosed Alphanumerics"](o)||St["Geometric Shapes"](o)||St["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||St["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||St["CJK Symbols and Punctuation"](o)||St.Katakana(o)||St["Private Use Area"](o)||St["CJK Compatibility Forms"](o)||St["Small Form Variants"](o)||St["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(l))}function zc(l){return l>=1424&&l<=2303||St["Arabic Presentation Forms-A"](l)||St["Arabic Presentation Forms-B"](l)}function Mh(l,o){return!(!o&&zc(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||St.Khmer(l))}function Zu(l){for(const o of l)if(zc(o.charCodeAt(0)))return!0;return!1}const Bc="deferred",Oc="loading",Fc="loaded";let xo=null,sr="unavailable",Do=null;const qu=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(sr="error"),xo&&xo(l)};function ha(){Nc.fire(new wr("pluginStateChange",{pluginStatus:sr,pluginURL:Do}))}const Nc=new Br,Ya=function(){return sr},Qu=function(){if(sr!==Bc||!Do)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");sr=Oc,ha(),Do&&xi({url:Do},l=>{l?qu(l):(sr=Fc,ha())})},Fr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>sr===Fc||Fr.applyArabicShaping!=null,isLoading:()=>sr===Oc,setState(l){if(!it())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");sr=l.pluginStatus,Do=l.pluginURL},isParsed(){if(!it())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Fr.applyArabicShaping!=null&&Fr.processBidirectionalText!=null&&Fr.processStyledBidirectionalText!=null},getPluginURL(){if(!it())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Do}};class Kn{constructor(o,u){this.zoom=o,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.zoomHistory=u.zoomHistory,this.transition=u.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Rc,this.transition={})}isSupportedScript(o){return function(u,g){for(const b of u)if(!Mh(b.charCodeAt(0),g))return!1;return!0}(o,Fr.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const o=this.zoom,u=o-Math.floor(o),g=this.crossFadingFactor();return o>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*u}}}class Ka{constructor(o,u){this.property=o,this.value=u,this.expression=function(g,b){if(Qn(g))return new Gn(g,b);if(ja(g)){const S=Ha(g,b);if(S.result==="error")throw new Error(S.value.map(C=>`${C.key}: ${C.message}`).join(", "));return S.value}{let S=g;return b.type==="color"&&typeof g=="string"?S=f.parse(g):b.type!=="padding"||typeof g!="number"&&!Array.isArray(g)||(S=we.parse(g)),{kind:"constant",evaluate:()=>S}}}(u===void 0?o.specification.default:u,o.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,u,g){return this.property.possiblyEvaluate(this,o,u,g)}}class Nl{constructor(o){this.property=o,this.value=new Ka(o,void 0)}transitioned(o,u){return new Yu(this.property,this.value,u,ee({},o.transition,this.transition),o.now)}untransitioned(){return new Yu(this.property,this.value,null,{},0)}}class Xu{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return te(this._values[o].value.value)}setValue(o,u){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new Nl(this._values[o].property)),this._values[o].value=new Ka(this._values[o].property,u===null?void 0:te(u))}getTransition(o){return te(this._values[o].transition)}setTransition(o,u){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new Nl(this._values[o].property)),this._values[o].transition=te(u)||void 0}serialize(){const o={};for(const u of Object.keys(this._values)){const g=this.getValue(u);g!==void 0&&(o[u]=g);const b=this.getTransition(u);b!==void 0&&(o[`${u}-transition`]=b)}return o}transitioned(o,u){const g=new Uc(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].transitioned(o,u._values[b]);return g}untransitioned(){const o=new Uc(this._properties);for(const u of Object.keys(this._values))o._values[u]=this._values[u].untransitioned();return o}}class Yu{constructor(o,u,g,b,S){this.property=o,this.value=u,this.begin=S+b.delay||0,this.end=this.begin+b.duration||0,o.specification.transition&&(b.delay||b.duration)&&(this.prior=g)}possiblyEvaluate(o,u,g){const b=o.now||0,S=this.value.possiblyEvaluate(o,u,g),C=this.prior;if(C){if(b>this.end)return this.prior=null,S;if(this.value.isDataDriven())return this.prior=null,S;if(b<this.begin)return C.possiblyEvaluate(o,u,g);{const R=(b-this.begin)/(this.end-this.begin);return this.property.interpolate(C.possiblyEvaluate(o,u,g),S,function(F){if(F<=0)return 0;if(F>=1)return 1;const j=F*F,Z=j*F;return 4*(F<.5?Z:3*(F-j)+Z-.75)}(R))}}return S}}class Uc{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,u,g){const b=new Ja(this._properties);for(const S of Object.keys(this._values))b._values[S]=this._values[S].possiblyEvaluate(o,u,g);return b}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class Ku{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return te(this._values[o].value)}setValue(o,u){this._values[o]=new Ka(this._values[o].property,u===null?void 0:te(u))}serialize(){const o={};for(const u of Object.keys(this._values)){const g=this.getValue(u);g!==void 0&&(o[u]=g)}return o}possiblyEvaluate(o,u,g){const b=new Ja(this._properties);for(const S of Object.keys(this._values))b._values[S]=this._values[S].possiblyEvaluate(o,u,g);return b}}class Hn{constructor(o,u,g){this.property=o,this.value=u,this.parameters=g}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,u,g,b){return this.property.evaluate(this.value,this.parameters,o,u,g,b)}}class Ja{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class Ut{constructor(o){this.specification=o}possiblyEvaluate(o,u){if(o.isDataDriven())throw new Error("Value should not be data driven");return o.expression.evaluate(u)}interpolate(o,u,g){const b=gi[this.specification.type];return b?b(o,u,g):o}}class qt{constructor(o,u){this.specification=o,this.overrides=u}possiblyEvaluate(o,u,g,b){return new Hn(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(u,null,{},g,b)}:o.expression,u)}interpolate(o,u,g){if(o.value.kind!=="constant"||u.value.kind!=="constant")return o;if(o.value.value===void 0||u.value.value===void 0)return new Hn(this,{kind:"constant",value:void 0},o.parameters);const b=gi[this.specification.type];return b?new Hn(this,{kind:"constant",value:b(o.value.value,u.value.value,g)},o.parameters):o}evaluate(o,u,g,b,S,C){return o.kind==="constant"?o.value:o.evaluate(u,g,b,S,C)}}class $i extends qt{possiblyEvaluate(o,u,g,b){if(o.value===void 0)return new Hn(this,{kind:"constant",value:void 0},u);if(o.expression.kind==="constant"){const S=o.expression.evaluate(u,null,{},g,b),C=o.property.specification.type==="resolvedImage"&&typeof S!="string"?S.name:S,R=this._calculate(C,C,C,u);return new Hn(this,{kind:"constant",value:R},u)}if(o.expression.kind==="camera"){const S=this._calculate(o.expression.evaluate({zoom:u.zoom-1}),o.expression.evaluate({zoom:u.zoom}),o.expression.evaluate({zoom:u.zoom+1}),u);return new Hn(this,{kind:"constant",value:S},u)}return new Hn(this,o.expression,u)}evaluate(o,u,g,b,S,C){if(o.kind==="source"){const R=o.evaluate(u,g,b,S,C);return this._calculate(R,R,R,u)}return o.kind==="composite"?this._calculate(o.evaluate({zoom:Math.floor(u.zoom)-1},g,b),o.evaluate({zoom:Math.floor(u.zoom)},g,b),o.evaluate({zoom:Math.floor(u.zoom)+1},g,b),u):o.value}_calculate(o,u,g,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:o,to:u}:{from:g,to:u}}interpolate(o){return o}}class Vc{constructor(o){this.specification=o}possiblyEvaluate(o,u,g,b){if(o.value!==void 0){if(o.expression.kind==="constant"){const S=o.expression.evaluate(u,null,{},g,b);return this._calculate(S,S,S,u)}return this._calculate(o.expression.evaluate(new Kn(Math.floor(u.zoom-1),u)),o.expression.evaluate(new Kn(Math.floor(u.zoom),u)),o.expression.evaluate(new Kn(Math.floor(u.zoom+1),u)),u)}}_calculate(o,u,g,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:o,to:u}:{from:g,to:u}}interpolate(o){return o}}class us{constructor(o){this.specification=o}possiblyEvaluate(o,u,g,b){return!!o.expression.evaluate(u,null,{},g,b)}interpolate(){return!1}}class Wi{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in o){const g=o[u];g.specification.overridable&&this.overridableProperties.push(u);const b=this.defaultPropertyValues[u]=new Ka(g,void 0),S=this.defaultTransitionablePropertyValues[u]=new Nl(g);this.defaultTransitioningPropertyValues[u]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=b.possiblyEvaluate({})}}}Pt("DataDrivenProperty",qt),Pt("DataConstantProperty",Ut),Pt("CrossFadedDataDrivenProperty",$i),Pt("CrossFadedProperty",Vc),Pt("ColorRampProperty",us);const zo="-transition";class no extends Br{constructor(o,u){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1},o.type!=="custom"&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type!=="background"&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),u.layout&&(this._unevaluatedLayout=new Ku(u.layout)),u.paint)){this._transitionablePaint=new Xu(u.paint);for(const g in o.paint)this.setPaintProperty(g,o.paint[g],{validate:!1});for(const g in o.layout)this.setLayoutProperty(g,o.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ja(u.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,u,g={}){u!=null&&this._validate(Sh,`layers.${this.id}.layout.${o}`,o,u,g)||(o!=="visibility"?this._unevaluatedLayout.setValue(o,u):this.visibility=u)}getPaintProperty(o){return o.endsWith(zo)?this._transitionablePaint.getTransition(o.slice(0,-zo.length)):this._transitionablePaint.getValue(o)}setPaintProperty(o,u,g={}){if(u!=null&&this._validate(Th,`layers.${this.id}.paint.${o}`,o,u,g))return!1;if(o.endsWith(zo))return this._transitionablePaint.setTransition(o.slice(0,-zo.length),u||void 0),!1;{const b=this._transitionablePaint._values[o],S=b.property.specification["property-type"]==="cross-faded-data-driven",C=b.value.isDataDriven(),R=b.value;this._transitionablePaint.setValue(o,u),this._handleSpecialPaintPropertyUpdate(o);const F=this._transitionablePaint._values[o].value;return F.isDataDriven()||C||S||this._handleOverridablePaintPropertyUpdate(o,R,F)}}_handleSpecialPaintPropertyUpdate(o){}_handleOverridablePaintPropertyUpdate(o,u,g){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,u){o.getCrossfadeParameters&&(this._crossfadeParameters=o.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,u)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),ne(o,(u,g)=>!(u===void 0||g==="layout"&&!Object.keys(u).length||g==="paint"&&!Object.keys(u).length))}_validate(o,u,g,b,S={}){return(!S||S.validate!==!1)&&ua(this,o.call(Xa,{key:u,layerType:this.type,objectKey:g,value:b,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const u=this.paint.get(o);if(u instanceof Hn&&Yn(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}const jc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Bo{constructor(o,u){this._structArray=o,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class li{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,u){return o._trim(),u&&(o.isTransferred=!0,u.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const u=Object.create(this.prototype);return u.arrayBuffer=o.arrayBuffer,u.length=o.length,u.capacity=o.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function bi(l,o=1){let u=0,g=0;return{members:l.map(b=>{const S=jc[b.type].BYTES_PER_ELEMENT,C=u=Gc(u,Math.max(o,S)),R=b.components||1;return g=Math.max(g,S),u+=S*R,{name:b.name,type:b.type,components:R,offset:C}}),size:Gc(u,Math.max(g,o)),alignment:o}}function Gc(l,o){return Math.ceil(l/o)*o}class zs extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u){const g=this.length;return this.resize(g+1),this.emplace(g,o,u)}emplace(o,u,g){const b=2*o;return this.int16[b+0]=u,this.int16[b+1]=g,o}}zs.prototype.bytesPerElement=4,Pt("StructArrayLayout2i4",zs);class x extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,g,b){const S=this.length;return this.resize(S+1),this.emplace(S,o,u,g,b)}emplace(o,u,g,b,S){const C=4*o;return this.int16[C+0]=u,this.int16[C+1]=g,this.int16[C+2]=b,this.int16[C+3]=S,o}}x.prototype.bytesPerElement=8,Pt("StructArrayLayout4i8",x);class s extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,g,b,S,C){const R=this.length;return this.resize(R+1),this.emplace(R,o,u,g,b,S,C)}emplace(o,u,g,b,S,C,R){const F=6*o;return this.int16[F+0]=u,this.int16[F+1]=g,this.int16[F+2]=b,this.int16[F+3]=S,this.int16[F+4]=C,this.int16[F+5]=R,o}}s.prototype.bytesPerElement=12,Pt("StructArrayLayout2i4i12",s);class A extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,g,b,S,C){const R=this.length;return this.resize(R+1),this.emplace(R,o,u,g,b,S,C)}emplace(o,u,g,b,S,C,R){const F=4*o,j=8*o;return this.int16[F+0]=u,this.int16[F+1]=g,this.uint8[j+4]=b,this.uint8[j+5]=S,this.uint8[j+6]=C,this.uint8[j+7]=R,o}}A.prototype.bytesPerElement=8,Pt("StructArrayLayout2i4ub8",A);class y extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u){const g=this.length;return this.resize(g+1),this.emplace(g,o,u)}emplace(o,u,g){const b=2*o;return this.float32[b+0]=u,this.float32[b+1]=g,o}}y.prototype.bytesPerElement=8,Pt("StructArrayLayout2f8",y);class w extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,g,b,S,C,R,F,j,Z){const Y=this.length;return this.resize(Y+1),this.emplace(Y,o,u,g,b,S,C,R,F,j,Z)}emplace(o,u,g,b,S,C,R,F,j,Z,Y){const re=10*o;return this.uint16[re+0]=u,this.uint16[re+1]=g,this.uint16[re+2]=b,this.uint16[re+3]=S,this.uint16[re+4]=C,this.uint16[re+5]=R,this.uint16[re+6]=F,this.uint16[re+7]=j,this.uint16[re+8]=Z,this.uint16[re+9]=Y,o}}w.prototype.bytesPerElement=20,Pt("StructArrayLayout10ui20",w);class M extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,g,b,S,C,R,F,j,Z,Y,re){const fe=this.length;return this.resize(fe+1),this.emplace(fe,o,u,g,b,S,C,R,F,j,Z,Y,re)}emplace(o,u,g,b,S,C,R,F,j,Z,Y,re,fe){const he=12*o;return this.int16[he+0]=u,this.int16[he+1]=g,this.int16[he+2]=b,this.int16[he+3]=S,this.uint16[he+4]=C,this.uint16[he+5]=R,this.uint16[he+6]=F,this.uint16[he+7]=j,this.int16[he+8]=Z,this.int16[he+9]=Y,this.int16[he+10]=re,this.int16[he+11]=fe,o}}M.prototype.bytesPerElement=24,Pt("StructArrayLayout4i4ui4i24",M);class L extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,o,u,g)}emplace(o,u,g,b){const S=3*o;return this.float32[S+0]=u,this.float32[S+1]=g,this.float32[S+2]=b,o}}L.prototype.bytesPerElement=12,Pt("StructArrayLayout3f12",L);class N extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.uint32[1*o+0]=u,o}}N.prototype.bytesPerElement=4,Pt("StructArrayLayout1ul4",N);class V extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,g,b,S,C,R,F,j){const Z=this.length;return this.resize(Z+1),this.emplace(Z,o,u,g,b,S,C,R,F,j)}emplace(o,u,g,b,S,C,R,F,j,Z){const Y=10*o,re=5*o;return this.int16[Y+0]=u,this.int16[Y+1]=g,this.int16[Y+2]=b,this.int16[Y+3]=S,this.int16[Y+4]=C,this.int16[Y+5]=R,this.uint32[re+3]=F,this.uint16[Y+8]=j,this.uint16[Y+9]=Z,o}}V.prototype.bytesPerElement=20,Pt("StructArrayLayout6i1ul2ui20",V);class $ extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,g,b,S,C){const R=this.length;return this.resize(R+1),this.emplace(R,o,u,g,b,S,C)}emplace(o,u,g,b,S,C,R){const F=6*o;return this.int16[F+0]=u,this.int16[F+1]=g,this.int16[F+2]=b,this.int16[F+3]=S,this.int16[F+4]=C,this.int16[F+5]=R,o}}$.prototype.bytesPerElement=12,Pt("StructArrayLayout2i2i2i12",$);class Q extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,g,b,S){const C=this.length;return this.resize(C+1),this.emplace(C,o,u,g,b,S)}emplace(o,u,g,b,S,C){const R=4*o,F=8*o;return this.float32[R+0]=u,this.float32[R+1]=g,this.float32[R+2]=b,this.int16[F+6]=S,this.int16[F+7]=C,o}}Q.prototype.bytesPerElement=16,Pt("StructArrayLayout2f1f2i16",Q);class J extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,g,b){const S=this.length;return this.resize(S+1),this.emplace(S,o,u,g,b)}emplace(o,u,g,b,S){const C=12*o,R=3*o;return this.uint8[C+0]=u,this.uint8[C+1]=g,this.float32[R+1]=b,this.float32[R+2]=S,o}}J.prototype.bytesPerElement=12,Pt("StructArrayLayout2ub2f12",J);class ce extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,o,u,g)}emplace(o,u,g,b){const S=3*o;return this.uint16[S+0]=u,this.uint16[S+1]=g,this.uint16[S+2]=b,o}}ce.prototype.bytesPerElement=6,Pt("StructArrayLayout3ui6",ce);class ye extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,g,b,S,C,R,F,j,Z,Y,re,fe,he,Pe,Se,Ue){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,o,u,g,b,S,C,R,F,j,Z,Y,re,fe,he,Pe,Se,Ue)}emplace(o,u,g,b,S,C,R,F,j,Z,Y,re,fe,he,Pe,Se,Ue,Qe){const Oe=24*o,We=12*o,at=48*o;return this.int16[Oe+0]=u,this.int16[Oe+1]=g,this.uint16[Oe+2]=b,this.uint16[Oe+3]=S,this.uint32[We+2]=C,this.uint32[We+3]=R,this.uint32[We+4]=F,this.uint16[Oe+10]=j,this.uint16[Oe+11]=Z,this.uint16[Oe+12]=Y,this.float32[We+7]=re,this.float32[We+8]=fe,this.uint8[at+36]=he,this.uint8[at+37]=Pe,this.uint8[at+38]=Se,this.uint32[We+10]=Ue,this.int16[Oe+22]=Qe,o}}ye.prototype.bytesPerElement=48,Pt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ye);class _e extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,g,b,S,C,R,F,j,Z,Y,re,fe,he,Pe,Se,Ue,Qe,Oe,We,at,st,Lt,Nt,Ct,wt,vt,kt){const Et=this.length;return this.resize(Et+1),this.emplace(Et,o,u,g,b,S,C,R,F,j,Z,Y,re,fe,he,Pe,Se,Ue,Qe,Oe,We,at,st,Lt,Nt,Ct,wt,vt,kt)}emplace(o,u,g,b,S,C,R,F,j,Z,Y,re,fe,he,Pe,Se,Ue,Qe,Oe,We,at,st,Lt,Nt,Ct,wt,vt,kt,Et){const At=34*o,Yt=17*o;return this.int16[At+0]=u,this.int16[At+1]=g,this.int16[At+2]=b,this.int16[At+3]=S,this.int16[At+4]=C,this.int16[At+5]=R,this.int16[At+6]=F,this.int16[At+7]=j,this.uint16[At+8]=Z,this.uint16[At+9]=Y,this.uint16[At+10]=re,this.uint16[At+11]=fe,this.uint16[At+12]=he,this.uint16[At+13]=Pe,this.uint16[At+14]=Se,this.uint16[At+15]=Ue,this.uint16[At+16]=Qe,this.uint16[At+17]=Oe,this.uint16[At+18]=We,this.uint16[At+19]=at,this.uint16[At+20]=st,this.uint16[At+21]=Lt,this.uint16[At+22]=Nt,this.uint32[Yt+12]=Ct,this.float32[Yt+13]=wt,this.float32[Yt+14]=vt,this.float32[Yt+15]=kt,this.float32[Yt+16]=Et,o}}_e.prototype.bytesPerElement=68,Pt("StructArrayLayout8i15ui1ul4f68",_e);class oe extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.float32[1*o+0]=u,o}}oe.prototype.bytesPerElement=4,Pt("StructArrayLayout1f4",oe);class ge extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,o,u,g)}emplace(o,u,g,b){const S=3*o;return this.int16[S+0]=u,this.int16[S+1]=g,this.int16[S+2]=b,o}}ge.prototype.bytesPerElement=6,Pt("StructArrayLayout3i6",ge);class De extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,o,u,g)}emplace(o,u,g,b){const S=4*o;return this.uint32[2*o+0]=u,this.uint16[S+2]=g,this.uint16[S+3]=b,o}}De.prototype.bytesPerElement=8,Pt("StructArrayLayout1ul2ui8",De);class Ve extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u){const g=this.length;return this.resize(g+1),this.emplace(g,o,u)}emplace(o,u,g){const b=2*o;return this.uint16[b+0]=u,this.uint16[b+1]=g,o}}Ve.prototype.bytesPerElement=4,Pt("StructArrayLayout2ui4",Ve);class Ee extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.uint16[1*o+0]=u,o}}Ee.prototype.bytesPerElement=2,Pt("StructArrayLayout1ui2",Ee);class Ze extends li{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,g,b){const S=this.length;return this.resize(S+1),this.emplace(S,o,u,g,b)}emplace(o,u,g,b,S){const C=4*o;return this.float32[C+0]=u,this.float32[C+1]=g,this.float32[C+2]=b,this.float32[C+3]=S,o}}Ze.prototype.bytesPerElement=16,Pt("StructArrayLayout4f16",Ze);class je extends Bo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Mt(this.anchorPointX,this.anchorPointY)}}je.prototype.size=20;class tt extends V{get(o){return new je(this,o)}}Pt("CollisionBoxArray",tt);class Ke extends Bo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(o){this._structArray.uint8[this._pos1+37]=o}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(o){this._structArray.uint8[this._pos1+38]=o}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(o){this._structArray.uint32[this._pos4+10]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ke.prototype.size=48;class d extends ye{get(o){return new Ke(this,o)}}Pt("PlacedSymbolArray",d);class h extends Bo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(o){this._structArray.uint32[this._pos4+12]=o}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}h.prototype.size=68;class m extends _e{get(o){return new h(this,o)}}Pt("SymbolInstanceArray",m);class _ extends oe{getoffsetX(o){return this.float32[1*o+0]}}Pt("GlyphOffsetArray",_);class v extends ge{getx(o){return this.int16[3*o+0]}gety(o){return this.int16[3*o+1]}gettileUnitDistanceFromAnchor(o){return this.int16[3*o+2]}}Pt("SymbolLineVertexArray",v);class E extends Bo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}E.prototype.size=8;class I extends De{get(o){return new E(this,o)}}Pt("FeatureIndexArray",I);class P extends zs{}class O extends zs{}class G extends zs{}class X extends s{}class de extends A{}class ve extends y{}class Re extends w{}class be extends M{}class ze extends L{}class Je extends N{}class Ye extends ${}class He extends J{}class $e extends ce{}class Be extends Ve{}const bt=bi([{name:"a_pos",components:2,type:"Int16"}],4),{members:yt}=bt;class ot{constructor(o=[]){this.segments=o}prepareSegment(o,u,g,b){let S=this.segments[this.segments.length-1];return o>ot.MAX_VERTEX_ARRAY_LENGTH&&Le(`Max vertices per segment is ${ot.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!S||S.vertexLength+o>ot.MAX_VERTEX_ARRAY_LENGTH||S.sortKey!==b)&&(S={vertexOffset:u.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},b!==void 0&&(S.sortKey=b),this.segments.push(S)),S}get(){return this.segments}destroy(){for(const o of this.segments)for(const u in o.vaos)o.vaos[u].destroy()}static simpleSegment(o,u,g,b){return new ot([{vertexOffset:o,primitiveOffset:u,vertexLength:g,primitiveLength:b,vaos:{},sortKey:0}])}}function ut(l,o){return 256*(l=D(Math.floor(l),0,255))+D(Math.floor(o),0,255)}ot.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pt("SegmentVector",ot);const cn=bi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var on={exports:{}},Kt={exports:{}};Kt.exports=function(l,o){var u,g,b,S,C,R,F,j;for(g=l.length-(u=3&l.length),b=o,C=3432918353,R=461845907,j=0;j<g;)F=255&l.charCodeAt(j)|(255&l.charCodeAt(++j))<<8|(255&l.charCodeAt(++j))<<16|(255&l.charCodeAt(++j))<<24,++j,b=27492+(65535&(S=5*(65535&(b=(b^=F=(65535&(F=(F=(65535&F)*C+(((F>>>16)*C&65535)<<16)&4294967295)<<15|F>>>17))*R+(((F>>>16)*R&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(F=0,u){case 3:F^=(255&l.charCodeAt(j+2))<<16;case 2:F^=(255&l.charCodeAt(j+1))<<8;case 1:b^=F=(65535&(F=(F=(65535&(F^=255&l.charCodeAt(j)))*C+(((F>>>16)*C&65535)<<16)&4294967295)<<15|F>>>17))*R+(((F>>>16)*R&65535)<<16)&4294967295}return b^=l.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0};var tn={exports:{}};tn.exports=function(l,o){for(var u,g=l.length,b=o^g,S=0;g>=4;)u=1540483477*(65535&(u=255&l.charCodeAt(S)|(255&l.charCodeAt(++S))<<8|(255&l.charCodeAt(++S))<<16|(255&l.charCodeAt(++S))<<24))+((1540483477*(u>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),g-=4,++S;switch(g){case 3:b^=(255&l.charCodeAt(S+2))<<16;case 2:b^=(255&l.charCodeAt(S+1))<<8;case 1:b=1540483477*(65535&(b^=255&l.charCodeAt(S)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0};var sn=Kt.exports,fn=tn.exports;on.exports=sn,on.exports.murmur3=sn,on.exports.murmur2=fn;class zn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,u,g,b){this.ids.push(un(o)),this.positions.push(u,g,b)}getPositions(o){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const u=un(o);let g=0,b=this.ids.length-1;for(;g<b;){const C=g+b>>1;this.ids[C]>=u?b=C:g=C+1}const S=[];for(;this.ids[g]===u;)S.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return S}static serialize(o,u){const g=new Float64Array(o.ids),b=new Uint32Array(o.positions);return $n(g,b,0,g.length-1),u&&u.push(g.buffer,b.buffer),{ids:g,positions:b}}static deserialize(o){const u=new zn;return u.ids=o.ids,u.positions=o.positions,u.indexed=!0,u}}function un(l){const o=+l;return!isNaN(o)&&o<=Number.MAX_SAFE_INTEGER?o:on.exports(String(l))}function $n(l,o,u,g){for(;u<g;){const b=l[u+g>>1];let S=u-1,C=g+1;for(;;){do S++;while(l[S]<b);do C--;while(l[C]>b);if(S>=C)break;ci(l,S,C),ci(o,3*S,3*C),ci(o,3*S+1,3*C+1),ci(o,3*S+2,3*C+2)}C-u<g-C?($n(l,o,u,C),u=C+1):($n(l,o,C+1,g),g=C)}}function ci(l,o,u){const g=l[o];l[o]=l[u],l[u]=g}Pt("FeaturePositionMap",zn);class fs{constructor(o,u){this.gl=o.gl,this.location=u}}class el extends fs{constructor(o,u){super(o,u),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class Ju extends fs{constructor(o,u){super(o,u),this.current=[0,0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3]))}}class ev extends fs{constructor(o,u){super(o,u),this.current=f.transparent}set(o){o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a))}}const T5=new Float32Array(16);function Bm(l){return[ut(255*l.r,255*l.g),ut(255*l.b,255*l.a)]}class Ih{constructor(o,u,g){this.value=o,this.uniformNames=u.map(b=>`u_${b}`),this.type=g}setUniform(o,u,g){o.set(g.constantOr(this.value))}getBinding(o,u,g){return this.type==="color"?new ev(o,u):new el(o,u)}}class ef{constructor(o,u){this.uniformNames=u.map(g=>`u_${g}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(o,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=o.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=o.tlbr}setUniform(o,u,g,b){const S=b==="u_pattern_to"?this.patternTo:b==="u_pattern_from"?this.patternFrom:b==="u_pixel_ratio_to"?this.pixelRatioTo:b==="u_pixel_ratio_from"?this.pixelRatioFrom:null;S&&o.set(S)}getBinding(o,u,g){return g.substr(0,9)==="u_pattern"?new Ju(o,u):new el(o,u)}}class tl{constructor(o,u,g,b){this.expression=o,this.type=g,this.maxValue=0,this.paintVertexAttributes=u.map(S=>({name:`a_${S}`,type:"Float32",components:g==="color"?2:1,offset:0})),this.paintVertexArray=new b}populatePaintArray(o,u,g,b,S){const C=this.paintVertexArray.length,R=this.expression.evaluate(new Kn(0),u,{},b,[],S);this.paintVertexArray.resize(o),this._setPaintValue(C,o,R)}updatePaintArray(o,u,g,b){const S=this.expression.evaluate({zoom:0},g,b);this._setPaintValue(o,u,S)}_setPaintValue(o,u,g){if(this.type==="color"){const b=Bm(g);for(let S=o;S<u;S++)this.paintVertexArray.emplace(S,b[0],b[1])}else{for(let b=o;b<u;b++)this.paintVertexArray.emplace(b,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bs{constructor(o,u,g,b,S,C){this.expression=o,this.uniformNames=u.map(R=>`u_${R}_t`),this.type=g,this.useIntegerZoom=b,this.zoom=S,this.maxValue=0,this.paintVertexAttributes=u.map(R=>({name:`a_${R}`,type:"Float32",components:g==="color"?4:2,offset:0})),this.paintVertexArray=new C}populatePaintArray(o,u,g,b,S){const C=this.expression.evaluate(new Kn(this.zoom),u,{},b,[],S),R=this.expression.evaluate(new Kn(this.zoom+1),u,{},b,[],S),F=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(F,o,C,R)}updatePaintArray(o,u,g,b){const S=this.expression.evaluate({zoom:this.zoom},g,b),C=this.expression.evaluate({zoom:this.zoom+1},g,b);this._setPaintValue(o,u,S,C)}_setPaintValue(o,u,g,b){if(this.type==="color"){const S=Bm(g),C=Bm(b);for(let R=o;R<u;R++)this.paintVertexArray.emplace(R,S[0],S[1],C[0],C[1])}else{for(let S=o;S<u;S++)this.paintVertexArray.emplace(S,g,b);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(b))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,u){const g=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,b=D(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);o.set(b)}getBinding(o,u,g){return new el(o,u)}}class Ul{constructor(o,u,g,b,S,C){this.expression=o,this.type=u,this.useIntegerZoom=g,this.zoom=b,this.layerId=C,this.zoomInPaintVertexArray=new S,this.zoomOutPaintVertexArray=new S}populatePaintArray(o,u,g){const b=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(o),this.zoomOutPaintVertexArray.resize(o),this._setPaintValues(b,o,u.patterns&&u.patterns[this.layerId],g)}updatePaintArray(o,u,g,b,S){this._setPaintValues(o,u,g.patterns&&g.patterns[this.layerId],S)}_setPaintValues(o,u,g,b){if(!b||!g)return;const{min:S,mid:C,max:R}=g,F=b[S],j=b[C],Z=b[R];if(F&&j&&Z)for(let Y=o;Y<u;Y++)this.zoomInPaintVertexArray.emplace(Y,j.tl[0],j.tl[1],j.br[0],j.br[1],F.tl[0],F.tl[1],F.br[0],F.br[1],j.pixelRatio,F.pixelRatio),this.zoomOutPaintVertexArray.emplace(Y,j.tl[0],j.tl[1],j.br[0],j.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],j.pixelRatio,Z.pixelRatio)}upload(o){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=o.createVertexBuffer(this.zoomInPaintVertexArray,cn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=o.createVertexBuffer(this.zoomOutPaintVertexArray,cn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class tv{constructor(o,u,g){this.binders={},this._buffers=[];const b=[];for(const S in o.paint._values){if(!g(S))continue;const C=o.paint.get(S);if(!(C instanceof Hn&&Yn(C.property.specification)))continue;const R=S5(S,o.type),F=C.value,j=C.property.specification.type,Z=C.property.useIntegerZoom,Y=C.property.specification["property-type"],re=Y==="cross-faded"||Y==="cross-faded-data-driven";if(F.kind==="constant")this.binders[S]=re?new ef(F.value,R):new Ih(F.value,R,j),b.push(`/u_${S}`);else if(F.kind==="source"||re){const fe=nv(S,j,"source");this.binders[S]=re?new Ul(F,j,Z,u,fe,o.id):new tl(F,R,j,fe),b.push(`/a_${S}`)}else{const fe=nv(S,j,"composite");this.binders[S]=new Bs(F,R,j,Z,u,fe),b.push(`/z_${S}`)}}this.cacheKey=b.sort().join("")}getMaxValue(o){const u=this.binders[o];return u instanceof tl||u instanceof Bs?u.maxValue:0}populatePaintArrays(o,u,g,b,S){for(const C in this.binders){const R=this.binders[C];(R instanceof tl||R instanceof Bs||R instanceof Ul)&&R.populatePaintArray(o,u,g,b,S)}}setConstantPatternPositions(o,u){for(const g in this.binders){const b=this.binders[g];b instanceof ef&&b.setConstantPatternPositions(o,u)}}updatePaintArrays(o,u,g,b,S){let C=!1;for(const R in o){const F=u.getPositions(R);for(const j of F){const Z=g.feature(j.index);for(const Y in this.binders){const re=this.binders[Y];if((re instanceof tl||re instanceof Bs||re instanceof Ul)&&re.expression.isStateDependent===!0){const fe=b.paint.get(Y);re.expression=fe.value,re.updatePaintArray(j.start,j.end,Z,o[R],S),C=!0}}}}return C}defines(){const o=[];for(const u in this.binders){const g=this.binders[u];(g instanceof Ih||g instanceof ef)&&o.push(...g.uniformNames.map(b=>`#define HAS_UNIFORM_${b}`))}return o}getBinderAttributes(){const o=[];for(const u in this.binders){const g=this.binders[u];if(g instanceof tl||g instanceof Bs)for(let b=0;b<g.paintVertexAttributes.length;b++)o.push(g.paintVertexAttributes[b].name);else if(g instanceof Ul)for(let b=0;b<cn.members.length;b++)o.push(cn.members[b].name)}return o}getBinderUniforms(){const o=[];for(const u in this.binders){const g=this.binders[u];if(g instanceof Ih||g instanceof ef||g instanceof Bs)for(const b of g.uniformNames)o.push(b)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o,u){const g=[];for(const b in this.binders){const S=this.binders[b];if(S instanceof Ih||S instanceof ef||S instanceof Bs){for(const C of S.uniformNames)if(u[C]){const R=S.getBinding(o,u[C],C);g.push({name:C,property:b,binding:R})}}}return g}setUniforms(o,u,g,b){for(const{name:S,property:C,binding:R}of u)this.binders[C].setUniform(R,b,g.get(C),S)}updatePaintBuffers(o){this._buffers=[];for(const u in this.binders){const g=this.binders[u];if(o&&g instanceof Ul){const b=o.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;b&&this._buffers.push(b)}else(g instanceof tl||g instanceof Bs)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}}upload(o){for(const u in this.binders){const g=this.binders[u];(g instanceof tl||g instanceof Bs||g instanceof Ul)&&g.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const u=this.binders[o];(u instanceof tl||u instanceof Bs||u instanceof Ul)&&u.destroy()}}}class Hc{constructor(o,u,g=()=>!0){this.programConfigurations={};for(const b of o)this.programConfigurations[b.id]=new tv(b,u,g);this.needsUpload=!1,this._featureMap=new zn,this._bufferOffset=0}populatePaintArrays(o,u,g,b,S,C){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(o,u,b,S,C);u.id!==void 0&&this._featureMap.add(u.id,g,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,u,g,b){for(const S of g)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(o,this._featureMap,u,S,b)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}function S5(l,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(`${o}-`,"").replace(/-/g,"_")]}function nv(l,o,u){const g={color:{source:y,composite:Ze},number:{source:oe,composite:y}},b=function(S){return{"line-pattern":{source:Re,composite:Re},"fill-pattern":{source:Re,composite:Re},"fill-extrusion-pattern":{source:Re,composite:Re}}[S]}(l);return b&&b[u]||g[o][u]}Pt("ConstantBinder",Ih),Pt("CrossFadedConstantBinder",ef),Pt("SourceExpressionBinder",tl),Pt("CrossFadedCompositeBinder",Ul),Pt("CompositeExpressionBinder",Bs),Pt("ProgramConfiguration",tv,{omit:["_buffers"]}),Pt("ProgramConfigurationSet",Hc);var Zi=8192;const Om=Math.pow(2,14)-1,iv=-Om-1;function $c(l){const o=Zi/l.extent,u=l.loadGeometry();for(let g=0;g<u.length;g++){const b=u[g];for(let S=0;S<b.length;S++){const C=b[S],R=Math.round(C.x*o),F=Math.round(C.y*o);C.x=D(R,iv,Om),C.y=D(F,iv,Om),(R<C.x||R>C.x+1||F<C.y||F>C.y+1)&&Le("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function Wc(l,o){return{type:l.type,id:l.id,properties:l.properties,geometry:o?$c(l):[]}}function MA(l,o,u,g,b){l.emplaceBack(2*o+(g+1)/2,2*u+(b+1)/2)}class Fm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new O,this.indexArray=new $e,this.segments=new ot,this.programConfigurations=new Hc(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,g){const b=this.layers[0],S=[];let C=null,R=!1;b.type==="circle"&&(C=b.layout.get("circle-sort-key"),R=!C.isConstant());for(const{feature:F,id:j,index:Z,sourceLayerIndex:Y}of o){const re=this.layers[0]._featureFilter.needGeometry,fe=Wc(F,re);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),fe,g))continue;const he=R?C.evaluate(fe,{},g):void 0,Pe={id:j,properties:F.properties,type:F.type,sourceLayerIndex:Y,index:Z,geometry:re?fe.geometry:$c(F),patterns:{},sortKey:he};S.push(Pe)}R&&S.sort((F,j)=>F.sortKey-j.sortKey);for(const F of S){const{geometry:j,index:Z,sourceLayerIndex:Y}=F,re=o[Z].feature;this.addFeature(F,j,Z,g),u.featureIndex.insert(re,j,Z,Y,this.index)}}update(o,u,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,yt),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,u,g,b){for(const S of u)for(const C of S){const R=C.x,F=C.y;if(R<0||R>=Zi||F<0||F>=Zi)continue;const j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),Z=j.vertexLength;MA(this.layoutVertexArray,R,F,-1,-1),MA(this.layoutVertexArray,R,F,1,-1),MA(this.layoutVertexArray,R,F,1,1),MA(this.layoutVertexArray,R,F,-1,1),this.indexArray.emplaceBack(Z,Z+1,Z+2),this.indexArray.emplaceBack(Z,Z+3,Z+2),j.vertexLength+=4,j.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,{},b)}}function rv(l,o){for(let u=0;u<l.length;u++)if(tf(o,l[u]))return!0;for(let u=0;u<o.length;u++)if(tf(l,o[u]))return!0;return!!Nm(l,o)}function M5(l,o,u){return!!tf(l,o)||!!Um(o,l,u)}function ov(l,o){if(l.length===1)return av(o,l[0]);for(let u=0;u<o.length;u++){const g=o[u];for(let b=0;b<g.length;b++)if(tf(l,g[b]))return!0}for(let u=0;u<l.length;u++)if(av(o,l[u]))return!0;for(let u=0;u<o.length;u++)if(Nm(l,o[u]))return!0;return!1}function I5(l,o,u){if(l.length>1){if(Nm(l,o))return!0;for(let g=0;g<o.length;g++)if(Um(o[g],l,u))return!0}for(let g=0;g<l.length;g++)if(Um(l[g],o,u))return!0;return!1}function Nm(l,o){if(l.length===0||o.length===0)return!1;for(let u=0;u<l.length-1;u++){const g=l[u],b=l[u+1];for(let S=0;S<o.length-1;S++)if(C5(g,b,o[S],o[S+1]))return!0}return!1}function C5(l,o,u,g){return Ge(l,u,g)!==Ge(o,u,g)&&Ge(l,o,u)!==Ge(l,o,g)}function Um(l,o,u){const g=u*u;if(o.length===1)return l.distSqr(o[0])<g;for(let b=1;b<o.length;b++)if(sv(l,o[b-1],o[b])<g)return!0;return!1}function sv(l,o,u){const g=o.distSqr(u);if(g===0)return l.distSqr(o);const b=((l.x-o.x)*(u.x-o.x)+(l.y-o.y)*(u.y-o.y))/g;return l.distSqr(b<0?o:b>1?u:u.sub(o)._mult(b)._add(o))}function av(l,o){let u,g,b,S=!1;for(let C=0;C<l.length;C++){u=l[C];for(let R=0,F=u.length-1;R<u.length;F=R++)g=u[R],b=u[F],g.y>o.y!=b.y>o.y&&o.x<(b.x-g.x)*(o.y-g.y)/(b.y-g.y)+g.x&&(S=!S)}return S}function tf(l,o){let u=!1;for(let g=0,b=l.length-1;g<l.length;b=g++){const S=l[g],C=l[b];S.y>o.y!=C.y>o.y&&o.x<(C.x-S.x)*(o.y-S.y)/(C.y-S.y)+S.x&&(u=!u)}return u}function k5(l,o,u){const g=u[0],b=u[2];if(l.x<g.x&&o.x<g.x||l.x>b.x&&o.x>b.x||l.y<g.y&&o.y<g.y||l.y>b.y&&o.y>b.y)return!1;const S=Ge(l,o,u[0]);return S!==Ge(l,o,u[1])||S!==Ge(l,o,u[2])||S!==Ge(l,o,u[3])}function Ch(l,o,u){const g=o.paint.get(l).value;return g.kind==="constant"?g.value:u.programConfigurations.get(o.id).getMaxValue(l)}function IA(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function CA(l,o,u,g,b){if(!o[0]&&!o[1])return l;const S=Mt.convert(o)._mult(b);u==="viewport"&&S._rotate(-g);const C=[];for(let R=0;R<l.length;R++)C.push(l[R].sub(S));return C}Pt("CircleBucket",Fm,{omit:["layers"]});const P5=new Wi({"circle-sort-key":new qt(et.layout_circle["circle-sort-key"])});var L5={paint:new Wi({"circle-radius":new qt(et.paint_circle["circle-radius"]),"circle-color":new qt(et.paint_circle["circle-color"]),"circle-blur":new qt(et.paint_circle["circle-blur"]),"circle-opacity":new qt(et.paint_circle["circle-opacity"]),"circle-translate":new Ut(et.paint_circle["circle-translate"]),"circle-translate-anchor":new Ut(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ut(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ut(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(et.paint_circle["circle-stroke-opacity"])}),layout:P5},Nr=1e-6,Ur=typeof Float32Array<"u"?Float32Array:Array;function lv(){var l=new Ur(9);return Ur!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function Vm(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function cv(l,o,u){var g=o[0],b=o[1],S=o[2],C=o[3],R=o[4],F=o[5],j=o[6],Z=o[7],Y=o[8],re=o[9],fe=o[10],he=o[11],Pe=o[12],Se=o[13],Ue=o[14],Qe=o[15],Oe=u[0],We=u[1],at=u[2],st=u[3];return l[0]=Oe*g+We*R+at*Y+st*Pe,l[1]=Oe*b+We*F+at*re+st*Se,l[2]=Oe*S+We*j+at*fe+st*Ue,l[3]=Oe*C+We*Z+at*he+st*Qe,l[4]=(Oe=u[4])*g+(We=u[5])*R+(at=u[6])*Y+(st=u[7])*Pe,l[5]=Oe*b+We*F+at*re+st*Se,l[6]=Oe*S+We*j+at*fe+st*Ue,l[7]=Oe*C+We*Z+at*he+st*Qe,l[8]=(Oe=u[8])*g+(We=u[9])*R+(at=u[10])*Y+(st=u[11])*Pe,l[9]=Oe*b+We*F+at*re+st*Se,l[10]=Oe*S+We*j+at*fe+st*Ue,l[11]=Oe*C+We*Z+at*he+st*Qe,l[12]=(Oe=u[12])*g+(We=u[13])*R+(at=u[14])*Y+(st=u[15])*Pe,l[13]=Oe*b+We*F+at*re+st*Se,l[14]=Oe*S+We*j+at*fe+st*Ue,l[15]=Oe*C+We*Z+at*he+st*Qe,l}Math.hypot||(Math.hypot=function(){for(var l=0,o=arguments.length;o--;)l+=arguments[o]*arguments[o];return Math.sqrt(l)});var kh,R5=cv;function uv(){var l=new Ur(3);return Ur!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function fv(l,o,u){var g=new Ur(3);return g[0]=l,g[1]=o,g[2]=u,g}function kA(l,o,u){var g=o[0],b=o[1],S=o[2],C=o[3];return l[0]=u[0]*g+u[4]*b+u[8]*S+u[12]*C,l[1]=u[1]*g+u[5]*b+u[9]*S+u[13]*C,l[2]=u[2]*g+u[6]*b+u[10]*S+u[14]*C,l[3]=u[3]*g+u[7]*b+u[11]*S+u[15]*C,l}function hv(){var l=new Ur(4);return Ur!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function dv(l,o){const u=kA([],[l.x,l.y,0,1],o);return new Mt(u[0]/u[3],u[1]/u[3])}uv(),kh=new Ur(4),Ur!=Float32Array&&(kh[0]=0,kh[1]=0,kh[2]=0,kh[3]=0),uv(),fv(1,0,0),fv(0,1,0),hv(),hv(),lv(),function(){var l;l=new Ur(2),Ur!=Float32Array&&(l[0]=0,l[1]=0)}();class Av extends Fm{}Pt("HeatmapBucket",Av,{omit:["layers"]});var D5={paint:new Wi({"heatmap-radius":new qt(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ut(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new us(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ut(et.paint_heatmap["heatmap-opacity"])})};function jm(l,{width:o,height:u},g,b){if(b){if(b instanceof Uint8ClampedArray)b=new Uint8Array(b.buffer);else if(b.length!==o*u*g)throw new RangeError(`mismatched image size. expected: ${b.length} but got: ${o*u*g}`)}else b=new Uint8Array(o*u*g);return l.width=o,l.height=u,l.data=b,l}function pv(l,{width:o,height:u},g){if(o===l.width&&u===l.height)return;const b=jm({},{width:o,height:u},g);Gm(l,b,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,o),height:Math.min(l.height,u)},g),l.width=o,l.height=u,l.data=b.data}function Gm(l,o,u,g,b,S){if(b.width===0||b.height===0)return o;if(b.width>l.width||b.height>l.height||u.x>l.width-b.width||u.y>l.height-b.height)throw new RangeError("out of range source coordinates for image copy");if(b.width>o.width||b.height>o.height||g.x>o.width-b.width||g.y>o.height-b.height)throw new RangeError("out of range destination coordinates for image copy");const C=l.data,R=o.data;if(C===R)throw new Error("srcData equals dstData, so image is already copied");for(let F=0;F<b.height;F++){const j=((u.y+F)*l.width+u.x)*S,Z=((g.y+F)*o.width+g.x)*S;for(let Y=0;Y<b.width*S;Y++)R[Z+Y]=C[j+Y]}return o}class Ph{constructor(o,u){jm(this,o,1,u)}resize(o){pv(this,o,1)}clone(){return new Ph({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,u,g,b,S){Gm(o,u,g,b,S,1)}}class Oo{constructor(o,u){jm(this,o,4,u)}resize(o){pv(this,o,4)}replace(o,u){u?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Oo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,u,g,b,S){Gm(o,u,g,b,S,4)}}function mv(l){const o={},u=l.resolution||256,g=l.clips?l.clips.length:1,b=l.image||new Oo({width:u,height:g});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);const S=(C,R,F)=>{o[l.evaluationKey]=F;const j=l.expression.evaluate(o);b.data[C+R+0]=Math.floor(255*j.r/j.a),b.data[C+R+1]=Math.floor(255*j.g/j.a),b.data[C+R+2]=Math.floor(255*j.b/j.a),b.data[C+R+3]=Math.floor(255*j.a)};if(l.clips)for(let C=0,R=0;C<g;++C,R+=4*u)for(let F=0,j=0;F<u;F++,j+=4){const Z=F/(u-1),{start:Y,end:re}=l.clips[C];S(R,j,Y*(1-Z)+re*Z)}else for(let C=0,R=0;C<u;C++,R+=4)S(0,R,C/(u-1));return b}Pt("AlphaImage",Ph),Pt("RGBAImage",Oo);var z5={paint:new Wi({"hillshade-illumination-direction":new Ut(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ut(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ut(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ut(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ut(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ut(et.paint_hillshade["hillshade-accent-color"])})};const B5=bi([{name:"a_pos",components:2,type:"Int16"}],4),{members:O5}=B5;var PA={exports:{}};function LA(l,o,u){u=u||2;var g,b,S,C,R,F,j,Z=o&&o.length,Y=Z?o[0]*u:l.length,re=gv(l,0,Y,u,!0),fe=[];if(!re||re.next===re.prev)return fe;if(Z&&(re=function(Pe,Se,Ue,Qe){var Oe,We,at,st=[];for(Oe=0,We=Se.length;Oe<We;Oe++)(at=gv(Pe,Se[Oe]*Qe,Oe<We-1?Se[Oe+1]*Qe:Pe.length,Qe,!1))===at.next&&(at.steiner=!0),st.push($5(at));for(st.sort(j5),Oe=0;Oe<st.length;Oe++)Ue=G5(st[Oe],Ue);return Ue}(l,o,re,u)),l.length>80*u){g=S=l[0],b=C=l[1];for(var he=u;he<Y;he+=u)(R=l[he])<g&&(g=R),(F=l[he+1])<b&&(b=F),R>S&&(S=R),F>C&&(C=F);j=(j=Math.max(S-g,C-b))!==0?32767/j:0}return Lh(re,fe,u,g,b,j,0),fe}function gv(l,o,u,g,b){var S,C;if(b===Wm(l,o,u,g)>0)for(S=o;S<u;S+=g)C=vv(S,l[S],l[S+1],C);else for(S=u-g;S>=o;S-=g)C=vv(S,l[S],l[S+1],C);return C&&RA(C,C.next)&&(Dh(C),C=C.next),C}function Zc(l,o){if(!l)return l;o||(o=l);var u,g=l;do if(u=!1,g.steiner||!RA(g,g.next)&&Ii(g.prev,g,g.next)!==0)g=g.next;else{if(Dh(g),(g=o=g.prev)===g.next)break;u=!0}while(u||g!==o);return o}function Lh(l,o,u,g,b,S,C){if(l){!C&&S&&function(Z,Y,re,fe){var he=Z;do he.z===0&&(he.z=Hm(he.x,he.y,Y,re,fe)),he.prevZ=he.prev,he.nextZ=he.next,he=he.next;while(he!==Z);he.prevZ.nextZ=null,he.prevZ=null,function(Pe){var Se,Ue,Qe,Oe,We,at,st,Lt,Nt=1;do{for(Ue=Pe,Pe=null,We=null,at=0;Ue;){for(at++,Qe=Ue,st=0,Se=0;Se<Nt&&(st++,Qe=Qe.nextZ);Se++);for(Lt=Nt;st>0||Lt>0&&Qe;)st!==0&&(Lt===0||!Qe||Ue.z<=Qe.z)?(Oe=Ue,Ue=Ue.nextZ,st--):(Oe=Qe,Qe=Qe.nextZ,Lt--),We?We.nextZ=Oe:Pe=Oe,Oe.prevZ=We,We=Oe;Ue=Qe}We.nextZ=null,Nt*=2}while(at>1)}(he)}(l,g,b,S);for(var R,F,j=l;l.prev!==l.next;)if(R=l.prev,F=l.next,S?N5(l,g,b,S):F5(l))o.push(R.i/u|0),o.push(l.i/u|0),o.push(F.i/u|0),Dh(l),l=F.next,j=F.next;else if((l=F)===j){C?C===1?Lh(l=U5(Zc(l),o,u),o,u,g,b,S,2):C===2&&V5(l,o,u,g,b,S):Lh(Zc(l),o,u,g,b,S,1);break}}}function F5(l){var o=l.prev,u=l,g=l.next;if(Ii(o,u,g)>=0)return!1;for(var b=o.x,S=u.x,C=g.x,R=o.y,F=u.y,j=g.y,Z=b<S?b<C?b:C:S<C?S:C,Y=R<F?R<j?R:j:F<j?F:j,re=b>S?b>C?b:C:S>C?S:C,fe=R>F?R>j?R:j:F>j?F:j,he=g.next;he!==o;){if(he.x>=Z&&he.x<=re&&he.y>=Y&&he.y<=fe&&nf(b,R,S,F,C,j,he.x,he.y)&&Ii(he.prev,he,he.next)>=0)return!1;he=he.next}return!0}function N5(l,o,u,g){var b=l.prev,S=l,C=l.next;if(Ii(b,S,C)>=0)return!1;for(var R=b.x,F=S.x,j=C.x,Z=b.y,Y=S.y,re=C.y,fe=R<F?R<j?R:j:F<j?F:j,he=Z<Y?Z<re?Z:re:Y<re?Y:re,Pe=R>F?R>j?R:j:F>j?F:j,Se=Z>Y?Z>re?Z:re:Y>re?Y:re,Ue=Hm(fe,he,o,u,g),Qe=Hm(Pe,Se,o,u,g),Oe=l.prevZ,We=l.nextZ;Oe&&Oe.z>=Ue&&We&&We.z<=Qe;){if(Oe.x>=fe&&Oe.x<=Pe&&Oe.y>=he&&Oe.y<=Se&&Oe!==b&&Oe!==C&&nf(R,Z,F,Y,j,re,Oe.x,Oe.y)&&Ii(Oe.prev,Oe,Oe.next)>=0||(Oe=Oe.prevZ,We.x>=fe&&We.x<=Pe&&We.y>=he&&We.y<=Se&&We!==b&&We!==C&&nf(R,Z,F,Y,j,re,We.x,We.y)&&Ii(We.prev,We,We.next)>=0))return!1;We=We.nextZ}for(;Oe&&Oe.z>=Ue;){if(Oe.x>=fe&&Oe.x<=Pe&&Oe.y>=he&&Oe.y<=Se&&Oe!==b&&Oe!==C&&nf(R,Z,F,Y,j,re,Oe.x,Oe.y)&&Ii(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.prevZ}for(;We&&We.z<=Qe;){if(We.x>=fe&&We.x<=Pe&&We.y>=he&&We.y<=Se&&We!==b&&We!==C&&nf(R,Z,F,Y,j,re,We.x,We.y)&&Ii(We.prev,We,We.next)>=0)return!1;We=We.nextZ}return!0}function U5(l,o,u){var g=l;do{var b=g.prev,S=g.next.next;!RA(b,S)&&_v(b,g,g.next,S)&&Rh(b,S)&&Rh(S,b)&&(o.push(b.i/u|0),o.push(g.i/u|0),o.push(S.i/u|0),Dh(g),Dh(g.next),g=l=S),g=g.next}while(g!==l);return Zc(g)}function V5(l,o,u,g,b,S){var C=l;do{for(var R=C.next.next;R!==C.prev;){if(C.i!==R.i&&W5(C,R)){var F=yv(C,R);return C=Zc(C,C.next),F=Zc(F,F.next),Lh(C,o,u,g,b,S,0),void Lh(F,o,u,g,b,S,0)}R=R.next}C=C.next}while(C!==l)}function j5(l,o){return l.x-o.x}function G5(l,o){var u=function(b,S){var C,R=S,F=b.x,j=b.y,Z=-1/0;do{if(j<=R.y&&j>=R.next.y&&R.next.y!==R.y){var Y=R.x+(j-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(Y<=F&&Y>Z&&(Z=Y,C=R.x<R.next.x?R:R.next,Y===F))return C}R=R.next}while(R!==S);if(!C)return null;var re,fe=C,he=C.x,Pe=C.y,Se=1/0;R=C;do F>=R.x&&R.x>=he&&F!==R.x&&nf(j<Pe?F:Z,j,he,Pe,j<Pe?Z:F,j,R.x,R.y)&&(re=Math.abs(j-R.y)/(F-R.x),Rh(R,b)&&(re<Se||re===Se&&(R.x>C.x||R.x===C.x&&H5(C,R)))&&(C=R,Se=re)),R=R.next;while(R!==fe);return C}(l,o);if(!u)return o;var g=yv(u,l);return Zc(g,g.next),Zc(u,u.next)}function H5(l,o){return Ii(l.prev,l,o.prev)<0&&Ii(o.next,l,l.next)<0}function Hm(l,o,u,g,b){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-u)*b|0)|l<<8))|l<<4))|l<<2))|l<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-g)*b|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function $5(l){var o=l,u=l;do(o.x<u.x||o.x===u.x&&o.y<u.y)&&(u=o),o=o.next;while(o!==l);return u}function nf(l,o,u,g,b,S,C,R){return(b-C)*(o-R)>=(l-C)*(S-R)&&(l-C)*(g-R)>=(u-C)*(o-R)&&(u-C)*(S-R)>=(b-C)*(g-R)}function W5(l,o){return l.next.i!==o.i&&l.prev.i!==o.i&&!function(u,g){var b=u;do{if(b.i!==u.i&&b.next.i!==u.i&&b.i!==g.i&&b.next.i!==g.i&&_v(b,b.next,u,g))return!0;b=b.next}while(b!==u);return!1}(l,o)&&(Rh(l,o)&&Rh(o,l)&&function(u,g){var b=u,S=!1,C=(u.x+g.x)/2,R=(u.y+g.y)/2;do b.y>R!=b.next.y>R&&b.next.y!==b.y&&C<(b.next.x-b.x)*(R-b.y)/(b.next.y-b.y)+b.x&&(S=!S),b=b.next;while(b!==u);return S}(l,o)&&(Ii(l.prev,l,o.prev)||Ii(l,o.prev,o))||RA(l,o)&&Ii(l.prev,l,l.next)>0&&Ii(o.prev,o,o.next)>0)}function Ii(l,o,u){return(o.y-l.y)*(u.x-o.x)-(o.x-l.x)*(u.y-o.y)}function RA(l,o){return l.x===o.x&&l.y===o.y}function _v(l,o,u,g){var b=zA(Ii(l,o,u)),S=zA(Ii(l,o,g)),C=zA(Ii(u,g,l)),R=zA(Ii(u,g,o));return b!==S&&C!==R||!(b!==0||!DA(l,u,o))||!(S!==0||!DA(l,g,o))||!(C!==0||!DA(u,l,g))||!(R!==0||!DA(u,o,g))}function DA(l,o,u){return o.x<=Math.max(l.x,u.x)&&o.x>=Math.min(l.x,u.x)&&o.y<=Math.max(l.y,u.y)&&o.y>=Math.min(l.y,u.y)}function zA(l){return l>0?1:l<0?-1:0}function Rh(l,o){return Ii(l.prev,l,l.next)<0?Ii(l,o,l.next)>=0&&Ii(l,l.prev,o)>=0:Ii(l,o,l.prev)<0||Ii(l,l.next,o)<0}function yv(l,o){var u=new $m(l.i,l.x,l.y),g=new $m(o.i,o.x,o.y),b=l.next,S=o.prev;return l.next=o,o.prev=l,u.next=b,b.prev=u,g.next=u,u.prev=g,S.next=g,g.prev=S,g}function vv(l,o,u,g){var b=new $m(l,o,u);return g?(b.next=g.next,b.prev=g,g.next.prev=b,g.next=b):(b.prev=b,b.next=b),b}function Dh(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function $m(l,o,u){this.i=l,this.x=o,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Wm(l,o,u,g){for(var b=0,S=o,C=u-g;S<u;S+=g)b+=(l[C]-l[S])*(l[S+1]+l[C+1]),C=S;return b}function Z5(l,o,u,g,b){xv(l,o,u||0,g||l.length-1,b||q5)}function xv(l,o,u,g,b){for(;g>u;){if(g-u>600){var S=g-u+1,C=o-u+1,R=Math.log(S),F=.5*Math.exp(2*R/3),j=.5*Math.sqrt(R*F*(S-F)/S)*(C-S/2<0?-1:1);xv(l,o,Math.max(u,Math.floor(o-C*F/S+j)),Math.min(g,Math.floor(o+(S-C)*F/S+j)),b)}var Z=l[o],Y=u,re=g;for(zh(l,u,o),b(l[g],Z)>0&&zh(l,u,g);Y<re;){for(zh(l,Y,re),Y++,re--;b(l[Y],Z)<0;)Y++;for(;b(l[re],Z)>0;)re--}b(l[u],Z)===0?zh(l,u,re):zh(l,++re,g),re<=o&&(u=re+1),o<=re&&(g=re-1)}}function zh(l,o,u){var g=l[o];l[o]=l[u],l[u]=g}function q5(l,o){return l<o?-1:l>o?1:0}function Zm(l,o){const u=l.length;if(u<=1)return[l];const g=[];let b,S;for(let C=0;C<u;C++){const R=nt(l[C]);R!==0&&(l[C].area=Math.abs(R),S===void 0&&(S=R<0),S===R<0?(b&&g.push(b),b=[l[C]]):b.push(l[C]))}if(b&&g.push(b),o>1)for(let C=0;C<g.length;C++)g[C].length<=o||(Z5(g[C],o,1,g[C].length-1,Q5),g[C]=g[C].slice(0,o));return g}function Q5(l,o){return o.area-l.area}function qm(l,o,u){const g=u.patternDependencies;let b=!1;for(const S of o){const C=S.paint.get(`${l}-pattern`);C.isConstant()||(b=!0);const R=C.constantOr(null);R&&(b=!0,g[R.to]=!0,g[R.from]=!0)}return b}function Qm(l,o,u,g,b){const S=b.patternDependencies;for(const C of o){const R=C.paint.get(`${l}-pattern`).value;if(R.kind!=="constant"){let F=R.evaluate({zoom:g-1},u,{},b.availableImages),j=R.evaluate({zoom:g},u,{},b.availableImages),Z=R.evaluate({zoom:g+1},u,{},b.availableImages);F=F&&F.name?F.name:F,j=j&&j.name?j.name:j,Z=Z&&Z.name?Z.name:Z,S[F]=!0,S[j]=!0,S[Z]=!0,u.patterns[C.id]={min:F,mid:j,max:Z}}}return u}PA.exports=LA,PA.exports.default=LA,LA.deviation=function(l,o,u,g){var b=o&&o.length,S=Math.abs(Wm(l,0,b?o[0]*u:l.length,u));if(b)for(var C=0,R=o.length;C<R;C++)S-=Math.abs(Wm(l,o[C]*u,C<R-1?o[C+1]*u:l.length,u));var F=0;for(C=0;C<g.length;C+=3){var j=g[C]*u,Z=g[C+1]*u,Y=g[C+2]*u;F+=Math.abs((l[j]-l[Y])*(l[Z+1]-l[j+1])-(l[j]-l[Z])*(l[Y+1]-l[j+1]))}return S===0&&F===0?0:Math.abs((F-S)/S)},LA.flatten=function(l){for(var o=l[0][0].length,u={vertices:[],holes:[],dimensions:o},g=0,b=0;b<l.length;b++){for(var S=0;S<l[b].length;S++)for(var C=0;C<o;C++)u.vertices.push(l[b][S][C]);b>0&&u.holes.push(g+=l[b-1].length)}return u};class Xm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new G,this.indexArray=new $e,this.indexArray2=new Be,this.programConfigurations=new Hc(o.layers,o.zoom),this.segments=new ot,this.segments2=new ot,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,g){this.hasPattern=qm("fill",this.layers,u);const b=this.layers[0].layout.get("fill-sort-key"),S=!b.isConstant(),C=[];for(const{feature:R,id:F,index:j,sourceLayerIndex:Z}of o){const Y=this.layers[0]._featureFilter.needGeometry,re=Wc(R,Y);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),re,g))continue;const fe=S?b.evaluate(re,{},g,u.availableImages):void 0,he={id:F,properties:R.properties,type:R.type,sourceLayerIndex:Z,index:j,geometry:Y?re.geometry:$c(R),patterns:{},sortKey:fe};C.push(he)}S&&C.sort((R,F)=>R.sortKey-F.sortKey);for(const R of C){const{geometry:F,index:j,sourceLayerIndex:Z}=R;if(this.hasPattern){const Y=Qm("fill",this.layers,R,this.zoom,u);this.patternFeatures.push(Y)}else this.addFeature(R,F,j,g,{});u.featureIndex.insert(o[j].feature,F,j,Z,this.index)}}update(o,u,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,g)}addFeatures(o,u,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,u,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,O5),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,u,g,b,S){for(const C of Zm(u,500)){let R=0;for(const fe of C)R+=fe.length;const F=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray),j=F.vertexLength,Z=[],Y=[];for(const fe of C){if(fe.length===0)continue;fe!==C[0]&&Y.push(Z.length/2);const he=this.segments2.prepareSegment(fe.length,this.layoutVertexArray,this.indexArray2),Pe=he.vertexLength;this.layoutVertexArray.emplaceBack(fe[0].x,fe[0].y),this.indexArray2.emplaceBack(Pe+fe.length-1,Pe),Z.push(fe[0].x),Z.push(fe[0].y);for(let Se=1;Se<fe.length;Se++)this.layoutVertexArray.emplaceBack(fe[Se].x,fe[Se].y),this.indexArray2.emplaceBack(Pe+Se-1,Pe+Se),Z.push(fe[Se].x),Z.push(fe[Se].y);he.vertexLength+=fe.length,he.primitiveLength+=fe.length}const re=PA.exports(Z,Y);for(let fe=0;fe<re.length;fe+=3)this.indexArray.emplaceBack(j+re[fe],j+re[fe+1],j+re[fe+2]);F.vertexLength+=R,F.primitiveLength+=re.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,S,b)}}Pt("FillBucket",Xm,{omit:["layers","patternFeatures"]});const X5=new Wi({"fill-sort-key":new qt(et.layout_fill["fill-sort-key"])});var Y5={paint:new Wi({"fill-antialias":new Ut(et.paint_fill["fill-antialias"]),"fill-opacity":new qt(et.paint_fill["fill-opacity"]),"fill-color":new qt(et.paint_fill["fill-color"]),"fill-outline-color":new qt(et.paint_fill["fill-outline-color"]),"fill-translate":new Ut(et.paint_fill["fill-translate"]),"fill-translate-anchor":new Ut(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new $i(et.paint_fill["fill-pattern"])}),layout:X5};const K5=bi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),J5=bi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:eT}=K5;var Vl={},tT=Mt,wv=rf;function rf(l,o,u,g,b){this.properties={},this.extent=u,this.type=0,this._pbf=l,this._geometry=-1,this._keys=g,this._values=b,l.readFields(nT,this,o)}function nT(l,o,u){l==1?o.id=u.readVarint():l==2?function(g,b){for(var S=g.readVarint()+g.pos;g.pos<S;){var C=b._keys[g.readVarint()],R=b._values[g.readVarint()];b.properties[C]=R}}(u,o):l==3?o.type=u.readVarint():l==4&&(o._geometry=u.pos)}function iT(l){for(var o,u,g=0,b=0,S=l.length,C=S-1;b<S;C=b++)g+=((u=l[C]).x-(o=l[b]).x)*(o.y+u.y);return g}rf.types=["Unknown","Point","LineString","Polygon"],rf.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var o,u=l.readVarint()+l.pos,g=1,b=0,S=0,C=0,R=[];l.pos<u;){if(b<=0){var F=l.readVarint();g=7&F,b=F>>3}if(b--,g===1||g===2)S+=l.readSVarint(),C+=l.readSVarint(),g===1&&(o&&R.push(o),o=[]),o.push(new tT(S,C));else{if(g!==7)throw new Error("unknown command "+g);o&&o.push(o[0].clone())}}return o&&R.push(o),R},rf.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var o=l.readVarint()+l.pos,u=1,g=0,b=0,S=0,C=1/0,R=-1/0,F=1/0,j=-1/0;l.pos<o;){if(g<=0){var Z=l.readVarint();u=7&Z,g=Z>>3}if(g--,u===1||u===2)(b+=l.readSVarint())<C&&(C=b),b>R&&(R=b),(S+=l.readSVarint())<F&&(F=S),S>j&&(j=S);else if(u!==7)throw new Error("unknown command "+u)}return[C,F,R,j]},rf.prototype.toGeoJSON=function(l,o,u){var g,b,S=this.extent*Math.pow(2,u),C=this.extent*l,R=this.extent*o,F=this.loadGeometry(),j=rf.types[this.type];function Z(fe){for(var he=0;he<fe.length;he++){var Pe=fe[he];fe[he]=[360*(Pe.x+C)/S-180,360/Math.PI*Math.atan(Math.exp((180-360*(Pe.y+R)/S)*Math.PI/180))-90]}}switch(this.type){case 1:var Y=[];for(g=0;g<F.length;g++)Y[g]=F[g][0];Z(F=Y);break;case 2:for(g=0;g<F.length;g++)Z(F[g]);break;case 3:for(F=function(fe){var he=fe.length;if(he<=1)return[fe];for(var Pe,Se,Ue=[],Qe=0;Qe<he;Qe++){var Oe=iT(fe[Qe]);Oe!==0&&(Se===void 0&&(Se=Oe<0),Se===Oe<0?(Pe&&Ue.push(Pe),Pe=[fe[Qe]]):Pe.push(fe[Qe]))}return Pe&&Ue.push(Pe),Ue}(F),g=0;g<F.length;g++)for(b=0;b<F[g].length;b++)Z(F[g][b])}F.length===1?F=F[0]:j="Multi"+j;var re={type:"Feature",geometry:{type:j,coordinates:F},properties:this.properties};return"id"in this&&(re.id=this.id),re};var rT=wv,bv=Ev;function Ev(l,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(oT,this,o),this.length=this._features.length}function oT(l,o,u){l===15?o.version=u.readVarint():l===1?o.name=u.readString():l===5?o.extent=u.readVarint():l===2?o._features.push(u.pos):l===3?o._keys.push(u.readString()):l===4&&o._values.push(function(g){for(var b=null,S=g.readVarint()+g.pos;g.pos<S;){var C=g.readVarint()>>3;b=C===1?g.readString():C===2?g.readFloat():C===3?g.readDouble():C===4?g.readVarint64():C===5?g.readVarint():C===6?g.readSVarint():C===7?g.readBoolean():null}return b}(u))}Ev.prototype.feature=function(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];var o=this._pbf.readVarint()+this._pbf.pos;return new rT(this._pbf,o,this.extent,this._keys,this._values)};var sT=bv;function aT(l,o,u){if(l===3){var g=new sT(u,u.readVarint()+u.pos);g.length&&(o[g.name]=g)}}Vl.VectorTile=function(l,o){this.layers=l.readFields(aT,{},o)},Vl.VectorTileFeature=wv,Vl.VectorTileLayer=bv;const lT=Vl.VectorTileFeature.types,Ym=Math.pow(2,13);function Bh(l,o,u,g,b,S,C,R){l.emplaceBack(o,u,2*Math.floor(g*Ym)+C,b*Ym*2,S*Ym*2,Math.round(R))}class Km{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasPattern=!1,this.layoutVertexArray=new X,this.centroidVertexArray=new P,this.indexArray=new $e,this.programConfigurations=new Hc(o.layers,o.zoom),this.segments=new ot,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,g){this.features=[],this.hasPattern=qm("fill-extrusion",this.layers,u);for(const{feature:b,id:S,index:C,sourceLayerIndex:R}of o){const F=this.layers[0]._featureFilter.needGeometry,j=Wc(b,F);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),j,g))continue;const Z={id:S,sourceLayerIndex:R,index:C,geometry:F?j.geometry:$c(b),properties:b.properties,type:b.type,patterns:{}};this.hasPattern?this.features.push(Qm("fill-extrusion",this.layers,Z,this.zoom,u)):this.addFeature(Z,Z.geometry,C,g,{}),u.featureIndex.insert(b,Z.geometry,C,R,this.index,!0)}}addFeatures(o,u,g){for(const b of this.features){const{geometry:S}=b;this.addFeature(b,S,b.index,u,g)}}update(o,u,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,g)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,eT),this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,J5.members,!0),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(o,u,g,b,S){const C={x:0,y:0,vertexCount:0};for(const R of Zm(u,500)){let F=0;for(const he of R)F+=he.length;let j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const he of R){if(he.length===0||uT(he))continue;let Pe=0;for(let Se=0;Se<he.length;Se++){const Ue=he[Se];if(Se>=1){const Qe=he[Se-1];if(!cT(Ue,Qe)){j.vertexLength+4>ot.MAX_VERTEX_ARRAY_LENGTH&&(j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Oe=Ue.sub(Qe)._perp()._unit(),We=Qe.dist(Ue);Pe+We>32768&&(Pe=0),Bh(this.layoutVertexArray,Ue.x,Ue.y,Oe.x,Oe.y,0,0,Pe),Bh(this.layoutVertexArray,Ue.x,Ue.y,Oe.x,Oe.y,0,1,Pe),C.x+=2*Ue.x,C.y+=2*Ue.y,C.vertexCount+=2,Pe+=We,Bh(this.layoutVertexArray,Qe.x,Qe.y,Oe.x,Oe.y,0,0,Pe),Bh(this.layoutVertexArray,Qe.x,Qe.y,Oe.x,Oe.y,0,1,Pe),C.x+=2*Qe.x,C.y+=2*Qe.y,C.vertexCount+=2;const at=j.vertexLength;this.indexArray.emplaceBack(at,at+2,at+1),this.indexArray.emplaceBack(at+1,at+2,at+3),j.vertexLength+=4,j.primitiveLength+=2}}}}if(j.vertexLength+F>ot.MAX_VERTEX_ARRAY_LENGTH&&(j=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray)),lT[o.type]!=="Polygon")continue;const Z=[],Y=[],re=j.vertexLength;for(const he of R)if(he.length!==0){he!==R[0]&&Y.push(Z.length/2);for(let Pe=0;Pe<he.length;Pe++){const Se=he[Pe];Bh(this.layoutVertexArray,Se.x,Se.y,0,0,1,1,0),C.x+=Se.x,C.y+=Se.y,C.vertexCount+=1,Z.push(Se.x),Z.push(Se.y)}}const fe=PA.exports(Z,Y);for(let he=0;he<fe.length;he+=3)this.indexArray.emplaceBack(re+fe[he],re+fe[he+2],re+fe[he+1]);j.primitiveLength+=fe.length/3,j.vertexLength+=F}for(let R=0;R<C.vertexCount;R++)this.centroidVertexArray.emplaceBack(Math.floor(C.x/C.vertexCount),Math.floor(C.y/C.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,S,b)}}function cT(l,o){return l.x===o.x&&(l.x<0||l.x>Zi)||l.y===o.y&&(l.y<0||l.y>Zi)}function uT(l){return l.every(o=>o.x<0)||l.every(o=>o.x>Zi)||l.every(o=>o.y<0)||l.every(o=>o.y>Zi)}Pt("FillExtrusionBucket",Km,{omit:["layers","features"]});var fT={paint:new Wi({"fill-extrusion-opacity":new Ut(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ut(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ut(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $i(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qt(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ut(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Oh(l,o){return l.x*o.x+l.y*o.y}function Tv(l,o){if(l.length===1){let u=0;const g=o[u++];let b;for(;!b||g.equals(b);)if(b=o[u++],!b)return 1/0;for(;u<o.length;u++){const S=o[u],C=l[0],R=b.sub(g),F=S.sub(g),j=C.sub(g),Z=Oh(R,R),Y=Oh(R,F),re=Oh(F,F),fe=Oh(j,R),he=Oh(j,F),Pe=Z*re-Y*Y,Se=(re*fe-Y*he)/Pe,Ue=(Z*he-Y*fe)/Pe,Qe=g.z*(1-Se-Ue)+b.z*Se+S.z*Ue;if(isFinite(Qe))return Qe}return 1/0}{let u=1/0;for(const g of o)u=Math.min(u,g.z);return u}}const hT=bi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:dT}=hT,AT=bi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:pT}=AT,mT=Vl.VectorTileFeature.types,gT=Math.cos(Math.PI/180*37.5),Sv=Math.pow(2,14)/.5;class Jm{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new de,this.layoutVertexArray2=new ve,this.indexArray=new $e,this.programConfigurations=new Hc(o.layers,o.zoom),this.segments=new ot,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,g){this.hasPattern=qm("line",this.layers,u);const b=this.layers[0].layout.get("line-sort-key"),S=!b.isConstant(),C=[];for(const{feature:R,id:F,index:j,sourceLayerIndex:Z}of o){const Y=this.layers[0]._featureFilter.needGeometry,re=Wc(R,Y);if(!this.layers[0]._featureFilter.filter(new Kn(this.zoom),re,g))continue;const fe=S?b.evaluate(re,{},g):void 0,he={id:F,properties:R.properties,type:R.type,sourceLayerIndex:Z,index:j,geometry:Y?re.geometry:$c(R),patterns:{},sortKey:fe};C.push(he)}S&&C.sort((R,F)=>R.sortKey-F.sortKey);for(const R of C){const{geometry:F,index:j,sourceLayerIndex:Z}=R;if(this.hasPattern){const Y=Qm("line",this.layers,R,this.zoom,u);this.patternFeatures.push(Y)}else this.addFeature(R,F,j,g,{});u.featureIndex.insert(o[j].feature,F,j,Z,this.index)}}update(o,u,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,g)}addFeatures(o,u,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,u,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,pT)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,dT),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,u,g,b,S){const C=this.layers[0].layout,R=C.get("line-join").evaluate(o,{}),F=C.get("line-cap"),j=C.get("line-miter-limit"),Z=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const Y of u)this.addLine(Y,o,R,F,j,Z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,g,S,b)}addLine(o,u,g,b,S,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ue=0;Ue<o.length-1;Ue++)this.totalDistance+=o[Ue].dist(o[Ue+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R=mT[u.type]==="Polygon";let F=o.length;for(;F>=2&&o[F-1].equals(o[F-2]);)F--;let j=0;for(;j<F-1&&o[j].equals(o[j+1]);)j++;if(F<(R?3:2))return;g==="bevel"&&(S=1.05);const Z=this.overscaling<=16?122880/(512*this.overscaling):0,Y=this.segments.prepareSegment(10*F,this.layoutVertexArray,this.indexArray);let re,fe,he,Pe,Se;this.e1=this.e2=-1,R&&(re=o[F-2],Se=o[j].sub(re)._unit()._perp());for(let Ue=j;Ue<F;Ue++){if(he=Ue===F-1?R?o[j+1]:void 0:o[Ue+1],he&&o[Ue].equals(he))continue;Se&&(Pe=Se),re&&(fe=re),re=o[Ue],Se=he?he.sub(re)._unit()._perp():Pe,Pe=Pe||Se;let Qe=Pe.add(Se);Qe.x===0&&Qe.y===0||Qe._unit();const Oe=Pe.x*Se.x+Pe.y*Se.y,We=Qe.x*Se.x+Qe.y*Se.y,at=We!==0?1/We:1/0,st=2*Math.sqrt(2-2*We),Lt=We<gT&&fe&&he,Nt=Pe.x*Se.y-Pe.y*Se.x>0;if(Lt&&Ue>j){const vt=re.dist(fe);if(vt>2*Z){const kt=re.sub(re.sub(fe)._mult(Z/vt)._round());this.updateDistance(fe,kt),this.addCurrentVertex(kt,Pe,0,0,Y),fe=kt}}const Ct=fe&&he;let wt=Ct?g:R?"butt":b;if(Ct&&wt==="round"&&(at<C?wt="miter":at<=2&&(wt="fakeround")),wt==="miter"&&at>S&&(wt="bevel"),wt==="bevel"&&(at>2&&(wt="flipbevel"),at<S&&(wt="miter")),fe&&this.updateDistance(fe,re),wt==="miter")Qe._mult(at),this.addCurrentVertex(re,Qe,0,0,Y);else if(wt==="flipbevel"){if(at>100)Qe=Se.mult(-1);else{const vt=at*Pe.add(Se).mag()/Pe.sub(Se).mag();Qe._perp()._mult(vt*(Nt?-1:1))}this.addCurrentVertex(re,Qe,0,0,Y),this.addCurrentVertex(re,Qe.mult(-1),0,0,Y)}else if(wt==="bevel"||wt==="fakeround"){const vt=-Math.sqrt(at*at-1),kt=Nt?vt:0,Et=Nt?0:vt;if(fe&&this.addCurrentVertex(re,Pe,kt,Et,Y),wt==="fakeround"){const At=Math.round(180*st/Math.PI/20);for(let Yt=1;Yt<At;Yt++){let Ht=Yt/At;if(Ht!==.5){const ti=Ht-.5;Ht+=Ht*ti*(Ht-1)*((1.0904+Oe*(Oe*(3.55645-1.43519*Oe)-3.2452))*ti*ti+(.848013+Oe*(.215638*Oe-1.06021)))}const xn=Se.sub(Pe)._mult(Ht)._add(Pe)._unit()._mult(Nt?-1:1);this.addHalfVertex(re,xn.x,xn.y,!1,Nt,0,Y)}}he&&this.addCurrentVertex(re,Se,-kt,-Et,Y)}else if(wt==="butt")this.addCurrentVertex(re,Qe,0,0,Y);else if(wt==="square"){const vt=fe?1:-1;this.addCurrentVertex(re,Qe,vt,vt,Y)}else wt==="round"&&(fe&&(this.addCurrentVertex(re,Pe,0,0,Y),this.addCurrentVertex(re,Pe,1,1,Y,!0)),he&&(this.addCurrentVertex(re,Se,-1,-1,Y,!0),this.addCurrentVertex(re,Se,0,0,Y)));if(Lt&&Ue<F-1){const vt=re.dist(he);if(vt>2*Z){const kt=re.add(he.sub(re)._mult(Z/vt)._round());this.updateDistance(re,kt),this.addCurrentVertex(kt,Se,0,0,Y),re=kt}}}}addCurrentVertex(o,u,g,b,S,C=!1){const R=u.y*b-u.x,F=-u.y-u.x*b;this.addHalfVertex(o,u.x+u.y*g,u.y-u.x*g,C,!1,g,S),this.addHalfVertex(o,R,F,C,!0,-b,S),this.distance>Sv/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(o,u,g,b,S,C))}addHalfVertex({x:o,y:u},g,b,S,C,R,F){const j=.5*(this.lineClips?this.scaledDistance*(Sv-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o<<1)+(S?1:0),(u<<1)+(C?1:0),Math.round(63*g)+128,Math.round(63*b)+128,1+(R===0?0:R<0?-1:1)|(63&j)<<2,j>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Z=F.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Z),F.primitiveLength++),C?this.e2=Z:this.e1=Z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(o,u){this.distance+=o.dist(u),this.updateScaledDistance()}}Pt("LineBucket",Jm,{omit:["layers","patternFeatures"]});const _T=new Wi({"line-cap":new Ut(et.layout_line["line-cap"]),"line-join":new qt(et.layout_line["line-join"]),"line-miter-limit":new Ut(et.layout_line["line-miter-limit"]),"line-round-limit":new Ut(et.layout_line["line-round-limit"]),"line-sort-key":new qt(et.layout_line["line-sort-key"])});var Mv={paint:new Wi({"line-opacity":new qt(et.paint_line["line-opacity"]),"line-color":new qt(et.paint_line["line-color"]),"line-translate":new Ut(et.paint_line["line-translate"]),"line-translate-anchor":new Ut(et.paint_line["line-translate-anchor"]),"line-width":new qt(et.paint_line["line-width"]),"line-gap-width":new qt(et.paint_line["line-gap-width"]),"line-offset":new qt(et.paint_line["line-offset"]),"line-blur":new qt(et.paint_line["line-blur"]),"line-dasharray":new Vc(et.paint_line["line-dasharray"]),"line-pattern":new $i(et.paint_line["line-pattern"]),"line-gradient":new us(et.paint_line["line-gradient"])}),layout:_T};const Iv=new class extends qt{possiblyEvaluate(l,o){return o=new Kn(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(l,o)}evaluate(l,o,u,g){return o=ee({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(l,o,u,g)}}(Mv.paint.properties["line-width"].specification);function Cv(l,o){return o>0?o+2*l:l}Iv.useIntegerZoom=!0;const yT=bi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),vT=bi([{name:"a_projected_pos",components:3,type:"Float32"}],4);bi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const xT=bi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);bi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const kv=bi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),wT=bi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function bT(l,o,u){return l.sections.forEach(g=>{g.text=function(b,S,C){const R=S.layout.get("text-transform").evaluate(C,{});return R==="uppercase"?b=b.toLocaleUpperCase():R==="lowercase"&&(b=b.toLocaleLowerCase()),Fr.applyArabicShaping&&(b=Fr.applyArabicShaping(b)),b}(g.text,o,u)}),l}bi([{name:"triangle",components:3,type:"Uint16"}]),bi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),bi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),bi([{type:"Float32",name:"offsetX"}]),bi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Fh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ar=24,eg=Xn,Pv=function(l,o,u,g,b){var S,C,R=8*b-g-1,F=(1<<R)-1,j=F>>1,Z=-7,Y=u?b-1:0,re=u?-1:1,fe=l[o+Y];for(Y+=re,S=fe&(1<<-Z)-1,fe>>=-Z,Z+=R;Z>0;S=256*S+l[o+Y],Y+=re,Z-=8);for(C=S&(1<<-Z)-1,S>>=-Z,Z+=g;Z>0;C=256*C+l[o+Y],Y+=re,Z-=8);if(S===0)S=1-j;else{if(S===F)return C?NaN:1/0*(fe?-1:1);C+=Math.pow(2,g),S-=j}return(fe?-1:1)*C*Math.pow(2,S-g)},Lv=function(l,o,u,g,b,S){var C,R,F,j=8*S-b-1,Z=(1<<j)-1,Y=Z>>1,re=b===23?Math.pow(2,-24)-Math.pow(2,-77):0,fe=g?0:S-1,he=g?1:-1,Pe=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(R=isNaN(o)?1:0,C=Z):(C=Math.floor(Math.log(o)/Math.LN2),o*(F=Math.pow(2,-C))<1&&(C--,F*=2),(o+=C+Y>=1?re/F:re*Math.pow(2,1-Y))*F>=2&&(C++,F/=2),C+Y>=Z?(R=0,C=Z):C+Y>=1?(R=(o*F-1)*Math.pow(2,b),C+=Y):(R=o*Math.pow(2,Y-1)*Math.pow(2,b),C=0));b>=8;l[u+fe]=255&R,fe+=he,R/=256,b-=8);for(C=C<<b|R,j+=b;j>0;l[u+fe]=255&C,fe+=he,C/=256,j-=8);l[u+fe-he]|=128*Pe};function Xn(l){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(l)?l:new Uint8Array(l||0),this.pos=0,this.type=0,this.length=this.buf.length}Xn.Varint=0,Xn.Fixed64=1,Xn.Bytes=2,Xn.Fixed32=5;var jl,tg=4294967296,Rv=1/tg,Dv=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function nl(l){return l.type===Xn.Bytes?l.readVarint()+l.pos:l.pos+1}function of(l,o,u){return u?4294967296*o+(l>>>0):4294967296*(o>>>0)+(l>>>0)}function zv(l,o,u){var g=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));u.realloc(g);for(var b=u.pos-1;b>=l;b--)u.buf[b+g]=u.buf[b]}function ET(l,o){for(var u=0;u<l.length;u++)o.writeVarint(l[u])}function TT(l,o){for(var u=0;u<l.length;u++)o.writeSVarint(l[u])}function ST(l,o){for(var u=0;u<l.length;u++)o.writeFloat(l[u])}function MT(l,o){for(var u=0;u<l.length;u++)o.writeDouble(l[u])}function IT(l,o){for(var u=0;u<l.length;u++)o.writeBoolean(l[u])}function CT(l,o){for(var u=0;u<l.length;u++)o.writeFixed32(l[u])}function kT(l,o){for(var u=0;u<l.length;u++)o.writeSFixed32(l[u])}function PT(l,o){for(var u=0;u<l.length;u++)o.writeFixed64(l[u])}function LT(l,o){for(var u=0;u<l.length;u++)o.writeSFixed64(l[u])}function BA(l,o){return(l[o]|l[o+1]<<8|l[o+2]<<16)+16777216*l[o+3]}function sf(l,o,u){l[u]=o,l[u+1]=o>>>8,l[u+2]=o>>>16,l[u+3]=o>>>24}function Bv(l,o){return(l[o]|l[o+1]<<8|l[o+2]<<16)+(l[o+3]<<24)}function RT(l,o,u){l===1&&u.readMessage(DT,o)}function DT(l,o,u){if(l===3){const{id:g,bitmap:b,width:S,height:C,left:R,top:F,advance:j}=u.readMessage(zT,{});o.push({id:g,bitmap:new Ph({width:S+6,height:C+6},b),metrics:{width:S,height:C,left:R,top:F,advance:j}})}}function zT(l,o,u){l===1?o.id=u.readVarint():l===2?o.bitmap=u.readBytes():l===3?o.width=u.readVarint():l===4?o.height=u.readVarint():l===5?o.left=u.readSVarint():l===6?o.top=u.readSVarint():l===7&&(o.advance=u.readVarint())}function Ov(l){let o=0,u=0;for(const C of l)o+=C.w*C.h,u=Math.max(u,C.w);l.sort((C,R)=>R.h-C.h);const g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),u),h:1/0}];let b=0,S=0;for(const C of l)for(let R=g.length-1;R>=0;R--){const F=g[R];if(!(C.w>F.w||C.h>F.h)){if(C.x=F.x,C.y=F.y,S=Math.max(S,C.y+C.h),b=Math.max(b,C.x+C.w),C.w===F.w&&C.h===F.h){const j=g.pop();R<g.length&&(g[R]=j)}else C.h===F.h?(F.x+=C.w,F.w-=C.w):C.w===F.w?(F.y+=C.h,F.h-=C.h):(g.push({x:F.x+C.w,y:F.y,w:F.w-C.w,h:C.h}),F.y+=C.h,F.h-=C.h);break}}return{w:b,h:S,fill:o/(b*S)||0}}Xn.prototype={destroy:function(){this.buf=null},readFields:function(l,o,u){for(u=u||this.length;this.pos<u;){var g=this.readVarint(),b=g>>3,S=this.pos;this.type=7&g,l(b,o,this),this.pos===S&&this.skip(g)}return o},readMessage:function(l,o){return this.readFields(l,o,this.readVarint()+this.pos)},readFixed32:function(){var l=BA(this.buf,this.pos);return this.pos+=4,l},readSFixed32:function(){var l=Bv(this.buf,this.pos);return this.pos+=4,l},readFixed64:function(){var l=BA(this.buf,this.pos)+BA(this.buf,this.pos+4)*tg;return this.pos+=8,l},readSFixed64:function(){var l=BA(this.buf,this.pos)+Bv(this.buf,this.pos+4)*tg;return this.pos+=8,l},readFloat:function(){var l=Pv(this.buf,this.pos,!0,23,4);return this.pos+=4,l},readDouble:function(){var l=Pv(this.buf,this.pos,!0,52,8);return this.pos+=8,l},readVarint:function(l){var o,u,g=this.buf;return o=127&(u=g[this.pos++]),u<128?o:(o|=(127&(u=g[this.pos++]))<<7,u<128?o:(o|=(127&(u=g[this.pos++]))<<14,u<128?o:(o|=(127&(u=g[this.pos++]))<<21,u<128?o:function(b,S,C){var R,F,j=C.buf;if(R=(112&(F=j[C.pos++]))>>4,F<128||(R|=(127&(F=j[C.pos++]))<<3,F<128)||(R|=(127&(F=j[C.pos++]))<<10,F<128)||(R|=(127&(F=j[C.pos++]))<<17,F<128)||(R|=(127&(F=j[C.pos++]))<<24,F<128)||(R|=(1&(F=j[C.pos++]))<<31,F<128))return of(b,R,S);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(u=g[this.pos]))<<28,l,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var l=this.readVarint();return l%2==1?(l+1)/-2:l/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var l=this.readVarint()+this.pos,o=this.pos;return this.pos=l,l-o>=12&&Dv?function(u,g,b){return Dv.decode(u.subarray(g,b))}(this.buf,o,l):function(u,g,b){for(var S="",C=g;C<b;){var R,F,j,Z=u[C],Y=null,re=Z>239?4:Z>223?3:Z>191?2:1;if(C+re>b)break;re===1?Z<128&&(Y=Z):re===2?(192&(R=u[C+1]))==128&&(Y=(31&Z)<<6|63&R)<=127&&(Y=null):re===3?(F=u[C+2],(192&(R=u[C+1]))==128&&(192&F)==128&&((Y=(15&Z)<<12|(63&R)<<6|63&F)<=2047||Y>=55296&&Y<=57343)&&(Y=null)):re===4&&(F=u[C+2],j=u[C+3],(192&(R=u[C+1]))==128&&(192&F)==128&&(192&j)==128&&((Y=(15&Z)<<18|(63&R)<<12|(63&F)<<6|63&j)<=65535||Y>=1114112)&&(Y=null)),Y===null?(Y=65533,re=1):Y>65535&&(Y-=65536,S+=String.fromCharCode(Y>>>10&1023|55296),Y=56320|1023&Y),S+=String.fromCharCode(Y),C+=re}return S}(this.buf,o,l)},readBytes:function(){var l=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,l);return this.pos=l,o},readPackedVarint:function(l,o){if(this.type!==Xn.Bytes)return l.push(this.readVarint(o));var u=nl(this);for(l=l||[];this.pos<u;)l.push(this.readVarint(o));return l},readPackedSVarint:function(l){if(this.type!==Xn.Bytes)return l.push(this.readSVarint());var o=nl(this);for(l=l||[];this.pos<o;)l.push(this.readSVarint());return l},readPackedBoolean:function(l){if(this.type!==Xn.Bytes)return l.push(this.readBoolean());var o=nl(this);for(l=l||[];this.pos<o;)l.push(this.readBoolean());return l},readPackedFloat:function(l){if(this.type!==Xn.Bytes)return l.push(this.readFloat());var o=nl(this);for(l=l||[];this.pos<o;)l.push(this.readFloat());return l},readPackedDouble:function(l){if(this.type!==Xn.Bytes)return l.push(this.readDouble());var o=nl(this);for(l=l||[];this.pos<o;)l.push(this.readDouble());return l},readPackedFixed32:function(l){if(this.type!==Xn.Bytes)return l.push(this.readFixed32());var o=nl(this);for(l=l||[];this.pos<o;)l.push(this.readFixed32());return l},readPackedSFixed32:function(l){if(this.type!==Xn.Bytes)return l.push(this.readSFixed32());var o=nl(this);for(l=l||[];this.pos<o;)l.push(this.readSFixed32());return l},readPackedFixed64:function(l){if(this.type!==Xn.Bytes)return l.push(this.readFixed64());var o=nl(this);for(l=l||[];this.pos<o;)l.push(this.readFixed64());return l},readPackedSFixed64:function(l){if(this.type!==Xn.Bytes)return l.push(this.readSFixed64());var o=nl(this);for(l=l||[];this.pos<o;)l.push(this.readSFixed64());return l},skip:function(l){var o=7&l;if(o===Xn.Varint)for(;this.buf[this.pos++]>127;);else if(o===Xn.Bytes)this.pos=this.readVarint()+this.pos;else if(o===Xn.Fixed32)this.pos+=4;else{if(o!==Xn.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(l,o){this.writeVarint(l<<3|o)},realloc:function(l){for(var o=this.length||16;o<this.pos+l;)o*=2;if(o!==this.length){var u=new Uint8Array(o);u.set(this.buf),this.buf=u,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(l){this.realloc(4),sf(this.buf,l,this.pos),this.pos+=4},writeSFixed32:function(l){this.realloc(4),sf(this.buf,l,this.pos),this.pos+=4},writeFixed64:function(l){this.realloc(8),sf(this.buf,-1&l,this.pos),sf(this.buf,Math.floor(l*Rv),this.pos+4),this.pos+=8},writeSFixed64:function(l){this.realloc(8),sf(this.buf,-1&l,this.pos),sf(this.buf,Math.floor(l*Rv),this.pos+4),this.pos+=8},writeVarint:function(l){(l=+l||0)>268435455||l<0?function(o,u){var g,b;if(o>=0?(g=o%4294967296|0,b=o/4294967296|0):(b=~(-o/4294967296),4294967295^(g=~(-o%4294967296))?g=g+1|0:(g=0,b=b+1|0)),o>=18446744073709552e3||o<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(S,C,R){R.buf[R.pos++]=127&S|128,S>>>=7,R.buf[R.pos++]=127&S|128,S>>>=7,R.buf[R.pos++]=127&S|128,S>>>=7,R.buf[R.pos++]=127&S|128,R.buf[R.pos]=127&(S>>>=7)}(g,0,u),function(S,C){var R=(7&S)<<4;C.buf[C.pos++]|=R|((S>>>=3)?128:0),S&&(C.buf[C.pos++]=127&S|((S>>>=7)?128:0),S&&(C.buf[C.pos++]=127&S|((S>>>=7)?128:0),S&&(C.buf[C.pos++]=127&S|((S>>>=7)?128:0),S&&(C.buf[C.pos++]=127&S|((S>>>=7)?128:0),S&&(C.buf[C.pos++]=127&S)))))}(b,u)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))},writeSVarint:function(l){this.writeVarint(l<0?2*-l-1:2*l)},writeBoolean:function(l){this.writeVarint(!!l)},writeString:function(l){l=String(l),this.realloc(4*l.length),this.pos++;var o=this.pos;this.pos=function(g,b,S){for(var C,R,F=0;F<b.length;F++){if((C=b.charCodeAt(F))>55295&&C<57344){if(!R){C>56319||F+1===b.length?(g[S++]=239,g[S++]=191,g[S++]=189):R=C;continue}if(C<56320){g[S++]=239,g[S++]=191,g[S++]=189,R=C;continue}C=R-55296<<10|C-56320|65536,R=null}else R&&(g[S++]=239,g[S++]=191,g[S++]=189,R=null);C<128?g[S++]=C:(C<2048?g[S++]=C>>6|192:(C<65536?g[S++]=C>>12|224:(g[S++]=C>>18|240,g[S++]=C>>12&63|128),g[S++]=C>>6&63|128),g[S++]=63&C|128)}return S}(this.buf,l,this.pos);var u=this.pos-o;u>=128&&zv(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u},writeFloat:function(l){this.realloc(4),Lv(this.buf,l,this.pos,!0,23,4),this.pos+=4},writeDouble:function(l){this.realloc(8),Lv(this.buf,l,this.pos,!0,52,8),this.pos+=8},writeBytes:function(l){var o=l.length;this.writeVarint(o),this.realloc(o);for(var u=0;u<o;u++)this.buf[this.pos++]=l[u]},writeRawMessage:function(l,o){this.pos++;var u=this.pos;l(o,this);var g=this.pos-u;g>=128&&zv(u,g,this),this.pos=u-1,this.writeVarint(g),this.pos+=g},writeMessage:function(l,o,u){this.writeTag(l,Xn.Bytes),this.writeRawMessage(o,u)},writePackedVarint:function(l,o){o.length&&this.writeMessage(l,ET,o)},writePackedSVarint:function(l,o){o.length&&this.writeMessage(l,TT,o)},writePackedBoolean:function(l,o){o.length&&this.writeMessage(l,IT,o)},writePackedFloat:function(l,o){o.length&&this.writeMessage(l,ST,o)},writePackedDouble:function(l,o){o.length&&this.writeMessage(l,MT,o)},writePackedFixed32:function(l,o){o.length&&this.writeMessage(l,CT,o)},writePackedSFixed32:function(l,o){o.length&&this.writeMessage(l,kT,o)},writePackedFixed64:function(l,o){o.length&&this.writeMessage(l,PT,o)},writePackedSFixed64:function(l,o){o.length&&this.writeMessage(l,LT,o)},writeBytesField:function(l,o){this.writeTag(l,Xn.Bytes),this.writeBytes(o)},writeFixed32Field:function(l,o){this.writeTag(l,Xn.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(l,o){this.writeTag(l,Xn.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(l,o){this.writeTag(l,Xn.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(l,o){this.writeTag(l,Xn.Fixed64),this.writeSFixed64(o)},writeVarintField:function(l,o){this.writeTag(l,Xn.Varint),this.writeVarint(o)},writeSVarintField:function(l,o){this.writeTag(l,Xn.Varint),this.writeSVarint(o)},writeStringField:function(l,o){this.writeTag(l,Xn.Bytes),this.writeString(o)},writeFloatField:function(l,o){this.writeTag(l,Xn.Fixed32),this.writeFloat(o)},writeDoubleField:function(l,o){this.writeTag(l,Xn.Fixed64),this.writeDouble(o)},writeBooleanField:function(l,o){this.writeVarintField(l,!!o)}};class ng{constructor(o,{pixelRatio:u,version:g,stretchX:b,stretchY:S,content:C}){this.paddedRect=o,this.pixelRatio=u,this.stretchX=b,this.stretchY=S,this.content=C,this.version=g}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Fv{constructor(o,u){const g={},b={};this.haveRenderCallbacks=[];const S=[];this.addImages(o,g,S),this.addImages(u,b,S);const{w:C,h:R}=Ov(S),F=new Oo({width:C||1,height:R||1});for(const j in o){const Z=o[j],Y=g[j].paddedRect;Oo.copy(Z.data,F,{x:0,y:0},{x:Y.x+1,y:Y.y+1},Z.data)}for(const j in u){const Z=u[j],Y=b[j].paddedRect,re=Y.x+1,fe=Y.y+1,he=Z.data.width,Pe=Z.data.height;Oo.copy(Z.data,F,{x:0,y:0},{x:re,y:fe},Z.data),Oo.copy(Z.data,F,{x:0,y:Pe-1},{x:re,y:fe-1},{width:he,height:1}),Oo.copy(Z.data,F,{x:0,y:0},{x:re,y:fe+Pe},{width:he,height:1}),Oo.copy(Z.data,F,{x:he-1,y:0},{x:re-1,y:fe},{width:1,height:Pe}),Oo.copy(Z.data,F,{x:0,y:0},{x:re+he,y:fe},{width:1,height:Pe})}this.image=F,this.iconPositions=g,this.patternPositions=b}addImages(o,u,g){for(const b in o){const S=o[b],C={x:0,y:0,w:S.data.width+2,h:S.data.height+2};g.push(C),u[b]=new ng(C,S),S.hasRenderCallback&&this.haveRenderCallbacks.push(b)}}patchUpdatedImages(o,u){o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const g in o.updatedImages)this.patchUpdatedImage(this.iconPositions[g],o.getImage(g),u),this.patchUpdatedImage(this.patternPositions[g],o.getImage(g),u)}patchUpdatedImage(o,u,g){if(!o||!u||o.version===u.version)return;o.version=u.version;const[b,S]=o.tl;g.update(u.data,void 0,{x:b,y:S})}}Pt("ImagePosition",ng),Pt("ImageAtlas",Fv),a.WritingMode=void 0,(jl=a.WritingMode||(a.WritingMode={}))[jl.none=0]="none",jl[jl.horizontal=1]="horizontal",jl[jl.vertical=2]="vertical",jl[jl.horizontalOnly=3]="horizontalOnly";const OA=-17;class Nh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,u){const g=new Nh;return g.scale=o||1,g.fontStack=u,g}static forImage(o){const u=new Nh;return u.imageName=o,u}}class af{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,u){const g=new af;for(let b=0;b<o.sections.length;b++){const S=o.sections[b];S.image?g.addImageSection(S):g.addTextSection(S,u)}return g}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(){this.text=function(o){let u="";for(let g=0;g<o.length;g++){const b=o.charCodeAt(g+1)||null,S=o.charCodeAt(g-1)||null;u+=b&&vo(b)&&!Fh[o[g+1]]||S&&vo(S)&&!Fh[o[g-1]]||!Fh[o[g]]?o[g]:Fh[o[g]]}return u}(this.text)}trim(){let o=0;for(let g=0;g<this.text.length&&NA[this.text.charCodeAt(g)];g++)o++;let u=this.text.length;for(let g=this.text.length-1;g>=0&&g>=o&&NA[this.text.charCodeAt(g)];g--)u--;this.text=this.text.substring(o,u),this.sectionIndex=this.sectionIndex.slice(o,u)}substring(o,u){const g=new af;return g.text=this.text.substring(o,u),g.sectionIndex=this.sectionIndex.slice(o,u),g.sections=this.sections,g}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,u)=>Math.max(o,this.sections[u].scale),0)}addTextSection(o,u){this.text+=o.text,this.sections.push(Nh.forText(o.scale,o.fontStack||u));const g=this.sections.length-1;for(let b=0;b<o.text.length;++b)this.sectionIndex.push(g)}addImageSection(o){const u=o.image?o.image.name:"";if(u.length===0)return void Le("Can't add FormattedSection with an empty image.");const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(Nh.forImage(u)),this.sectionIndex.push(this.sections.length-1)):Le("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function FA(l,o,u,g,b,S,C,R,F,j,Z,Y,re,fe,he,Pe){const Se=af.fromFeature(l,b);let Ue;Y===a.WritingMode.vertical&&Se.verticalizePunctuation();const{processBidirectionalText:Qe,processStyledBidirectionalText:Oe}=Fr;if(Qe&&Se.sections.length===1){Ue=[];const st=Qe(Se.toString(),ig(Se,j,S,o,g,fe,he));for(const Lt of st){const Nt=new af;Nt.text=Lt,Nt.sections=Se.sections;for(let Ct=0;Ct<Lt.length;Ct++)Nt.sectionIndex.push(0);Ue.push(Nt)}}else if(Oe){Ue=[];const st=Oe(Se.text,Se.sectionIndex,ig(Se,j,S,o,g,fe,he));for(const Lt of st){const Nt=new af;Nt.text=Lt[0],Nt.sectionIndex=Lt[1],Nt.sections=Se.sections,Ue.push(Nt)}}else Ue=function(st,Lt){const Nt=[],Ct=st.text;let wt=0;for(const vt of Lt)Nt.push(st.substring(wt,vt)),wt=vt;return wt<Ct.length&&Nt.push(st.substring(wt,Ct.length)),Nt}(Se,ig(Se,j,S,o,g,fe,he));const We=[],at={positionedLines:We,text:Se.toString(),top:Z[1],bottom:Z[1],left:Z[0],right:Z[0],writingMode:Y,iconsInText:!1,verticalizable:!1};return function(st,Lt,Nt,Ct,wt,vt,kt,Et,At,Yt,Ht,xn){let ti=0,si=OA,qi=0,No=0;const pr=Et==="right"?1:Et==="left"?0:.5;let Fi=0;for(const Ni of wt){Ni.trim();const gr=Ni.getMaxScale(),Mr=(gr-1)*ar,Vr={positionedGlyphs:[],lineOffset:0};st.positionedLines[Fi]=Vr;const ro=Vr.positionedGlyphs;let oo=0;if(!Ni.length()){si+=vt,++Fi;continue}for(let tr=0;tr<Ni.length();tr++){const Cn=Ni.getSection(tr),wo=Ni.getSectionIndex(tr),_r=Ni.getCharCode(tr);let Ir=0,hs=null,Os=null,Fs=null,rl=ar;const ds=!(At===a.WritingMode.horizontal||!Ht&&!Fl(_r)||Ht&&(NA[_r]||(er=_r,St.Arabic(er)||St["Arabic Supplement"](er)||St["Arabic Extended-A"](er)||St["Arabic Presentation Forms-A"](er)||St["Arabic Presentation Forms-B"](er))));if(Cn.imageName){const Uo=Ct[Cn.imageName];if(!Uo)continue;Fs=Cn.imageName,st.iconsInText=st.iconsInText||!0,Os=Uo.paddedRect;const so=Uo.displaySize;Cn.scale=Cn.scale*ar/xn,hs={width:so[0],height:so[1],left:1,top:-3,advance:ds?so[1]:so[0]},Ir=Mr+(ar-so[1]*Cn.scale),rl=hs.advance;const ol=ds?so[0]*Cn.scale-ar*gr:so[1]*Cn.scale-ar*gr;ol>0&&ol>oo&&(oo=ol)}else{const Uo=Nt[Cn.fontStack],so=Uo&&Uo[_r];if(so&&so.rect)Os=so.rect,hs=so.metrics;else{const ol=Lt[Cn.fontStack],jh=ol&&ol[_r];if(!jh)continue;hs=jh.metrics}Ir=(gr-Cn.scale)*ar}ds?(st.verticalizable=!0,ro.push({glyph:_r,imageName:Fs,x:ti,y:si+Ir,vertical:ds,scale:Cn.scale,fontStack:Cn.fontStack,sectionIndex:wo,metrics:hs,rect:Os}),ti+=rl*Cn.scale+Yt):(ro.push({glyph:_r,imageName:Fs,x:ti,y:si+Ir,vertical:ds,scale:Cn.scale,fontStack:Cn.fontStack,sectionIndex:wo,metrics:hs,rect:Os}),ti+=hs.advance*Cn.scale+Yt)}ro.length!==0&&(qi=Math.max(ti-Yt,qi),FT(ro,0,ro.length-1,pr,oo)),ti=0;const ui=vt*gr+oo;Vr.lineOffset=Math.max(oo,Mr),si+=ui,No=Math.max(ui,No),++Fi}var er;const mr=si-OA,{horizontalAlign:Sr,verticalAlign:io}=rg(kt);(function(Ni,gr,Mr,Vr,ro,oo,ui,tr,Cn){const wo=(gr-Mr)*ro;let _r=0;_r=oo!==ui?-tr*Vr-OA:(-Vr*Cn+.5)*ui;for(const Ir of Ni)for(const hs of Ir.positionedGlyphs)hs.x+=wo,hs.y+=_r})(st.positionedLines,pr,Sr,io,qi,No,vt,mr,wt.length),st.top+=-io*mr,st.bottom=st.top+mr,st.left+=-Sr*qi,st.right=st.left+qi}(at,o,u,g,Ue,C,R,F,Y,j,re,Pe),!function(st){for(const Lt of st)if(Lt.positionedGlyphs.length!==0)return!1;return!0}(We)&&at}const NA={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},BT={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Nv(l,o,u,g,b,S){if(o.imageName){const C=g[o.imageName];return C?C.displaySize[0]*o.scale*ar/S+b:0}{const C=u[o.fontStack],R=C&&C[l];return R?R.metrics.advance*o.scale+b:0}}function Uv(l,o,u,g){const b=Math.pow(l-o,2);return g?l<o?b/2:2*b:b+Math.abs(u)*u}function OT(l,o,u){let g=0;return l===10&&(g-=1e4),u&&(g+=150),l!==40&&l!==65288||(g+=50),o!==41&&o!==65289||(g+=50),g}function Vv(l,o,u,g,b,S){let C=null,R=Uv(o,u,b,S);for(const F of g){const j=Uv(o-F.x,u,b,S)+F.badness;j<=R&&(C=F,R=j)}return{index:l,x:o,priorBreak:C,badness:R}}function jv(l){return l?jv(l.priorBreak).concat(l.index):[]}function ig(l,o,u,g,b,S,C){if(S!=="point")return[];if(!l)return[];const R=[],F=function(re,fe,he,Pe,Se,Ue){let Qe=0;for(let Oe=0;Oe<re.length();Oe++){const We=re.getSection(Oe);Qe+=Nv(re.getCharCode(Oe),We,Pe,Se,fe,Ue)}return Qe/Math.max(1,Math.ceil(Qe/he))}(l,o,u,g,b,C),j=l.text.indexOf("​")>=0;let Z=0;for(let re=0;re<l.length();re++){const fe=l.getSection(re),he=l.getCharCode(re);if(NA[he]||(Z+=Nv(he,fe,g,b,o,C)),re<l.length()-1){const Pe=!((Y=he)<11904||!(St["Bopomofo Extended"](Y)||St.Bopomofo(Y)||St["CJK Compatibility Forms"](Y)||St["CJK Compatibility Ideographs"](Y)||St["CJK Compatibility"](Y)||St["CJK Radicals Supplement"](Y)||St["CJK Strokes"](Y)||St["CJK Symbols and Punctuation"](Y)||St["CJK Unified Ideographs Extension A"](Y)||St["CJK Unified Ideographs"](Y)||St["Enclosed CJK Letters and Months"](Y)||St["Halfwidth and Fullwidth Forms"](Y)||St.Hiragana(Y)||St["Ideographic Description Characters"](Y)||St["Kangxi Radicals"](Y)||St["Katakana Phonetic Extensions"](Y)||St.Katakana(Y)||St["Vertical Forms"](Y)||St["Yi Radicals"](Y)||St["Yi Syllables"](Y)));(BT[he]||Pe||fe.imageName)&&R.push(Vv(re+1,Z,F,R,OT(he,l.getCharCode(re+1),Pe&&j),!1))}}var Y;return jv(Vv(l.length(),Z,F,R,0,!0))}function rg(l){let o=.5,u=.5;switch(l){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:o,verticalAlign:u}}function FT(l,o,u,g,b){if(!g&&!b)return;const S=l[u],C=(l[u].x+S.metrics.advance*S.scale)*g;for(let R=o;R<=u;R++)l[R].x-=C,l[R].y+=b}function NT(l,o,u){const{horizontalAlign:g,verticalAlign:b}=rg(u),S=o[0]-l.displaySize[0]*g,C=o[1]-l.displaySize[1]*b;return{image:l,top:C,bottom:C+l.displaySize[1],left:S,right:S+l.displaySize[0]}}function Gv(l,o,u,g,b,S){const C=l.image;let R;if(C.content){const Se=C.content,Ue=C.pixelRatio||1;R=[Se[0]/Ue,Se[1]/Ue,C.displaySize[0]-Se[2]/Ue,C.displaySize[1]-Se[3]/Ue]}const F=o.left*S,j=o.right*S;let Z,Y,re,fe;u==="width"||u==="both"?(fe=b[0]+F-g[3],Y=b[0]+j+g[1]):(fe=b[0]+(F+j-C.displaySize[0])/2,Y=fe+C.displaySize[0]);const he=o.top*S,Pe=o.bottom*S;return u==="height"||u==="both"?(Z=b[1]+he-g[0],re=b[1]+Pe+g[2]):(Z=b[1]+(he+Pe-C.displaySize[1])/2,re=Z+C.displaySize[1]),{image:C,top:Z,right:Y,bottom:re,left:fe,collisionPadding:R}}const il=128;function Hv(l,o){const{expression:u}=o;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new Kn(l+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:g,interpolationType:b}=u;let S=0;for(;S<g.length&&g[S]<=l;)S++;S=Math.max(0,S-1);let C=S;for(;C<g.length&&g[C]<l+1;)C++;C=Math.min(g.length-1,C);const R=g[S],F=g[C];return u.kind==="composite"?{kind:"composite",minZoom:R,maxZoom:F,interpolationType:b}:{kind:"camera",minZoom:R,maxZoom:F,minSize:u.evaluate(new Kn(R)),maxSize:u.evaluate(new Kn(F)),interpolationType:b}}}class Gl extends Mt{constructor(o,u,g,b){super(o,u),this.angle=g,b!==void 0&&(this.segment=b)}clone(){return new Gl(this.x,this.y,this.angle,this.segment)}}function $v(l,o,u,g,b){if(o.segment===void 0)return!0;let S=o,C=o.segment+1,R=0;for(;R>-u/2;){if(C--,C<0)return!1;R-=l[C].dist(S),S=l[C]}R+=l[C].dist(l[C+1]),C++;const F=[];let j=0;for(;R<u/2;){const Z=l[C],Y=l[C+1];if(!Y)return!1;let re=l[C-1].angleTo(Z)-Z.angleTo(Y);for(re=Math.abs((re+3*Math.PI)%(2*Math.PI)-Math.PI),F.push({distance:R,angleDelta:re}),j+=re;R-F[0].distance>g;)j-=F.shift().angleDelta;if(j>b)return!1;C++,R+=Z.dist(Y)}return!0}function Wv(l){let o=0;for(let u=0;u<l.length-1;u++)o+=l[u].dist(l[u+1]);return o}function Zv(l,o,u){return l?.6*o*u:0}function qv(l,o){return Math.max(l?l.right-l.left:0,o?o.right-o.left:0)}function UT(l,o,u,g,b,S){const C=Zv(u,b,S),R=qv(u,g)*S;let F=0;const j=Wv(l)/2;for(let Z=0;Z<l.length-1;Z++){const Y=l[Z],re=l[Z+1],fe=Y.dist(re);if(F+fe>j){const he=(j-F)/fe,Pe=pn(Y.x,re.x,he),Se=pn(Y.y,re.y,he),Ue=new Gl(Pe,Se,re.angleTo(Y),Z);return Ue._round(),!C||$v(l,Ue,R,C,o)?Ue:void 0}F+=fe}}function VT(l,o,u,g,b,S,C,R,F){const j=Zv(g,S,C),Z=qv(g,b),Y=Z*C,re=l[0].x===0||l[0].x===F||l[0].y===0||l[0].y===F;return o-Y<o/4&&(o=Y+o/4),Qv(l,re?o/2*R%o:(Z/2+2*S)*C*R%o,o,j,u,Y,re,!1,F)}function Qv(l,o,u,g,b,S,C,R,F){const j=S/2,Z=Wv(l);let Y=0,re=o-u,fe=[];for(let he=0;he<l.length-1;he++){const Pe=l[he],Se=l[he+1],Ue=Pe.dist(Se),Qe=Se.angleTo(Pe);for(;re+u<Y+Ue;){re+=u;const Oe=(re-Y)/Ue,We=pn(Pe.x,Se.x,Oe),at=pn(Pe.y,Se.y,Oe);if(We>=0&&We<F&&at>=0&&at<F&&re-j>=0&&re+j<=Z){const st=new Gl(We,at,Qe,he);st._round(),g&&!$v(l,st,S,g,b)||fe.push(st)}}Y+=Ue}return R||fe.length||C||(fe=Qv(l,Y/2,u,g,b,S,C,!0,F)),fe}function Xv(l,o,u,g,b){const S=[];for(let C=0;C<l.length;C++){const R=l[C];let F;for(let j=0;j<R.length-1;j++){let Z=R[j],Y=R[j+1];Z.x<o&&Y.x<o||(Z.x<o?Z=new Mt(o,Z.y+(o-Z.x)/(Y.x-Z.x)*(Y.y-Z.y))._round():Y.x<o&&(Y=new Mt(o,Z.y+(o-Z.x)/(Y.x-Z.x)*(Y.y-Z.y))._round()),Z.y<u&&Y.y<u||(Z.y<u?Z=new Mt(Z.x+(u-Z.y)/(Y.y-Z.y)*(Y.x-Z.x),u)._round():Y.y<u&&(Y=new Mt(Z.x+(u-Z.y)/(Y.y-Z.y)*(Y.x-Z.x),u)._round()),Z.x>=g&&Y.x>=g||(Z.x>=g?Z=new Mt(g,Z.y+(g-Z.x)/(Y.x-Z.x)*(Y.y-Z.y))._round():Y.x>=g&&(Y=new Mt(g,Z.y+(g-Z.x)/(Y.x-Z.x)*(Y.y-Z.y))._round()),Z.y>=b&&Y.y>=b||(Z.y>=b?Z=new Mt(Z.x+(b-Z.y)/(Y.y-Z.y)*(Y.x-Z.x),b)._round():Y.y>=b&&(Y=new Mt(Z.x+(b-Z.y)/(Y.y-Z.y)*(Y.x-Z.x),b)._round()),F&&Z.equals(F[F.length-1])||(F=[Z],S.push(F)),F.push(Y)))))}}return S}function Yv(l,o,u,g){const b=[],S=l.image,C=S.pixelRatio,R=S.paddedRect.w-2,F=S.paddedRect.h-2,j=l.right-l.left,Z=l.bottom-l.top,Y=S.stretchX||[[0,R]],re=S.stretchY||[[0,F]],fe=(vt,kt)=>vt+kt[1]-kt[0],he=Y.reduce(fe,0),Pe=re.reduce(fe,0),Se=R-he,Ue=F-Pe;let Qe=0,Oe=he,We=0,at=Pe,st=0,Lt=Se,Nt=0,Ct=Ue;if(S.content&&g){const vt=S.content;Qe=UA(Y,0,vt[0]),We=UA(re,0,vt[1]),Oe=UA(Y,vt[0],vt[2]),at=UA(re,vt[1],vt[3]),st=vt[0]-Qe,Nt=vt[1]-We,Lt=vt[2]-vt[0]-Oe,Ct=vt[3]-vt[1]-at}const wt=(vt,kt,Et,At)=>{const Yt=VA(vt.stretch-Qe,Oe,j,l.left),Ht=jA(vt.fixed-st,Lt,vt.stretch,he),xn=VA(kt.stretch-We,at,Z,l.top),ti=jA(kt.fixed-Nt,Ct,kt.stretch,Pe),si=VA(Et.stretch-Qe,Oe,j,l.left),qi=jA(Et.fixed-st,Lt,Et.stretch,he),No=VA(At.stretch-We,at,Z,l.top),pr=jA(At.fixed-Nt,Ct,At.stretch,Pe),Fi=new Mt(Yt,xn),er=new Mt(si,xn),mr=new Mt(si,No),Sr=new Mt(Yt,No),io=new Mt(Ht/C,ti/C),Ni=new Mt(qi/C,pr/C),gr=o*Math.PI/180;if(gr){const ro=Math.sin(gr),oo=Math.cos(gr),ui=[oo,-ro,ro,oo];Fi._matMult(ui),er._matMult(ui),Sr._matMult(ui),mr._matMult(ui)}const Mr=vt.stretch+vt.fixed,Vr=kt.stretch+kt.fixed;return{tl:Fi,tr:er,bl:Sr,br:mr,tex:{x:S.paddedRect.x+1+Mr,y:S.paddedRect.y+1+Vr,w:Et.stretch+Et.fixed-Mr,h:At.stretch+At.fixed-Vr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:io,pixelOffsetBR:Ni,minFontScaleX:Lt/C/j,minFontScaleY:Ct/C/Z,isSDF:u}};if(g&&(S.stretchX||S.stretchY)){const vt=Kv(Y,Se,he),kt=Kv(re,Ue,Pe);for(let Et=0;Et<vt.length-1;Et++){const At=vt[Et],Yt=vt[Et+1];for(let Ht=0;Ht<kt.length-1;Ht++)b.push(wt(At,kt[Ht],Yt,kt[Ht+1]))}}else b.push(wt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:R+1},{fixed:0,stretch:F+1}));return b}function UA(l,o,u){let g=0;for(const b of l)g+=Math.max(o,Math.min(u,b[1]))-Math.max(o,Math.min(u,b[0]));return g}function Kv(l,o,u){const g=[{fixed:-1,stretch:0}];for(const[b,S]of l){const C=g[g.length-1];g.push({fixed:b-C.stretch,stretch:C.stretch}),g.push({fixed:b-C.stretch,stretch:C.stretch+(S-b)})}return g.push({fixed:o+1,stretch:u}),g}function VA(l,o,u,g){return l/o*u+g}function jA(l,o,u,g){return l-o*u/g}Pt("Anchor",Gl);class GA{constructor(o,u,g,b,S,C,R,F,j,Z){if(this.boxStartIndex=o.length,j){let Y=C.top,re=C.bottom;const fe=C.collisionPadding;fe&&(Y-=fe[1],re+=fe[3]);let he=re-Y;he>0&&(he=Math.max(10,he),this.circleDiameter=he)}else{let Y=C.top*R-F[0],re=C.bottom*R+F[2],fe=C.left*R-F[3],he=C.right*R+F[1];const Pe=C.collisionPadding;if(Pe&&(fe-=Pe[0]*R,Y-=Pe[1]*R,he+=Pe[2]*R,re+=Pe[3]*R),Z){const Se=new Mt(fe,Y),Ue=new Mt(he,Y),Qe=new Mt(fe,re),Oe=new Mt(he,re),We=Z*Math.PI/180;Se._rotate(We),Ue._rotate(We),Qe._rotate(We),Oe._rotate(We),fe=Math.min(Se.x,Ue.x,Qe.x,Oe.x),he=Math.max(Se.x,Ue.x,Qe.x,Oe.x),Y=Math.min(Se.y,Ue.y,Qe.y,Oe.y),re=Math.max(Se.y,Ue.y,Qe.y,Oe.y)}o.emplaceBack(u.x,u.y,fe,Y,he,re,g,b,S)}this.boxEndIndex=o.length}}class jT{constructor(o=[],u=GT){if(this.data=o,this.length=this.data.length,this.compare=u,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const o=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:u,compare:g}=this,b=u[o];for(;o>0;){const S=o-1>>1,C=u[S];if(g(b,C)>=0)break;u[o]=C,o=S}u[o]=b}_down(o){const{data:u,compare:g}=this,b=this.length>>1,S=u[o];for(;o<b;){let C=1+(o<<1),R=u[C];const F=C+1;if(F<this.length&&g(u[F],R)<0&&(C=F,R=u[F]),g(R,S)>=0)break;u[o]=R,o=C}u[o]=S}}function GT(l,o){return l<o?-1:l>o?1:0}function HT(l,o=1,u=!1){let g=1/0,b=1/0,S=-1/0,C=-1/0;const R=l[0];for(let fe=0;fe<R.length;fe++){const he=R[fe];(!fe||he.x<g)&&(g=he.x),(!fe||he.y<b)&&(b=he.y),(!fe||he.x>S)&&(S=he.x),(!fe||he.y>C)&&(C=he.y)}const F=Math.min(S-g,C-b);let j=F/2;const Z=new jT([],$T);if(F===0)return new Mt(g,b);for(let fe=g;fe<S;fe+=F)for(let he=b;he<C;he+=F)Z.push(new lf(fe+j,he+j,j,l));let Y=function(fe){let he=0,Pe=0,Se=0;const Ue=fe[0];for(let Qe=0,Oe=Ue.length,We=Oe-1;Qe<Oe;We=Qe++){const at=Ue[Qe],st=Ue[We],Lt=at.x*st.y-st.x*at.y;Pe+=(at.x+st.x)*Lt,Se+=(at.y+st.y)*Lt,he+=3*Lt}return new lf(Pe/he,Se/he,0,fe)}(l),re=Z.length;for(;Z.length;){const fe=Z.pop();(fe.d>Y.d||!Y.d)&&(Y=fe,u&&console.log("found best %d after %d probes",Math.round(1e4*fe.d)/1e4,re)),fe.max-Y.d<=o||(j=fe.h/2,Z.push(new lf(fe.p.x-j,fe.p.y-j,j,l)),Z.push(new lf(fe.p.x+j,fe.p.y-j,j,l)),Z.push(new lf(fe.p.x-j,fe.p.y+j,j,l)),Z.push(new lf(fe.p.x+j,fe.p.y+j,j,l)),re+=4)}return u&&(console.log(`num probes: ${re}`),console.log(`best distance: ${Y.d}`)),Y.p}function $T(l,o){return o.max-l.max}function lf(l,o,u,g){this.p=new Mt(l,o),this.h=u,this.d=function(b,S){let C=!1,R=1/0;for(let F=0;F<S.length;F++){const j=S[F];for(let Z=0,Y=j.length,re=Y-1;Z<Y;re=Z++){const fe=j[Z],he=j[re];fe.y>b.y!=he.y>b.y&&b.x<(he.x-fe.x)*(b.y-fe.y)/(he.y-fe.y)+fe.x&&(C=!C),R=Math.min(R,sv(b,fe,he))}}return(C?1:-1)*Math.sqrt(R)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}const og=Number.POSITIVE_INFINITY;function Jv(l,o){return o[1]!==og?function(u,g,b){let S=0,C=0;switch(g=Math.abs(g),b=Math.abs(b),u){case"top-right":case"top-left":case"top":C=b-7;break;case"bottom-right":case"bottom-left":case"bottom":C=7-b}switch(u){case"top-right":case"bottom-right":case"right":S=-g;break;case"top-left":case"bottom-left":case"left":S=g}return[S,C]}(l,o[0],o[1]):function(u,g){let b=0,S=0;g<0&&(g=0);const C=g/Math.sqrt(2);switch(u){case"top-right":case"top-left":S=C-7;break;case"bottom-right":case"bottom-left":S=7-C;break;case"bottom":S=7-g;break;case"top":S=g-7}switch(u){case"top-right":case"bottom-right":b=-C;break;case"top-left":case"bottom-left":b=C;break;case"left":b=g;break;case"right":b=-g}return[b,S]}(l,o[0])}function sg(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function WT(l,o,u,g,b,S,C,R,F,j,Z){let Y=S.textMaxSize.evaluate(o,{});Y===void 0&&(Y=C);const re=l.layers[0].layout,fe=re.get("icon-offset").evaluate(o,{},Z),he=tx(u.horizontal),Pe=C/24,Se=l.tilePixelRatio*Pe,Ue=l.tilePixelRatio*Y/24,Qe=l.tilePixelRatio*R,Oe=l.tilePixelRatio*re.get("symbol-spacing"),We=re.get("text-padding")*l.tilePixelRatio,at=function(At,Yt,Ht,xn=1){const ti=At.get("icon-padding").evaluate(Yt,{},Ht),si=ti&&ti.values;return[si[0]*xn,si[1]*xn,si[2]*xn,si[3]*xn]}(re,o,Z,l.tilePixelRatio),st=re.get("text-max-angle")/180*Math.PI,Lt=re.get("text-rotation-alignment")!=="viewport"&&re.get("symbol-placement")!=="point",Nt=re.get("icon-rotation-alignment")==="map"&&re.get("symbol-placement")!=="point",Ct=re.get("symbol-placement"),wt=Oe/2,vt=re.get("icon-text-fit");let kt;g&&vt!=="none"&&(l.allowVerticalPlacement&&u.vertical&&(kt=Gv(g,u.vertical,vt,re.get("icon-text-fit-padding"),fe,Pe)),he&&(g=Gv(g,he,vt,re.get("icon-text-fit-padding"),fe,Pe)));const Et=(At,Yt)=>{Yt.x<0||Yt.x>=Zi||Yt.y<0||Yt.y>=Zi||function(Ht,xn,ti,si,qi,No,pr,Fi,er,mr,Sr,io,Ni,gr,Mr,Vr,ro,oo,ui,tr,Cn,wo,_r,Ir,hs){const Os=Ht.addToLineVertexArray(xn,ti);let Fs,rl,ds,Uo,so=0,ol=0,jh=0,gx=0,mg=-1,gg=-1;const sl={};let _x=on.exports(""),_g=0,yg=0;if(Fi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[_g,yg]=Fi.layout.get("text-offset").evaluate(Cn,{},Ir).map(ao=>ao*ar):(_g=Fi.layout.get("text-radial-offset").evaluate(Cn,{},Ir)*ar,yg=og),Ht.allowVerticalPlacement&&si.vertical){const ao=Fi.layout.get("text-rotate").evaluate(Cn,{},Ir)+90;ds=new GA(er,xn,mr,Sr,io,si.vertical,Ni,gr,Mr,ao),pr&&(Uo=new GA(er,xn,mr,Sr,io,pr,ro,oo,Mr,ao))}if(qi){const ao=Fi.layout.get("icon-rotate").evaluate(Cn,{}),da=Fi.layout.get("icon-text-fit")!=="none",Gh=Yv(qi,ao,_r,da),Hh=pr?Yv(pr,ao,_r,da):void 0;rl=new GA(er,xn,mr,Sr,io,qi,ro,oo,!1,ao),so=4*Gh.length;const xx=Ht.iconSizeData;let Qc=null;xx.kind==="source"?(Qc=[il*Fi.layout.get("icon-size").evaluate(Cn,{})],Qc[0]>Hl&&Le(`${Ht.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):xx.kind==="composite"&&(Qc=[il*wo.compositeIconSizes[0].evaluate(Cn,{},Ir),il*wo.compositeIconSizes[1].evaluate(Cn,{},Ir)],(Qc[0]>Hl||Qc[1]>Hl)&&Le(`${Ht.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ht.addSymbols(Ht.icon,Gh,Qc,tr,ui,Cn,a.WritingMode.none,xn,Os.lineStartIndex,Os.lineLength,-1,Ir),mg=Ht.icon.placedSymbolArray.length-1,Hh&&(ol=4*Hh.length,Ht.addSymbols(Ht.icon,Hh,Qc,tr,ui,Cn,a.WritingMode.vertical,xn,Os.lineStartIndex,Os.lineLength,-1,Ir),gg=Ht.icon.placedSymbolArray.length-1)}const yx=Object.keys(si.horizontal);for(const ao of yx){const da=si.horizontal[ao];if(!Fs){_x=on.exports(da.text);const Hh=Fi.layout.get("text-rotate").evaluate(Cn,{},Ir);Fs=new GA(er,xn,mr,Sr,io,da,Ni,gr,Mr,Hh)}const Gh=da.positionedLines.length===1;if(jh+=ex(Ht,xn,da,No,Fi,Mr,Cn,Vr,Os,si.vertical?a.WritingMode.horizontal:a.WritingMode.horizontalOnly,Gh?yx:[ao],sl,mg,wo,Ir),Gh)break}si.vertical&&(gx+=ex(Ht,xn,si.vertical,No,Fi,Mr,Cn,Vr,Os,a.WritingMode.vertical,["vertical"],sl,gg,wo,Ir));const oS=Fs?Fs.boxStartIndex:Ht.collisionBoxArray.length,sS=Fs?Fs.boxEndIndex:Ht.collisionBoxArray.length,aS=ds?ds.boxStartIndex:Ht.collisionBoxArray.length,lS=ds?ds.boxEndIndex:Ht.collisionBoxArray.length,cS=rl?rl.boxStartIndex:Ht.collisionBoxArray.length,uS=rl?rl.boxEndIndex:Ht.collisionBoxArray.length,fS=Uo?Uo.boxStartIndex:Ht.collisionBoxArray.length,hS=Uo?Uo.boxEndIndex:Ht.collisionBoxArray.length;let Ns=-1;const qA=(ao,da)=>ao&&ao.circleDiameter?Math.max(ao.circleDiameter,da):da;Ns=qA(Fs,Ns),Ns=qA(ds,Ns),Ns=qA(rl,Ns),Ns=qA(Uo,Ns);const vx=Ns>-1?1:0;vx&&(Ns*=hs/ar),Ht.glyphOffsetArray.length>=cf.MAX_GLYPHS&&Le("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Cn.sortKey!==void 0&&Ht.addToSortKeyRanges(Ht.symbolInstances.length,Cn.sortKey),Ht.symbolInstances.emplaceBack(xn.x,xn.y,sl.right>=0?sl.right:-1,sl.center>=0?sl.center:-1,sl.left>=0?sl.left:-1,sl.vertical||-1,mg,gg,_x,oS,sS,aS,lS,cS,uS,fS,hS,mr,jh,gx,so,ol,vx,0,Ni,_g,yg,Ns)}(l,Yt,At,u,g,b,kt,l.layers[0],l.collisionBoxArray,o.index,o.sourceLayerIndex,l.index,Se,[We,We,We,We],Lt,F,Qe,at,Nt,fe,o,S,j,Z,C)};if(Ct==="line")for(const At of Xv(o.geometry,0,0,Zi,Zi)){const Yt=VT(At,Oe,st,u.vertical||he,g,24,Ue,l.overscaling,Zi);for(const Ht of Yt){const xn=he;xn&&ZT(l,xn.text,wt,Ht)||Et(At,Ht)}}else if(Ct==="line-center"){for(const At of o.geometry)if(At.length>1){const Yt=UT(At,st,u.vertical||he,g,24,Ue);Yt&&Et(At,Yt)}}else if(o.type==="Polygon")for(const At of Zm(o.geometry,0)){const Yt=HT(At,16);Et(At[0],new Gl(Yt.x,Yt.y,0))}else if(o.type==="LineString")for(const At of o.geometry)Et(At,new Gl(At[0].x,At[0].y,0));else if(o.type==="Point")for(const At of o.geometry)for(const Yt of At)Et([Yt],new Gl(Yt.x,Yt.y,0))}const Hl=32640;function ex(l,o,u,g,b,S,C,R,F,j,Z,Y,re,fe,he){const Pe=function(Qe,Oe,We,at,st,Lt,Nt,Ct){const wt=at.layout.get("text-rotate").evaluate(Lt,{})*Math.PI/180,vt=[];for(const kt of Oe.positionedLines)for(const Et of kt.positionedGlyphs){if(!Et.rect)continue;const At=Et.rect||{};let Yt=4,Ht=!0,xn=1,ti=0;const si=(st||Ct)&&Et.vertical,qi=Et.metrics.advance*Et.scale/2;if(Ct&&Oe.verticalizable){const ui=(Et.scale-1)*ar,tr=(ar-Et.metrics.width*Et.scale)/2;ti=kt.lineOffset/2-(Et.imageName?-tr:ui)}if(Et.imageName){const ui=Nt[Et.imageName];Ht=ui.sdf,xn=ui.pixelRatio,Yt=1/xn}const No=st?[Et.x+qi,Et.y]:[0,0];let pr=st?[0,0]:[Et.x+qi+We[0],Et.y+We[1]-ti],Fi=[0,0];si&&(Fi=pr,pr=[0,0]);const er=(Et.metrics.left-Yt)*Et.scale-qi+pr[0],mr=(-Et.metrics.top-Yt)*Et.scale+pr[1],Sr=er+At.w*Et.scale/xn,io=mr+At.h*Et.scale/xn,Ni=new Mt(er,mr),gr=new Mt(Sr,mr),Mr=new Mt(er,io),Vr=new Mt(Sr,io);if(si){const ui=new Mt(-qi,qi-OA),tr=-Math.PI/2,Cn=12-qi,wo=new Mt(22-Cn,-(Et.imageName?Cn:0)),_r=new Mt(...Fi);Ni._rotateAround(tr,ui)._add(wo)._add(_r),gr._rotateAround(tr,ui)._add(wo)._add(_r),Mr._rotateAround(tr,ui)._add(wo)._add(_r),Vr._rotateAround(tr,ui)._add(wo)._add(_r)}if(wt){const ui=Math.sin(wt),tr=Math.cos(wt),Cn=[tr,-ui,ui,tr];Ni._matMult(Cn),gr._matMult(Cn),Mr._matMult(Cn),Vr._matMult(Cn)}const ro=new Mt(0,0),oo=new Mt(0,0);vt.push({tl:Ni,tr:gr,bl:Mr,br:Vr,tex:At,writingMode:Oe.writingMode,glyphOffset:No,sectionIndex:Et.sectionIndex,isSDF:Ht,pixelOffsetTL:ro,pixelOffsetBR:oo,minFontScaleX:0,minFontScaleY:0})}return vt}(0,u,R,b,S,C,g,l.allowVerticalPlacement),Se=l.textSizeData;let Ue=null;Se.kind==="source"?(Ue=[il*b.layout.get("text-size").evaluate(C,{})],Ue[0]>Hl&&Le(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Se.kind==="composite"&&(Ue=[il*fe.compositeTextSizes[0].evaluate(C,{},he),il*fe.compositeTextSizes[1].evaluate(C,{},he)],(Ue[0]>Hl||Ue[1]>Hl)&&Le(`${l.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),l.addSymbols(l.text,Pe,Ue,R,S,C,j,o,F.lineStartIndex,F.lineLength,re,he);for(const Qe of Z)Y[Qe]=l.text.placedSymbolArray.length-1;return 4*Pe.length}function tx(l){for(const o in l)return l[o];return null}function ZT(l,o,u,g){const b=l.compareText;if(o in b){const S=b[o];for(let C=S.length-1;C>=0;C--)if(g.dist(S[C])<u)return!0}else b[o]=[];return b[o].push(g),!1}const qT=Vl.VectorTileFeature.types,QT=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function HA(l,o,u,g,b,S,C,R,F,j,Z,Y,re){const fe=R?Math.min(Hl,Math.round(R[0])):0,he=R?Math.min(Hl,Math.round(R[1])):0;l.emplaceBack(o,u,Math.round(32*g),Math.round(32*b),S,C,(fe<<1)+(F?1:0),he,16*j,16*Z,256*Y,256*re)}function ag(l,o,u){l.emplaceBack(o.x,o.y,u),l.emplaceBack(o.x,o.y,u),l.emplaceBack(o.x,o.y,u),l.emplaceBack(o.x,o.y,u)}function XT(l){for(const o of l.sections)if(Zu(o.text))return!0;return!1}class lg{constructor(o){this.layoutVertexArray=new be,this.indexArray=new $e,this.programConfigurations=o,this.segments=new ot,this.dynamicLayoutVertexArray=new ze,this.opacityVertexArray=new Je,this.placedSymbolArray=new d}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(o,u,g,b){this.isEmpty()||(g&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,yT.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,vT.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,QT,!0),this.opacityVertexBuffer.itemSize=1),(g||b)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pt("SymbolBuffers",lg);class cg{constructor(o,u,g){this.layoutVertexArray=new o,this.layoutAttributes=u,this.indexArray=new g,this.segments=new ot,this.collisionVertexArray=new He}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,xT.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pt("CollisionBuffers",cg);class cf{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(C=>C.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Vm([]),this.placementViewportMatrix=Vm([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Hv(this.zoom,u["text-size"]),this.iconSizeData=Hv(this.zoom,u["icon-size"]);const g=this.layers[0].layout,b=g.get("symbol-sort-key"),S=g.get("symbol-z-order");this.canOverlap=fg(g,"text-overlap","text-allow-overlap")!=="never"||fg(g,"icon-overlap","icon-allow-overlap")!=="never"||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=S!=="viewport-y"&&!b.isConstant(),this.sortFeaturesByY=(S==="viewport-y"||S==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(C=>a.WritingMode[C])),this.stateDependentLayerIds=this.layers.filter(C=>C.isStateDependent()).map(C=>C.id),this.sourceID=o.sourceID}createArrays(){this.text=new lg(new Hc(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new lg(new Hc(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new _,this.lineVertexArray=new v,this.symbolInstances=new m}calculateGlyphDependencies(o,u,g,b,S){for(let C=0;C<o.length;C++)if(u[o.charCodeAt(C)]=!0,(g||b)&&S){const R=Fh[o.charAt(C)];R&&(u[R.charCodeAt(0)]=!0)}}populate(o,u,g){const b=this.layers[0],S=b.layout,C=S.get("text-font"),R=S.get("text-field"),F=S.get("icon-image"),j=(R.value.kind!=="constant"||R.value.value instanceof Te&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),Z=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,Y=S.get("symbol-sort-key");if(this.features=[],!j&&!Z)return;const re=u.iconDependencies,fe=u.glyphDependencies,he=u.availableImages,Pe=new Kn(this.zoom);for(const{feature:Se,id:Ue,index:Qe,sourceLayerIndex:Oe}of o){const We=b._featureFilter.needGeometry,at=Wc(Se,We);if(!b._featureFilter.filter(Pe,at,g))continue;let st,Lt;if(We||(at.geometry=$c(Se)),j){const Ct=b.getValueAndResolveTokens("text-field",at,g,he),wt=Te.factory(Ct);XT(wt)&&(this.hasRTLText=!0),(!this.hasRTLText||Ya()==="unavailable"||this.hasRTLText&&Fr.isParsed())&&(st=bT(wt,b,at))}if(Z){const Ct=b.getValueAndResolveTokens("icon-image",at,g,he);Lt=Ct instanceof Me?Ct:Me.fromString(Ct)}if(!st&&!Lt)continue;const Nt=this.sortFeaturesByKey?Y.evaluate(at,{},g):void 0;if(this.features.push({id:Ue,text:st,icon:Lt,index:Qe,sourceLayerIndex:Oe,geometry:at.geometry,properties:Se.properties,type:qT[Se.type],sortKey:Nt}),Lt&&(re[Lt.name]=!0),st){const Ct=C.evaluate(at,{},g).join(","),wt=S.get("text-rotation-alignment")!=="viewport"&&S.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.WritingMode.vertical)>=0;for(const vt of st.sections)if(vt.image)re[vt.image.name]=!0;else{const kt=Ol(st.toString()),Et=vt.fontStack||Ct,At=fe[Et]=fe[Et]||{};this.calculateGlyphDependencies(vt.text,At,wt,this.allowVerticalPlacement,kt)}}}S.get("symbol-placement")==="line"&&(this.features=function(Se){const Ue={},Qe={},Oe=[];let We=0;function at(Ct){Oe.push(Se[Ct]),We++}function st(Ct,wt,vt){const kt=Qe[Ct];return delete Qe[Ct],Qe[wt]=kt,Oe[kt].geometry[0].pop(),Oe[kt].geometry[0]=Oe[kt].geometry[0].concat(vt[0]),kt}function Lt(Ct,wt,vt){const kt=Ue[wt];return delete Ue[wt],Ue[Ct]=kt,Oe[kt].geometry[0].shift(),Oe[kt].geometry[0]=vt[0].concat(Oe[kt].geometry[0]),kt}function Nt(Ct,wt,vt){const kt=vt?wt[0][wt[0].length-1]:wt[0][0];return`${Ct}:${kt.x}:${kt.y}`}for(let Ct=0;Ct<Se.length;Ct++){const wt=Se[Ct],vt=wt.geometry,kt=wt.text?wt.text.toString():null;if(!kt){at(Ct);continue}const Et=Nt(kt,vt),At=Nt(kt,vt,!0);if(Et in Qe&&At in Ue&&Qe[Et]!==Ue[At]){const Yt=Lt(Et,At,vt),Ht=st(Et,At,Oe[Yt].geometry);delete Ue[Et],delete Qe[At],Qe[Nt(kt,Oe[Ht].geometry,!0)]=Ht,Oe[Yt].geometry=null}else Et in Qe?st(Et,At,vt):At in Ue?Lt(Et,At,vt):(at(Ct),Ue[Et]=We-1,Qe[At]=We-1)}return Oe.filter(Ct=>Ct.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Se,Ue)=>Se.sortKey-Ue.sortKey)}update(o,u,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,u,this.layers,g),this.icon.programConfigurations.updatePaintArrays(o,u,this.layers,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,u){const g=this.lineVertexArray.length;if(o.segment!==void 0){let b=o.dist(u[o.segment+1]),S=o.dist(u[o.segment]);const C={};for(let R=o.segment+1;R<u.length;R++)C[R]={x:u[R].x,y:u[R].y,tileUnitDistanceFromAnchor:b},R<u.length-1&&(b+=u[R+1].dist(u[R]));for(let R=o.segment||0;R>=0;R--)C[R]={x:u[R].x,y:u[R].y,tileUnitDistanceFromAnchor:S},R>0&&(S+=u[R-1].dist(u[R]));for(let R=0;R<u.length;R++){const F=C[R];this.lineVertexArray.emplaceBack(F.x,F.y,F.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}}addSymbols(o,u,g,b,S,C,R,F,j,Z,Y,re){const fe=o.indexArray,he=o.layoutVertexArray,Pe=o.segments.prepareSegment(4*u.length,he,fe,this.canOverlap?C.sortKey:void 0),Se=this.glyphOffsetArray.length,Ue=Pe.vertexLength,Qe=this.allowVerticalPlacement&&R===a.WritingMode.vertical?Math.PI/2:0,Oe=C.text&&C.text.sections;for(let We=0;We<u.length;We++){const{tl:at,tr:st,bl:Lt,br:Nt,tex:Ct,pixelOffsetTL:wt,pixelOffsetBR:vt,minFontScaleX:kt,minFontScaleY:Et,glyphOffset:At,isSDF:Yt,sectionIndex:Ht}=u[We],xn=Pe.vertexLength,ti=At[1];HA(he,F.x,F.y,at.x,ti+at.y,Ct.x,Ct.y,g,Yt,wt.x,wt.y,kt,Et),HA(he,F.x,F.y,st.x,ti+st.y,Ct.x+Ct.w,Ct.y,g,Yt,vt.x,wt.y,kt,Et),HA(he,F.x,F.y,Lt.x,ti+Lt.y,Ct.x,Ct.y+Ct.h,g,Yt,wt.x,vt.y,kt,Et),HA(he,F.x,F.y,Nt.x,ti+Nt.y,Ct.x+Ct.w,Ct.y+Ct.h,g,Yt,vt.x,vt.y,kt,Et),ag(o.dynamicLayoutVertexArray,F,Qe),fe.emplaceBack(xn,xn+1,xn+2),fe.emplaceBack(xn+1,xn+2,xn+3),Pe.vertexLength+=4,Pe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(At[0]),We!==u.length-1&&Ht===u[We+1].sectionIndex||o.programConfigurations.populatePaintArrays(he.length,C,C.index,{},re,Oe&&Oe[Ht])}o.placedSymbolArray.emplaceBack(F.x,F.y,Se,this.glyphOffsetArray.length-Se,Ue,j,Z,F.segment,g?g[0]:0,g?g[1]:0,b[0],b[1],R,0,!1,0,Y)}_addCollisionDebugVertex(o,u,g,b,S,C){return u.emplaceBack(0,0),o.emplaceBack(g.x,g.y,b,S,Math.round(C.x),Math.round(C.y))}addCollisionDebugVertices(o,u,g,b,S,C,R){const F=S.segments.prepareSegment(4,S.layoutVertexArray,S.indexArray),j=F.vertexLength,Z=S.layoutVertexArray,Y=S.collisionVertexArray,re=R.anchorX,fe=R.anchorY;this._addCollisionDebugVertex(Z,Y,C,re,fe,new Mt(o,u)),this._addCollisionDebugVertex(Z,Y,C,re,fe,new Mt(g,u)),this._addCollisionDebugVertex(Z,Y,C,re,fe,new Mt(g,b)),this._addCollisionDebugVertex(Z,Y,C,re,fe,new Mt(o,b)),F.vertexLength+=4;const he=S.indexArray;he.emplaceBack(j,j+1),he.emplaceBack(j+1,j+2),he.emplaceBack(j+2,j+3),he.emplaceBack(j+3,j),F.primitiveLength+=4}addDebugCollisionBoxes(o,u,g,b){for(let S=o;S<u;S++){const C=this.collisionBoxArray.get(S);this.addCollisionDebugVertices(C.x1,C.y1,C.x2,C.y2,b?this.textCollisionBox:this.iconCollisionBox,C.anchorPoint,g)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new cg(Ye,kv.members,Be),this.iconCollisionBox=new cg(Ye,kv.members,Be);for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(o,u,g,b,S,C,R,F,j){const Z={};for(let Y=u;Y<g;Y++){const re=o.get(Y);Z.textBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,anchorPointX:re.anchorPointX,anchorPointY:re.anchorPointY},Z.textFeatureIndex=re.featureIndex;break}for(let Y=b;Y<S;Y++){const re=o.get(Y);Z.verticalTextBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,anchorPointX:re.anchorPointX,anchorPointY:re.anchorPointY},Z.verticalTextFeatureIndex=re.featureIndex;break}for(let Y=C;Y<R;Y++){const re=o.get(Y);Z.iconBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,anchorPointX:re.anchorPointX,anchorPointY:re.anchorPointY},Z.iconFeatureIndex=re.featureIndex;break}for(let Y=F;Y<j;Y++){const re=o.get(Y);Z.verticalIconBox={x1:re.x1,y1:re.y1,x2:re.x2,y2:re.y2,anchorPointX:re.anchorPointX,anchorPointY:re.anchorPointY},Z.verticalIconFeatureIndex=re.featureIndex;break}return Z}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const g=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,u){const g=o.placedSymbolArray.get(u),b=g.vertexStartIndex+4*g.numGlyphs;for(let S=g.vertexStartIndex;S<b;S+=4)o.indexArray.emplaceBack(S,S+1,S+2),o.indexArray.emplaceBack(S+1,S+2,S+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(o),g=Math.cos(o),b=[],S=[],C=[];for(let R=0;R<this.symbolInstances.length;++R){C.push(R);const F=this.symbolInstances.get(R);b.push(0|Math.round(u*F.anchorX+g*F.anchorY)),S.push(F.featureIndex)}return C.sort((R,F)=>b[R]-b[F]||S[F]-S[R]),C}addToSortKeyRanges(o,u){const g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===u?g.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const g=this.symbolInstances.get(u);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach((b,S,C)=>{b>=0&&C.indexOf(b)===S&&this.addIndicesForPlacedSymbol(this.text,b)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Pt("SymbolBucket",cf,{omit:["layers","collisionBoxArray","features","compareText"]}),cf.MAX_GLYPHS=65535,cf.addDynamicAttributes=ag;const YT=new Wi({"symbol-placement":new Ut(et.layout_symbol["symbol-placement"]),"symbol-spacing":new Ut(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ut(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ut(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ut(et.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ut(et.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ut(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ut(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ut(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(et.layout_symbol["icon-size"]),"icon-text-fit":new Ut(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ut(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(et.layout_symbol["icon-image"]),"icon-rotate":new qt(et.layout_symbol["icon-rotate"]),"icon-padding":new qt(et.layout_symbol["icon-padding"]),"icon-keep-upright":new Ut(et.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(et.layout_symbol["icon-offset"]),"icon-anchor":new qt(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ut(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ut(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ut(et.layout_symbol["text-rotation-alignment"]),"text-field":new qt(et.layout_symbol["text-field"]),"text-font":new qt(et.layout_symbol["text-font"]),"text-size":new qt(et.layout_symbol["text-size"]),"text-max-width":new qt(et.layout_symbol["text-max-width"]),"text-line-height":new Ut(et.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(et.layout_symbol["text-letter-spacing"]),"text-justify":new qt(et.layout_symbol["text-justify"]),"text-radial-offset":new qt(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ut(et.layout_symbol["text-variable-anchor"]),"text-anchor":new qt(et.layout_symbol["text-anchor"]),"text-max-angle":new Ut(et.layout_symbol["text-max-angle"]),"text-writing-mode":new Ut(et.layout_symbol["text-writing-mode"]),"text-rotate":new qt(et.layout_symbol["text-rotate"]),"text-padding":new Ut(et.layout_symbol["text-padding"]),"text-keep-upright":new Ut(et.layout_symbol["text-keep-upright"]),"text-transform":new qt(et.layout_symbol["text-transform"]),"text-offset":new qt(et.layout_symbol["text-offset"]),"text-allow-overlap":new Ut(et.layout_symbol["text-allow-overlap"]),"text-overlap":new Ut(et.layout_symbol["text-overlap"]),"text-ignore-placement":new Ut(et.layout_symbol["text-ignore-placement"]),"text-optional":new Ut(et.layout_symbol["text-optional"])});var ug={paint:new Wi({"icon-opacity":new qt(et.paint_symbol["icon-opacity"]),"icon-color":new qt(et.paint_symbol["icon-color"]),"icon-halo-color":new qt(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(et.paint_symbol["icon-halo-blur"]),"icon-translate":new Ut(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ut(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new qt(et.paint_symbol["text-opacity"]),"text-color":new qt(et.paint_symbol["text-color"],{runtimeType:mi,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new qt(et.paint_symbol["text-halo-color"]),"text-halo-width":new qt(et.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(et.paint_symbol["text-halo-blur"]),"text-translate":new Ut(et.paint_symbol["text-translate"]),"text-translate-anchor":new Ut(et.paint_symbol["text-translate-anchor"])}),layout:YT};class nx{constructor(o){if(o.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=o.property.overrides?o.property.overrides.runtimeType:Xr,this.defaultValue=o}evaluate(o){if(o.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(o.formattedSection))return u.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pt("FormatSectionOverride",nx,{omit:["defaultValue"]});class $A extends no{constructor(o){super(o,ug)}recalculate(o,u){if(super.recalculate(o,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const g=this.layout.get("text-writing-mode");if(g){const b=[];for(const S of g)b.indexOf(S)<0&&b.push(S);this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(o,u,g,b){const S=this.layout.get(o).evaluate(u,{},g,b),C=this._unevaluatedLayout._values[o];return C.isDataDriven()||ja(C.value)||!S?S:function(R,F){return F.replace(/{([^{}]+)}/g,(j,Z)=>Z in R?String(R[Z]):"")}(u.properties,S)}createBucket(o){return new cf(o)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const o of ug.paint.overridableProperties){if(!$A.hasPaintOverride(this.layout,o))continue;const u=this.paint.get(o),g=new nx(u),b=new Va(g,u.property.specification);let S=null;S=u.value.kind==="constant"||u.value.kind==="source"?new Ps("source",b):new Ga("composite",b,u.value.zoomStops),this.paint._values[o]=new Hn(u.property,S,u.parameters)}}_handleOverridablePaintPropertyUpdate(o,u,g){return!(!this.layout||u.isDataDriven()||g.isDataDriven())&&$A.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,u){const g=o.get("text-field"),b=ug.paint.properties[u];let S=!1;const C=R=>{for(const F of R)if(b.overrides&&b.overrides.hasOverride(F))return void(S=!0)};if(g.value.kind==="constant"&&g.value.value instanceof Te)C(g.value.value.sections);else if(g.value.kind==="source"){const R=j=>{S||(j instanceof Tt&&Ne(j.value)===wi?C(j.value.sections):j instanceof Pl?C(j.sections):j.eachChild(R))},F=g.value;F._styleExpression&&R(F._styleExpression.expression)}return S}}function fg(l,o,u){let g="never";const b=l.get(o);return b?g=b:l.get(u)&&(g="always"),g}var KT={paint:new Wi({"background-color":new Ut(et.paint_background["background-color"]),"background-pattern":new Vc(et.paint_background["background-pattern"]),"background-opacity":new Ut(et.paint_background["background-opacity"])})},JT={paint:new Wi({"raster-opacity":new Ut(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ut(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ut(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ut(et.paint_raster["raster-brightness-max"]),"raster-saturation":new Ut(et.paint_raster["raster-saturation"]),"raster-contrast":new Ut(et.paint_raster["raster-contrast"]),"raster-resampling":new Ut(et.paint_raster["raster-resampling"]),"raster-fade-duration":new Ut(et.paint_raster["raster-fade-duration"])})};class eS extends no{constructor(o){super(o,{}),this.onAdd=u=>{this.implementation.onAdd&&this.implementation.onAdd(u,u.painter.context.gl)},this.onRemove=u=>{this.implementation.onRemove&&this.implementation.onRemove(u,u.painter.context.gl)},this.implementation=o}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const tS={circle:class extends no{constructor(l){super(l,L5)}createBucket(l){return new Fm(l)}queryRadius(l){const o=l;return Ch("circle-radius",this,o)+Ch("circle-stroke-width",this,o)+IA(this.paint.get("circle-translate"))}queryIntersectsFeature(l,o,u,g,b,S,C,R){const F=CA(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),S.angle,C),j=this.paint.get("circle-radius").evaluate(o,u)+this.paint.get("circle-stroke-width").evaluate(o,u),Z=this.paint.get("circle-pitch-alignment")==="map",Y=Z?F:function(fe,he){return fe.map(Pe=>dv(Pe,he))}(F,R),re=Z?j*C:j;for(const fe of g)for(const he of fe){const Pe=Z?he:dv(he,R);let Se=re;const Ue=kA([],[he.x,he.y,0,1],R);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Se*=Ue[3]/S.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Se*=S.cameraToCenterDistance/Ue[3]),M5(Y,Pe,Se))return!0}return!1}},heatmap:class extends no{constructor(l){super(l,D5),this._updateColorRamp()}createBucket(l){return new Av(l)}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=mv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends no{constructor(l){super(l,z5)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends no{constructor(l){super(l,Y5)}recalculate(l,o){super.recalculate(l,o);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new Xm(l)}queryRadius(){return IA(this.paint.get("fill-translate"))}queryIntersectsFeature(l,o,u,g,b,S,C){return ov(CA(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),S.angle,C),g)}isTileClipped(){return!0}},"fill-extrusion":class extends no{constructor(l){super(l,fT)}createBucket(l){return new Km(l)}queryRadius(){return IA(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(l,o,u,g,b,S,C,R){const F=CA(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),S.angle,C),j=this.paint.get("fill-extrusion-height").evaluate(o,u),Z=this.paint.get("fill-extrusion-base").evaluate(o,u),Y=function(fe,he,Pe,Se){const Ue=[];for(const Qe of fe){const Oe=[Qe.x,Qe.y,0,1];kA(Oe,Oe,he),Ue.push(new Mt(Oe[0]/Oe[3],Oe[1]/Oe[3]))}return Ue}(F,R),re=function(fe,he,Pe,Se){const Ue=[],Qe=[],Oe=Se[8]*he,We=Se[9]*he,at=Se[10]*he,st=Se[11]*he,Lt=Se[8]*Pe,Nt=Se[9]*Pe,Ct=Se[10]*Pe,wt=Se[11]*Pe;for(const vt of fe){const kt=[],Et=[];for(const At of vt){const Yt=At.x,Ht=At.y,xn=Se[0]*Yt+Se[4]*Ht+Se[12],ti=Se[1]*Yt+Se[5]*Ht+Se[13],si=Se[2]*Yt+Se[6]*Ht+Se[14],qi=Se[3]*Yt+Se[7]*Ht+Se[15],No=si+at,pr=qi+st,Fi=xn+Lt,er=ti+Nt,mr=si+Ct,Sr=qi+wt,io=new Mt((xn+Oe)/pr,(ti+We)/pr);io.z=No/pr,kt.push(io);const Ni=new Mt(Fi/Sr,er/Sr);Ni.z=mr/Sr,Et.push(Ni)}Ue.push(kt),Qe.push(Et)}return[Ue,Qe]}(g,Z,j,R);return function(fe,he,Pe){let Se=1/0;ov(Pe,he)&&(Se=Tv(Pe,he[0]));for(let Ue=0;Ue<he.length;Ue++){const Qe=he[Ue],Oe=fe[Ue];for(let We=0;We<Qe.length-1;We++){const at=Qe[We],st=[at,Qe[We+1],Oe[We+1],Oe[We],at];rv(Pe,st)&&(Se=Math.min(Se,Tv(Pe,st)))}}return Se!==1/0&&Se}(re[0],re[1],Y)}},line:class extends no{constructor(l){super(l,Mv),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){l==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ei,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,o){super.recalculate(l,o),this.paint._values["line-floorwidth"]=Iv.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new Jm(l)}queryRadius(l){const o=l,u=Cv(Ch("line-width",this,o),Ch("line-gap-width",this,o)),g=Ch("line-offset",this,o);return u/2+Math.abs(g)+IA(this.paint.get("line-translate"))}queryIntersectsFeature(l,o,u,g,b,S,C){const R=CA(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),S.angle,C),F=C/2*Cv(this.paint.get("line-width").evaluate(o,u),this.paint.get("line-gap-width").evaluate(o,u)),j=this.paint.get("line-offset").evaluate(o,u);return j&&(g=function(Z,Y){const re=[];for(let fe=0;fe<Z.length;fe++){const he=Z[fe],Pe=[];for(let Se=0;Se<he.length;Se++){const Ue=he[Se-1],Qe=he[Se],Oe=he[Se+1],We=Se===0?new Mt(0,0):Qe.sub(Ue)._unit()._perp(),at=Se===he.length-1?new Mt(0,0):Oe.sub(Qe)._unit()._perp(),st=We._add(at)._unit(),Lt=st.x*at.x+st.y*at.y;Lt!==0&&st._mult(1/Lt),Pe.push(st._mult(Y)._add(Qe))}re.push(Pe)}return re}(g,j*C)),function(Z,Y,re){for(let fe=0;fe<Y.length;fe++){const he=Y[fe];if(Z.length>=3){for(let Pe=0;Pe<he.length;Pe++)if(tf(Z,he[Pe]))return!0}if(I5(Z,he,re))return!0}return!1}(R,g,F)}isTileClipped(){return!0}},symbol:$A,background:class extends no{constructor(l){super(l,KT)}},raster:class extends no{constructor(l){super(l,JT)}}};class nS{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const ix=63710088e-1;class Ei{constructor(o,u){if(isNaN(o)||isNaN(u))throw new Error(`Invalid LngLat object: (${o}, ${u})`);if(this.lng=+o,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ei(K(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const u=Math.PI/180,g=this.lat*u,b=o.lat*u,S=Math.sin(g)*Math.sin(b)+Math.cos(g)*Math.cos(b)*Math.cos((o.lng-this.lng)*u);return ix*Math.acos(Math.min(S,1))}toBounds(o=0){const u=360*o/40075017,g=u/Math.cos(Math.PI/180*this.lat);return new qc(new Ei(this.lng-g,this.lat-u),new Ei(this.lng+g,this.lat+u))}static convert(o){if(o instanceof Ei)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new Ei(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new Ei(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class qc{constructor(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof Ei?new Ei(o.lng,o.lat):Ei.convert(o),this}setSouthWest(o){return this._sw=o instanceof Ei?new Ei(o.lng,o.lat):Ei.convert(o),this}extend(o){const u=this._sw,g=this._ne;let b,S;if(o instanceof Ei)b=o,S=o;else{if(!(o instanceof qc))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(qc.convert(o)):this.extend(Ei.convert(o)):this;if(b=o._sw,S=o._ne,!b||!S)return this}return u||g?(u.lng=Math.min(b.lng,u.lng),u.lat=Math.min(b.lat,u.lat),g.lng=Math.max(S.lng,g.lng),g.lat=Math.max(S.lat,g.lat)):(this._sw=new Ei(b.lng,b.lat),this._ne=new Ei(S.lng,S.lat)),this}getCenter(){return new Ei((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ei(this.getWest(),this.getNorth())}getSouthEast(){return new Ei(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:u,lat:g}=Ei.convert(o);let b=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(b=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&b}static convert(o){return o instanceof qc?o:o&&new qc(o)}}const rx=2*Math.PI*ix;function ox(l){return rx*Math.cos(l*Math.PI/180)}function sx(l){return(180+l)/360}function ax(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function lx(l,o){return l/ox(o)}function hg(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}class WA{constructor(o,u,g=0){this.x=+o,this.y=+u,this.z=+g}static fromLngLat(o,u=0){const g=Ei.convert(o);return new WA(sx(g.lng),ax(g.lat),lx(u,g.lat))}toLngLat(){return new Ei(360*this.x-180,hg(this.y))}toAltitude(){return this.z*ox(hg(this.y))}meterInMercatorCoordinateUnits(){return 1/rx*(o=hg(this.y),1/Math.cos(o*Math.PI/180));var o}}function cx(l,o,u){var g=2*Math.PI*6378137/256/Math.pow(2,u);return[l*g-2*Math.PI*6378137/2,o*g-2*Math.PI*6378137/2]}class dg{constructor(o,u,g){if(o<0||o>25||g<0||g>=Math.pow(2,o)||u<0||u>=Math.pow(2,o))throw new Error(`x=${u}, y=${g}, z=${o} outside of bounds. 0<=x<${Math.pow(2,o)}, 0<=y<${Math.pow(2,o)} 0<=z<=25 `);this.z=o,this.x=u,this.y=g,this.key=Uh(0,o,o,u,g)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,u,g){const b=(C=this.y,R=this.z,F=cx(256*(S=this.x),256*(C=Math.pow(2,R)-C-1),R),j=cx(256*(S+1),256*(C+1),R),F[0]+","+F[1]+","+j[0]+","+j[1]);var S,C,R,F,j;const Z=function(Y,re,fe){let he,Pe="";for(let Se=Y;Se>0;Se--)he=1<<Se-1,Pe+=(re&he?1:0)+(fe&he?2:0);return Pe}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(g==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,Z).replace(/{bbox-epsg-3857}/g,b)}isChildOf(o){const u=this.z-o.z;return u>0&&o.x===this.x>>u&&o.y===this.y>>u}getTilePoint(o){const u=Math.pow(2,this.z);return new Mt((o.x*u-this.x)*Zi,(o.y*u-this.y)*Zi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ux{constructor(o,u){this.wrap=o,this.canonical=u,this.key=Uh(o,u.z,u.z,u.x,u.y)}}class Fo{constructor(o,u,g,b,S){if(o<g)throw new Error(`overscaledZ should be >= z; overscaledZ = ${o}; z = ${g}`);this.overscaledZ=o,this.wrap=u,this.canonical=new dg(g,+b,+S),this.key=Uh(u,o,g,b,S)}clone(){return new Fo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-o;return o>this.canonical.z?new Fo(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Fo(o,this.wrap,o,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(o,u){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-o;return o>this.canonical.z?Uh(this.wrap*+u,o,this.canonical.z,this.canonical.x,this.canonical.y):Uh(this.wrap*+u,o,o,this.canonical.x>>g,this.canonical.y>>g)}isChildOf(o){if(o.wrap!==this.wrap)return!1;const u=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>u&&o.canonical.y===this.canonical.y>>u}children(o){if(this.overscaledZ>=o)return[new Fo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,g=2*this.canonical.x,b=2*this.canonical.y;return[new Fo(u,this.wrap,u,g,b),new Fo(u,this.wrap,u,g+1,b),new Fo(u,this.wrap,u,g,b+1),new Fo(u,this.wrap,u,g+1,b+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new Fo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new Fo(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ux(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(o){return this.canonical.getTilePoint(new WA(o.x-this.wrap,o.y))}}function Uh(l,o,u,g,b){(l*=2)<0&&(l=-1*l-1);const S=1<<u;return(S*S*l+S*b+g).toString(36)+u.toString(36)+o.toString(36)}Pt("CanonicalTileID",dg),Pt("OverscaledTileID",Fo,{omit:["posMatrix"]});class fx{constructor(o,u,g){if(this.uid=o,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(g&&g!=="mapbox"&&g!=="terrarium")return void Le(`"${g}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const b=this.dim=u.height-2;this.data=new Uint32Array(u.data.buffer),this.encoding=g||"mapbox";for(let S=0;S<b;S++)this.data[this._idx(-1,S)]=this.data[this._idx(0,S)],this.data[this._idx(b,S)]=this.data[this._idx(b-1,S)],this.data[this._idx(S,-1)]=this.data[this._idx(S,0)],this.data[this._idx(S,b)]=this.data[this._idx(S,b-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(b,-1)]=this.data[this._idx(b-1,0)],this.data[this._idx(-1,b)]=this.data[this._idx(0,b-1)],this.data[this._idx(b,b)]=this.data[this._idx(b-1,b-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let S=0;S<b;S++)for(let C=0;C<b;C++){const R=this.get(S,C);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(o,u){const g=new Uint8Array(this.data.buffer),b=4*this._idx(o,u);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(g[b],g[b+1],g[b+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(o,u){if(o<-1||o>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(o+1)}_unpackMapbox(o,u,g){return(256*o*256+256*u+g)/10-1e4}_unpackTerrarium(o,u,g){return 256*o+u+g/256-32768}getPixels(){return new Oo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(o,u,g){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let b=u*this.dim,S=u*this.dim+this.dim,C=g*this.dim,R=g*this.dim+this.dim;switch(u){case-1:b=S-1;break;case 1:S=b+1}switch(g){case-1:C=R-1;break;case 1:R=C+1}const F=-u*this.dim,j=-g*this.dim;for(let Z=C;Z<R;Z++)for(let Y=b;Y<S;Y++)this.data[this._idx(Y,Z)]=o.data[this._idx(Y+F,Z+j)]}}Pt("DEMData",fx);class hx{constructor(o){this._stringToNumber={},this._numberToString=[];for(let u=0;u<o.length;u++){const g=o[u];this._stringToNumber[g]=u,this._numberToString[u]=g}}encode(o){return this._stringToNumber[o]}decode(o){if(o>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${o} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[o]}}class dx{constructor(o,u,g,b,S){this.type="Feature",this._vectorTileFeature=o,o._z=u,o._x=g,o._y=b,this.properties=o.properties,this.id=S}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(o[u]=this[u]);return o}}class Ax{constructor(o,u){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new fa(Zi,16,0),this.grid3D=new fa(Zi,16,0),this.featureIndexArray=new I,this.promoteId=u}insert(o,u,g,b,S,C){const R=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,b,S);const F=C?this.grid3D:this.grid;for(let j=0;j<u.length;j++){const Z=u[j],Y=[1/0,1/0,-1/0,-1/0];for(let re=0;re<Z.length;re++){const fe=Z[re];Y[0]=Math.min(Y[0],fe.x),Y[1]=Math.min(Y[1],fe.y),Y[2]=Math.max(Y[2],fe.x),Y[3]=Math.max(Y[3],fe.y)}Y[0]<Zi&&Y[1]<Zi&&Y[2]>=0&&Y[3]>=0&&F.insert(R,Y[0],Y[1],Y[2],Y[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Vl.VectorTile(new eg(this.rawTileData)).layers,this.sourceLayerCoder=new hx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(o,u,g,b){this.loadVTLayers();const S=o.params||{},C=Zi/o.tileSize/o.scale,R=_o(S.filter),F=o.queryGeometry,j=o.queryPadding*C,Z=mx(F),Y=this.grid.query(Z.minX-j,Z.minY-j,Z.maxX+j,Z.maxY+j),re=mx(o.cameraQueryGeometry),fe=this.grid3D.query(re.minX-j,re.minY-j,re.maxX+j,re.maxY+j,(Se,Ue,Qe,Oe)=>function(We,at,st,Lt,Nt){for(const wt of We)if(at<=wt.x&&st<=wt.y&&Lt>=wt.x&&Nt>=wt.y)return!0;const Ct=[new Mt(at,st),new Mt(at,Nt),new Mt(Lt,Nt),new Mt(Lt,st)];if(We.length>2){for(const wt of Ct)if(tf(We,wt))return!0}for(let wt=0;wt<We.length-1;wt++)if(k5(We[wt],We[wt+1],Ct))return!0;return!1}(o.cameraQueryGeometry,Se-j,Ue-j,Qe+j,Oe+j));for(const Se of fe)Y.push(Se);Y.sort(iS);const he={};let Pe;for(let Se=0;Se<Y.length;Se++){const Ue=Y[Se];if(Ue===Pe)continue;Pe=Ue;const Qe=this.featureIndexArray.get(Ue);let Oe=null;this.loadMatchingFeature(he,Qe.bucketIndex,Qe.sourceLayerIndex,Qe.featureIndex,R,S.layers,S.availableImages,u,g,b,(We,at,st)=>(Oe||(Oe=$c(We)),at.queryIntersectsFeature(F,We,st,Oe,this.z,o.transform,C,o.pixelPosMatrix)))}return he}loadMatchingFeature(o,u,g,b,S,C,R,F,j,Z,Y){const re=this.bucketLayerIDs[u];if(C&&!function(Se,Ue){for(let Qe=0;Qe<Se.length;Qe++)if(Ue.indexOf(Se[Qe])>=0)return!0;return!1}(C,re))return;const fe=this.sourceLayerCoder.decode(g),he=this.vtLayers[fe].feature(b);if(S.needGeometry){const Se=Wc(he,!0);if(!S.filter(new Kn(this.tileID.overscaledZ),Se,this.tileID.canonical))return}else if(!S.filter(new Kn(this.tileID.overscaledZ),he))return;const Pe=this.getId(he,fe);for(let Se=0;Se<re.length;Se++){const Ue=re[Se];if(C&&C.indexOf(Ue)<0)continue;const Qe=F[Ue];if(!Qe)continue;let Oe={};Pe&&Z&&(Oe=Z.getState(Qe.sourceLayer||"_geojsonTileLayer",Pe));const We=ee({},j[Ue]);We.paint=px(We.paint,Qe.paint,he,Oe,R),We.layout=px(We.layout,Qe.layout,he,Oe,R);const at=!Y||Y(he,Qe,Oe);if(!at)continue;const st=new dx(he,this.z,this.x,this.y,Pe);st.layer=We;let Lt=o[Ue];Lt===void 0&&(Lt=o[Ue]=[]),Lt.push({featureIndex:b,feature:st,intersectionZ:at})}}lookupSymbolFeatures(o,u,g,b,S,C,R,F){const j={};this.loadVTLayers();const Z=_o(S);for(const Y of o)this.loadMatchingFeature(j,g,b,Y,Z,C,R,F,u);return j}hasLayer(o){for(const u of this.bucketLayerIDs)for(const g of u)if(o===g)return!0;return!1}getId(o,u){let g=o.id;return this.promoteId&&(g=o.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof g=="boolean"&&(g=Number(g))),g}}function px(l,o,u,g,b){return se(l,(S,C)=>{const R=o instanceof Ja?o.get(C):null;return R&&R.evaluate?R.evaluate(u,g,b):R})}function mx(l){let o=1/0,u=1/0,g=-1/0,b=-1/0;for(const S of l)o=Math.min(o,S.x),u=Math.min(u,S.y),g=Math.max(g,S.x),b=Math.max(b,S.y);return{minX:o,minY:u,maxX:g,maxY:b}}function iS(l,o){return o-l}var Ag;Pt("FeatureIndex",Ax,{omit:["rawTileData","sourceLayerCoder"]}),a.PerformanceMarkers=void 0,(Ag=a.PerformanceMarkers||(a.PerformanceMarkers={})).create="create",Ag.load="load",Ag.fullLoad="fullLoad";let ZA=null,Vh=[];const pg=1e3/30,rS={mark(l){performance.mark(l)},frame(l){const o=l;ZA!=null&&Vh.push(o-ZA),ZA=o},clearMetrics(){ZA=null,Vh=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const l in a.PerformanceMarkers)performance.clearMarks(a.PerformanceMarkers[l])},getPerformanceMetrics(){performance.measure("loadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.load),performance.measure("fullLoadTime",a.PerformanceMarkers.create,a.PerformanceMarkers.fullLoad);const l=performance.getEntriesByName("loadTime")[0].duration,o=performance.getEntriesByName("fullLoadTime")[0].duration,u=Vh.length,g=1/(Vh.reduce((S,C)=>S+C,0)/u/1e3),b=Vh.filter(S=>S>pg).reduce((S,C)=>S+(C-pg)/pg,0);return{loadTime:l,fullLoadTime:o,fps:g,percentDroppedFrames:b/(u+b)*100}}};a.AJAXError=Si,a.ARRAY_TYPE=Ur,a.Actor=class{constructor(l,o,u){this.target=l,this.parent=o,this.mapId=u,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Ce(["receive","process"],this),this.invoker=new nS(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=it()?l:window}send(l,o,u,g,b=!1){const S=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(this.callbacks[S]=u);const C=Rt(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:l,hasCallback:!!u,targetMapId:g,mustQueue:b,sourceMapId:this.mapId,data:Ds(o,C)},C),{cancel:()=>{u&&delete this.callbacks[S],this.target.postMessage({id:S,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(l){const o=l.data,u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){delete this.tasks[u];const g=this.cancelCallbacks[u];delete this.cancelCallbacks[u],g&&g()}else it()||o.mustQueue?(this.tasks[u]=o,this.taskQueue.push(u),this.invoker.trigger()):this.processTask(u,o)}process(){if(!this.taskQueue.length)return;const l=this.taskQueue.shift(),o=this.tasks[l];delete this.tasks[l],this.taskQueue.length&&this.invoker.trigger(),o&&this.processTask(l,o)}processTask(l,o){if(o.type==="<response>"){const u=this.callbacks[l];delete this.callbacks[l],u&&(o.error?u(cs(o.error)):u(null,cs(o.data)))}else{let u=!1;const g=Rt(this.globalScope)?void 0:[],b=o.hasCallback?(R,F)=>{u=!0,delete this.cancelCallbacks[l],this.target.postMessage({id:l,type:"<response>",sourceMapId:this.mapId,error:R?Ds(R):null,data:Ds(F,g)},g)}:R=>{u=!0};let S=null;const C=cs(o.data);if(this.parent[o.type])S=this.parent[o.type](o.sourceMapId,C,b);else if(this.parent.getWorkerSource){const R=o.type.split(".");S=this.parent.getWorkerSource(o.sourceMapId,R[0],C.source)[R[1]](C,b)}else b(new Error(`Could not find function ${o.type}`));!u&&S&&S.cancel&&(this.cancelCallbacks[l]=S.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.AlphaImage=Ph,a.CanonicalTileID=dg,a.CollisionBoxArray=tt,a.CollisionCircleLayoutArray=class extends Q{},a.Color=f,a.DEMData=fx,a.DataConstantProperty=Ut,a.DictionaryCoder=hx,a.EXTENT=Zi,a.ErrorEvent=is,a.EvaluationParameters=Kn,a.Event=wr,a.Evented=Br,a.FeatureIndex=Ax,a.FillBucket=Xm,a.FillExtrusionBucket=Km,a.GeoJSONFeature=dx,a.ImageAtlas=Fv,a.ImagePosition=ng,a.LineBucket=Jm,a.LineStripIndexArray=class extends Ee{},a.LngLat=Ei,a.LngLatBounds=qc,a.MercatorCoordinate=WA,a.ONE_EM=ar,a.OverscaledTileID=Fo,a.PerformanceUtils=rS,a.PosArray=P,a.Properties=Wi,a.QuadTriangleArray=class extends ce{},a.RGBAImage=Oo,a.RasterBoundsArray=class extends x{},a.RequestPerformance=class{constructor(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let l=performance.getEntriesByName(this._marks.measure);return l.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),l=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),l}},a.ResourceType=pi,a.SegmentVector=ot,a.SymbolBucket=cf,a.Transitionable=Xu,a.TriangleIndexArray=$e,a.Uniform1f=el,a.Uniform1i=class extends fs{constructor(l,o){super(l,o),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},a.Uniform2f=class extends fs{constructor(l,o){super(l,o),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},a.Uniform3f=class extends fs{constructor(l,o){super(l,o),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},a.Uniform4f=Ju,a.UniformColor=ev,a.UniformMatrix4f=class extends fs{constructor(l,o){super(l,o),this.current=T5}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let o=1;o<16;o++)if(l[o]!==this.current[o]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},a.UnwrappedTileID=ux,a.ValidationError=gt,a.ZoomHistory=Rc,a.add=function(l,o,u){return l[0]=o[0]+u[0],l[1]=o[1]+u[1],l[2]=o[2]+u[2],l},a.addDynamicAttributes=ag,a.asyncAll=function(l,o,u){if(!l.length)return u(null,[]);let g=l.length;const b=new Array(l.length);let S=null;l.forEach((C,R)=>{o(C,(F,j)=>{F&&(S=F),b[R]=j,--g==0&&u(S,b)})})},a.bezier=z,a.bindAll=Ce,a.cacheEntryPossiblyAdded=function(l){Ri++,Ri>ri&&(l.getActor().send("enforceCacheSizeLimit",Mn),Ri=0)},a.clamp=D,a.clearTileCache=function(l){const o=caches.delete(It);l&&o.catch(l).then(()=>l())},a.clipLine=Xv,a.clone=function(l){var o=new Ur(16);return o[0]=l[0],o[1]=l[1],o[2]=l[2],o[3]=l[3],o[4]=l[4],o[5]=l[5],o[6]=l[6],o[7]=l[7],o[8]=l[8],o[9]=l[9],o[10]=l[10],o[11]=l[11],o[12]=l[12],o[13]=l[13],o[14]=l[14],o[15]=l[15],o},a.clone$1=te,a.clone$2=function(l){var o=new Ur(3);return o[0]=l[0],o[1]=l[1],o[2]=l[2],o},a.collisionCircleLayout=wT,a.config=pt,a.copy=function(l,o){return l[0]=o[0],l[1]=o[1],l[2]=o[2],l[3]=o[3],l[4]=o[4],l[5]=o[5],l[6]=o[6],l[7]=o[7],l[8]=o[8],l[9]=o[9],l[10]=o[10],l[11]=o[11],l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15],l},a.create=function(){var l=new Ur(16);return Ur!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},a.create$1=lv,a.createExpression=oa,a.createFilter=_o,a.createLayout=bi,a.createStyleLayer=function(l){return l.type==="custom"?new eS(l):new tS[l.type](l)},a.cross=function(l,o,u){var g=o[0],b=o[1],S=o[2],C=u[0],R=u[1],F=u[2];return l[0]=b*F-S*R,l[1]=S*C-g*F,l[2]=g*R-b*C,l},a.dot=function(l,o){return l[0]*o[0]+l[1]*o[1]+l[2]*o[2]},a.dot$1=function(l,o){return l[0]*o[0]+l[1]*o[1]+l[2]*o[2]+l[3]*o[3]},a.ease=B,a.emitValidationErrors=ua,a.enforceCacheSizeLimit=function(l){oi(),Jt&&Jt.then(o=>{o.keys().then(u=>{for(let g=0;g<u.length-l;g++)o.delete(u[g])})})},a.equals=function(l,o){var u=l[0],g=l[1],b=l[2],S=l[3],C=l[4],R=l[5],F=l[6],j=l[7],Z=l[8],Y=l[9],re=l[10],fe=l[11],he=l[12],Pe=l[13],Se=l[14],Ue=l[15],Qe=o[0],Oe=o[1],We=o[2],at=o[3],st=o[4],Lt=o[5],Nt=o[6],Ct=o[7],wt=o[8],vt=o[9],kt=o[10],Et=o[11],At=o[12],Yt=o[13],Ht=o[14],xn=o[15];return Math.abs(u-Qe)<=Nr*Math.max(1,Math.abs(u),Math.abs(Qe))&&Math.abs(g-Oe)<=Nr*Math.max(1,Math.abs(g),Math.abs(Oe))&&Math.abs(b-We)<=Nr*Math.max(1,Math.abs(b),Math.abs(We))&&Math.abs(S-at)<=Nr*Math.max(1,Math.abs(S),Math.abs(at))&&Math.abs(C-st)<=Nr*Math.max(1,Math.abs(C),Math.abs(st))&&Math.abs(R-Lt)<=Nr*Math.max(1,Math.abs(R),Math.abs(Lt))&&Math.abs(F-Nt)<=Nr*Math.max(1,Math.abs(F),Math.abs(Nt))&&Math.abs(j-Ct)<=Nr*Math.max(1,Math.abs(j),Math.abs(Ct))&&Math.abs(Z-wt)<=Nr*Math.max(1,Math.abs(Z),Math.abs(wt))&&Math.abs(Y-vt)<=Nr*Math.max(1,Math.abs(Y),Math.abs(vt))&&Math.abs(re-kt)<=Nr*Math.max(1,Math.abs(re),Math.abs(kt))&&Math.abs(fe-Et)<=Nr*Math.max(1,Math.abs(fe),Math.abs(Et))&&Math.abs(he-At)<=Nr*Math.max(1,Math.abs(he),Math.abs(At))&&Math.abs(Pe-Yt)<=Nr*Math.max(1,Math.abs(Pe),Math.abs(Yt))&&Math.abs(Se-Ht)<=Nr*Math.max(1,Math.abs(Se),Math.abs(Ht))&&Math.abs(Ue-xn)<=Nr*Math.max(1,Math.abs(Ue),Math.abs(xn))},a.evaluateSizeForFeature=function(l,{uSize:o,uSizeT:u},{lowerSize:g,upperSize:b}){return l.kind==="source"?g/il:l.kind==="composite"?pn(g/il,b/il,u):o},a.evaluateSizeForZoom=function(l,o){let u=0,g=0;if(l.kind==="constant")g=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:b,minZoom:S,maxZoom:C}=l,R=b?D(Zn.interpolationFactor(b,o,S,C),0,1):0;l.kind==="camera"?g=pn(l.minSize,l.maxSize,R):u=R}return{uSizeT:u,uSize:g}},a.evaluateVariableOffset=Jv,a.evented=Nc,a.exported=_n,a.exported$1=Ai,a.extend=ee,a.filterObject=ne,a.fromRotation=function(l,o){var u=Math.sin(o),g=Math.cos(o);return l[0]=g,l[1]=u,l[2]=0,l[3]=-u,l[4]=g,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},a.fromScaling=function(l,o){return l[0]=o[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=o[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=o[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},a.getAnchorAlignment=rg,a.getAnchorJustification=sg,a.getArrayBuffer=xi,a.getImage=zr,a.getJSON=function(l,o){return Gi(ee(l,{type:"json"}),o)},a.getOverlapMode=fg,a.getRTLTextPluginStatus=Ya,a.getReferrer=Qr,a.getVideo=function(l,o){const u=window.document.createElement("video");u.muted=!0,u.onloadstart=function(){o(null,u)};for(let g=0;g<l.length;g++){const b=window.document.createElement("source");Dr(l[g])||(u.crossOrigin="Anonymous"),b.src=l[g],u.appendChild(b)}return{cancel:()=>{}}},a.identity=Vm,a.invert=function(l,o){var u=o[0],g=o[1],b=o[2],S=o[3],C=o[4],R=o[5],F=o[6],j=o[7],Z=o[8],Y=o[9],re=o[10],fe=o[11],he=o[12],Pe=o[13],Se=o[14],Ue=o[15],Qe=u*R-g*C,Oe=u*F-b*C,We=u*j-S*C,at=g*F-b*R,st=g*j-S*R,Lt=b*j-S*F,Nt=Z*Pe-Y*he,Ct=Z*Se-re*he,wt=Z*Ue-fe*he,vt=Y*Se-re*Pe,kt=Y*Ue-fe*Pe,Et=re*Ue-fe*Se,At=Qe*Et-Oe*kt+We*vt+at*wt-st*Ct+Lt*Nt;return At?(l[0]=(R*Et-F*kt+j*vt)*(At=1/At),l[1]=(b*kt-g*Et-S*vt)*At,l[2]=(Pe*Lt-Se*st+Ue*at)*At,l[3]=(re*st-Y*Lt-fe*at)*At,l[4]=(F*wt-C*Et-j*Ct)*At,l[5]=(u*Et-b*wt+S*Ct)*At,l[6]=(Se*We-he*Lt-Ue*Oe)*At,l[7]=(Z*Lt-re*We+fe*Oe)*At,l[8]=(C*kt-R*wt+j*Nt)*At,l[9]=(g*wt-u*kt-S*Nt)*At,l[10]=(he*st-Pe*We+Ue*Qe)*At,l[11]=(Y*We-Z*st-fe*Qe)*At,l[12]=(R*Ct-C*vt-F*Nt)*At,l[13]=(u*vt-g*Ct+b*Nt)*At,l[14]=(Pe*Oe-he*at-Se*Qe)*At,l[15]=(Z*at-Y*Oe+re*Qe)*At,l):null},a.isImageBitmap=jt,a.isSafari=Rt,a.isWorker=it,a.keysDifference=function(l,o){const u=[];for(const g in l)g in o||u.push(g);return u},a.lazyLoadRTLTextPlugin=function(){Fr.isLoading()||Fr.isLoaded()||Ya()!=="deferred"||Qu()},a.makeRequest=Gi,a.mapObject=se,a.mercatorXfromLng=sx,a.mercatorYfromLat=ax,a.mercatorZfromAltitude=lx,a.mul=R5,a.mul$1=function(l,o,u){return l[0]=o[0]*u[0],l[1]=o[1]*u[1],l[2]=o[2]*u[2],l[3]=o[3]*u[3],l},a.multiply=cv,a.nextPowerOfTwo=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},a.normalize=function(l,o){var u=o[0],g=o[1],b=o[2],S=u*u+g*g+b*b;return S>0&&(S=1/Math.sqrt(S)),l[0]=o[0]*S,l[1]=o[1]*S,l[2]=o[2]*S,l},a.number=pn,a.ortho=function(l,o,u,g,b,S,C){var R=1/(o-u),F=1/(g-b),j=1/(S-C);return l[0]=-2*R,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*F,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*j,l[11]=0,l[12]=(o+u)*R,l[13]=(b+g)*F,l[14]=(C+S)*j,l[15]=1,l},a.parseCacheControl=dt,a.parseGlyphPbf=function(l){return new eg(l).readFields(RT,[])},a.pbf=eg,a.performSymbolLayout=function(l){l.bucket.createArrays(),l.bucket.tilePixelRatio=Zi/(512*l.bucket.overscaling),l.bucket.compareText={},l.bucket.iconsNeedLinear=!1;const o=l.bucket.layers[0].layout,u=l.bucket.layers[0]._unevaluatedLayout._values,g={layoutIconSize:u["icon-size"].possiblyEvaluate(new Kn(l.bucket.zoom+1),l.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Kn(l.bucket.zoom+1),l.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Kn(18))};if(l.bucket.textSizeData.kind==="composite"){const{minZoom:F,maxZoom:j}=l.bucket.textSizeData;g.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Kn(F),l.canonical),u["text-size"].possiblyEvaluate(new Kn(j),l.canonical)]}if(l.bucket.iconSizeData.kind==="composite"){const{minZoom:F,maxZoom:j}=l.bucket.iconSizeData;g.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Kn(F),l.canonical),u["icon-size"].possiblyEvaluate(new Kn(j),l.canonical)]}const b=o.get("text-line-height")*ar,S=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",C=o.get("text-keep-upright"),R=o.get("text-size");for(const F of l.bucket.features){const j=o.get("text-font").evaluate(F,{},l.canonical).join(","),Z=R.evaluate(F,{},l.canonical),Y=g.layoutTextSize.evaluate(F,{},l.canonical),re=g.layoutIconSize.evaluate(F,{},l.canonical),fe={horizontal:{},vertical:void 0},he=F.text;let Pe,Se=[0,0];if(he){const Oe=he.toString(),We=o.get("text-letter-spacing").evaluate(F,{},l.canonical)*ar,at=Wu(Oe)?We:0,st=o.get("text-anchor").evaluate(F,{},l.canonical),Lt=o.get("text-variable-anchor");if(!Lt){const kt=o.get("text-radial-offset").evaluate(F,{},l.canonical);Se=kt?Jv(st,[kt*ar,og]):o.get("text-offset").evaluate(F,{},l.canonical).map(Et=>Et*ar)}let Nt=S?"center":o.get("text-justify").evaluate(F,{},l.canonical);const Ct=o.get("symbol-placement"),wt=Ct==="point"?o.get("text-max-width").evaluate(F,{},l.canonical)*ar:0,vt=()=>{l.bucket.allowVerticalPlacement&&Ol(Oe)&&(fe.vertical=FA(he,l.glyphMap,l.glyphPositions,l.imagePositions,j,wt,b,st,"left",at,Se,a.WritingMode.vertical,!0,Ct,Y,Z))};if(!S&&Lt){const kt=Nt==="auto"?Lt.map(At=>sg(At)):[Nt];let Et=!1;for(let At=0;At<kt.length;At++){const Yt=kt[At];if(!fe.horizontal[Yt])if(Et)fe.horizontal[Yt]=fe.horizontal[0];else{const Ht=FA(he,l.glyphMap,l.glyphPositions,l.imagePositions,j,wt,b,"center",Yt,at,Se,a.WritingMode.horizontal,!1,Ct,Y,Z);Ht&&(fe.horizontal[Yt]=Ht,Et=Ht.positionedLines.length===1)}}vt()}else{Nt==="auto"&&(Nt=sg(st));const kt=FA(he,l.glyphMap,l.glyphPositions,l.imagePositions,j,wt,b,st,Nt,at,Se,a.WritingMode.horizontal,!1,Ct,Y,Z);kt&&(fe.horizontal[Nt]=kt),vt(),Ol(Oe)&&S&&C&&(fe.vertical=FA(he,l.glyphMap,l.glyphPositions,l.imagePositions,j,wt,b,st,Nt,at,Se,a.WritingMode.vertical,!1,Ct,Y,Z))}}let Ue=!1;if(F.icon&&F.icon.name){const Oe=l.imageMap[F.icon.name];Oe&&(Pe=NT(l.imagePositions[F.icon.name],o.get("icon-offset").evaluate(F,{},l.canonical),o.get("icon-anchor").evaluate(F,{},l.canonical)),Ue=!!Oe.sdf,l.bucket.sdfIcons===void 0?l.bucket.sdfIcons=Ue:l.bucket.sdfIcons!==Ue&&Le("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Oe.pixelRatio!==l.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(l.bucket.iconsNeedLinear=!0))}const Qe=tx(fe.horizontal)||fe.vertical;l.bucket.iconsInText=!!Qe&&Qe.iconsInText,(Qe||Pe)&&WT(l.bucket,F,fe,Pe,l.imageMap,g,Y,re,Se,Ue,l.canonical)}l.showCollisionBoxes&&l.bucket.generateCollisionDebugBuffers()},a.perspective=function(l,o,u,g,b){var S,C=1/Math.tan(o/2);return l[0]=C/u,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=C,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,b!=null&&b!==1/0?(l[10]=(b+g)*(S=1/(g-b)),l[14]=2*b*g*S):(l[10]=-1,l[14]=-2*g),l},a.pick=function(l,o){const u={};for(let g=0;g<o.length;g++){const b=o[g];b in l&&(u[b]=l[b])}return u},a.plugin=Fr,a.pointGeometry=Mt,a.polygonIntersectsPolygon=rv,a.potpack=Ov,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.register=Pt,a.registerForPluginStateChange=function(l){return l({pluginStatus:sr,pluginURL:Do}),Nc.on("pluginStateChange",l),l},a.renderColorRamp=mv,a.rotateX=function(l,o,u){var g=Math.sin(u),b=Math.cos(u),S=o[4],C=o[5],R=o[6],F=o[7],j=o[8],Z=o[9],Y=o[10],re=o[11];return o!==l&&(l[0]=o[0],l[1]=o[1],l[2]=o[2],l[3]=o[3],l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15]),l[4]=S*b+j*g,l[5]=C*b+Z*g,l[6]=R*b+Y*g,l[7]=F*b+re*g,l[8]=j*b-S*g,l[9]=Z*b-C*g,l[10]=Y*b-R*g,l[11]=re*b-F*g,l},a.rotateZ=function(l,o,u){var g=Math.sin(u),b=Math.cos(u),S=o[0],C=o[1],R=o[2],F=o[3],j=o[4],Z=o[5],Y=o[6],re=o[7];return o!==l&&(l[8]=o[8],l[9]=o[9],l[10]=o[10],l[11]=o[11],l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15]),l[0]=S*b+j*g,l[1]=C*b+Z*g,l[2]=R*b+Y*g,l[3]=F*b+re*g,l[4]=j*b-S*g,l[5]=Z*b-C*g,l[6]=Y*b-R*g,l[7]=re*b-F*g,l},a.scale=function(l,o,u){var g=u[0],b=u[1],S=u[2];return l[0]=o[0]*g,l[1]=o[1]*g,l[2]=o[2]*g,l[3]=o[3]*g,l[4]=o[4]*b,l[5]=o[5]*b,l[6]=o[6]*b,l[7]=o[7]*b,l[8]=o[8]*S,l[9]=o[9]*S,l[10]=o[10]*S,l[11]=o[11]*S,l[12]=o[12],l[13]=o[13],l[14]=o[14],l[15]=o[15],l},a.scale$1=function(l,o,u){return l[0]=o[0]*u,l[1]=o[1]*u,l[2]=o[2]*u,l},a.setCacheLimits=function(l,o){Mn=l,ri=o},a.setRTLTextPlugin=function(l,o,u=!1){if(sr===Bc||sr===Oc||sr===Fc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Do=_n.resolveURL(l),sr=Bc,xo=o,ha(),u||Qu()},a.spec=et,a.sphericalToCartesian=function([l,o,u]){return o+=90,o*=Math.PI/180,u*=Math.PI/180,{x:l*Math.cos(o)*Math.sin(u),y:l*Math.sin(o)*Math.sin(u),z:l*Math.cos(u)}},a.sqrLen=function(l){var o=l[0],u=l[1];return o*o+u*u},a.sub=function(l,o,u){return l[0]=o[0]-u[0],l[1]=o[1]-u[1],l[2]=o[2]-u[2],l},a.toEvaluationFeature=Wc,a.transformMat3=function(l,o,u){var g=o[0],b=o[1],S=o[2];return l[0]=g*u[0]+b*u[3]+S*u[6],l[1]=g*u[1]+b*u[4]+S*u[7],l[2]=g*u[2]+b*u[5]+S*u[8],l},a.transformMat4=kA,a.transformMat4$1=function(l,o,u){var g=o[0],b=o[1];return l[0]=u[0]*g+u[4]*b+u[12],l[1]=u[1]*g+u[5]*b+u[13],l},a.translate=function(l,o,u){var g,b,S,C,R,F,j,Z,Y,re,fe,he,Pe=u[0],Se=u[1],Ue=u[2];return o===l?(l[12]=o[0]*Pe+o[4]*Se+o[8]*Ue+o[12],l[13]=o[1]*Pe+o[5]*Se+o[9]*Ue+o[13],l[14]=o[2]*Pe+o[6]*Se+o[10]*Ue+o[14],l[15]=o[3]*Pe+o[7]*Se+o[11]*Ue+o[15]):(b=o[1],S=o[2],C=o[3],R=o[4],F=o[5],j=o[6],Z=o[7],Y=o[8],re=o[9],fe=o[10],he=o[11],l[0]=g=o[0],l[1]=b,l[2]=S,l[3]=C,l[4]=R,l[5]=F,l[6]=j,l[7]=Z,l[8]=Y,l[9]=re,l[10]=fe,l[11]=he,l[12]=g*Pe+R*Se+Y*Ue+o[12],l[13]=b*Pe+F*Se+re*Ue+o[13],l[14]=S*Pe+j*Se+fe*Ue+o[14],l[15]=C*Pe+Z*Se+he*Ue+o[15]),l},a.triggerPluginCompletionEvent=qu,a.unicodeBlockLookup=St,a.uniqueId=function(){return le++},a.validateCustomStyleLayer=function(l){const o=[],u=l.id;return u===void 0&&o.push({message:`layers.${u}: missing required property "id"`}),l.render===void 0&&o.push({message:`layers.${u}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&o.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),o},a.validateLight=Lc,a.validateStyle=Xa,a.vectorTile=Vl,a.warnOnce=Le,a.wrap=K}),c(["./shared"],function(a){function T(q){const U=typeof q;if(U==="number"||U==="boolean"||U==="string"||q==null)return JSON.stringify(q);if(Array.isArray(q)){let f="[";for(const H of q)f+=`${T(H)},`;return`${f}]`}const W=Object.keys(q).sort();let ie="{";for(let f=0;f<W.length;f++)ie+=`${JSON.stringify(W[f])}:${T(q[W[f]])},`;return`${ie}}`}function k(q){let U="";for(const W of a.refProperties)U+=`/${T(q[W])}`;return U}class z{constructor(U){this.keyCache={},U&&this.replace(U)}replace(U){this._layerConfigs={},this._layers={},this.update(U,[])}update(U,W){for(const f of U){this._layerConfigs[f.id]=f;const H=this._layers[f.id]=a.createStyleLayer(f);H._featureFilter=a.createFilter(H.filter),this.keyCache[f.id]&&delete this.keyCache[f.id]}for(const f of W)delete this.keyCache[f],delete this._layerConfigs[f],delete this._layers[f];this.familiesBySource={};const ie=function(f,H){const ke={};for(let we=0;we<f.length;we++){const Me=H&&H[f[we].id]||k(f[we]);H&&(H[f[we].id]=Me);let Fe=ke[Me];Fe||(Fe=ke[Me]=[]),Fe.push(f[we])}const Te=[];for(const we in ke)Te.push(ke[we]);return Te}(Object.values(this._layerConfigs),this.keyCache);for(const f of ie){const H=f.map(rt=>this._layers[rt.id]),ke=H[0];if(ke.visibility==="none")continue;const Te=ke.source||"";let we=this.familiesBySource[Te];we||(we=this.familiesBySource[Te]={});const Me=ke.sourceLayer||"_geojsonTileLayer";let Fe=we[Me];Fe||(Fe=we[Me]=[]),Fe.push(H)}}}class B{constructor(U){const W={},ie=[];for(const Te in U){const we=U[Te],Me=W[Te]={};for(const Fe in we){const rt=we[+Fe];if(!rt||rt.bitmap.width===0||rt.bitmap.height===0)continue;const Ne={x:0,y:0,w:rt.bitmap.width+2,h:rt.bitmap.height+2};ie.push(Ne),Me[Fe]={rect:Ne,metrics:rt.metrics}}}const{w:f,h:H}=a.potpack(ie),ke=new a.AlphaImage({width:f||1,height:H||1});for(const Te in U){const we=U[Te];for(const Me in we){const Fe=we[+Me];if(!Fe||Fe.bitmap.width===0||Fe.bitmap.height===0)continue;const rt=W[Te][Me].rect;a.AlphaImage.copy(Fe.bitmap,ke,{x:0,y:0},{x:rt.x+1,y:rt.y+1},Fe.bitmap)}}this.image=ke,this.positions=W}}a.register("GlyphAtlas",B);class D{constructor(U){this.tileID=new a.OverscaledTileID(U.tileID.overscaledZ,U.tileID.wrap,U.tileID.canonical.z,U.tileID.canonical.x,U.tileID.canonical.y),this.uid=U.uid,this.zoom=U.zoom,this.pixelRatio=U.pixelRatio,this.tileSize=U.tileSize,this.source=U.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=U.showCollisionBoxes,this.collectResourceTiming=!!U.collectResourceTiming,this.returnDependencies=!!U.returnDependencies,this.promoteId=U.promoteId}parse(U,W,ie,f,H){this.status="parsing",this.data=U,this.collisionBoxArray=new a.CollisionBoxArray;const ke=new a.DictionaryCoder(Object.keys(U.layers).sort()),Te=new a.FeatureIndex(this.tileID,this.promoteId);Te.bucketLayerIDs=[];const we={},Me={featureIndex:Te,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ie},Fe=W.familiesBySource[this.source];for(const Gt in Fe){const Wt=U.layers[Gt];if(!Wt)continue;Wt.version===1&&a.warnOnce(`Vector tile source "${this.source}" layer "${Gt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const dn=ke.encode(Gt),wn=[];for(let Ln=0;Ln<Wt.length;Ln++){const Ot=Wt.feature(Ln),me=Te.getId(Ot,Gt);wn.push({feature:Ot,id:me,index:Ln,sourceLayerIndex:dn})}for(const Ln of Fe[Gt]){const Ot=Ln[0];Ot.source!==this.source&&a.warnOnce(`layer.source = ${Ot.source} does not equal this.source = ${this.source}`),Ot.minzoom&&this.zoom<Math.floor(Ot.minzoom)||Ot.maxzoom&&this.zoom>=Ot.maxzoom||Ot.visibility!=="none"&&(K(Ln,this.zoom,ie),(we[Ot.id]=Ot.createBucket({index:Te.bucketLayerIDs.length,layers:Ln,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:dn,sourceID:this.source})).populate(wn,Me,this.tileID.canonical),Te.bucketLayerIDs.push(Ln.map(me=>me.id)))}}let rt,Ne,lt,Tt;const xt=a.mapObject(Me.glyphDependencies,Gt=>Object.keys(Gt).map(Number));Object.keys(xt).length?f.send("getGlyphs",{uid:this.uid,stacks:xt},(Gt,Wt)=>{rt||(rt=Gt,Ne=Wt,en.call(this))}):Ne={};const $t=Object.keys(Me.iconDependencies);$t.length?f.send("getImages",{icons:$t,source:this.source,tileID:this.tileID,type:"icons"},(Gt,Wt)=>{rt||(rt=Gt,lt=Wt,en.call(this))}):lt={};const Ft=Object.keys(Me.patternDependencies);function en(){if(rt)return H(rt);if(Ne&&lt&&Tt){const Gt=new B(Ne),Wt=new a.ImageAtlas(lt,Tt);for(const dn in we){const wn=we[dn];wn instanceof a.SymbolBucket?(K(wn.layers,this.zoom,ie),a.performSymbolLayout({bucket:wn,glyphMap:Ne,glyphPositions:Gt.positions,imageMap:lt,imagePositions:Wt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):wn.hasPattern&&(wn instanceof a.LineBucket||wn instanceof a.FillBucket||wn instanceof a.FillExtrusionBucket)&&(K(wn.layers,this.zoom,ie),wn.addFeatures(Me,this.tileID.canonical,Wt.patternPositions))}this.status="done",H(null,{buckets:Object.values(we).filter(dn=>!dn.isEmpty()),featureIndex:Te,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Gt.image,imageAtlas:Wt,glyphMap:this.returnDependencies?Ne:null,iconMap:this.returnDependencies?lt:null,glyphPositions:this.returnDependencies?Gt.positions:null})}}Ft.length?f.send("getImages",{icons:Ft,source:this.source,tileID:this.tileID,type:"patterns"},(Gt,Wt)=>{rt||(rt=Gt,Tt=Wt,en.call(this))}):Tt={},en.call(this)}}function K(q,U,W){const ie=new a.EvaluationParameters(U);for(const f of q)f.recalculate(ie,W)}function ee(q,U){const W=a.getArrayBuffer(q.request,(ie,f,H,ke)=>{ie?U(ie):f&&U(null,{vectorTile:new a.vectorTile.VectorTile(new a.pbf(f)),rawData:f,cacheControl:H,expires:ke})});return()=>{W.cancel(),U()}}class le{constructor(U,W,ie,f){this.actor=U,this.layerIndex=W,this.availableImages=ie,this.loadVectorData=f||ee,this.loading={},this.loaded={}}loadTile(U,W){const ie=U.uid;this.loading||(this.loading={});const f=!!(U&&U.request&&U.request.collectResourceTiming)&&new a.RequestPerformance(U.request),H=this.loading[ie]=new D(U);H.abort=this.loadVectorData(U,(ke,Te)=>{if(delete this.loading[ie],ke||!Te)return H.status="done",this.loaded[ie]=H,W(ke);const we=Te.rawData,Me={};Te.expires&&(Me.expires=Te.expires),Te.cacheControl&&(Me.cacheControl=Te.cacheControl);const Fe={};if(f){const rt=f.finish();rt&&(Fe.resourceTiming=JSON.parse(JSON.stringify(rt)))}H.vectorTile=Te.vectorTile,H.parse(Te.vectorTile,this.layerIndex,this.availableImages,this.actor,(rt,Ne)=>{if(rt||!Ne)return W(rt);W(null,a.extend({rawTileData:we.slice(0)},Ne,Me,Fe))}),this.loaded=this.loaded||{},this.loaded[ie]=H})}reloadTile(U,W){const ie=this.loaded,f=U.uid,H=this;if(ie&&ie[f]){const ke=ie[f];ke.showCollisionBoxes=U.showCollisionBoxes;const Te=(we,Me)=>{const Fe=ke.reloadCallback;Fe&&(delete ke.reloadCallback,ke.parse(ke.vectorTile,H.layerIndex,this.availableImages,H.actor,Fe)),W(we,Me)};ke.status==="parsing"?ke.reloadCallback=Te:ke.status==="done"&&(ke.vectorTile?ke.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,Te):Te())}}abortTile(U,W){const ie=this.loading,f=U.uid;ie&&ie[f]&&ie[f].abort&&(ie[f].abort(),delete ie[f]),W()}removeTile(U,W){const ie=this.loaded,f=U.uid;ie&&ie[f]&&delete ie[f],W()}}class Ce{constructor(){this.loaded={}}loadTile(U,W){const{uid:ie,encoding:f,rawImageData:H}=U,ke=a.isImageBitmap(H)?this.getImageData(H):H,Te=new a.DEMData(ie,ke,f);this.loaded=this.loaded||{},this.loaded[ie]=Te,W(null,Te)}getImageData(U){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(U.width,U.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=U.width,this.offscreenCanvas.height=U.height,this.offscreenCanvasContext.drawImage(U,0,0,U.width,U.height);const W=this.offscreenCanvasContext.getImageData(-1,-1,U.width+2,U.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:W.width,height:W.height},W.data)}removeTile(U){const W=this.loaded,ie=U.uid;W&&W[ie]&&delete W[ie]}}var se=function q(U,W){var ie,f=U&&U.type;if(f==="FeatureCollection")for(ie=0;ie<U.features.length;ie++)q(U.features[ie],W);else if(f==="GeometryCollection")for(ie=0;ie<U.geometries.length;ie++)q(U.geometries[ie],W);else if(f==="Feature")q(U.geometry,W);else if(f==="Polygon")ne(U.coordinates,W);else if(f==="MultiPolygon")for(ie=0;ie<U.coordinates.length;ie++)ne(U.coordinates[ie],W);return U};function ne(q,U){if(q.length!==0){te(q[0],U);for(var W=1;W<q.length;W++)te(q[W],!U)}}function te(q,U){for(var W=0,ie=0,f=0,H=q.length,ke=H-1;f<H;ke=f++){var Te=(q[f][0]-q[ke][0])*(q[ke][1]+q[f][1]),we=W+Te;ie+=Math.abs(W)>=Math.abs(Te)?W-we+Te:Te-we+W,W=we}W+ie>=0!=!!U&&q.reverse()}const xe=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Le{constructor(U){this._feature=U,this.extent=a.EXTENT,this.type=U.type,this.properties=U.tags,"id"in U&&!isNaN(U.id)&&(this.id=parseInt(U.id,10))}loadGeometry(){if(this._feature.type===1){const U=[];for(const W of this._feature.geometry)U.push([new a.pointGeometry(W[0],W[1])]);return U}{const U=[];for(const W of this._feature.geometry){const ie=[];for(const f of W)ie.push(new a.pointGeometry(f[0],f[1]));U.push(ie)}return U}}toGeoJSON(U,W,ie){return xe.call(this,U,W,ie)}}class Ge{constructor(U){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=U.length,this._features=U}feature(U){return new Le(this._features[U])}}var nt={exports:{}},it=a.pointGeometry,dt=a.vectorTile.VectorTileFeature,ct=Xe;function Xe(q,U){this.options=U||{},this.features=q,this.length=q.length}function Bt(q,U){this.id=typeof q.id=="number"?q.id:void 0,this.type=q.type,this.rawGeometry=q.type===1?[q.geometry]:q.geometry,this.properties=q.tags,this.extent=U||4096}Xe.prototype.feature=function(q){return new Bt(this.features[q],this.options.extent)},Bt.prototype.loadGeometry=function(){var q=this.rawGeometry;this.geometry=[];for(var U=0;U<q.length;U++){for(var W=q[U],ie=[],f=0;f<W.length;f++)ie.push(new it(W[f][0],W[f][1]));this.geometry.push(ie)}return this.geometry},Bt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var q=this.geometry,U=1/0,W=-1/0,ie=1/0,f=-1/0,H=0;H<q.length;H++)for(var ke=q[H],Te=0;Te<ke.length;Te++){var we=ke[Te];U=Math.min(U,we.x),W=Math.max(W,we.x),ie=Math.min(ie,we.y),f=Math.max(f,we.y)}return[U,ie,W,f]},Bt.prototype.toGeoJSON=dt.prototype.toGeoJSON;var Rt=a.pbf,jt=ct;function _n(q){var U=new Rt;return function(W,ie){for(var f in W.layers)ie.writeMessage(3,Mt,W.layers[f])}(q,U),U.finish()}function Mt(q,U){var W;U.writeVarintField(15,q.version||1),U.writeStringField(1,q.name||""),U.writeVarintField(5,q.extent||4096);var ie={keys:[],values:[],keycache:{},valuecache:{}};for(W=0;W<q.length;W++)ie.feature=q.feature(W),U.writeMessage(2,Sn,ie);var f=ie.keys;for(W=0;W<f.length;W++)U.writeStringField(3,f[W]);var H=ie.values;for(W=0;W<H.length;W++)U.writeMessage(4,Mn,H[W])}function Sn(q,U){var W=q.feature;W.id!==void 0&&U.writeVarintField(1,W.id),U.writeMessage(2,pt,q),U.writeVarintField(3,W.type),U.writeMessage(4,kn,W)}function pt(q,U){var W=q.feature,ie=q.keys,f=q.values,H=q.keycache,ke=q.valuecache;for(var Te in W.properties){var we=W.properties[Te],Me=H[Te];if(we!==null){Me===void 0&&(ie.push(Te),H[Te]=Me=ie.length-1),U.writeVarint(Me);var Fe=typeof we;Fe!=="string"&&Fe!=="boolean"&&Fe!=="number"&&(we=JSON.stringify(we));var rt=Fe+":"+we,Ne=ke[rt];Ne===void 0&&(f.push(we),ke[rt]=Ne=f.length-1),U.writeVarint(Ne)}}}function It(q,U){return(U<<3)+(7&q)}function Jt(q){return q<<1^q>>31}function kn(q,U){for(var W=q.loadGeometry(),ie=q.type,f=0,H=0,ke=W.length,Te=0;Te<ke;Te++){var we=W[Te],Me=1;ie===1&&(Me=we.length),U.writeVarint(It(1,Me));for(var Fe=ie===3?we.length-1:we.length,rt=0;rt<Fe;rt++){rt===1&&ie!==1&&U.writeVarint(It(2,Fe-1));var Ne=we[rt].x-f,lt=we[rt].y-H;U.writeVarint(Jt(Ne)),U.writeVarint(Jt(lt)),f+=Ne,H+=lt}ie===3&&U.writeVarint(It(7,1))}}function Mn(q,U){var W=typeof q;W==="string"?U.writeStringField(1,q):W==="boolean"?U.writeBooleanField(7,q):W==="number"&&(q%1!=0?U.writeDoubleField(3,q):q<0?U.writeSVarintField(6,q):U.writeVarintField(5,q))}function ri(q,U,W,ie,f,H){if(f-ie<=W)return;const ke=ie+f>>1;oi(q,U,ke,ie,f,H%2),ri(q,U,W,ie,ke-1,H+1),ri(q,U,W,ke+1,f,H+1)}function oi(q,U,W,ie,f,H){for(;f>ie;){if(f-ie>600){const Me=f-ie+1,Fe=W-ie+1,rt=Math.log(Me),Ne=.5*Math.exp(2*rt/3),lt=.5*Math.sqrt(rt*Ne*(Me-Ne)/Me)*(Fe-Me/2<0?-1:1);oi(q,U,W,Math.max(ie,Math.floor(W-Fe*Ne/Me+lt)),Math.min(f,Math.floor(W+(Me-Fe)*Ne/Me+lt)),H)}const ke=U[2*W+H];let Te=ie,we=f;for(Ri(q,U,ie,W),U[2*f+H]>ke&&Ri(q,U,ie,f);Te<we;){for(Ri(q,U,Te,we),Te++,we--;U[2*Te+H]<ke;)Te++;for(;U[2*we+H]>ke;)we--}U[2*ie+H]===ke?Ri(q,U,ie,we):(we++,Ri(q,U,we,f)),we<=W&&(ie=we+1),W<=we&&(f=we-1)}}function Ri(q,U,W,ie){Ai(q,W,ie),Ai(U,2*W,2*ie),Ai(U,2*W+1,2*ie+1)}function Ai(q,U,W){const ie=q[U];q[U]=q[W],q[W]=ie}function Nn(q,U,W,ie){const f=q-W,H=U-ie;return f*f+H*H}nt.exports=_n,nt.exports.fromVectorTileJs=_n,nt.exports.fromGeojsonVt=function(q,U){U=U||{};var W={};for(var ie in q)W[ie]=new jt(q[ie].features,U),W[ie].name=ie,W[ie].version=U.version,W[ie].extent=U.extent;return _n({layers:W})},nt.exports.GeoJSONWrapper=jt;const Di=q=>q[0],yn=q=>q[1];class qn{constructor(U,W=Di,ie=yn,f=64,H=Float64Array){this.nodeSize=f,this.points=U;const ke=U.length<65536?Uint16Array:Uint32Array,Te=this.ids=new ke(U.length),we=this.coords=new H(2*U.length);for(let Me=0;Me<U.length;Me++)Te[Me]=Me,we[2*Me]=W(U[Me]),we[2*Me+1]=ie(U[Me]);ri(Te,we,f,0,Te.length-1,0)}range(U,W,ie,f){return function(H,ke,Te,we,Me,Fe,rt){const Ne=[0,H.length-1,0],lt=[];let Tt,xt;for(;Ne.length;){const $t=Ne.pop(),Ft=Ne.pop(),en=Ne.pop();if(Ft-en<=rt){for(let dn=en;dn<=Ft;dn++)Tt=ke[2*dn],xt=ke[2*dn+1],Tt>=Te&&Tt<=Me&&xt>=we&&xt<=Fe&&lt.push(H[dn]);continue}const Gt=Math.floor((en+Ft)/2);Tt=ke[2*Gt],xt=ke[2*Gt+1],Tt>=Te&&Tt<=Me&&xt>=we&&xt<=Fe&&lt.push(H[Gt]);const Wt=($t+1)%2;($t===0?Te<=Tt:we<=xt)&&(Ne.push(en),Ne.push(Gt-1),Ne.push(Wt)),($t===0?Me>=Tt:Fe>=xt)&&(Ne.push(Gt+1),Ne.push(Ft),Ne.push(Wt))}return lt}(this.ids,this.coords,U,W,ie,f,this.nodeSize)}within(U,W,ie){return function(f,H,ke,Te,we,Me){const Fe=[0,f.length-1,0],rt=[],Ne=we*we;for(;Fe.length;){const lt=Fe.pop(),Tt=Fe.pop(),xt=Fe.pop();if(Tt-xt<=Me){for(let Wt=xt;Wt<=Tt;Wt++)Nn(H[2*Wt],H[2*Wt+1],ke,Te)<=Ne&&rt.push(f[Wt]);continue}const $t=Math.floor((xt+Tt)/2),Ft=H[2*$t],en=H[2*$t+1];Nn(Ft,en,ke,Te)<=Ne&&rt.push(f[$t]);const Gt=(lt+1)%2;(lt===0?ke-we<=Ft:Te-we<=en)&&(Fe.push(xt),Fe.push($t-1),Fe.push(Gt)),(lt===0?ke+we>=Ft:Te+we>=en)&&(Fe.push($t+1),Fe.push(Tt),Fe.push(Gt))}return rt}(this.ids,this.coords,U,W,ie,this.nodeSize)}}const Xi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:q=>q},pi=Math.fround||(Si=new Float32Array(1),q=>(Si[0]=+q,Si[0]));var Si;class Qr{constructor(U){this.options=zr(Object.create(Xi),U),this.trees=new Array(this.options.maxZoom+1)}load(U){const{log:W,minZoom:ie,maxZoom:f,nodeSize:H}=this.options;W&&console.time("total time");const ke=`prepare ${U.length} points`;W&&console.time(ke),this.points=U;let Te=[];for(let we=0;we<U.length;we++)U[we].geometry&&Te.push(Gi(U[we],we));this.trees[f+1]=new qn(Te,ns,Yi,H,Float32Array),W&&console.timeEnd(ke);for(let we=f;we>=ie;we--){const Me=+Date.now();Te=this._cluster(Te,we),this.trees[we]=new qn(Te,ns,Yi,H,Float32Array),W&&console.log("z%d: %d clusters in %dms",we,Te.length,+Date.now()-Me)}return W&&console.timeEnd("total time"),this}getClusters(U,W){let ie=((U[0]+180)%360+360)%360-180;const f=Math.max(-90,Math.min(90,U[1]));let H=U[2]===180?180:((U[2]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,U[3]));if(U[2]-U[0]>=360)ie=-180,H=180;else if(ie>H){const Fe=this.getClusters([ie,f,180,ke],W),rt=this.getClusters([-180,f,H,ke],W);return Fe.concat(rt)}const Te=this.trees[this._limitZoom(W)],we=Te.range(bn(ie),ir(ke),bn(H),ir(f)),Me=[];for(const Fe of we){const rt=Te.points[Fe];Me.push(rt.numPoints?xi(rt):this.points[rt.index])}return Me}getChildren(U){const W=this._getOriginId(U),ie=this._getOriginZoom(U),f="No cluster with the specified id.",H=this.trees[ie];if(!H)throw new Error(f);const ke=H.points[W];if(!ke)throw new Error(f);const Te=this.options.radius/(this.options.extent*Math.pow(2,ie-1)),we=H.within(ke.x,ke.y,Te),Me=[];for(const Fe of we){const rt=H.points[Fe];rt.parentId===U&&Me.push(rt.numPoints?xi(rt):this.points[rt.index])}if(Me.length===0)throw new Error(f);return Me}getLeaves(U,W,ie){const f=[];return this._appendLeaves(f,U,W=W||10,ie=ie||0,0),f}getTile(U,W,ie){const f=this.trees[this._limitZoom(U)],H=Math.pow(2,U),{extent:ke,radius:Te}=this.options,we=Te/ke,Me=(ie-we)/H,Fe=(ie+1+we)/H,rt={features:[]};return this._addTileFeatures(f.range((W-we)/H,Me,(W+1+we)/H,Fe),f.points,W,ie,H,rt),W===0&&this._addTileFeatures(f.range(1-we/H,Me,1,Fe),f.points,H,ie,H,rt),W===H-1&&this._addTileFeatures(f.range(0,Me,we/H,Fe),f.points,-1,ie,H,rt),rt.features.length?rt:null}getClusterExpansionZoom(U){let W=this._getOriginZoom(U)-1;for(;W<=this.options.maxZoom;){const ie=this.getChildren(U);if(W++,ie.length!==1)break;U=ie[0].properties.cluster_id}return W}_appendLeaves(U,W,ie,f,H){const ke=this.getChildren(W);for(const Te of ke){const we=Te.properties;if(we&&we.cluster?H+we.point_count<=f?H+=we.point_count:H=this._appendLeaves(U,we.cluster_id,ie,f,H):H<f?H++:U.push(Te),U.length===ie)break}return H}_addTileFeatures(U,W,ie,f,H,ke){for(const Te of U){const we=W[Te],Me=we.numPoints;let Fe,rt,Ne;if(Me)Fe=Dr(we),rt=we.x,Ne=we.y;else{const xt=this.points[we.index];Fe=xt.properties,rt=bn(xt.geometry.coordinates[0]),Ne=ir(xt.geometry.coordinates[1])}const lt={type:1,geometry:[[Math.round(this.options.extent*(rt*H-ie)),Math.round(this.options.extent*(Ne*H-f))]],tags:Fe};let Tt;Me?Tt=we.id:this.options.generateId?Tt=we.index:this.points[we.index].id&&(Tt=this.points[we.index].id),Tt!==void 0&&(lt.id=Tt),ke.features.push(lt)}}_limitZoom(U){return Math.max(this.options.minZoom,Math.min(Math.floor(+U),this.options.maxZoom+1))}_cluster(U,W){const ie=[],{radius:f,extent:H,reduce:ke,minPoints:Te}=this.options,we=f/(H*Math.pow(2,W));for(let Me=0;Me<U.length;Me++){const Fe=U[Me];if(Fe.zoom<=W)continue;Fe.zoom=W;const rt=this.trees[W+1],Ne=rt.within(Fe.x,Fe.y,we),lt=Fe.numPoints||1;let Tt=lt;for(const xt of Ne){const $t=rt.points[xt];$t.zoom>W&&(Tt+=$t.numPoints||1)}if(Tt>lt&&Tt>=Te){let xt=Fe.x*lt,$t=Fe.y*lt,Ft=ke&&lt>1?this._map(Fe,!0):null;const en=(Me<<5)+(W+1)+this.points.length;for(const Gt of Ne){const Wt=rt.points[Gt];if(Wt.zoom<=W)continue;Wt.zoom=W;const dn=Wt.numPoints||1;xt+=Wt.x*dn,$t+=Wt.y*dn,Wt.parentId=en,ke&&(Ft||(Ft=this._map(Fe,!0)),ke(Ft,this._map(Wt)))}Fe.parentId=en,ie.push(hr(xt/Tt,$t/Tt,en,Tt,Ft))}else if(ie.push(Fe),Tt>1)for(const xt of Ne){const $t=rt.points[xt];$t.zoom<=W||($t.zoom=W,ie.push($t))}}return ie}_getOriginId(U){return U-this.points.length>>5}_getOriginZoom(U){return(U-this.points.length)%32}_map(U,W){if(U.numPoints)return W?zr({},U.properties):U.properties;const ie=this.points[U.index].properties,f=this.options.map(ie);return W&&f===ie?zr({},f):f}}function hr(q,U,W,ie,f){return{x:pi(q),y:pi(U),zoom:1/0,id:W,parentId:-1,numPoints:ie,properties:f}}function Gi(q,U){const[W,ie]=q.geometry.coordinates;return{x:pi(bn(W)),y:pi(ir(ie)),zoom:1/0,index:U,parentId:-1}}function xi(q){return{type:"Feature",id:q.id,properties:Dr(q),geometry:{type:"Point",coordinates:[(U=q.x,360*(U-.5)),Vn(q.y)]}};var U}function Dr(q){const U=q.numPoints,W=U>=1e4?`${Math.round(U/1e3)}k`:U>=1e3?Math.round(U/100)/10+"k":U;return zr(zr({},q.properties),{cluster:!0,cluster_id:q.id,point_count:U,point_count_abbreviated:W})}function bn(q){return q/360+.5}function ir(q){const U=Math.sin(q*Math.PI/180),W=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return W<0?0:W>1?1:W}function Vn(q){const U=(180-360*q)*Math.PI/180;return 360*Math.atan(Math.exp(U))/Math.PI-90}function zr(q,U){for(const W in U)q[W]=U[W];return q}function ns(q){return q.x}function Yi(q){return q.y}function wr(q,U,W,ie){for(var f,H=ie,ke=W-U>>1,Te=W-U,we=q[U],Me=q[U+1],Fe=q[W],rt=q[W+1],Ne=U+3;Ne<W;Ne+=3){var lt=is(q[Ne],q[Ne+1],we,Me,Fe,rt);if(lt>H)f=Ne,H=lt;else if(lt===H){var Tt=Math.abs(Ne-ke);Tt<Te&&(f=Ne,Te=Tt)}}H>ie&&(f-U>3&&wr(q,U,f,ie),q[f+2]=H,W-f>3&&wr(q,f,W,ie))}function is(q,U,W,ie,f,H){var ke=f-W,Te=H-ie;if(ke!==0||Te!==0){var we=((q-W)*ke+(U-ie)*Te)/(ke*ke+Te*Te);we>1?(W=f,ie=H):we>0&&(W+=ke*we,ie+=Te*we)}return(ke=q-W)*ke+(Te=U-ie)*Te}function Br(q,U,W,ie){var f={id:q===void 0?null:q,type:U,geometry:W,tags:ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(H){var ke=H.geometry,Te=H.type;if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")et(H,ke);else if(Te==="Polygon"||Te==="MultiLineString")for(var we=0;we<ke.length;we++)et(H,ke[we]);else if(Te==="MultiPolygon")for(we=0;we<ke.length;we++)for(var Me=0;Me<ke[we].length;Me++)et(H,ke[we][Me])}(f),f}function et(q,U){for(var W=0;W<U.length;W+=3)q.minX=Math.min(q.minX,U[W]),q.minY=Math.min(q.minY,U[W+1]),q.maxX=Math.max(q.maxX,U[W]),q.maxY=Math.max(q.maxY,U[W+1])}function gt(q,U,W,ie){if(U.geometry){var f=U.geometry.coordinates,H=U.geometry.type,ke=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2),Te=[],we=U.id;if(W.promoteId?we=U.properties[W.promoteId]:W.generateId&&(we=ie||0),H==="Point")po(f,Te);else if(H==="MultiPoint")for(var Me=0;Me<f.length;Me++)po(f[Me],Te);else if(H==="LineString")Ki(f,Te,ke,!1);else if(H==="MultiLineString"){if(W.lineMetrics){for(Me=0;Me<f.length;Me++)Ki(f[Me],Te=[],ke,!1),q.push(Br(we,"LineString",Te,U.properties));return}vn(f,Te,ke,!1)}else if(H==="Polygon")vn(f,Te,ke,!0);else{if(H!=="MultiPolygon"){if(H==="GeometryCollection"){for(Me=0;Me<U.geometry.geometries.length;Me++)gt(q,{id:we,geometry:U.geometry.geometries[Me],properties:U.properties},W,ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Me=0;Me<f.length;Me++){var Fe=[];vn(f[Me],Fe,ke,!0),Te.push(Fe)}}q.push(Br(we,H,Te,U.properties))}}function po(q,U){U.push(dr(q[0])),U.push(rr(q[1])),U.push(0)}function Ki(q,U,W,ie){for(var f,H,ke=0,Te=0;Te<q.length;Te++){var we=dr(q[Te][0]),Me=rr(q[Te][1]);U.push(we),U.push(Me),U.push(0),Te>0&&(ke+=ie?(f*Me-we*H)/2:Math.sqrt(Math.pow(we-f,2)+Math.pow(Me-H,2))),f=we,H=Me}var Fe=U.length-3;U[2]=1,wr(U,0,Fe,W),U[Fe+2]=1,U.size=Math.abs(ke),U.start=0,U.end=U.size}function vn(q,U,W,ie){for(var f=0;f<q.length;f++){var H=[];Ki(q[f],H,W,ie),U.push(H)}}function dr(q){return q/360+.5}function rr(q){var U=Math.sin(q*Math.PI/180),W=.5-.25*Math.log((1+U)/(1-U))/Math.PI;return W<0?0:W>1?1:W}function or(q,U,W,ie,f,H,ke,Te){if(ie/=U,H>=(W/=U)&&ke<ie)return q;if(ke<W||H>=ie)return null;for(var we=[],Me=0;Me<q.length;Me++){var Fe=q[Me],rt=Fe.geometry,Ne=Fe.type,lt=f===0?Fe.minX:Fe.minY,Tt=f===0?Fe.maxX:Fe.maxY;if(lt>=W&&Tt<ie)we.push(Fe);else if(!(Tt<W||lt>=ie)){var xt=[];if(Ne==="Point"||Ne==="MultiPoint")Xr(rt,xt,W,ie,f);else if(Ne==="LineString")_t(rt,xt,W,ie,f,!1,Te.lineMetrics);else if(Ne==="MultiLineString")an(rt,xt,W,ie,f,!1);else if(Ne==="Polygon")an(rt,xt,W,ie,f,!0);else if(Ne==="MultiPolygon")for(var $t=0;$t<rt.length;$t++){var Ft=[];an(rt[$t],Ft,W,ie,f,!0),Ft.length&&xt.push(Ft)}if(xt.length){if(Te.lineMetrics&&Ne==="LineString"){for($t=0;$t<xt.length;$t++)we.push(Br(Fe.id,Ne,xt[$t],Fe.tags));continue}Ne!=="LineString"&&Ne!=="MultiLineString"||(xt.length===1?(Ne="LineString",xt=xt[0]):Ne="MultiLineString"),Ne!=="Point"&&Ne!=="MultiPoint"||(Ne=xt.length===3?"Point":"MultiPoint"),we.push(Br(Fe.id,Ne,xt,Fe.tags))}}}return we.length?we:null}function Xr(q,U,W,ie,f){for(var H=0;H<q.length;H+=3){var ke=q[H+f];ke>=W&&ke<=ie&&(U.push(q[H]),U.push(q[H+1]),U.push(q[H+2]))}}function _t(q,U,W,ie,f,H,ke){for(var Te,we,Me=ln(q),Fe=f===0?Yr:rn,rt=q.start,Ne=0;Ne<q.length-3;Ne+=3){var lt=q[Ne],Tt=q[Ne+1],xt=q[Ne+2],$t=q[Ne+3],Ft=q[Ne+4],en=f===0?lt:Tt,Gt=f===0?$t:Ft,Wt=!1;ke&&(Te=Math.sqrt(Math.pow(lt-$t,2)+Math.pow(Tt-Ft,2))),en<W?Gt>W&&(we=Fe(Me,lt,Tt,$t,Ft,W),ke&&(Me.start=rt+Te*we)):en>ie?Gt<ie&&(we=Fe(Me,lt,Tt,$t,Ft,ie),ke&&(Me.start=rt+Te*we)):mi(Me,lt,Tt,xt),Gt<W&&en>=W&&(we=Fe(Me,lt,Tt,$t,Ft,W),Wt=!0),Gt>ie&&en<=ie&&(we=Fe(Me,lt,Tt,$t,Ft,ie),Wt=!0),!H&&Wt&&(ke&&(Me.end=rt+Te*we),U.push(Me),Me=ln(q)),ke&&(rt+=Te)}var dn=q.length-3;lt=q[dn],Tt=q[dn+1],xt=q[dn+2],(en=f===0?lt:Tt)>=W&&en<=ie&&mi(Me,lt,Tt,xt),dn=Me.length-3,H&&dn>=3&&(Me[dn]!==Me[0]||Me[dn+1]!==Me[1])&&mi(Me,Me[0],Me[1],Me[2]),Me.length&&U.push(Me)}function ln(q){var U=[];return U.size=q.size,U.start=q.start,U.end=q.end,U}function an(q,U,W,ie,f,H){for(var ke=0;ke<q.length;ke++)_t(q[ke],U,W,ie,f,H,!1)}function mi(q,U,W,ie){q.push(U),q.push(W),q.push(ie)}function Yr(q,U,W,ie,f,H){var ke=(H-U)/(ie-U);return q.push(H),q.push(W+(f-W)*ke),q.push(1),ke}function rn(q,U,W,ie,f,H){var ke=(H-W)/(f-W);return q.push(U+(ie-U)*ke),q.push(H),q.push(1),ke}function ft(q,U){for(var W=[],ie=0;ie<q.length;ie++){var f,H=q[ie],ke=H.type;if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")f=wi(H.geometry,U);else if(ke==="MultiLineString"||ke==="Polygon"){f=[];for(var Te=0;Te<H.geometry.length;Te++)f.push(wi(H.geometry[Te],U))}else if(ke==="MultiPolygon")for(f=[],Te=0;Te<H.geometry.length;Te++){for(var we=[],Me=0;Me<H.geometry[Te].length;Me++)we.push(wi(H.geometry[Te][Me],U));f.push(we)}W.push(Br(H.id,ke,f,H.tags))}return W}function wi(q,U){var W=[];W.size=q.size,q.start!==void 0&&(W.start=q.start,W.end=q.end);for(var ie=0;ie<q.length;ie+=3)W.push(q[ie]+U,q[ie+1],q[ie+2]);return W}function Co(q,U){if(q.transformed)return q;var W,ie,f,H=1<<q.z,ke=q.x,Te=q.y;for(W=0;W<q.features.length;W++){var we=q.features[W],Me=we.geometry,Fe=we.type;if(we.geometry=[],Fe===1)for(ie=0;ie<Me.length;ie+=2)we.geometry.push(ai(Me[ie],Me[ie+1],U,H,ke,Te));else for(ie=0;ie<Me.length;ie++){var rt=[];for(f=0;f<Me[ie].length;f+=2)rt.push(ai(Me[ie][f],Me[ie][f+1],U,H,ke,Te));we.geometry.push(rt)}}return q.transformed=!0,q}function ai(q,U,W,ie,f,H){return[Math.round(W*(q*ie-f)),Math.round(W*(U*ie-H))]}function zi(q,U,W,ie,f){for(var H=U===f.maxZoom?0:f.tolerance/((1<<U)*f.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:W,y:ie,z:U,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Te=0;Te<q.length;Te++){ke.numFeatures++,Pn(ke,q[Te],H,f);var we=q[Te].minX,Me=q[Te].minY,Fe=q[Te].maxX,rt=q[Te].maxY;we<ke.minX&&(ke.minX=we),Me<ke.minY&&(ke.minY=Me),Fe>ke.maxX&&(ke.maxX=Fe),rt>ke.maxY&&(ke.maxY=rt)}return ke}function Pn(q,U,W,ie){var f=U.geometry,H=U.type,ke=[];if(H==="Point"||H==="MultiPoint")for(var Te=0;Te<f.length;Te+=3)ke.push(f[Te]),ke.push(f[Te+1]),q.numPoints++,q.numSimplified++;else if(H==="LineString")ko(ke,f,q,W,!1,!1);else if(H==="MultiLineString"||H==="Polygon")for(Te=0;Te<f.length;Te++)ko(ke,f[Te],q,W,H==="Polygon",Te===0);else if(H==="MultiPolygon")for(var we=0;we<f.length;we++){var Me=f[we];for(Te=0;Te<Me.length;Te++)ko(ke,Me[Te],q,W,!0,Te===0)}if(ke.length){var Fe=U.tags||null;if(H==="LineString"&&ie.lineMetrics){for(var rt in Fe={},U.tags)Fe[rt]=U.tags[rt];Fe.mapbox_clip_start=f.start/f.size,Fe.mapbox_clip_end=f.end/f.size}var Ne={geometry:ke,type:H==="Polygon"||H==="MultiPolygon"?3:H==="LineString"||H==="MultiLineString"?2:1,tags:Fe};U.id!==null&&(Ne.id=U.id),q.features.push(Ne)}}function ko(q,U,W,ie,f,H){var ke=ie*ie;if(ie>0&&U.size<(f?ke:ie))W.numPoints+=U.length/3;else{for(var Te=[],we=0;we<U.length;we+=3)(ie===0||U[we+2]>ke)&&(W.numSimplified++,Te.push(U[we]),Te.push(U[we+1])),W.numPoints++;f&&function(Me,Fe){for(var rt=0,Ne=0,lt=Me.length,Tt=lt-2;Ne<lt;Tt=Ne,Ne+=2)rt+=(Me[Ne]-Me[Tt])*(Me[Ne+1]+Me[Tt+1]);if(rt>0===Fe)for(Ne=0,lt=Me.length;Ne<lt/2;Ne+=2){var xt=Me[Ne],$t=Me[Ne+1];Me[Ne]=Me[lt-2-Ne],Me[Ne+1]=Me[lt-1-Ne],Me[lt-2-Ne]=xt,Me[lt-1-Ne]=$t}}(Te,H),q.push(Te)}}function br(q,U){var W=(U=this.options=function(f,H){for(var ke in H)f[ke]=H[ke];return f}(Object.create(this.options),U)).debug;if(W&&console.time("preprocess data"),U.maxZoom<0||U.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(U.promoteId&&U.generateId)throw new Error("promoteId and generateId cannot be used together.");var ie=function(f,H){var ke=[];if(f.type==="FeatureCollection")for(var Te=0;Te<f.features.length;Te++)gt(ke,f.features[Te],H,Te);else gt(ke,f.type==="Feature"?f:{geometry:f},H);return ke}(q,U);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",U.indexMaxZoom,U.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ie=function(f,H){var ke=H.buffer/H.extent,Te=f,we=or(f,1,-1-ke,ke,0,-1,2,H),Me=or(f,1,1-ke,2+ke,0,-1,2,H);return(we||Me)&&(Te=or(f,1,-ke,1+ke,0,-1,2,H)||[],we&&(Te=ft(we,1).concat(Te)),Me&&(Te=Te.concat(ft(Me,-1)))),Te}(ie,U),ie.length&&this.splitTile(ie,0,0,0),W&&(ie.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Er(q,U,W){return 32*((1<<q)*W+U)+q}function Or(q,U){const W=q.tileID.canonical;if(!this._geoJSONIndex)return U(null,null);const ie=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!ie)return U(null,null);const f=new Ge(ie.features);let H=nt.exports(f);H.byteOffset===0&&H.byteLength===H.buffer.byteLength||(H=new Uint8Array(H)),U(null,{vectorTile:f,rawData:H.buffer})}br.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},br.prototype.splitTile=function(q,U,W,ie,f,H,ke){for(var Te=[q,U,W,ie],we=this.options,Me=we.debug;Te.length;){ie=Te.pop(),W=Te.pop(),U=Te.pop(),q=Te.pop();var Fe=1<<U,rt=Er(U,W,ie),Ne=this.tiles[rt];if(!Ne&&(Me>1&&console.time("creation"),Ne=this.tiles[rt]=zi(q,U,W,ie,we),this.tileCoords.push({z:U,x:W,y:ie}),Me)){Me>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",U,W,ie,Ne.numFeatures,Ne.numPoints,Ne.numSimplified),console.timeEnd("creation"));var lt="z"+U;this.stats[lt]=(this.stats[lt]||0)+1,this.total++}if(Ne.source=q,f){if(U===we.maxZoom||U===f)continue;var Tt=1<<f-U;if(W!==Math.floor(H/Tt)||ie!==Math.floor(ke/Tt))continue}else if(U===we.indexMaxZoom||Ne.numPoints<=we.indexMaxPoints)continue;if(Ne.source=null,q.length!==0){Me>1&&console.time("clipping");var xt,$t,Ft,en,Gt,Wt,dn=.5*we.buffer/we.extent,wn=.5-dn,Ln=.5+dn,Ot=1+dn;xt=$t=Ft=en=null,Gt=or(q,Fe,W-dn,W+Ln,0,Ne.minX,Ne.maxX,we),Wt=or(q,Fe,W+wn,W+Ot,0,Ne.minX,Ne.maxX,we),q=null,Gt&&(xt=or(Gt,Fe,ie-dn,ie+Ln,1,Ne.minY,Ne.maxY,we),$t=or(Gt,Fe,ie+wn,ie+Ot,1,Ne.minY,Ne.maxY,we),Gt=null),Wt&&(Ft=or(Wt,Fe,ie-dn,ie+Ln,1,Ne.minY,Ne.maxY,we),en=or(Wt,Fe,ie+wn,ie+Ot,1,Ne.minY,Ne.maxY,we),Wt=null),Me>1&&console.timeEnd("clipping"),Te.push(xt||[],U+1,2*W,2*ie),Te.push($t||[],U+1,2*W,2*ie+1),Te.push(Ft||[],U+1,2*W+1,2*ie),Te.push(en||[],U+1,2*W+1,2*ie+1)}}},br.prototype.getTile=function(q,U,W){var ie=this.options,f=ie.extent,H=ie.debug;if(q<0||q>24)return null;var ke=1<<q,Te=Er(q,U=(U%ke+ke)%ke,W);if(this.tiles[Te])return Co(this.tiles[Te],f);H>1&&console.log("drilling down to z%d-%d-%d",q,U,W);for(var we,Me=q,Fe=U,rt=W;!we&&Me>0;)Me--,Fe=Math.floor(Fe/2),rt=Math.floor(rt/2),we=this.tiles[Er(Me,Fe,rt)];return we&&we.source?(H>1&&console.log("found parent tile z%d-%d-%d",Me,Fe,rt),H>1&&console.time("drilling down"),this.splitTile(we.source,Me,Fe,rt,q,U,W),H>1&&console.timeEnd("drilling down"),this.tiles[Te]?Co(this.tiles[Te],f):null):null};class mo extends le{constructor(U,W,ie,f){super(U,W,ie,Or),f&&(this.loadGeoJSON=f)}loadData(U,W){var ie;(ie=this._pendingRequest)===null||ie===void 0||ie.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const f=!!(U&&U.request&&U.request.collectResourceTiming)&&new a.RequestPerformance(U.request);this._pendingCallback=W,this._pendingRequest=this.loadGeoJSON(U,(H,ke)=>{if(delete this._pendingCallback,delete this._pendingRequest,H||!ke)return W(H);if(typeof ke!="object")return W(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));{se(ke,!0);try{if(U.filter){const we=a.createExpression(U.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(we.result==="error")throw new Error(we.value.map(Fe=>`${Fe.key}: ${Fe.message}`).join(", "));ke={type:"FeatureCollection",features:ke.features.filter(Fe=>we.value.evaluate({zoom:0},Fe))}}this._geoJSONIndex=U.cluster?new Qr(function({superclusterOptions:we,clusterProperties:Me}){if(!Me||!we)return we;const Fe={},rt={},Ne={accumulated:null,zoom:0},lt={properties:null},Tt=Object.keys(Me);for(const xt of Tt){const[$t,Ft]=Me[xt],en=a.createExpression(Ft),Gt=a.createExpression(typeof $t=="string"?[$t,["accumulated"],["get",xt]]:$t);Fe[xt]=en.value,rt[xt]=Gt.value}return we.map=xt=>{lt.properties=xt;const $t={};for(const Ft of Tt)$t[Ft]=Fe[Ft].evaluate(Ne,lt);return $t},we.reduce=(xt,$t)=>{lt.properties=$t;for(const Ft of Tt)Ne.accumulated=xt[Ft],xt[Ft]=rt[Ft].evaluate(Ne,lt)},we}(U)).load(ke.features):function(we,Me){return new br(we,Me)}(ke,U.geojsonVtOptions)}catch(we){return W(we)}this.loaded={};const Te={};if(f){const we=f.finish();we&&(Te.resourceTiming={},Te.resourceTiming[U.source]=JSON.parse(JSON.stringify(we)))}W(null,Te)}})}reloadTile(U,W){const ie=this.loaded;return ie&&ie[U.uid]?super.reloadTile(U,W):this.loadTile(U,W)}loadGeoJSON(U,W){if(U.request)return a.getJSON(U.request,W);if(typeof U.data=="string")try{W(null,JSON.parse(U.data))}catch{W(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`))}else W(new Error(`Input data given to '${U.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(U,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),W()}getClusterExpansionZoom(U,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom(U.clusterId))}catch(ie){W(ie)}}getClusterChildren(U,W){try{W(null,this._geoJSONIndex.getChildren(U.clusterId))}catch(ie){W(ie)}}getClusterLeaves(U,W){try{W(null,this._geoJSONIndex.getLeaves(U.clusterId,U.limit,U.offset))}catch(ie){W(ie)}}}class Ji{constructor(U){this.self=U,this.actor=new a.Actor(U,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:le,geojson:mo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(W,ie)=>{if(this.workerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.workerSourceTypes[W]=ie},this.self.registerRTLTextPlugin=W=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=W.applyArabicShaping,a.plugin.processBidirectionalText=W.processBidirectionalText,a.plugin.processStyledBidirectionalText=W.processStyledBidirectionalText}}setReferrer(U,W){this.referrer=W}setImages(U,W,ie){this.availableImages[U]=W;for(const f in this.workerSources[U]){const H=this.workerSources[U][f];for(const ke in H)H[ke].availableImages=W}ie()}setLayers(U,W,ie){this.getLayerIndex(U).replace(W),ie()}updateLayers(U,W,ie){this.getLayerIndex(U).update(W.layers,W.removedIds),ie()}loadTile(U,W,ie){this.getWorkerSource(U,W.type,W.source).loadTile(W,ie)}loadDEMTile(U,W,ie){this.getDEMWorkerSource(U,W.source).loadTile(W,ie)}reloadTile(U,W,ie){this.getWorkerSource(U,W.type,W.source).reloadTile(W,ie)}abortTile(U,W,ie){this.getWorkerSource(U,W.type,W.source).abortTile(W,ie)}removeTile(U,W,ie){this.getWorkerSource(U,W.type,W.source).removeTile(W,ie)}removeDEMTile(U,W){this.getDEMWorkerSource(U,W.source).removeTile(W)}removeSource(U,W,ie){if(!this.workerSources[U]||!this.workerSources[U][W.type]||!this.workerSources[U][W.type][W.source])return;const f=this.workerSources[U][W.type][W.source];delete this.workerSources[U][W.type][W.source],f.removeSource!==void 0?f.removeSource(W,ie):ie()}loadWorkerSource(U,W,ie){try{this.self.importScripts(W.url),ie()}catch(f){ie(f.toString())}}syncRTLPluginState(U,W,ie){try{a.plugin.setState(W);const f=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&f!=null){this.self.importScripts(f);const H=a.plugin.isParsed();ie(H?void 0:new Error(`RTL Text Plugin failed to import scripts from ${f}`),H)}}catch(f){ie(f.toString())}}getAvailableImages(U){let W=this.availableImages[U];return W||(W=[]),W}getLayerIndex(U){let W=this.layerIndexes[U];return W||(W=this.layerIndexes[U]=new z),W}getWorkerSource(U,W,ie){if(this.workerSources[U]||(this.workerSources[U]={}),this.workerSources[U][W]||(this.workerSources[U][W]={}),!this.workerSources[U][W][ie]){const f={send:(H,ke,Te)=>{this.actor.send(H,ke,Te,U)}};this.workerSources[U][W][ie]=new this.workerSourceTypes[W](f,this.getLayerIndex(U),this.getAvailableImages(U))}return this.workerSources[U][W][ie]}getDEMWorkerSource(U,W){return this.demWorkerSources[U]||(this.demWorkerSources[U]={}),this.demWorkerSources[U][W]||(this.demWorkerSources[U][W]=new Ce),this.demWorkerSources[U][W]}enforceCacheSizeLimit(U,W){a.enforceCacheSizeLimit(W)}}return a.isWorker()&&(self.worker=new Ji(self)),Ji}),c(["./shared"],function(a){var T=k;function k(x){return!function(s){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,w,M=new Blob([""],{type:"text/javascript"}),L=URL.createObjectURL(M);try{w=new Worker(L),y=!0}catch{y=!1}return w&&w.terminate(),URL.revokeObjectURL(L),y}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var y=document.createElement("canvas");y.width=y.height=1;var w=y.getContext("2d");if(!w)return!1;var M=w.getImageData(0,0,1,1);return M&&M.width===y.width}()?(z[A=s&&s.failIfMajorPerformanceCaveat]===void 0&&(z[A]=function(y){var w,M=function(L){var N=document.createElement("canvas"),V=Object.create(k.webGLContextAttributes);return V.failIfMajorPerformanceCaveat=L,N.getContext("webgl",V)||N.getContext("experimental-webgl",V)}(y);if(!M)return!1;try{w=M.createShader(M.VERTEX_SHADER)}catch{return!1}return!(!w||M.isContextLost())&&(M.shaderSource(w,"void main() {}"),M.compileShader(w),M.getShaderParameter(w,M.COMPILE_STATUS)===!0)}(A)),z[A]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var A}(x)}var z={};function B(x,s){if(Array.isArray(x)){if(!Array.isArray(s)||x.length!==s.length)return!1;for(let A=0;A<x.length;A++)if(!B(x[A],s[A]))return!1;return!0}if(typeof x=="object"&&x!==null&&s!==null){if(typeof s!="object"||Object.keys(x).length!==Object.keys(s).length)return!1;for(const A in x)if(!B(x[A],s[A]))return!1;return!0}return x===s}k.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class D{static testProp(s){if(!D.docStyle)return s[0];for(let A=0;A<s.length;A++)if(s[A]in D.docStyle)return s[A];return s[0]}static create(s,A,y){const w=window.document.createElement(s);return A!==void 0&&(w.className=A),y&&y.appendChild(w),w}static createNS(s,A){return window.document.createElementNS(s,A)}static disableDrag(){D.docStyle&&D.selectProp&&(D.userSelect=D.docStyle[D.selectProp],D.docStyle[D.selectProp]="none")}static enableDrag(){D.docStyle&&D.selectProp&&(D.docStyle[D.selectProp]=D.userSelect)}static setTransform(s,A){s.style[D.transformProp]=A}static addEventListener(s,A,y,w={}){s.addEventListener(A,y,"passive"in w?w:w.capture)}static removeEventListener(s,A,y,w={}){s.removeEventListener(A,y,"passive"in w?w:w.capture)}static suppressClickInternal(s){s.preventDefault(),s.stopPropagation(),window.removeEventListener("click",D.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",D.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",D.suppressClickInternal,!0)},0)}static mousePos(s,A){const y=s.getBoundingClientRect();return new a.pointGeometry(A.clientX-y.left-s.clientLeft,A.clientY-y.top-s.clientTop)}static touchPos(s,A){const y=s.getBoundingClientRect(),w=[];for(let M=0;M<A.length;M++)w.push(new a.pointGeometry(A[M].clientX-y.left-s.clientLeft,A[M].clientY-y.top-s.clientTop));return w}static mouseButton(s){return s.button}static remove(s){s.parentNode&&s.parentNode.removeChild(s)}}D.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,D.selectProp=D.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),D.transformProp=D.testProp(["transform","WebkitTransform"]);class K{constructor(s){this._transformRequestFn=s}transformRequest(s,A){return this._transformRequestFn&&this._transformRequestFn(s,A)||{url:s}}normalizeSpriteURL(s,A,y){const w=function(M){const L=M.match(ee);if(!L)throw new Error(`Unable to parse URL "${M}"`);return{protocol:L[1],authority:L[2],path:L[3]||"/",params:L[4]?L[4].split("&"):[]}}(s);return w.path+=`${A}${y}`,function(M){const L=M.params.length?`?${M.params.join("&")}`:"";return`${M.protocol}://${M.authority}${M.path}${L}`}(w)}setTransformRequest(s){this._transformRequestFn=s}}const ee=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class le{constructor(s,A,y,w){this.context=s,this.format=y,this.texture=s.gl.createTexture(),this.update(A,w)}update(s,A,y){const{width:w,height:M}=s,L=!(this.size&&this.size[0]===w&&this.size[1]===M||y),{context:N}=this,{gl:V}=N;if(this.useMipmap=!!(A&&A.useMipmap),V.bindTexture(V.TEXTURE_2D,this.texture),N.pixelStoreUnpackFlipY.set(!1),N.pixelStoreUnpack.set(1),N.pixelStoreUnpackPremultiplyAlpha.set(this.format===V.RGBA&&(!A||A.premultiply!==!1)),L)this.size=[w,M],s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.isImageBitmap(s)?V.texImage2D(V.TEXTURE_2D,0,this.format,this.format,V.UNSIGNED_BYTE,s):V.texImage2D(V.TEXTURE_2D,0,this.format,w,M,0,this.format,V.UNSIGNED_BYTE,s.data);else{const{x:$,y:Q}=y||{x:0,y:0};s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||a.isImageBitmap(s)?V.texSubImage2D(V.TEXTURE_2D,0,$,Q,V.RGBA,V.UNSIGNED_BYTE,s):V.texSubImage2D(V.TEXTURE_2D,0,$,Q,w,M,V.RGBA,V.UNSIGNED_BYTE,s.data)}this.useMipmap&&this.isSizePowerOfTwo()&&V.generateMipmap(V.TEXTURE_2D)}bind(s,A,y){const{context:w}=this,{gl:M}=w;M.bindTexture(M.TEXTURE_2D,this.texture),y!==M.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(y=M.LINEAR),s!==this.filter&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,s),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,y||s),this.filter=s),A!==this.wrap&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,A),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,A),this.wrap=A)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}function Ce(x){const{userImage:s}=x;return!!(s&&s.render&&s.render())&&(x.data.replace(new Uint8Array(s.data.buffer)),!0)}class se extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(s){if(this.loaded!==s&&(this.loaded=s,s)){for(const{ids:A,callback:y}of this.requestors)this._notify(A,y);this.requestors=[]}}getImage(s){return this.images[s]}addImage(s,A){if(this.images[s])throw new Error(`Image id ${s} already exist, use updateImage instead`);this._validate(s,A)&&(this.images[s]=A)}_validate(s,A){let y=!0;return this._validateStretch(A.stretchX,A.data&&A.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${s}" has invalid "stretchX" value`))),y=!1),this._validateStretch(A.stretchY,A.data&&A.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${s}" has invalid "stretchY" value`))),y=!1),this._validateContent(A.content,A)||(this.fire(new a.ErrorEvent(new Error(`Image "${s}" has invalid "content" value`))),y=!1),y}_validateStretch(s,A){if(!s)return!0;let y=0;for(const w of s){if(w[0]<y||w[1]<w[0]||A<w[1])return!1;y=w[1]}return!0}_validateContent(s,A){return!(s&&(s.length!==4||s[0]<0||A.data.width<s[0]||s[1]<0||A.data.height<s[1]||s[2]<0||A.data.width<s[2]||s[3]<0||A.data.height<s[3]||s[2]<s[0]||s[3]<s[1]))}updateImage(s,A){const y=this.images[s];if(y.data.width!==A.data.width||y.data.height!==A.data.height)throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${A.data.width}x${A.data.height}).`);A.version=y.version+1,this.images[s]=A,this.updatedImages[s]=!0}removeImage(s){const A=this.images[s];delete this.images[s],delete this.patterns[s],A.userImage&&A.userImage.onRemove&&A.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(s,A){let y=!0;if(!this.isLoaded())for(const w of s)this.images[w]||(y=!1);this.isLoaded()||y?this._notify(s,A):this.requestors.push({ids:s,callback:A})}_notify(s,A){const y={};for(const w of s){this.images[w]||this.fire(new a.Event("styleimagemissing",{id:w}));const M=this.images[w];M?y[w]={data:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:!!(M.userImage&&M.userImage.render)}:a.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}A(null,y)}getPixelSize(){const{width:s,height:A}=this.atlasImage;return{width:s,height:A}}getPattern(s){const A=this.patterns[s],y=this.getImage(s);if(!y)return null;if(A&&A.position.version===y.version)return A.position;if(A)A.position.version=y.version;else{const w={w:y.data.width+2,h:y.data.height+2,x:0,y:0},M=new a.ImagePosition(w,y);this.patterns[s]={bin:w,position:M}}return this._updatePatternAtlas(),this.patterns[s].position}bind(s){const A=s.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new le(s,this.atlasImage,A.RGBA),this.atlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE)}_updatePatternAtlas(){const s=[];for(const M in this.patterns)s.push(this.patterns[M].bin);const{w:A,h:y}=a.potpack(s),w=this.atlasImage;w.resize({width:A||1,height:y||1});for(const M in this.patterns){const{bin:L}=this.patterns[M],N=L.x+1,V=L.y+1,$=this.images[M].data,Q=$.width,J=$.height;a.RGBAImage.copy($,w,{x:0,y:0},{x:N,y:V},{width:Q,height:J}),a.RGBAImage.copy($,w,{x:0,y:J-1},{x:N,y:V-1},{width:Q,height:1}),a.RGBAImage.copy($,w,{x:0,y:0},{x:N,y:V+J},{width:Q,height:1}),a.RGBAImage.copy($,w,{x:Q-1,y:0},{x:N-1,y:V},{width:1,height:J}),a.RGBAImage.copy($,w,{x:0,y:0},{x:N+Q,y:V},{width:1,height:J})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(s){for(const A of s){if(this.callbackDispatchedThisFrame[A])continue;this.callbackDispatchedThisFrame[A]=!0;const y=this.images[A];y||a.warnOnce(`Image with ID: "${A}" was not found`),Ce(y)&&this.updateImage(A,y)}}}const ne=1e20;function te(x,s,A,y,w,M,L,N,V){for(let $=s;$<s+y;$++)xe(x,A*M+$,M,w,L,N,V);for(let $=A;$<A+w;$++)xe(x,$*M+s,1,y,L,N,V)}function xe(x,s,A,y,w,M,L){M[0]=0,L[0]=-ne,L[1]=ne,w[0]=x[s];for(let N=1,V=0,$=0;N<y;N++){w[N]=x[s+N*A];const Q=N*N;do{const J=M[V];$=(w[N]-w[J]+Q-J*J)/(N-J)/2}while($<=L[V]&&--V>-1);V++,M[V]=N,L[V]=$,L[V+1]=ne}for(let N=0,V=0;N<y;N++){for(;L[V+1]<N;)V++;const $=M[V],Q=N-$;x[s+N*A]=w[$]+Q*Q}}class Le{constructor(s,A){this.requestManager=s,this.localIdeographFontFamily=A,this.entries={}}setURL(s){this.url=s}getGlyphs(s,A){const y=[];for(const w in s)for(const M of s[w])y.push({stack:w,id:M});a.asyncAll(y,({stack:w,id:M},L)=>{let N=this.entries[w];N||(N=this.entries[w]={glyphs:{},requests:{},ranges:{}});let V=N.glyphs[M];if(V!==void 0)return void L(null,{stack:w,id:M,glyph:V});if(V=this._tinySDF(N,w,M),V)return N.glyphs[M]=V,void L(null,{stack:w,id:M,glyph:V});const $=Math.floor(M/256);if(256*$>65535)return void L(new Error("glyphs > 65535 not supported"));if(N.ranges[$])return void L(null,{stack:w,id:M,glyph:V});let Q=N.requests[$];Q||(Q=N.requests[$]=[],Le.loadGlyphRange(w,$,this.url,this.requestManager,(J,ce)=>{if(ce){for(const ye in ce)this._doesCharSupportLocalGlyph(+ye)||(N.glyphs[+ye]=ce[+ye]);N.ranges[$]=!0}for(const ye of Q)ye(J,ce);delete N.requests[$]})),Q.push((J,ce)=>{J?L(J):ce&&L(null,{stack:w,id:M,glyph:ce[M]||null})})},(w,M)=>{if(w)A(w);else if(M){const L={};for(const{stack:N,id:V,glyph:$}of M)(L[N]||(L[N]={}))[V]=$&&{id:$.id,bitmap:$.bitmap.clone(),metrics:$.metrics};A(null,L)}})}_doesCharSupportLocalGlyph(s){return!!this.localIdeographFontFamily&&(a.unicodeBlockLookup["CJK Unified Ideographs"](s)||a.unicodeBlockLookup["Hangul Syllables"](s)||a.unicodeBlockLookup.Hiragana(s)||a.unicodeBlockLookup.Katakana(s))}_tinySDF(s,A,y){const w=this.localIdeographFontFamily;if(!w||!this._doesCharSupportLocalGlyph(y))return;let M=s.tinySDF;if(!M){let N="400";/bold/i.test(A)?N="900":/medium/i.test(A)?N="500":/light/i.test(A)&&(N="200"),M=s.tinySDF=new Le.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:w,fontWeight:N})}const L=M.draw(String.fromCharCode(y));return{id:y,bitmap:new a.AlphaImage({width:L.width||30,height:L.height||30},L.data),metrics:{width:L.glyphWidth||24,height:L.glyphHeight||24,left:L.glyphLeft||0,top:L.glyphTop-27||-8,advance:L.glyphAdvance||24}}}}Le.loadGlyphRange=function(x,s,A,y,w){const M=256*s,L=M+255,N=y.transformRequest(A.replace("{fontstack}",x).replace("{range}",`${M}-${L}`),a.ResourceType.Glyphs);a.getArrayBuffer(N,(V,$)=>{if(V)w(V);else if($){const Q={};for(const J of a.parseGlyphPbf($))Q[J.id]=J;w(null,Q)}})},Le.TinySDF=class{constructor({fontSize:x=24,buffer:s=3,radius:A=8,cutoff:y=.25,fontFamily:w="sans-serif",fontWeight:M="normal",fontStyle:L="normal"}={}){this.buffer=s,this.cutoff=y,this.radius=A;const N=this.size=x+4*s,V=this._createCanvas(N),$=this.ctx=V.getContext("2d",{willReadFrequently:!0});$.font=`${L} ${M} ${x}px ${w}`,$.textBaseline="alphabetic",$.textAlign="left",$.fillStyle="black",this.gridOuter=new Float64Array(N*N),this.gridInner=new Float64Array(N*N),this.f=new Float64Array(N),this.z=new Float64Array(N+1),this.v=new Uint16Array(N)}_createCanvas(x){const s=document.createElement("canvas");return s.width=s.height=x,s}draw(x){const{width:s,actualBoundingBoxAscent:A,actualBoundingBoxDescent:y,actualBoundingBoxLeft:w,actualBoundingBoxRight:M}=this.ctx.measureText(x),L=Math.ceil(A),N=Math.min(this.size-this.buffer,Math.ceil(M-w)),V=Math.min(this.size-this.buffer,L+Math.ceil(y)),$=N+2*this.buffer,Q=V+2*this.buffer,J=Math.max($*Q,0),ce=new Uint8ClampedArray(J),ye={data:ce,width:$,height:Q,glyphWidth:N,glyphHeight:V,glyphTop:L,glyphLeft:0,glyphAdvance:s};if(N===0||V===0)return ye;const{ctx:_e,buffer:oe,gridInner:ge,gridOuter:De}=this;_e.clearRect(oe,oe,N,V),_e.fillText(x,oe,oe+L);const Ve=_e.getImageData(oe,oe,N,V);De.fill(ne,0,J),ge.fill(0,0,J);for(let Ee=0;Ee<V;Ee++)for(let Ze=0;Ze<N;Ze++){const je=Ve.data[4*(Ee*N+Ze)+3]/255;if(je===0)continue;const tt=(Ee+oe)*$+Ze+oe;if(je===1)De[tt]=0,ge[tt]=ne;else{const Ke=.5-je;De[tt]=Ke>0?Ke*Ke:0,ge[tt]=Ke<0?Ke*Ke:0}}te(De,0,0,$,Q,$,this.f,this.v,this.z),te(ge,oe,oe,N,V,$,this.f,this.v,this.z);for(let Ee=0;Ee<J;Ee++){const Ze=Math.sqrt(De[Ee])-Math.sqrt(ge[Ee]);ce[Ee]=Math.round(255-255*(Ze/this.radius+this.cutoff))}return ye}};const Ge=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(x,s){return a.sphericalToCartesian(x.expression.evaluate(s))}interpolate(x,s,A){return{x:a.number(x.x,s.x,A),y:a.number(x.y,s.y,A),z:a.number(x.z,s.z,A)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),nt="-transition";class it extends a.Evented{constructor(s){super(),this._transitionable=new a.Transitionable(Ge),this.setLight(s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,A={}){if(!this._validate(a.validateLight,s,A))for(const y in s){const w=s[y];y.endsWith(nt)?this._transitionable.setTransition(y.slice(0,-nt.length),w):this._transitionable.setValue(y,w)}}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,A,y){return(!y||y.validate!==!1)&&a.emitValidationErrors(this,s.call(a.validateStyle,a.extend({value:A,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class dt{constructor(s,A){this.width=s,this.height=A,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(s,A){const y=s.join(",")+String(A);return this.dashEntry[y]||(this.dashEntry[y]=this.addDash(s,A)),this.dashEntry[y]}getDashRanges(s,A,y){const w=[];let M=s.length%2==1?-s[s.length-1]*y:0,L=s[0]*y,N=!0;w.push({left:M,right:L,isDash:N,zeroLength:s[0]===0});let V=s[0];for(let $=1;$<s.length;$++){N=!N;const Q=s[$];M=V*y,V+=Q,L=V*y,w.push({left:M,right:L,isDash:N,zeroLength:Q===0})}return w}addRoundDash(s,A,y){const w=A/2;for(let M=-y;M<=y;M++){const L=this.width*(this.nextRow+y+M);let N=0,V=s[N];for(let $=0;$<this.width;$++){$/V.right>1&&(V=s[++N]);const Q=Math.abs($-V.left),J=Math.abs($-V.right),ce=Math.min(Q,J);let ye;const _e=M/y*(w+1);if(V.isDash){const oe=w-Math.abs(_e);ye=Math.sqrt(ce*ce+oe*oe)}else ye=w-Math.sqrt(ce*ce+_e*_e);this.data[L+$]=Math.max(0,Math.min(255,ye+128))}}}addRegularDash(s){for(let N=s.length-1;N>=0;--N){const V=s[N],$=s[N+1];V.zeroLength?s.splice(N,1):$&&$.isDash===V.isDash&&($.left=V.left,s.splice(N,1))}const A=s[0],y=s[s.length-1];A.isDash===y.isDash&&(A.left=y.left-this.width,y.right=A.right+this.width);const w=this.width*this.nextRow;let M=0,L=s[M];for(let N=0;N<this.width;N++){N/L.right>1&&(L=s[++M]);const V=Math.abs(N-L.left),$=Math.abs(N-L.right),Q=Math.min(V,$);this.data[w+N]=Math.max(0,Math.min(255,(L.isDash?Q:-Q)+128))}}addDash(s,A){const y=A?7:0,w=2*y+1;if(this.nextRow+w>this.height)return a.warnOnce("LineAtlas out of space"),null;let M=0;for(let N=0;N<s.length;N++)M+=s[N];if(M!==0){const N=this.width/M,V=this.getDashRanges(s,this.width,N);A?this.addRoundDash(V,N,y):this.addRegularDash(V)}const L={y:(this.nextRow+y+.5)/this.height,height:2*y/this.height,width:M};return this.nextRow+=w,this.dirty=!0,L}bind(s){const A=s.gl;this.texture?(A.bindTexture(A.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,A.texSubImage2D(A.TEXTURE_2D,0,0,0,this.width,this.height,A.ALPHA,A.UNSIGNED_BYTE,this.data))):(this.texture=A.createTexture(),A.bindTexture(A.TEXTURE_2D,this.texture),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.REPEAT),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.REPEAT),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR),A.texImage2D(A.TEXTURE_2D,0,A.ALPHA,this.width,this.height,0,A.ALPHA,A.UNSIGNED_BYTE,this.data))}}class ct{constructor(s,A){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const y=this.workerPool.acquire(this.id);for(let w=0;w<y.length;w++){const M=new ct.Actor(y[w],A,this.id);M.name=`Worker ${w}`,this.actors.push(M)}if(!this.actors.length)throw new Error("No actors found")}broadcast(s,A,y){a.asyncAll(this.actors,(w,M)=>{w.send(s,A,M)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Xe(x,s,A){const y=function(w,M){if(w)return A(w);if(M){const L=a.pick(a.extend(M,x),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(L.vectorLayers=M.vector_layers,L.vectorLayerIds=L.vectorLayers.map(N=>N.id)),A(null,L)}};return x.url?a.getJSON(s.transformRequest(x.url,a.ResourceType.Source),y):a.exported.frame(()=>y(null,x))}ct.Actor=a.Actor;class Bt{constructor(s,A,y){this.bounds=a.LngLatBounds.convert(this.validateBounds(s)),this.minzoom=A||0,this.maxzoom=y||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const A=Math.pow(2,s.z),y=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*A),w=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*A),M=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*A),L=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*A);return s.x>=y&&s.x<M&&s.y>=w&&s.y<L}}class Rt extends a.Evented{constructor(s,A,y,w){if(super(),this.id=s,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(A,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},A),this._collectResourceTiming=A.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w)}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Xe(this._options,this.map._requestManager,(s,A)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),s?this.fire(new a.ErrorEvent(s)):A&&(a.extend(this,A),A.bounds&&(this.tileBounds=new Bt(A.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}setSourceProperty(s){this._tileJSONRequest&&this._tileJSONRequest.cancel(),s(),this.load()}setTiles(s){return this.setSourceProperty(()=>{this._options.tiles=s}),this}setUrl(s){return this.setSourceProperty(()=>{this.url=s,this._options.url=s}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(s,A){const y=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),w={request:this.map._requestManager.transformRequest(y,a.ResourceType.Tile),uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function M(L,N){return delete s.request,s.aborted?A(null):L&&L.status!==404?A(L):(N&&N.resourceTiming&&(s.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&N&&s.setExpiryData(N),s.loadVectorData(N,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),A(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}w.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired"?s.state==="loading"?s.reloadCallback=A:s.request=s.actor.send("reloadTile",w,M.bind(this)):(s.actor=this.dispatcher.getActor(),s.request=s.actor.send("loadTile",w,M.bind(this)))}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id},void 0)}unloadTile(s){s.unloadVectorData(),s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class jt extends a.Evented{constructor(s,A,y,w){super(),this.id=s,this.dispatcher=y,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},A),a.extend(this,a.pick(A,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Xe(this._options,this.map._requestManager,(s,A)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new a.ErrorEvent(s)):A&&(a.extend(this,A),A.bounds&&(this.tileBounds=new Bt(A.bounds,this.minzoom,this.maxzoom)),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,A){const y=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);s.request=a.getImage(this.map._requestManager.transformRequest(y,a.ResourceType.Tile),(w,M,L)=>{if(delete s.request,s.aborted)s.state="unloaded",A(null);else if(w)s.state="errored",A(w);else if(M){this.map._refreshExpiredTiles&&s.setExpiryData(L);const N=this.map.painter.context,V=N.gl;s.texture=this.map.painter.getTileTexture(M.width),s.texture?s.texture.update(M,{useMipmap:!0}):(s.texture=new le(N,M,V.RGBA,{useMipmap:!0}),s.texture.bind(V.LINEAR,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),N.extTextureFilterAnisotropic&&V.texParameterf(V.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax)),s.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),A(null)}})}abortTile(s,A){s.request&&(s.request.cancel(),delete s.request),A()}unloadTile(s,A){s.texture&&this.map.painter.saveTileTexture(s.texture),A()}hasTransition(){return!1}}let _n;class Mt extends jt{constructor(s,A,y,w){super(s,A,y,w),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},A),this.encoding=A.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(s,A){const y=s.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function w(M,L){M&&(s.state="errored",A(M)),L&&(s.dem=L,s.needsHillshadePrepare=!0,s.needsTerrainPrepare=!0,s.state="loaded",A(null))}s.request=a.getImage(this.map._requestManager.transformRequest(y,a.ResourceType.Tile),(function(M,L){if(delete s.request,s.aborted)s.state="unloaded",A(null);else if(M)s.state="errored",A(M);else if(L){this.map._refreshExpiredTiles&&s.setExpiryData(L),delete L.cacheControl,delete L.expires;const N=a.isImageBitmap(L)&&(_n==null&&(_n=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),_n)?L:a.exported.getImageData(L,1),V={uid:s.uid,coord:s.tileID,source:this.id,rawImageData:N,encoding:this.encoding};s.actor&&s.state!=="expired"||(s.actor=this.dispatcher.getActor(),s.actor.send("loadDEMTile",V,w.bind(this)))}}).bind(this)),s.neighboringTiles=this._getNeighboringTiles(s.tileID)}_getNeighboringTiles(s){const A=s.canonical,y=Math.pow(2,A.z),w=(A.x-1+y)%y,M=A.x===0?s.wrap-1:s.wrap,L=(A.x+1+y)%y,N=A.x+1===y?s.wrap+1:s.wrap,V={};return V[new a.OverscaledTileID(s.overscaledZ,M,A.z,w,A.y).key]={backfilled:!1},V[new a.OverscaledTileID(s.overscaledZ,N,A.z,L,A.y).key]={backfilled:!1},A.y>0&&(V[new a.OverscaledTileID(s.overscaledZ,M,A.z,w,A.y-1).key]={backfilled:!1},V[new a.OverscaledTileID(s.overscaledZ,s.wrap,A.z,A.x,A.y-1).key]={backfilled:!1},V[new a.OverscaledTileID(s.overscaledZ,N,A.z,L,A.y-1).key]={backfilled:!1}),A.y+1<y&&(V[new a.OverscaledTileID(s.overscaledZ,M,A.z,w,A.y+1).key]={backfilled:!1},V[new a.OverscaledTileID(s.overscaledZ,s.wrap,A.z,A.x,A.y+1).key]={backfilled:!1},V[new a.OverscaledTileID(s.overscaledZ,N,A.z,L,A.y+1).key]={backfilled:!1}),V}unloadTile(s){s.demTexture&&this.map.painter.saveTileTexture(s.demTexture),s.fbo&&(s.fbo.destroy(),delete s.fbo),s.dem&&delete s.dem,delete s.neighboringTiles,s.state="unloaded",s.actor&&s.actor.send("removeDEMTile",{uid:s.uid,source:this.id})}}class Sn extends a.Evented{constructor(s,A,y,w){super(),this.id=s,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=y.getActor(),this.setEventedParent(w),this._data=A.data,this._options=a.extend({},A),this._collectResourceTiming=A.collectResourceTiming,A.maxzoom!==void 0&&(this.maxzoom=A.maxzoom),A.type&&(this.type=A.type),A.attribution&&(this.attribution=A.attribution),this.promoteId=A.promoteId;const M=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:A.cluster||!1,geojsonVtOptions:{buffer:(A.buffer!==void 0?A.buffer:128)*M,tolerance:(A.tolerance!==void 0?A.tolerance:.375)*M,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:A.lineMetrics||!1,generateId:A.generateId||!1},superclusterOptions:{maxZoom:A.clusterMaxZoom!==void 0?A.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,A.clusterMinPoints||2),extent:a.EXTENT,radius:(A.clusterRadius||50)*M,log:!1,generateId:A.generateId||!1},clusterProperties:A.clusterProperties,filter:A.filter},A.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(s){this.map=s,this.load()}setData(s){return this._data=s,this._updateWorkerData("content"),this}getClusterExpansionZoom(s,A){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:s,source:this.id},A),this}getClusterChildren(s,A){return this.actor.send("geojson.getClusterChildren",{clusterId:s,source:this.id},A),this}getClusterLeaves(s,A,y,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:s,limit:A,offset:y},w),this}_updateWorkerData(s){const A=a.extend({},this.workerOptions),y=this._data;typeof y=="string"?(A.request=this.map._requestManager.transformRequest(a.exported.resolveURL(y),a.ResourceType.Source),A.request.collectResourceTiming=this._collectResourceTiming):A.data=JSON.stringify(y),this._pendingLoads++,this.fire(new a.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,A,(w,M)=>{if(this._pendingLoads--,this._removed||M&&M.abandoned)return void this.fire(new a.Event("dataabort",{dataType:"source",sourceDataType:s}));let L=null;if(M&&M.resourceTiming&&M.resourceTiming[this.id]&&(L=M.resourceTiming[this.id].slice(0)),w)return void this.fire(new a.ErrorEvent(w));const N={dataType:"source",sourceDataType:s};this._collectResourceTiming&&L&&L.length>0&&a.extend(N,{resourceTiming:L}),this.fire(new a.Event("data",N))})}loaded(){return this._pendingLoads===0}loadTile(s,A){const y=s.actor?"reloadTile":"loadTile";s.actor=this.actor;const w={type:this.type,uid:s.uid,tileID:s.tileID,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};s.request=this.actor.send(y,w,(M,L)=>(delete s.request,s.unloadVectorData(),s.aborted?A(null):M?A(M):(s.loadVectorData(L,this.map.painter,y==="reloadTile"),A(null))))}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.aborted=!0}unloadTile(s){s.unloadVectorData(),this.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var pt=a.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class It extends a.Evented{constructor(s,A,y,w){super(),this.id=s,this.dispatcher=y,this.coordinates=A.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=A}load(s,A){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(y,w)=>{this._loaded=!0,y?this.fire(new a.ErrorEvent(y)):w&&(this.image=w,s&&(this.coordinates=s),A&&A(),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return this.image&&s.url?(this.options.url=s.url,this.load(s.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}setCoordinates(s){this.coordinates=s;const A=s.map(a.MercatorCoordinate.fromLngLat);this.tileID=function(w){let M=1/0,L=1/0,N=-1/0,V=-1/0;for(const ce of w)M=Math.min(M,ce.x),L=Math.min(L,ce.y),N=Math.max(N,ce.x),V=Math.max(V,ce.y);const $=Math.max(N-M,V-L),Q=Math.max(0,Math.floor(-Math.log($)/Math.LN2)),J=Math.pow(2,Q);return new a.CanonicalTileID(Q,Math.floor((M+N)/2*J),Math.floor((L+V)/2*J))}(A),this.minzoom=this.maxzoom=this.tileID.z;const y=A.map(w=>this.tileID.getTilePoint(w)._round());return this._boundsArray=new a.RasterBoundsArray,this._boundsArray.emplaceBack(y[0].x,y[0].y,0,0),this._boundsArray.emplaceBack(y[1].x,y[1].y,a.EXTENT,0),this._boundsArray.emplaceBack(y[3].x,y[3].y,0,a.EXTENT),this._boundsArray.emplaceBack(y[2].x,y[2].y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const s=this.map.painter.context,A=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new le(s,this.image,A.RGBA),this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE));for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}loadTile(s,A){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},A(null)):(s.state="errored",A(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Jt extends It{constructor(s,A,y,w){super(s,A,y,w),this.roundZoom=!0,this.type="video",this.options=A}load(){this._loaded=!1;const s=this.options;this.urls=[];for(const A of s.urls)this.urls.push(this.map._requestManager.transformRequest(A,a.ResourceType.Source).url);a.getVideo(this.urls,(A,y)=>{this._loaded=!0,A?this.fire(new a.ErrorEvent(A)):y&&(this.video=y,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(s){if(this.video){const A=this.video.seekable;s<A.start(0)||s>A.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${A.start(0)} and ${A.end(0)}-second mark.`))):this.video.currentTime=s}}getVideo(){return this.video}onAdd(s){this.map||(this.map=s,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const s=this.map.painter.context,A=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE),A.texSubImage2D(A.TEXTURE_2D,0,0,0,A.RGBA,A.UNSIGNED_BYTE,this.video)):(this.texture=new le(s,this.video,A.RGBA),this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE));for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class kn extends It{constructor(s,A,y,w){super(s,A,y,w),A.coordinates?Array.isArray(A.coordinates)&&A.coordinates.length===4&&!A.coordinates.some(M=>!Array.isArray(M)||M.length!==2||M.some(L=>typeof L!="number"))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${s}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${s}`,null,'missing required property "coordinates"'))),A.animate&&typeof A.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${s}`,null,'optional "animate" property must be a boolean value'))),A.canvas?typeof A.canvas=="string"||A.canvas instanceof HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${s}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${s}`,null,'missing required property "canvas"'))),this.options=A,this.animate=A.animate===void 0||A.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(s){this.map=s,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let s=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,s=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,s=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const A=this.map.painter.context,y=A.gl;this.boundsBuffer||(this.boundsBuffer=A.createVertexBuffer(this._boundsArray,pt.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(s||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new le(A,this.canvas,y.RGBA,{premultiply:!0});for(const w in this.tiles){const M=this.tiles[w];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const s of[this.canvas.width,this.canvas.height])if(isNaN(s)||s<=0)return!0;return!1}}const Mn={vector:Rt,raster:jt,"raster-dem":Mt,geojson:Sn,video:Jt,image:It,canvas:kn};function ri(x,s){const A=a.create();return a.translate(A,A,[1,1,0]),a.scale(A,A,[.5*x.width,.5*x.height,1]),a.multiply(A,A,x.calculatePosMatrix(s.toUnwrapped()))}function oi(x,s,A,y,w,M){const L=function(J,ce,ye){if(J)for(const _e of J){const oe=ce[_e];if(oe&&oe.source===ye&&oe.type==="fill-extrusion")return!0}else for(const _e in ce){const oe=ce[_e];if(oe.source===ye&&oe.type==="fill-extrusion")return!0}return!1}(w&&w.layers,s,x.id),N=M.maxPitchScaleFactor(),V=x.tilesIn(y,N,L);V.sort(Ri);const $=[];for(const J of V)$.push({wrappedTileID:J.tileID.wrapped().key,queryResults:J.tile.queryRenderedFeatures(s,A,x._state,J.queryGeometry,J.cameraQueryGeometry,J.scale,w,M,N,ri(x.transform,J.tileID))});const Q=function(J){const ce={},ye={};for(const _e of J){const oe=_e.queryResults,ge=_e.wrappedTileID,De=ye[ge]=ye[ge]||{};for(const Ve in oe){const Ee=oe[Ve],Ze=De[Ve]=De[Ve]||{},je=ce[Ve]=ce[Ve]||[];for(const tt of Ee)Ze[tt.featureIndex]||(Ze[tt.featureIndex]=!0,je.push(tt))}}return ce}($);for(const J in Q)Q[J].forEach(ce=>{const ye=ce.feature,_e=x.getFeatureState(ye.layer["source-layer"],ye.id);ye.source=ye.layer.source,ye.layer["source-layer"]&&(ye.sourceLayer=ye.layer["source-layer"]),ye.state=_e});return Q}function Ri(x,s){const A=x.tileID,y=s.tileID;return A.overscaledZ-y.overscaledZ||A.canonical.y-y.canonical.y||A.wrap-y.wrap||A.canonical.x-y.canonical.x}class Ai{constructor(s,A){this.tileID=s,this.uid=a.uniqueId(),this.uses=0,this.tileSize=A,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(s){const A=s+this.timeAdded;A<a.exported.now()||this.fadeEndTime&&A<this.fadeEndTime||(this.fadeEndTime=A)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(s){this.demTexture&&s.saveTileTexture(this.demTexture),this.textures.forEach(A=>s.saveTileTexture(A)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(s,A,y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(w,M){const L={};if(!M)return L;for(const N of w){const V=N.layerIds.map($=>M.getLayer($)).filter(Boolean);if(V.length!==0){N.layers=V,N.stateDependentLayerIds&&(N.stateDependentLayers=N.stateDependentLayerIds.map($=>V.filter(Q=>Q.id===$)[0]));for(const $ of V)L[$.id]=N}}return L}(s.buckets,A.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const M=this.buckets[w];if(M instanceof a.SymbolBucket){if(this.hasSymbolBuckets=!0,!y)break;M.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const M=this.buckets[w];if(M instanceof a.SymbolBucket&&M.hasRTLText){this.hasRTLText=!0,a.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const w in this.buckets){const M=this.buckets[w];this.queryPadding=Math.max(this.queryPadding,A.style.getLayer(w).queryRadius(M))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage)}else this.collisionBoxArray=new a.CollisionBoxArray}unloadVectorData(){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(s){return this.buckets[s.id]}upload(s){for(const y in this.buckets){const w=this.buckets[y];w.uploadPending()&&w.upload(s)}const A=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new le(s,this.imageAtlas.image,A.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new le(s,this.glyphAtlasImage,A.ALPHA),this.glyphAtlasImage=null)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,A,y,w,M,L,N,V,$,Q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:w,cameraQueryGeometry:M,scale:L,tileSize:this.tileSize,pixelPosMatrix:Q,transform:V,params:N,queryPadding:this.queryPadding*$},s,A,y):{}}querySourceFeatures(s,A){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const w=y.loadVTLayers(),M=A?A.sourceLayer:"",L=w._geojsonTileLayer||w[M];if(!L)return;const N=a.createFilter(A&&A.filter),{z:V,x:$,y:Q}=this.tileID.canonical,J={z:V,x:$,y:Q};for(let ce=0;ce<L.length;ce++){const ye=L.feature(ce);if(N.needGeometry){const ge=a.toEvaluationFeature(ye,!0);if(!N.filter(new a.EvaluationParameters(this.tileID.overscaledZ),ge,this.tileID.canonical))continue}else if(!N.filter(new a.EvaluationParameters(this.tileID.overscaledZ),ye))continue;const _e=y.getId(ye,M),oe=new a.GeoJSONFeature(ye,V,$,Q,_e);oe.tile=J,s.push(oe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const A=this.expirationTime;if(s.cacheControl){const y=a.parseCacheControl(s.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const y=Date.now();let w=!1;if(this.expirationTime>y)w=!1;else if(A)if(this.expirationTime<A)w=!0;else{const M=this.expirationTime-A;M?this.expirationTime=y+Math.max(M,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(s,A){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(s).length===0)return;const y=this.latestFeatureIndex.loadVTLayers();for(const w in this.buckets){if(!A.style.hasLayer(w))continue;const M=this.buckets[w],L=M.layers[0].sourceLayer||"_geojsonTileLayer",N=y[L],V=s[L];if(!N||!V||Object.keys(V).length===0)continue;M.update(V,N,this.imageAtlas&&this.imageAtlas.patternPositions||{});const $=A&&A.style&&A.style.getLayer(w);$&&(this.queryPadding=Math.max(this.queryPadding,$.queryRadius(M)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=a.exported.now()+s}setDependencies(s,A){const y={};for(const w of A)y[w]=!0;this.dependencies[s]=y}hasDependency(s,A){for(const y of s){const w=this.dependencies[y];if(w){for(const M of A)if(w[M])return!0}}return!1}}class Nn{constructor(s,A){this.max=s,this.onRemove=A,this.reset()}reset(){for(const s in this.data)for(const A of this.data[s])A.timeout&&clearTimeout(A.timeout),this.onRemove(A.value);return this.data={},this.order=[],this}add(s,A,y){const w=s.wrapped().key;this.data[w]===void 0&&(this.data[w]=[]);const M={value:A,timeout:void 0};if(y!==void 0&&(M.timeout=setTimeout(()=>{this.remove(s,M)},y)),this.data[w].push(M),this.order.push(w),this.order.length>this.max){const L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const A=this.data[s].shift();return A.timeout&&clearTimeout(A.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),A.value}getByKey(s){const A=this.data[s];return A?A[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,A){if(!this.has(s))return this;const y=s.wrapped().key,w=A===void 0?0:this.data[y].indexOf(A),M=this.data[y][w];return this.data[y].splice(w,1),M.timeout&&clearTimeout(M.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(M.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}filter(s){const A=[];for(const y in this.data)for(const w of this.data[y])s(w.value)||A.push(w);for(const y of A)this.remove(y.value.tileID,y)}}class Di{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,A,y){const w=String(A);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][w]=this.stateChanges[s][w]||{},a.extend(this.stateChanges[s][w],y),this.deletedStates[s]===null){this.deletedStates[s]={};for(const M in this.state[s])M!==w&&(this.deletedStates[s][M]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][w]===null){this.deletedStates[s][w]={};for(const M in this.state[s][w])y[M]||(this.deletedStates[s][w][M]=null)}else for(const M in y)this.deletedStates[s]&&this.deletedStates[s][w]&&this.deletedStates[s][w][M]===null&&delete this.deletedStates[s][w][M]}removeFeatureState(s,A,y){if(this.deletedStates[s]===null)return;const w=String(A);if(this.deletedStates[s]=this.deletedStates[s]||{},y&&A!==void 0)this.deletedStates[s][w]!==null&&(this.deletedStates[s][w]=this.deletedStates[s][w]||{},this.deletedStates[s][w][y]=null);else if(A!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][w])for(y in this.deletedStates[s][w]={},this.stateChanges[s][w])this.deletedStates[s][w][y]=null;else this.deletedStates[s][w]=null;else this.deletedStates[s]=null}getState(s,A){const y=String(A),w=a.extend({},(this.state[s]||{})[y],(this.stateChanges[s]||{})[y]);if(this.deletedStates[s]===null)return{};if(this.deletedStates[s]){const M=this.deletedStates[s][A];if(M===null)return{};for(const L in M)delete w[L]}return w}initializeTileState(s,A){s.setFeatureState(this.state,A)}coalesceChanges(s,A){const y={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const M={};for(const L in this.stateChanges[w])this.state[w][L]||(this.state[w][L]={}),a.extend(this.state[w][L],this.stateChanges[w][L]),M[L]=this.state[w][L];y[w]=M}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const M={};if(this.deletedStates[w]===null)for(const L in this.state[w])M[L]={},this.state[w][L]={};else for(const L in this.deletedStates[w]){if(this.deletedStates[w][L]===null)this.state[w][L]={};else for(const N of Object.keys(this.deletedStates[w][L]))delete this.state[w][L][N];M[L]=this.state[w][L]}y[w]=y[w]||{},a.extend(y[w],M)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const w in s)s[w].setFeatureState(y,A)}}class yn extends a.Evented{constructor(s,A,y){super(),this.id=s,this.dispatcher=y,this.on("data",w=>{w.dataType==="source"&&w.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&w.dataType==="source"&&w.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(w,M,L,N){const V=new Mn[M.type](w,M,L,N);if(V.id!==w)throw new Error(`Expected Source id to be ${w} instead of ${V.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],V),V}(s,A,y,this),this._tiles={},this._cache=new Nn(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Di}onAdd(s){this.map=s,this._maxTileCacheSize=s?s._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(s)}onRemove(s){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(s)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const A=this._tiles[s];if(A.state!=="loaded"&&A.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(s,A){return this._source.loadTile(s,A)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){this._source.abortTile&&this._source.abortTile(s,()=>{}),this._source.fire(new a.Event("dataabort",{tile:s,coord:s.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const A in this._tiles){const y=this._tiles[A];y.upload(s),y.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(s=>s.tileID).sort(qn).map(s=>s.key)}getRenderableIds(s){const A=[];for(const y in this._tiles)this._isIdRenderable(y,s)&&A.push(this._tiles[y]);return s?A.sort((y,w)=>{const M=y.tileID,L=w.tileID,N=new a.pointGeometry(M.canonical.x,M.canonical.y)._rotate(this.transform.angle),V=new a.pointGeometry(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return M.overscaledZ-L.overscaledZ||V.y-N.y||V.x-N.x}).map(y=>y.tileID.key):A.map(y=>y.tileID).sort(qn).map(y=>y.key)}hasRenderableParent(s){const A=this.findLoadedParent(s,0);return!!A&&this._isIdRenderable(A.tileID.key)}_isIdRenderable(s,A){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(A||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(s,"reloading")}}_reloadTile(s,A){const y=this._tiles[s];y&&(y.state!=="loading"&&(y.state=A),this._loadTile(y,this._tileLoaded.bind(this,y,s,A)))}_tileLoaded(s,A,y,w){if(w)return s.state="errored",void(w.status!==404?this._source.fire(new a.ErrorEvent(w,{tile:s})):this.update(this.transform,this.terrain));s.timeAdded=a.exported.now(),y==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(A,s),this.getSource().type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),s.aborted||this._source.fire(new a.Event("data",{dataType:"source",tile:s,coord:s.tileID}))}_backfillDEM(s){const A=this.getRenderableIds();for(let w=0;w<A.length;w++){const M=A[w];if(s.neighboringTiles&&s.neighboringTiles[M]){const L=this.getTileByID(M);y(s,L),y(L,s)}}function y(w,M){w.needsHillshadePrepare=!0,w.needsTerrainPrepare=!0;let L=M.tileID.canonical.x-w.tileID.canonical.x;const N=M.tileID.canonical.y-w.tileID.canonical.y,V=Math.pow(2,w.tileID.canonical.z),$=M.tileID.key;L===0&&N===0||Math.abs(N)>1||(Math.abs(L)>1&&(Math.abs(L+V)===1?L+=V:Math.abs(L-V)===1&&(L-=V)),M.dem&&w.dem&&(w.dem.backfillBorder(M.dem,L,N),w.neighboringTiles&&w.neighboringTiles[$]&&(w.neighboringTiles[$].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,A,y,w){for(const M in this._tiles){let L=this._tiles[M];if(w[M]||!L.hasData()||L.tileID.overscaledZ<=A||L.tileID.overscaledZ>y)continue;let N=L.tileID;for(;L&&L.tileID.overscaledZ>A+1;){const $=L.tileID.scaledTo(L.tileID.overscaledZ-1);L=this._tiles[$.key],L&&L.hasData()&&(N=$)}let V=N;for(;V.overscaledZ>A;)if(V=V.scaledTo(V.overscaledZ-1),s[V.key]){w[N.key]=N;break}}}findLoadedParent(s,A){if(s.key in this._loadedParentTiles){const y=this._loadedParentTiles[s.key];return y&&y.tileID.overscaledZ>=A?y:null}for(let y=s.overscaledZ-1;y>=A;y--){const w=s.scaledTo(y),M=this._getLoadedTile(w);if(M)return M}}_getLoadedTile(s){const A=this._tiles[s.key];return A&&A.hasData()?A:this._cache.getByKey(s.wrapped().key)}updateCacheSize(s){const A=Math.ceil(s.width/this._source.tileSize)+1,y=Math.ceil(s.height/this._source.tileSize)+1,w=Math.floor(A*y*5),M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(M)}handleWrapJump(s){const A=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,A){const y={};for(const w in this._tiles){const M=this._tiles[w];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+A),y[M.tileID.key]=M}this._tiles=y;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(w,this._tiles[w])}}update(s,A){if(this.transform=s,this.terrain=A,!this._sourceLoaded||this._paused)return;let y;this.updateCacheSize(s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?y=s.getVisibleUnwrappedCoordinates(this._source.tileID).map($=>new a.OverscaledTileID($.canonical.z,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y)):(y=s.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:A}),this._source.hasTile&&(y=y.filter($=>this._source.hasTile($)))):y=[];const w=s.coveringZoomLevel(this._source),M=Math.max(w-yn.maxOverzooming,this._source.minzoom),L=Math.max(w+yn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const $={};for(const Q of y)if(Q.canonical.z>this._source.minzoom){const J=Q.scaledTo(Q.canonical.z-1);$[J.key]=J;const ce=Q.scaledTo(Math.max(this._source.minzoom,Math.min(Q.canonical.z,5)));$[ce.key]=ce}y=y.concat(Object.values($))}const N=this._updateRetainedTiles(y,w);if(Xi(this._source.type)){const $={},Q={},J=Object.keys(N);for(const ce of J){const ye=N[ce],_e=this._tiles[ce];if(!_e||_e.fadeEndTime&&_e.fadeEndTime<=a.exported.now())continue;const oe=this.findLoadedParent(ye,M);oe&&(this._addTile(oe.tileID),$[oe.tileID.key]=oe.tileID),Q[ce]=ye}this._retainLoadedChildren(Q,w,L,N);for(const ce in $)N[ce]||(this._coveredTiles[ce]=!0,N[ce]=$[ce]);if(A){const ce={},ye={};for(const _e of y)this._tiles[_e.key].hasData()?ce[_e.key]=_e:ye[_e.key]=_e;for(const _e in ye){const oe=ye[_e].children(this._source.maxzoom);this._tiles[oe[0].key]&&this._tiles[oe[1].key]&&this._tiles[oe[2].key]&&this._tiles[oe[3].key]&&(ce[oe[0].key]=N[oe[0].key]=oe[0],ce[oe[1].key]=N[oe[1].key]=oe[1],ce[oe[2].key]=N[oe[2].key]=oe[2],ce[oe[3].key]=N[oe[3].key]=oe[3],delete ye[_e])}for(const _e in ye){const oe=this.findLoadedParent(ye[_e],this._source.minzoom);if(oe){ce[oe.tileID.key]=N[oe.tileID.key]=oe.tileID;for(const ge in ce)ce[ge].isChildOf(oe.tileID)&&delete ce[ge]}}for(const _e in this._tiles)ce[_e]||(this._coveredTiles[_e]=!0)}}for(const $ in N)this._tiles[$].clearFadeHold();const V=a.keysDifference(this._tiles,N);for(const $ of V){const Q=this._tiles[$];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile($)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(s)}_updateRetainedTiles(s,A){const y={},w={},M=Math.max(A-yn.maxOverzooming,this._source.minzoom),L=Math.max(A+yn.maxUnderzooming,this._source.minzoom),N={};for(const V of s){const $=this._addTile(V);y[V.key]=V,$.hasData()||A<this._source.maxzoom&&(N[V.key]=V)}this._retainLoadedChildren(N,A,L,y);for(const V of s){let $=this._tiles[V.key];if($.hasData())continue;if(A+1>this._source.maxzoom){const J=V.children(this._source.maxzoom)[0],ce=this.getTile(J);if(ce&&ce.hasData()){y[J.key]=J;continue}}else{const J=V.children(this._source.maxzoom);if(y[J[0].key]&&y[J[1].key]&&y[J[2].key]&&y[J[3].key])continue}let Q=$.wasRequested();for(let J=V.overscaledZ-1;J>=M;--J){const ce=V.scaledTo(J);if(w[ce.key]||(w[ce.key]=!0,$=this.getTile(ce),!$&&Q&&($=this._addTile(ce)),$&&(y[ce.key]=ce,Q=$.wasRequested(),$.hasData())))break}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const A=[];let y,w=this._tiles[s].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){y=this._loadedParentTiles[w.key];break}A.push(w.key);const M=w.scaledTo(w.overscaledZ-1);if(y=this._getLoadedTile(M),y)break;w=M}for(const M of A)this._loadedParentTiles[M]=y}}_addTile(s){let A=this._tiles[s.key];if(A)return A;A=this._cache.getAndRemove(s),A&&(this._setTileReloadTimer(s.key,A),A.tileID=s,this._state.initializeTileState(A,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,A)));const y=A;return A||(A=new Ai(s,this._source.tileSize*s.overscaleFactor()),this._loadTile(A,this._tileLoaded.bind(this,A,s.key,A.state))),A.uses++,this._tiles[s.key]=A,y||this._source.fire(new a.Event("dataloading",{tile:A,coord:A.tileID,dataType:"source"})),A}_setTileReloadTimer(s,A){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const y=A.getExpiryTimeout();y&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},y))}_removeTile(s){const A=this._tiles[s];A&&(A.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),A.uses>0||(A.hasData()&&A.state!=="reloading"?this._cache.add(A.tileID,A,A.getExpiryTimeout()):(A.aborted=!0,this._abortTile(A),this._unloadTile(A))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(s);this._cache.reset()}tilesIn(s,A,y){const w=[],M=this.transform;if(!M)return w;const L=y?M.getCameraQueryGeometry(s):s,N=s.map(_e=>M.pointCoordinate(_e,this.terrain)),V=L.map(_e=>M.pointCoordinate(_e,this.terrain)),$=this.getIds();let Q=1/0,J=1/0,ce=-1/0,ye=-1/0;for(const _e of V)Q=Math.min(Q,_e.x),J=Math.min(J,_e.y),ce=Math.max(ce,_e.x),ye=Math.max(ye,_e.y);for(let _e=0;_e<$.length;_e++){const oe=this._tiles[$[_e]];if(oe.holdingForFade())continue;const ge=oe.tileID,De=Math.pow(2,M.zoom-oe.tileID.overscaledZ),Ve=A*oe.queryPadding*a.EXTENT/oe.tileSize/De,Ee=[ge.getTilePoint(new a.MercatorCoordinate(Q,J)),ge.getTilePoint(new a.MercatorCoordinate(ce,ye))];if(Ee[0].x-Ve<a.EXTENT&&Ee[0].y-Ve<a.EXTENT&&Ee[1].x+Ve>=0&&Ee[1].y+Ve>=0){const Ze=N.map(tt=>ge.getTilePoint(tt)),je=V.map(tt=>ge.getTilePoint(tt));w.push({tile:oe,tileID:ge,queryGeometry:Ze,cameraQueryGeometry:je,scale:De})}}return w}getVisibleCoordinates(s){const A=this.getRenderableIds(s).map(y=>this._tiles[y].tileID);for(const y of A)y.posMatrix=this.transform.calculatePosMatrix(y.toUnwrapped());return A}hasTransition(){if(this._source.hasTransition())return!0;if(Xi(this._source.type))for(const s in this._tiles){const A=this._tiles[s];if(A.fadeEndTime!==void 0&&A.fadeEndTime>=a.exported.now())return!0}return!1}setFeatureState(s,A,y){this._state.updateState(s=s||"_geojsonTileLayer",A,y)}removeFeatureState(s,A,y){this._state.removeFeatureState(s=s||"_geojsonTileLayer",A,y)}getFeatureState(s,A){return this._state.getState(s=s||"_geojsonTileLayer",A)}setDependencies(s,A,y){const w=this._tiles[s];w&&w.setDependencies(A,y)}reloadTilesForDependencies(s,A){for(const y in this._tiles)this._tiles[y].hasDependency(s,A)&&this._reloadTile(y,"reloading");this._cache.filter(y=>!y.hasDependency(s,A))}}function qn(x,s){const A=Math.abs(2*x.wrap)-+(x.wrap<0),y=Math.abs(2*s.wrap)-+(s.wrap<0);return x.overscaledZ-s.overscaledZ||y-A||s.canonical.y-x.canonical.y||s.canonical.x-x.canonical.x}function Xi(x){return x==="raster"||x==="image"||x==="video"}yn.maxOverzooming=10,yn.maxUnderzooming=3;const pi="mapboxgl_preloaded_worker_pool";class Si{constructor(){this.active={}}acquire(s){if(!this.workers)for(this.workers=[];this.workers.length<Si.workerCount;)this.workers.push(new Worker(zs.workerUrl));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.numActive()===0&&(this.workers.forEach(A=>{A.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[pi]}numActive(){return Object.keys(this.active).length}}const Qr=Math.floor(a.exported.hardwareConcurrency/2);let hr;function Gi(){return hr||(hr=new Si),hr}function xi(x,s){const A={};for(const y in x)y!=="ref"&&(A[y]=x[y]);return a.refProperties.forEach(y=>{y in s&&(A[y]=s[y])}),A}function Dr(x){x=x.slice();const s=Object.create(null);for(let A=0;A<x.length;A++)s[x[A].id]=x[A];for(let A=0;A<x.length;A++)"ref"in x[A]&&(x[A]=xi(x[A],s[x[A].ref]));return x}Si.workerCount=Math.max(Math.min(Qr,6),1);const bn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ir(x,s,A){A.push({command:bn.addSource,args:[x,s[x]]})}function Vn(x,s,A){s.push({command:bn.removeSource,args:[x]}),A[x]=!0}function zr(x,s,A,y){Vn(x,A,y),ir(x,s,A)}function ns(x,s,A){let y;for(y in x[A])if(Object.prototype.hasOwnProperty.call(x[A],y)&&y!=="data"&&!B(x[A][y],s[A][y]))return!1;for(y in s[A])if(Object.prototype.hasOwnProperty.call(s[A],y)&&y!=="data"&&!B(x[A][y],s[A][y]))return!1;return!0}function Yi(x,s,A,y,w,M){let L;for(L in s=s||{},x=x||{})Object.prototype.hasOwnProperty.call(x,L)&&(B(x[L],s[L])||A.push({command:M,args:[y,L,s[L],w]}));for(L in s)Object.prototype.hasOwnProperty.call(s,L)&&!Object.prototype.hasOwnProperty.call(x,L)&&(B(x[L],s[L])||A.push({command:M,args:[y,L,s[L],w]}))}function wr(x){return x.id}function is(x,s){return x[s.id]=s,x}class Br{constructor(s,A){this.reset(s,A)}reset(s,A){this.points=s||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(A||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=a.clamp(s,0,1);let A=1,y=this._distances[A];const w=s*this.paddedLength+this.padding;for(;y<w&&A<this._distances.length;)y=this._distances[++A];const M=A-1,L=this._distances[M],N=y-L,V=N>0?(w-L)/N:0;return this.points[M].mult(1-V).add(this.points[A].mult(V))}}function et(x,s){let A=!0;return x==="always"||x!=="never"&&s!=="never"||(A=!1),A}class gt{constructor(s,A,y){const w=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(s/y),this.yCellCount=Math.ceil(A/y);for(let L=0;L<this.xCellCount*this.yCellCount;L++)w.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=A,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/A,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,A,y,w,M){this._forEachCell(A,y,w,M,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(A),this.bboxes.push(y),this.bboxes.push(w),this.bboxes.push(M)}insertCircle(s,A,y,w){this._forEachCell(A-w,y-w,A+w,y+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(A),this.circles.push(y),this.circles.push(w)}_insertBoxCell(s,A,y,w,M,L){this.boxCells[M].push(L)}_insertCircleCell(s,A,y,w,M,L){this.circleCells[M].push(L)}_query(s,A,y,w,M,L,N){if(y<0||s>this.width||w<0||A>this.height)return[];const V=[];if(s<=0&&A<=0&&this.width<=y&&this.height<=w){if(M)return[{key:null,x1:s,y1:A,x2:y,y2:w}];for(let $=0;$<this.boxKeys.length;$++)V.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(let $=0;$<this.circleKeys.length;$++){const Q=this.circles[3*$],J=this.circles[3*$+1],ce=this.circles[3*$+2];V.push({key:this.circleKeys[$],x1:Q-ce,y1:J-ce,x2:Q+ce,y2:J+ce})}}else this._forEachCell(s,A,y,w,this._queryCell,V,{hitTest:M,overlapMode:L,seenUids:{box:{},circle:{}}},N);return V}query(s,A,y,w){return this._query(s,A,y,w,!1,null)}hitTest(s,A,y,w,M,L){return this._query(s,A,y,w,!0,M,L).length>0}hitTestCircle(s,A,y,w,M){const L=s-y,N=s+y,V=A-y,$=A+y;if(N<0||L>this.width||$<0||V>this.height)return!1;const Q=[];return this._forEachCell(L,V,N,$,this._queryCellCircle,Q,{hitTest:!0,overlapMode:w,circle:{x:s,y:A,radius:y},seenUids:{box:{},circle:{}}},M),Q.length>0}_queryCell(s,A,y,w,M,L,N,V){const{seenUids:$,hitTest:Q,overlapMode:J}=N,ce=this.boxCells[M];if(ce!==null){const _e=this.bboxes;for(const oe of ce)if(!$.box[oe]){$.box[oe]=!0;const ge=4*oe,De=this.boxKeys[oe];if(s<=_e[ge+2]&&A<=_e[ge+3]&&y>=_e[ge+0]&&w>=_e[ge+1]&&(!V||V(De))&&(!Q||!et(J,De.overlapMode))&&(L.push({key:De,x1:_e[ge],y1:_e[ge+1],x2:_e[ge+2],y2:_e[ge+3]}),Q))return!0}}const ye=this.circleCells[M];if(ye!==null){const _e=this.circles;for(const oe of ye)if(!$.circle[oe]){$.circle[oe]=!0;const ge=3*oe,De=this.circleKeys[oe];if(this._circleAndRectCollide(_e[ge],_e[ge+1],_e[ge+2],s,A,y,w)&&(!V||V(De))&&(!Q||!et(J,De.overlapMode))){const Ve=_e[ge],Ee=_e[ge+1],Ze=_e[ge+2];if(L.push({key:De,x1:Ve-Ze,y1:Ee-Ze,x2:Ve+Ze,y2:Ee+Ze}),Q)return!0}}}return!1}_queryCellCircle(s,A,y,w,M,L,N,V){const{circle:$,seenUids:Q,overlapMode:J}=N,ce=this.boxCells[M];if(ce!==null){const _e=this.bboxes;for(const oe of ce)if(!Q.box[oe]){Q.box[oe]=!0;const ge=4*oe,De=this.boxKeys[oe];if(this._circleAndRectCollide($.x,$.y,$.radius,_e[ge+0],_e[ge+1],_e[ge+2],_e[ge+3])&&(!V||V(De))&&!et(J,De.overlapMode))return L.push(!0),!0}}const ye=this.circleCells[M];if(ye!==null){const _e=this.circles;for(const oe of ye)if(!Q.circle[oe]){Q.circle[oe]=!0;const ge=3*oe,De=this.circleKeys[oe];if(this._circlesCollide(_e[ge],_e[ge+1],_e[ge+2],$.x,$.y,$.radius)&&(!V||V(De))&&!et(J,De.overlapMode))return L.push(!0),!0}}}_forEachCell(s,A,y,w,M,L,N,V){const $=this._convertToXCellCoord(s),Q=this._convertToYCellCoord(A),J=this._convertToXCellCoord(y),ce=this._convertToYCellCoord(w);for(let ye=$;ye<=J;ye++)for(let _e=Q;_e<=ce;_e++)if(M.call(this,s,A,y,w,this.xCellCount*_e+ye,L,N,V))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,A,y,w,M,L){const N=w-s,V=M-A,$=y+L;return $*$>N*N+V*V}_circleAndRectCollide(s,A,y,w,M,L,N){const V=(L-w)/2,$=Math.abs(s-(w+V));if($>V+y)return!1;const Q=(N-M)/2,J=Math.abs(A-(M+Q));if(J>Q+y)return!1;if($<=V||J<=Q)return!0;const ce=$-V,ye=J-Q;return ce*ce+ye*ye<=y*y}}function po(x,s,A,y,w){const M=a.create();return s?(a.scale(M,M,[1/w,1/w,1]),A||a.rotateZ(M,M,y.angle)):a.multiply(M,y.labelPlaneMatrix,x),M}function Ki(x,s,A,y,w){if(s){const M=a.clone(x);return a.scale(M,M,[w,w,1]),A||a.rotateZ(M,M,-y.angle),M}return y.glCoordMatrix}function vn(x,s,A){let y;A?(y=[x.x,x.y,A(x.x,x.y),1],a.transformMat4(y,y,s)):(y=[x.x,x.y,0,1],ft(y,y,s));const w=y[3];return{point:new a.pointGeometry(y[0]/w,y[1]/w),signedDistanceFromCamera:w}}function dr(x,s){return .5+x/s*.5}function rr(x,s){const A=x[0]/x[3],y=x[1]/x[3];return A>=-s[0]&&A<=s[0]&&y>=-s[1]&&y<=s[1]}function or(x,s,A,y,w,M,L,N,V,$){const Q=y?x.textSizeData:x.iconSizeData,J=a.evaluateSizeForZoom(Q,A.transform.zoom),ce=[256/A.width*2+1,256/A.height*2+1],ye=y?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;ye.clear();const _e=x.lineVertexArray,oe=y?x.text.placedSymbolArray:x.icon.placedSymbolArray,ge=A.transform.width/A.transform.height;let De=!1;for(let Ve=0;Ve<oe.length;Ve++){const Ee=oe.get(Ve);if(Ee.hidden||Ee.writingMode===a.WritingMode.vertical&&!De){rn(Ee.numGlyphs,ye);continue}let Ze;if(De=!1,$?(Ze=[Ee.anchorX,Ee.anchorY,$(Ee.anchorX,Ee.anchorY),1],a.transformMat4(Ze,Ze,s)):(Ze=[Ee.anchorX,Ee.anchorY,0,1],ft(Ze,Ze,s)),!rr(Ze,ce)){rn(Ee.numGlyphs,ye);continue}const je=dr(A.transform.cameraToCenterDistance,Ze[3]),tt=a.evaluateSizeForFeature(Q,J,Ee),Ke=L?tt/je:tt*je,d=new a.pointGeometry(Ee.anchorX,Ee.anchorY),h=vn(d,w,$).point,m={},_=ln(Ee,Ke,!1,N,s,w,M,x.glyphOffsetArray,_e,ye,h,d,m,ge,V,$);De=_.useVertical,(_.notEnoughRoom||De||_.needsFlipping&&ln(Ee,Ke,!0,N,s,w,M,x.glyphOffsetArray,_e,ye,h,d,m,ge,V,$).notEnoughRoom)&&rn(Ee.numGlyphs,ye)}y?x.text.dynamicLayoutVertexBuffer.updateData(ye):x.icon.dynamicLayoutVertexBuffer.updateData(ye)}function Xr(x,s,A,y,w,M,L,N,V,$,Q,J,ce){const ye=N.glyphStartIndex+N.numGlyphs,_e=N.lineStartIndex,oe=N.lineStartIndex+N.lineLength,ge=s.getoffsetX(N.glyphStartIndex),De=s.getoffsetX(ye-1),Ve=mi(x*ge,A,y,w,M,L,N.segment,_e,oe,V,$,Q,J,ce);if(!Ve)return null;const Ee=mi(x*De,A,y,w,M,L,N.segment,_e,oe,V,$,Q,J,ce);return Ee?{first:Ve,last:Ee}:null}function _t(x,s,A,y){return x===a.WritingMode.horizontal&&Math.abs(A.y-s.y)>Math.abs(A.x-s.x)*y?{useVertical:!0}:(x===a.WritingMode.vertical?s.y<A.y:s.x>A.x)?{needsFlipping:!0}:null}function ln(x,s,A,y,w,M,L,N,V,$,Q,J,ce,ye,_e,oe){const ge=s/24,De=x.lineOffsetX*ge,Ve=x.lineOffsetY*ge;let Ee;if(x.numGlyphs>1){const Ze=x.glyphStartIndex+x.numGlyphs,je=x.lineStartIndex,tt=x.lineStartIndex+x.lineLength,Ke=Xr(ge,N,De,Ve,A,Q,J,x,V,M,ce,_e,oe);if(!Ke)return{notEnoughRoom:!0};const d=vn(Ke.first.point,L,oe).point,h=vn(Ke.last.point,L,oe).point;if(y&&!A){const m=_t(x.writingMode,d,h,ye);if(m)return m}Ee=[Ke.first];for(let m=x.glyphStartIndex+1;m<Ze-1;m++)Ee.push(mi(ge*N.getoffsetX(m),De,Ve,A,Q,J,x.segment,je,tt,V,M,ce,_e,oe));Ee.push(Ke.last)}else{if(y&&!A){const je=vn(J,w,oe).point,tt=x.lineStartIndex+x.segment+1,Ke=new a.pointGeometry(V.getx(tt),V.gety(tt)),d=vn(Ke,w,oe),h=d.signedDistanceFromCamera>0?d.point:an(J,Ke,je,1,w,oe),m=_t(x.writingMode,je,h,ye);if(m)return m}const Ze=mi(ge*N.getoffsetX(x.glyphStartIndex),De,Ve,A,Q,J,x.segment,x.lineStartIndex,x.lineStartIndex+x.lineLength,V,M,ce,_e,oe);if(!Ze)return{notEnoughRoom:!0};Ee=[Ze]}for(const Ze of Ee)a.addDynamicAttributes($,Ze.point,Ze.angle);return{}}function an(x,s,A,y,w,M){const L=vn(x.add(x.sub(s)._unit()),w,M).point,N=A.sub(L);return A.add(N._mult(y/N.mag()))}function mi(x,s,A,y,w,M,L,N,V,$,Q,J,ce,ye){const _e=y?x-s:x+s;let oe=_e>0?1:-1,ge=0;y&&(oe*=-1,ge=Math.PI),oe<0&&(ge+=Math.PI);let De=oe>0?N+L:N+L+1,Ve=w,Ee=w,Ze=0,je=0;const tt=Math.abs(_e),Ke=[];for(;Ze+je<=tt;){if(De+=oe,De<N||De>=V)return null;if(Ee=Ve,Ke.push(Ve),Ve=J[De],Ve===void 0){const v=new a.pointGeometry($.getx(De),$.gety(De)),E=vn(v,Q,ye);if(E.signedDistanceFromCamera>0)Ve=J[De]=E.point;else{const I=De-oe;Ve=an(Ze===0?M:new a.pointGeometry($.getx(I),$.gety(I)),v,Ee,tt-Ze+1,Q,ye)}}Ze+=je,je=Ee.dist(Ve)}const d=(tt-Ze)/je,h=Ve.sub(Ee),m=h.mult(d)._add(Ee);m._add(h._unit()._perp()._mult(A*oe));const _=ge+Math.atan2(Ve.y-Ee.y,Ve.x-Ee.x);return Ke.push(m),{point:m,angle:ce?_:0,path:Ke}}const Yr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function rn(x,s){for(let A=0;A<x;A++){const y=s.length;s.resize(y+4),s.float32.set(Yr,3*y)}}function ft(x,s,A){const y=s[0],w=s[1];return x[0]=A[0]*y+A[4]*w+A[12],x[1]=A[1]*y+A[5]*w+A[13],x[3]=A[3]*y+A[7]*w+A[15],x}const wi=100;class Co{constructor(s,A=new gt(s.width+200,s.height+200,25),y=new gt(s.width+200,s.height+200,25)){this.transform=s,this.grid=A,this.ignoredGrid=y,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+wi,this.screenBottomBoundary=s.height+wi,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(s,A,y,w,M,L){const N=this.projectAndGetPerspectiveRatio(w,s.anchorPointX,s.anchorPointY,L),V=y*N.perspectiveRatio,$=s.x1*V+N.point.x,Q=s.y1*V+N.point.y,J=s.x2*V+N.point.x,ce=s.y2*V+N.point.y;return!this.isInsideGrid($,Q,J,ce)||A!=="always"&&this.grid.hitTest($,Q,J,ce,A,M)||N.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[$,Q,J,ce],offscreen:this.isOffscreen($,Q,J,ce)}}placeCollisionCircles(s,A,y,w,M,L,N,V,$,Q,J,ce,ye,_e){const oe=[],ge=new a.pointGeometry(A.anchorX,A.anchorY),De=vn(ge,L,_e),Ve=dr(this.transform.cameraToCenterDistance,De.signedDistanceFromCamera),Ee=(Q?M/Ve:M*Ve)/a.ONE_EM,Ze=vn(ge,N,_e).point,je=Xr(Ee,w,A.lineOffsetX*Ee,A.lineOffsetY*Ee,!1,Ze,ge,A,y,N,{},!1,_e);let tt=!1,Ke=!1,d=!0;if(je){const h=.5*ce*Ve+ye,m=new a.pointGeometry(-100,-100),_=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),v=new Br,E=je.first,I=je.last;let P=[];for(let X=E.path.length-1;X>=1;X--)P.push(E.path[X]);for(let X=1;X<I.path.length;X++)P.push(I.path[X]);const O=2.5*h;if(V){const X=P.map(de=>vn(de,V,_e));P=X.some(de=>de.signedDistanceFromCamera<=0)?[]:X.map(de=>de.point)}let G=[];if(P.length>0){const X=P[0].clone(),de=P[0].clone();for(let ve=1;ve<P.length;ve++)X.x=Math.min(X.x,P[ve].x),X.y=Math.min(X.y,P[ve].y),de.x=Math.max(de.x,P[ve].x),de.y=Math.max(de.y,P[ve].y);G=X.x>=m.x&&de.x<=_.x&&X.y>=m.y&&de.y<=_.y?[P]:de.x<m.x||X.x>_.x||de.y<m.y||X.y>_.y?[]:a.clipLine([P],m.x,m.y,_.x,_.y)}for(const X of G){v.reset(X,.25*h);let de=0;de=v.length<=.5*h?1:Math.ceil(v.paddedLength/O)+1;for(let ve=0;ve<de;ve++){const Re=ve/Math.max(de-1,1),be=v.lerp(Re),ze=be.x+wi,Je=be.y+wi;oe.push(ze,Je,h,0);const Ye=ze-h,He=Je-h,$e=ze+h,Be=Je+h;if(d=d&&this.isOffscreen(Ye,He,$e,Be),Ke=Ke||this.isInsideGrid(Ye,He,$e,Be),s!=="always"&&this.grid.hitTestCircle(ze,Je,h,s,J)&&(tt=!0,!$))return{circles:[],offscreen:!1,collisionDetected:tt}}}}return{circles:!$&&tt||!Ke||Ve<this.perspectiveRatioCutoff?[]:oe,offscreen:d,collisionDetected:tt}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const A=[];let y=1/0,w=1/0,M=-1/0,L=-1/0;for(const Q of s){const J=new a.pointGeometry(Q.x+wi,Q.y+wi);y=Math.min(y,J.x),w=Math.min(w,J.y),M=Math.max(M,J.x),L=Math.max(L,J.y),A.push(J)}const N=this.grid.query(y,w,M,L).concat(this.ignoredGrid.query(y,w,M,L)),V={},$={};for(const Q of N){const J=Q.key;if(V[J.bucketInstanceId]===void 0&&(V[J.bucketInstanceId]={}),V[J.bucketInstanceId][J.featureIndex])continue;const ce=[new a.pointGeometry(Q.x1,Q.y1),new a.pointGeometry(Q.x2,Q.y1),new a.pointGeometry(Q.x2,Q.y2),new a.pointGeometry(Q.x1,Q.y2)];a.polygonIntersectsPolygon(A,ce)&&(V[J.bucketInstanceId][J.featureIndex]=!0,$[J.bucketInstanceId]===void 0&&($[J.bucketInstanceId]=[]),$[J.bucketInstanceId].push(J.featureIndex))}return $}insertCollisionBox(s,A,y,w,M,L){(y?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:M,collisionGroupID:L,overlapMode:A},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,A,y,w,M,L){const N=y?this.ignoredGrid:this.grid,V={bucketInstanceId:w,featureIndex:M,collisionGroupID:L,overlapMode:A};for(let $=0;$<s.length;$+=4)N.insertCircle(V,s[$],s[$+1],s[$+2])}projectAndGetPerspectiveRatio(s,A,y,w){let M;return w?(M=[A,y,w(A,y),1],a.transformMat4(M,M,s)):(M=[A,y,0,1],ft(M,M,s)),{point:new a.pointGeometry((M[0]/M[3]+1)/2*this.transform.width+wi,(-M[1]/M[3]+1)/2*this.transform.height+wi),perspectiveRatio:.5+this.transform.cameraToCenterDistance/M[3]*.5}}isOffscreen(s,A,y,w){return y<wi||s>=this.screenRightBoundary||w<wi||A>this.screenBottomBoundary}isInsideGrid(s,A,y,w){return y>=0&&s<this.gridRightBoundary&&w>=0&&A<this.gridBottomBoundary}getViewportMatrix(){const s=a.identity([]);return a.translate(s,s,[-100,-100,0]),s}}function ai(x,s,A){return s*(a.EXTENT/(x.tileSize*Math.pow(2,A-x.tileID.overscaledZ)))}class zi{constructor(s,A,y,w){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?A:-A))):w&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class Pn{constructor(s,A,y,w,M){this.text=new zi(s?s.text:null,A,y,M),this.icon=new zi(s?s.icon:null,A,w,M)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ko{constructor(s,A,y){this.text=s,this.icon=A,this.skipFade=y}}class br{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Er{constructor(s,A,y,w,M){this.bucketInstanceId=s,this.featureIndex=A,this.sourceLayerIndex=y,this.bucketIndex=w,this.tileID=M}}class Or{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const A=++this.maxGroupID;this.collisionGroups[s]={ID:A,predicate:y=>y.collisionGroupID===A}}return this.collisionGroups[s]}}function mo(x,s,A,y,w){const{horizontalAlign:M,verticalAlign:L}=a.getAnchorAlignment(x),N=-(M-.5)*s,V=-(L-.5)*A,$=a.evaluateVariableOffset(x,y);return new a.pointGeometry(N+$[0]*w,V+$[1]*w)}function Ji(x,s,A,y,w,M){const{x1:L,x2:N,y1:V,y2:$,anchorPointX:Q,anchorPointY:J}=x,ce=new a.pointGeometry(s,A);return y&&ce._rotate(w?M:-M),{x1:L+ce.x,y1:V+ce.y,x2:N+ce.x,y2:$+ce.y,anchorPointX:Q,anchorPointY:J}}class q{constructor(s,A,y,w,M){this.transform=s.clone(),this.terrain=A,this.collisionIndex=new Co(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new Or(w),this.collisionCircleArrays={},this.prevPlacement=M,M&&(M.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,A,y,w){const M=y.getBucket(A),L=y.latestFeatureIndex;if(!M||!L||A.id!==M.layerIds[0])return;const N=y.collisionBoxArray,V=M.layers[0].layout,$=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),Q=y.tileSize/a.EXTENT,J=this.transform.calculatePosMatrix(y.tileID.toUnwrapped()),ce=V.get("text-pitch-alignment")==="map",ye=V.get("text-rotation-alignment")==="map",_e=ai(y,1,this.transform.zoom),oe=po(J,ce,ye,this.transform,_e);let ge=null;if(ce){const Ve=Ki(J,ce,ye,this.transform,_e);ge=a.multiply([],this.transform.labelPlaneMatrix,Ve)}this.retainedQueryData[M.bucketInstanceId]=new Er(M.bucketInstanceId,L,M.sourceLayerIndex,M.index,y.tileID);const De={bucket:M,layout:V,posMatrix:J,textLabelPlaneMatrix:oe,labelToScreenMatrix:ge,scale:$,textPixelRatio:Q,holdingForFade:y.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(M.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(M.sourceID)};if(w)for(const Ve of M.sortKeyRanges){const{sortKey:Ee,symbolInstanceStart:Ze,symbolInstanceEnd:je}=Ve;s.push({sortKey:Ee,symbolInstanceStart:Ze,symbolInstanceEnd:je,parameters:De})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:De})}attemptAnchorPlacement(s,A,y,w,M,L,N,V,$,Q,J,ce,ye,_e,oe,ge){const De=[ce.textOffset0,ce.textOffset1],Ve=mo(s,y,w,De,M),Ee=this.collisionIndex.placeCollisionBox(Ji(A,Ve.x,Ve.y,L,N,this.transform.angle),J,V,$,Q.predicate,ge);if((!oe||this.collisionIndex.placeCollisionBox(Ji(oe,Ve.x,Ve.y,L,N,this.transform.angle),J,V,$,Q.predicate,ge).box.length!==0)&&Ee.box.length>0){let Ze;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID].text&&(Ze=this.prevPlacement.variableOffsets[ce.crossTileID].anchor),ce.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ce.crossTileID]={textOffset:De,width:y,height:w,anchor:s,textBoxScale:M,prevAnchor:Ze},this.markUsedJustification(ye,s,ce,_e),ye.allowVerticalPlacement&&(this.markUsedOrientation(ye,_e,ce),this.placedOrientations[ce.crossTileID]=_e),{shift:Ve,placedGlyphBoxes:Ee}}}placeLayerBucketPart(s,A,y){const{bucket:w,layout:M,posMatrix:L,textLabelPlaneMatrix:N,labelToScreenMatrix:V,textPixelRatio:$,holdingForFade:Q,collisionBoxArray:J,partiallyEvaluatedTextSize:ce,collisionGroup:ye}=s.parameters,_e=M.get("text-optional"),oe=M.get("icon-optional"),ge=a.getOverlapMode(M,"text-overlap","text-allow-overlap"),De=ge==="always",Ve=a.getOverlapMode(M,"icon-overlap","icon-allow-overlap"),Ee=Ve==="always",Ze=M.get("text-rotation-alignment")==="map",je=M.get("text-pitch-alignment")==="map",tt=M.get("icon-text-fit")!=="none",Ke=M.get("symbol-z-order")==="viewport-y",d=De&&(Ee||!w.hasIconData()||oe),h=Ee&&(De||!w.hasTextData()||_e);!w.collisionArrays&&J&&w.deserializeCollisionBoxes(J);const m=(_,v)=>{if(A[_.crossTileID])return;if(Q)return void(this.placements[_.crossTileID]=new ko(!1,!1,!1));let E=!1,I=!1,P=!0,O=null,G={box:null,offscreen:null},X={box:null,offscreen:null},de=null,ve=null,Re=null,be=0,ze=0,Je=0;v.textFeatureIndex?be=v.textFeatureIndex:_.useRuntimeCollisionCircles&&(be=_.featureIndex),v.verticalTextFeatureIndex&&(ze=v.verticalTextFeatureIndex);const Ye=this.retainedQueryData[w.bucketInstanceId].tileID,He=this.terrain?(yt,ot)=>this.terrain.getElevation(Ye,yt,ot):null;for(const yt of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const ot=v[yt];ot&&(ot.elevation=He?He(ot.anchorPointX,ot.anchorPointY):0)}const $e=v.textBox;if($e){const yt=ut=>{let cn=a.WritingMode.horizontal;if(w.allowVerticalPlacement&&!ut&&this.prevPlacement){const on=this.prevPlacement.placedOrientations[_.crossTileID];on&&(this.placedOrientations[_.crossTileID]=on,cn=on,this.markUsedOrientation(w,cn,_))}return cn},ot=(ut,cn)=>{if(w.allowVerticalPlacement&&_.numVerticalGlyphVertices>0&&v.verticalTextBox){for(const on of w.writingModes)if(on===a.WritingMode.vertical?(G=cn(),X=G):G=ut(),G&&G.box&&G.box.length)break}else G=ut()};if(M.get("text-variable-anchor")){let ut=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[_.crossTileID]){const Kt=this.prevPlacement.variableOffsets[_.crossTileID];ut.indexOf(Kt.anchor)>0&&(ut=ut.filter(tn=>tn!==Kt.anchor),ut.unshift(Kt.anchor))}const cn=(Kt,tn,sn)=>{const fn=Kt.x2-Kt.x1,zn=Kt.y2-Kt.y1,un=_.textBoxScale,$n=tt&&Ve==="never"?tn:null;let ci={box:[],offscreen:!1};const fs=ge!=="never"?2*ut.length:ut.length;for(let el=0;el<fs;++el){const Ju=this.attemptAnchorPlacement(ut[el%ut.length],Kt,fn,zn,un,Ze,je,$,L,ye,el>=ut.length?ge:"never",_,w,sn,$n,He);if(Ju&&(ci=Ju.placedGlyphBoxes,ci&&ci.box&&ci.box.length)){E=!0,O=Ju.shift;break}}return ci};ot(()=>cn($e,v.iconBox,a.WritingMode.horizontal),()=>{const Kt=v.verticalTextBox;return w.allowVerticalPlacement&&!(G&&G.box&&G.box.length)&&_.numVerticalGlyphVertices>0&&Kt?cn(Kt,v.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),G&&(E=G.box,P=G.offscreen);const on=yt(G&&G.box);if(!E&&this.prevPlacement){const Kt=this.prevPlacement.variableOffsets[_.crossTileID];Kt&&(this.variableOffsets[_.crossTileID]=Kt,this.markUsedJustification(w,Kt.anchor,_,on))}}else{const ut=(cn,on)=>{const Kt=this.collisionIndex.placeCollisionBox(cn,ge,$,L,ye.predicate,He);return Kt&&Kt.box&&Kt.box.length&&(this.markUsedOrientation(w,on,_),this.placedOrientations[_.crossTileID]=on),Kt};ot(()=>ut($e,a.WritingMode.horizontal),()=>{const cn=v.verticalTextBox;return w.allowVerticalPlacement&&_.numVerticalGlyphVertices>0&&cn?ut(cn,a.WritingMode.vertical):{box:null,offscreen:null}}),yt(G&&G.box&&G.box.length)}}if(de=G,E=de&&de.box&&de.box.length>0,P=de&&de.offscreen,_.useRuntimeCollisionCircles){const yt=w.text.placedSymbolArray.get(_.centerJustifiedTextSymbolIndex),ot=a.evaluateSizeForFeature(w.textSizeData,ce,yt),ut=M.get("text-padding");ve=this.collisionIndex.placeCollisionCircles(ge,yt,w.lineVertexArray,w.glyphOffsetArray,ot,L,N,V,y,je,ye.predicate,_.collisionCircleDiameter,ut,He),ve.circles.length&&ve.collisionDetected&&!y&&a.warnOnce("Collisions detected, but collision boxes are not shown"),E=De||ve.circles.length>0&&!ve.collisionDetected,P=P&&ve.offscreen}if(v.iconFeatureIndex&&(Je=v.iconFeatureIndex),v.iconBox){const yt=ot=>{const ut=tt&&O?Ji(ot,O.x,O.y,Ze,je,this.transform.angle):ot;return this.collisionIndex.placeCollisionBox(ut,Ve,$,L,ye.predicate,He)};X&&X.box&&X.box.length&&v.verticalIconBox?(Re=yt(v.verticalIconBox),I=Re.box.length>0):(Re=yt(v.iconBox),I=Re.box.length>0),P=P&&Re.offscreen}const Be=_e||_.numHorizontalGlyphVertices===0&&_.numVerticalGlyphVertices===0,bt=oe||_.numIconVertices===0;if(Be||bt?bt?Be||(I=I&&E):E=I&&E:I=E=I&&E,E&&de&&de.box&&this.collisionIndex.insertCollisionBox(de.box,ge,M.get("text-ignore-placement"),w.bucketInstanceId,X&&X.box&&ze?ze:be,ye.ID),I&&Re&&this.collisionIndex.insertCollisionBox(Re.box,Ve,M.get("icon-ignore-placement"),w.bucketInstanceId,Je,ye.ID),ve&&(E&&this.collisionIndex.insertCollisionCircles(ve.circles,ge,M.get("text-ignore-placement"),w.bucketInstanceId,be,ye.ID),y)){const yt=w.bucketInstanceId;let ot=this.collisionCircleArrays[yt];ot===void 0&&(ot=this.collisionCircleArrays[yt]=new br);for(let ut=0;ut<ve.circles.length;ut+=4)ot.circles.push(ve.circles[ut+0]),ot.circles.push(ve.circles[ut+1]),ot.circles.push(ve.circles[ut+2]),ot.circles.push(ve.collisionDetected?1:0)}if(_.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(w.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[_.crossTileID]=new ko(E||d,I||h,P||w.justReloaded),A[_.crossTileID]=!0};if(Ke){if(s.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const _=w.getSortedSymbolIndexes(this.transform.angle);for(let v=_.length-1;v>=0;--v){const E=_[v];m(w.symbolInstances.get(E),w.collisionArrays[E])}}else for(let _=s.symbolInstanceStart;_<s.symbolInstanceEnd;_++)m(w.symbolInstances.get(_),w.collisionArrays[_]);if(y&&w.bucketInstanceId in this.collisionCircleArrays){const _=this.collisionCircleArrays[w.bucketInstanceId];a.invert(_.invProjMatrix,L),_.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(s,A,y,w){let M;M=w===a.WritingMode.vertical?y.verticalPlacedTextSymbolIndex:{left:y.leftJustifiedTextSymbolIndex,center:y.centerJustifiedTextSymbolIndex,right:y.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(A)];const L=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex,y.verticalPlacedTextSymbolIndex];for(const N of L)N>=0&&(s.text.placedSymbolArray.get(N).crossTileID=M>=0&&N!==M?0:y.crossTileID)}markUsedOrientation(s,A,y){const w=A===a.WritingMode.horizontal||A===a.WritingMode.horizontalOnly?A:0,M=A===a.WritingMode.vertical?A:0,L=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex];for(const N of L)s.text.placedSymbolArray.get(N).placedOrientation=w;y.verticalPlacedTextSymbolIndex&&(s.text.placedSymbolArray.get(y.verticalPlacedTextSymbolIndex).placedOrientation=M)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const A=this.prevPlacement;let y=!1;this.prevZoomAdjustment=A?A.zoomAdjustment(this.transform.zoom):0;const w=A?A.symbolFadeChange(s):1,M=A?A.opacities:{},L=A?A.variableOffsets:{},N=A?A.placedOrientations:{};for(const V in this.placements){const $=this.placements[V],Q=M[V];Q?(this.opacities[V]=new Pn(Q,w,$.text,$.icon),y=y||$.text!==Q.text.placed||$.icon!==Q.icon.placed):(this.opacities[V]=new Pn(null,w,$.text,$.icon,$.skipFade),y=y||$.text||$.icon)}for(const V in M){const $=M[V];if(!this.opacities[V]){const Q=new Pn($,w,!1,!1);Q.isHidden()||(this.opacities[V]=Q,y=y||$.text.placed||$.icon.placed)}}for(const V in L)this.variableOffsets[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.variableOffsets[V]=L[V]);for(const V in N)this.placedOrientations[V]||!this.opacities[V]||this.opacities[V].isHidden()||(this.placedOrientations[V]=N[V]);if(A&&A.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");y?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=A?A.lastPlacementChangeTime:s)}updateLayerOpacities(s,A){const y={};for(const w of A){const M=w.getBucket(s);M&&w.latestFeatureIndex&&s.id===M.layerIds[0]&&this.updateBucketOpacities(M,y,w.collisionBoxArray)}}updateBucketOpacities(s,A,y){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const w=s.layers[0].layout,M=new Pn(null,0,!1,!1,!0),L=w.get("text-allow-overlap"),N=w.get("icon-allow-overlap"),V=w.get("text-variable-anchor"),$=w.get("text-rotation-alignment")==="map",Q=w.get("text-pitch-alignment")==="map",J=w.get("icon-text-fit")!=="none",ce=new Pn(null,0,L&&(N||!s.hasIconData()||w.get("icon-optional")),N&&(L||!s.hasTextData()||w.get("text-optional")),!0);!s.collisionArrays&&y&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(y);const ye=(_e,oe,ge)=>{for(let De=0;De<oe/4;De++)_e.opacityVertexArray.emplaceBack(ge)};for(let _e=0;_e<s.symbolInstances.length;_e++){const oe=s.symbolInstances.get(_e),{numHorizontalGlyphVertices:ge,numVerticalGlyphVertices:De,crossTileID:Ve}=oe;let Ee=this.opacities[Ve];A[Ve]?Ee=M:Ee||(Ee=ce,this.opacities[Ve]=Ee),A[Ve]=!0;const Ze=oe.numIconVertices>0,je=this.placedOrientations[oe.crossTileID],tt=je===a.WritingMode.vertical,Ke=je===a.WritingMode.horizontal||je===a.WritingMode.horizontalOnly;if(ge>0||De>0){const d=Me(Ee.text);ye(s.text,ge,tt?Fe:d),ye(s.text,De,Ke?Fe:d);const h=Ee.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach(v=>{v>=0&&(s.text.placedSymbolArray.get(v).hidden=h||tt?1:0)}),oe.verticalPlacedTextSymbolIndex>=0&&(s.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=h||Ke?1:0);const m=this.variableOffsets[oe.crossTileID];m&&this.markUsedJustification(s,m.anchor,oe,je);const _=this.placedOrientations[oe.crossTileID];_&&(this.markUsedJustification(s,"left",oe,_),this.markUsedOrientation(s,_,oe))}if(Ze){const d=Me(Ee.icon),h=!(J&&oe.verticalPlacedIconSymbolIndex&&tt);oe.placedIconSymbolIndex>=0&&(ye(s.icon,oe.numIconVertices,h?d:Fe),s.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=Ee.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(ye(s.icon,oe.numVerticalIconVertices,h?Fe:d),s.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=Ee.icon.isHidden())}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const d=s.collisionArrays[_e];if(d){let h=new a.pointGeometry(0,0);if(d.textBox||d.verticalTextBox){let _=!0;if(V){const v=this.variableOffsets[Ve];v?(h=mo(v.anchor,v.width,v.height,v.textOffset,v.textBoxScale),$&&h._rotate(Q?this.transform.angle:-this.transform.angle)):_=!1}d.textBox&&U(s.textCollisionBox.collisionVertexArray,Ee.text.placed,!_||tt,h.x,h.y),d.verticalTextBox&&U(s.textCollisionBox.collisionVertexArray,Ee.text.placed,!_||Ke,h.x,h.y)}const m=!!(!Ke&&d.verticalIconBox);d.iconBox&&U(s.iconCollisionBox.collisionVertexArray,Ee.icon.placed,m,J?h.x:0,J?h.y:0),d.verticalIconBox&&U(s.iconCollisionBox.collisionVertexArray,Ee.icon.placed,!m,J?h.x:0,J?h.y:0)}}}if(s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.text.opacityVertexArray.length!==s.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${s.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${s.text.layoutVertexArray.length}) / 4`);if(s.icon.opacityVertexArray.length!==s.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${s.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${s.icon.layoutVertexArray.length}) / 4`);if(s.bucketInstanceId in this.collisionCircleArrays){const _e=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=_e.invProjMatrix,s.placementViewportMatrix=_e.viewportMatrix,s.collisionCircleArray=_e.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,A){const y=this.zoomAtLastRecencyCheck===A?1-this.zoomAdjustment(A):1;return this.zoomAtLastRecencyCheck=A,this.commitTime+this.fadeDuration*y>s}setStale(){this.stale=!0}}function U(x,s,A,y,w){x.emplaceBack(s?1:0,A?1:0,y||0,w||0),x.emplaceBack(s?1:0,A?1:0,y||0,w||0),x.emplaceBack(s?1:0,A?1:0,y||0,w||0),x.emplaceBack(s?1:0,A?1:0,y||0,w||0)}const W=Math.pow(2,25),ie=Math.pow(2,24),f=Math.pow(2,17),H=Math.pow(2,16),ke=Math.pow(2,9),Te=Math.pow(2,8),we=Math.pow(2,1);function Me(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;const s=x.placed?1:0,A=Math.floor(127*x.opacity);return A*W+s*ie+A*f+s*H+A*ke+s*Te+A*we+s}const Fe=0;class rt{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&!s.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(s,A,y,w,M){const L=this._bucketParts;for(;this._currentTileIndex<s.length;)if(A.getBucketParts(L,w,s[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,M())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((N,V)=>N.sortKey-V.sortKey));this._currentPartIndex<L.length;)if(A.placeLayerBucketPart(L[this._currentPartIndex],this._seenCrossTileIDs,y),this._currentPartIndex++,M())return!0;return!1}}class Ne{constructor(s,A,y,w,M,L,N,V){this.placement=new q(s,A,L,N,V),this._currentPlacementIndex=y.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=M,this._done=!1}isDone(){return this._done}continuePlacement(s,A,y){const w=a.exported.now(),M=()=>{const L=a.exported.now()-w;return!this._forceFullPlacement&&L>2};for(;this._currentPlacementIndex>=0;){const L=A[s[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=N)&&(!L.maxzoom||L.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new rt(L)),this._inProgressLayer.continuePlacement(y[L.source],this.placement,this._showCollisionBoxes,L,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const lt=512/a.EXTENT/2;class Tt{constructor(s,A,y){this.tileID=s,this.indexedSymbolInstances={},this.bucketInstanceId=y;for(let w=0;w<A.length;w++){const M=A.get(w),L=M.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:M.crossTileID,coord:this.getScaledCoordinates(M,s)})}}getScaledCoordinates(s,A){const y=lt/Math.pow(2,A.canonical.z-this.tileID.canonical.z);return{x:Math.floor((A.canonical.x*a.EXTENT+s.anchorX)*y),y:Math.floor((A.canonical.y*a.EXTENT+s.anchorY)*y)}}findMatches(s,A,y){const w=this.tileID.canonical.z<A.canonical.z?1:Math.pow(2,this.tileID.canonical.z-A.canonical.z);for(let M=0;M<s.length;M++){const L=s.get(M);if(L.crossTileID)continue;const N=this.indexedSymbolInstances[L.key];if(!N)continue;const V=this.getScaledCoordinates(L,A);for(const $ of N)if(Math.abs($.coord.x-V.x)<=w&&Math.abs($.coord.y-V.y)<=w&&!y[$.crossTileID]){y[$.crossTileID]=!0,L.crossTileID=$.crossTileID;break}}}}class xt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $t{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const A=Math.round((s-this.lng)/360);if(A!==0)for(const y in this.indexes){const w=this.indexes[y],M={};for(const L in w){const N=w[L];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+A),M[N.tileID.key]=N}this.indexes[y]=M}this.lng=s}addBucket(s,A,y){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===A.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let M=0;M<A.symbolInstances.length;M++)A.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]={});const w=this.usedCrossTileIDs[s.overscaledZ];for(const M in this.indexes){const L=this.indexes[M];if(Number(M)>s.overscaledZ)for(const N in L){const V=L[N];V.tileID.isChildOf(s)&&V.findMatches(A.symbolInstances,s,w)}else{const N=L[s.scaledTo(Number(M)).key];N&&N.findMatches(A.symbolInstances,s,w)}}for(let M=0;M<A.symbolInstances.length;M++){const L=A.symbolInstances.get(M);L.crossTileID||(L.crossTileID=y.generate(),w[L.crossTileID]=!0)}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new Tt(s,A.symbolInstances,A.bucketInstanceId),!0}removeBucketCrossTileIDs(s,A){for(const y in A.indexedSymbolInstances)for(const w of A.indexedSymbolInstances[y])delete this.usedCrossTileIDs[s][w.crossTileID]}removeStaleBuckets(s){let A=!1;for(const y in this.indexes){const w=this.indexes[y];for(const M in w)s[w[M].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,w[M]),delete w[M],A=!0)}return A}}class Ft{constructor(){this.layerIndexes={},this.crossTileIDs=new xt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,A,y){let w=this.layerIndexes[s.id];w===void 0&&(w=this.layerIndexes[s.id]=new $t);let M=!1;const L={};w.handleWrapJump(y);for(const N of A){const V=N.getBucket(s);V&&s.id===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(N.tileID,V,this.crossTileIDs)&&(M=!0),L[V.bucketInstanceId]=!0)}return w.removeStaleBuckets(L)&&(M=!0),M}pruneUnusedLayers(s){const A={};s.forEach(y=>{A[y]=!0});for(const y in this.layerIndexes)A[y]||delete this.layerIndexes[y]}}var en=a.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Gt extends a.Evented{constructor(s){super(),this.sourceCache=s,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=s._cache.max,s.usedForTerrain=!0,s.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const s in this._tiles){const A=this._tiles[s];A.textures.forEach(y=>y.destroy()),A.textures=[]}}update(s,A){this.sourceCache.update(s,A),this._renderableTilesKeys=[];for(const y of s.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:A}))this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.posMatrix=new Float64Array(16),a.ortho(y.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),this._tiles[y.key]=new Ai(y,this.tileSize))}removeOutdated(s){const A={};this.renderHistory=this.renderHistory.filter((y,w)=>this.renderHistory.indexOf(y)===w).slice(0,this.renderHistorySize);for(const y of this._renderableTilesKeys)A[y]=!0;for(const y of this.renderHistory)A[y]=!0;for(const y in this._tiles)A[y]||(this._tiles[y].clearTextures(s),delete this._tiles[y])}getRenderableTiles(){return this._renderableTilesKeys.map(s=>this.getTileByID(s))}getTileByID(s){return this._tiles[s]}getTerrainCoords(s){const A={};for(const y of this._renderableTilesKeys){const w=this._tiles[y].tileID;if(w.canonical.equals(s.canonical)){const M=s.clone();M.posMatrix=new Float64Array(16),a.ortho(M.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),A[y]=M}else if(w.canonical.isChildOf(s.canonical)){const M=s.clone();M.posMatrix=new Float64Array(16);const L=w.canonical.z-s.canonical.z,N=w.canonical.x-(w.canonical.x>>L<<L),V=w.canonical.y-(w.canonical.y>>L<<L),$=a.EXTENT>>L;a.ortho(M.posMatrix,0,$,0,$,0,1),a.translate(M.posMatrix,M.posMatrix,[-N*$,-V*$,0]),A[y]=M}else if(s.canonical.isChildOf(w.canonical)){const M=s.clone();M.posMatrix=new Float64Array(16);const L=s.canonical.z-w.canonical.z,N=s.canonical.x-(s.canonical.x>>L<<L),V=s.canonical.y-(s.canonical.y>>L<<L),$=a.EXTENT>>L;a.ortho(M.posMatrix,0,a.EXTENT,0,a.EXTENT,0,1),a.translate(M.posMatrix,M.posMatrix,[N*$,V*$,0]),a.scale(M.posMatrix,M.posMatrix,[1/2**L,1/2**L,0]),A[y]=M}}return A}getSourceTile(s,A){const y=this.sourceCache._source;let w=s.overscaledZ-this.deltaZoom;if(w>y.maxzoom&&(w=y.maxzoom),w<y.minzoom)return null;this._sourceTileCache[s.key]||(this._sourceTileCache[s.key]=s.scaledTo(w).key);let M=this.sourceCache.getTileByID(this._sourceTileCache[s.key]);if((!M||!M.dem)&&A)for(;w>=y.minzoom&&(!M||!M.dem);)M=this.sourceCache.getTileByID(s.scaledTo(w--).key);return M}tilesAfterTime(s=Date.now()){return Object.values(this._tiles).filter(A=>A.timeLoaded>=s)}}class Wt{constructor(s,A,y){this.style=s,this.sourceCache=new Gt(A),this.options=y,this.exaggeration=typeof y.exaggeration=="number"?y.exaggeration:1,this.elevationOffset=typeof y.elevationOffset=="number"?y.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(s,A,y,w=a.EXTENT){if(!(A>=0&&A<w&&y>=0&&y<w))return this.elevationOffset;let M=0;const L=this.getTerrainData(s);if(L.tile&&L.tile.dem){const N=a.transformMat4$1([],[A/w*a.EXTENT,y/w*a.EXTENT],L.u_terrain_matrix),V=[N[0]*L.tile.dem.dim,N[1]*L.tile.dem.dim],$=[Math.floor(V[0]),Math.floor(V[1])],Q=L.tile.dem.get($[0],$[1]),J=L.tile.dem.get($[0],$[1]+1),ce=L.tile.dem.get($[0]+1,$[1]),ye=L.tile.dem.get($[0]+1,$[1]+1);M=a.number(a.number(Q,J,V[0]-$[0]),a.number(ce,ye,V[0]-$[0]),V[1]-$[1])}return M}rememberForRerender(s,A){for(const y in this.sourceCache._tiles){const w=this.sourceCache._tiles[y];(w.tileID.equals(A)||w.tileID.isChildOf(A))&&(s===this.sourceCache.sourceCache.id&&(w.timeLoaded=Date.now()),this._rerender[s]=this._rerender[s]||{},this._rerender[s][w.tileID.key]=!0)}}needsRerender(s,A){return this._rerender[s]&&this._rerender[s][A.key]}clearRerenderCache(){this._rerender={}}getElevation(s,A,y,w=a.EXTENT){return(this.getDEMElevation(s,A,y,w)+this.elevationOffset)*this.exaggeration}getTerrainData(s){if(!this._emptyDemTexture){const w=this.style.map.painter.context,M=new a.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new le(w,M,w.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new le(w,new a.RGBAImage({width:1,height:1}),w.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(w.gl.NEAREST,w.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.identity([])}const A=this.sourceCache.getSourceTile(s,!0);if(A&&A.dem&&(!A.demTexture||A.needsTerrainPrepare)){const w=this.style.map.painter.context;A.demTexture=this.style.map.painter.getTileTexture(A.dem.stride),A.demTexture?A.demTexture.update(A.dem.getPixels(),{premultiply:!1}):A.demTexture=new le(w,A.dem.getPixels(),w.gl.RGBA,{premultiply:!1}),A.demTexture.bind(w.gl.NEAREST,w.gl.CLAMP_TO_EDGE),A.needsTerrainPrepare=!1}const y=A&&A+A.tileID.key+s.key;if(y&&!this._demMatrixCache[y]){const w=this.sourceCache.sourceCache._source.maxzoom;let M=s.canonical.z-A.tileID.canonical.z;s.overscaledZ>s.canonical.z&&(s.canonical.z>=w?M=s.canonical.z-w:a.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const L=s.canonical.x-(s.canonical.x>>M<<M),N=s.canonical.y-(s.canonical.y>>M<<M),V=a.fromScaling(new Float64Array(16),[1/(a.EXTENT<<M),1/(a.EXTENT<<M),0]);a.translate(V,V,[L*a.EXTENT,N*a.EXTENT,0]),this._demMatrixCache[s.key]={matrix:V,coord:s}}return{u_depth:2,u_terrain:3,u_terrain_dim:A&&A.dem&&A.dem.dim||1,u_terrain_matrix:y?this._demMatrixCache[s.key].matrix:this._emptyDemMatrix,u_terrain_unpack:A&&A.dem&&A.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(A&&A.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:A}}getRTTFramebuffer(){const s=this.style.map.painter;if(!this._rttFramebuffer){const A=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=s.context.createFramebuffer(A,A,!0),this._rttFramebuffer.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,A,A))}return this._rttFramebuffer}getFramebuffer(s){const A=this.style.map.painter,y=A.width/devicePixelRatio,w=A.height/devicePixelRatio;return!this._fbo||this._fbo.width===y&&this._fbo.height===w||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new le(A.context,{width:y,height:w,data:null},A.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(A.context.gl.NEAREST,A.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new le(A.context,{width:y,height:w,data:null},A.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(A.context.gl.NEAREST,A.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=A.context.createFramebuffer(y,w,!0),this._fbo.depthAttachment.set(A.context.createRenderbuffer(A.context.gl.DEPTH_COMPONENT16,y,w))),this._fbo.colorAttachment.set(s==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const s=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const A=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let M=0,L=0;M<this._coordsTextureSize;M++)for(let N=0;N<this._coordsTextureSize;N++,L+=4)A[L+0]=255&N,A[L+1]=255&M,A[L+2]=N>>8<<4|M>>8,A[L+3]=0;const y=new a.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(A.buffer)),w=new le(s,y,s.gl.RGBA,{premultiply:!1});return w.bind(s.gl.NEAREST,s.gl.CLAMP_TO_EDGE),this._coordsTexture=w,w}pointCoordinate(s){const A=new Uint8Array(4),y=this.style.map.painter,w=y.context,M=w.gl;w.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),M.readPixels(s.x,y.height/devicePixelRatio-s.y-1,1,1,M.RGBA,M.UNSIGNED_BYTE,A),w.bindFramebuffer.set(null);const L=A[0]+(A[2]>>4<<8),N=A[1]+((15&A[2])<<8),V=this.coordsIndex[255-A[3]],$=V&&this.sourceCache.getTileByID(V);if(!$)return null;const Q=this._coordsTextureSize,J=(1<<$.tileID.canonical.z)*Q;return new a.MercatorCoordinate(($.tileID.canonical.x*Q+L)/J,($.tileID.canonical.y*Q+N)/J,this.getElevation($.tileID,L,N,Q))}getTerrainMesh(){if(this._mesh)return this._mesh;const s=this.style.map.painter.context,A=new a.PosArray,y=new a.TriangleIndexArray,w=this.meshSize,M=a.EXTENT/w,L=w*w;for(let N=0;N<=w;N++)for(let V=0;V<=w;V++)A.emplaceBack(V*M,N*M);for(let N=0;N<L;N+=w+1)for(let V=0;V<w;V++)y.emplaceBack(V+N,w+V+N+1,w+V+N+2),y.emplaceBack(V+N,w+V+N+2,V+N+1);return this._mesh={indexBuffer:s.createIndexBuffer(y),vertexBuffer:s.createVertexBuffer(A,en.members),segments:a.SegmentVector.simpleSegment(0,0,A.length,y.length)},this._mesh}getMinMaxElevation(s){const A=this.getTerrainData(s).tile,y={minElevation:null,maxElevation:null};return A&&A.dem&&(y.minElevation=(A.dem.min+this.elevationOffset)*this.exaggeration,y.maxElevation=(A.dem.max+this.elevationOffset)*this.exaggeration),y}}const dn=(x,s)=>a.emitValidationErrors(x,s&&s.filter(A=>A.identifier!=="source.canvas")),wn=a.pick(bn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ln=a.pick(bn,["setCenter","setZoom","setBearing","setPitch"]),Ot=function(){const x={},s=a.spec.$version;for(const A in a.spec.$root){const y=a.spec.$root[A];if(y.required){let w=null;w=A==="version"?s:y.type==="array"?[]:{},w!=null&&(x[A]=w)}}return x}();class me extends a.Evented{constructor(s,A={}){super(),this.map=s,this.dispatcher=new ct(Gi(),this),this.imageManager=new se,this.imageManager.setEventedParent(this),this.glyphManager=new Le(s._requestManager,A.localIdeographFontFamily),this.lineAtlas=new dt(256,512),this.crossTileSymbolIndex=new Ft,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const y=this;this._rtlTextPluginCallback=me.registerForPluginStateChange(w=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(M,L)=>{if(a.triggerPluginCompletionEvent(M),L&&L.every(N=>N))for(const N in y.sourceCaches)y.sourceCaches[N].reload()})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const M=this.sourceCaches[w.sourceId];if(!M)return;const L=M.getSource();if(L&&L.vectorLayerIds)for(const N in this._layers){const V=this._layers[N];V.source===L.id&&this._validateLayer(V)}})}loadURL(s,A={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const y=typeof A.validate!="boolean"||A.validate,w=this.map._requestManager.transformRequest(s,a.ResourceType.Style);this._request=a.getJSON(w,(M,L)=>{this._request=null,M?this.fire(new a.ErrorEvent(M)):L&&this._load(L,y)})}loadJSON(s,A={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(s,A.validate!==!1)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Ot,!1)}_load(s,A){if(A&&dn(this,a.validateStyle(s)))return;this._loaded=!0,this.stylesheet=s;for(const w in s.sources)this.addSource(w,s.sources[w],{validate:!1});s.sprite?this._loadSprite(s.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(s.glyphs);const y=Dr(this.stylesheet.layers);this._order=y.map(w=>w.id),this._layers={},this._serializedLayers={};for(let w of y)w=a.createStyleLayer(w),w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new it(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}_loadSprite(s){this._spriteRequest=function(A,y,w,M){let L,N,V;const $=w>1?"@2x":"";let Q=a.getJSON(y.transformRequest(y.normalizeSpriteURL(A,$,".json"),a.ResourceType.SpriteJSON),(ye,_e)=>{Q=null,V||(V=ye,L=_e,ce())}),J=a.getImage(y.transformRequest(y.normalizeSpriteURL(A,$,".png"),a.ResourceType.SpriteImage),(ye,_e)=>{J=null,V||(V=ye,N=_e,ce())});function ce(){if(V)M(V);else if(L&&N){const ye=a.exported.getImageData(N),_e={};for(const oe in L){const{width:ge,height:De,x:Ve,y:Ee,sdf:Ze,pixelRatio:je,stretchX:tt,stretchY:Ke,content:d}=L[oe],h=new a.RGBAImage({width:ge,height:De});a.RGBAImage.copy(ye,h,{x:Ve,y:Ee},{x:0,y:0},{width:ge,height:De}),_e[oe]={data:h,pixelRatio:je,sdf:Ze,stretchX:tt,stretchY:Ke,content:d}}M(null,_e)}}return{cancel(){Q&&(Q.cancel(),Q=null),J&&(J.cancel(),J=null)}}}(s,this.map._requestManager,this.map.getPixelRatio(),(A,y)=>{if(this._spriteRequest=null,A)this.fire(new a.ErrorEvent(A));else if(y)for(const w in y)this.imageManager.addImage(w,y[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(s){const A=this.sourceCaches[s.source];if(!A)return;const y=s.sourceLayer;if(!y)return;const w=A.getSource();(w.type==="geojson"||w.vectorLayerIds&&w.vectorLayerIds.indexOf(y)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${w.id}" as specified by style layer "${s.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const s in this.sourceCaches)if(!this.sourceCaches[s].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(s){const A=[];for(const y of s){const w=this._layers[y];w.type!=="custom"&&A.push(w.serialize())}return A}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const s in this.sourceCaches)if(this.sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(s){if(!this._loaded)return;const A=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);(w.length||M.length)&&this._updateWorkerLayers(w,M);for(const L in this._updatedSources){const N=this._updatedSources[L];if(N==="reload")this._reloadSource(L);else{if(N!=="clear")throw new Error(`Invalid action ${N}`);this._clearSource(L)}}this._updateTilesForChangedImages();for(const L in this._updatedPaintProps)this._layers[L].updateTransitions(s);this.light.updateTransitions(s),this._resetUpdates()}const y={};for(const w in this.sourceCaches){const M=this.sourceCaches[w];y[w]=M.used,M.used=!1}for(const w of this._order){const M=this._layers[w];M.recalculate(s,this._availableImages),!M.isHidden(s.zoom)&&M.source&&(this.sourceCaches[M.source].used=!0)}for(const w in y){const M=this.sourceCaches[w];y[w]!==M.used&&M.fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w}))}this.light.recalculate(s),this.z=s.zoom,A&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=Object.keys(this._changedImages);if(s.length){for(const A in this.sourceCaches)this.sourceCaches[A].reloadTilesForDependencies(["icons","patterns"],s);this._changedImages={}}}_updateWorkerLayers(s,A){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(s),removedIds:A})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(s){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),s){const A=this.sourceCaches[s.source];if(!A)throw new Error(`cannot load terrain, because there exists no source with ID: ${s.source}`);this.terrain=new Wt(this,A,s),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=y=>{y.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=y=>{y.tile&&(y.sourceId===s.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(y.sourceId,y.tile.tileID)):y.source.type==="geojson"&&this.terrain.rememberForRerender(y.sourceId,y.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new a.Event("terrain",{terrain:s}))}setState(s){if(this._checkLoaded(),dn(this,a.validateStyle(s)))return!1;(s=a.clone$1(s)).layers=Dr(s.layers);const A=function(w,M){if(!w)return[{command:bn.setStyle,args:[M]}];let L=[];try{if(!B(w.version,M.version))return[{command:bn.setStyle,args:[M]}];B(w.center,M.center)||L.push({command:bn.setCenter,args:[M.center]}),B(w.zoom,M.zoom)||L.push({command:bn.setZoom,args:[M.zoom]}),B(w.bearing,M.bearing)||L.push({command:bn.setBearing,args:[M.bearing]}),B(w.pitch,M.pitch)||L.push({command:bn.setPitch,args:[M.pitch]}),B(w.sprite,M.sprite)||L.push({command:bn.setSprite,args:[M.sprite]}),B(w.glyphs,M.glyphs)||L.push({command:bn.setGlyphs,args:[M.glyphs]}),B(w.transition,M.transition)||L.push({command:bn.setTransition,args:[M.transition]}),B(w.light,M.light)||L.push({command:bn.setLight,args:[M.light]});const N={},V=[];(function(Q,J,ce,ye){let _e;for(_e in J=J||{},Q=Q||{})Object.prototype.hasOwnProperty.call(Q,_e)&&(Object.prototype.hasOwnProperty.call(J,_e)||Vn(_e,ce,ye));for(_e in J)Object.prototype.hasOwnProperty.call(J,_e)&&(Object.prototype.hasOwnProperty.call(Q,_e)?B(Q[_e],J[_e])||(Q[_e].type==="geojson"&&J[_e].type==="geojson"&&ns(Q,J,_e)?ce.push({command:bn.setGeoJSONSourceData,args:[_e,J[_e].data]}):zr(_e,J,ce,ye)):ir(_e,J,ce))})(w.sources,M.sources,V,N);const $=[];w.layers&&w.layers.forEach(Q=>{N[Q.source]?L.push({command:bn.removeLayer,args:[Q.id]}):$.push(Q)}),L=L.concat(V),function(Q,J,ce){J=J||[];const ye=(Q=Q||[]).map(wr),_e=J.map(wr),oe=Q.reduce(is,{}),ge=J.reduce(is,{}),De=ye.slice(),Ve=Object.create(null);let Ee,Ze,je,tt,Ke,d,h;for(Ee=0,Ze=0;Ee<ye.length;Ee++)je=ye[Ee],Object.prototype.hasOwnProperty.call(ge,je)?Ze++:(ce.push({command:bn.removeLayer,args:[je]}),De.splice(De.indexOf(je,Ze),1));for(Ee=0,Ze=0;Ee<_e.length;Ee++)je=_e[_e.length-1-Ee],De[De.length-1-Ee]!==je&&(Object.prototype.hasOwnProperty.call(oe,je)?(ce.push({command:bn.removeLayer,args:[je]}),De.splice(De.lastIndexOf(je,De.length-Ze),1)):Ze++,d=De[De.length-Ee],ce.push({command:bn.addLayer,args:[ge[je],d]}),De.splice(De.length-Ee,0,je),Ve[je]=!0);for(Ee=0;Ee<_e.length;Ee++)if(je=_e[Ee],tt=oe[je],Ke=ge[je],!Ve[je]&&!B(tt,Ke))if(B(tt.source,Ke.source)&&B(tt["source-layer"],Ke["source-layer"])&&B(tt.type,Ke.type)){for(h in Yi(tt.layout,Ke.layout,ce,je,null,bn.setLayoutProperty),Yi(tt.paint,Ke.paint,ce,je,null,bn.setPaintProperty),B(tt.filter,Ke.filter)||ce.push({command:bn.setFilter,args:[je,Ke.filter]}),B(tt.minzoom,Ke.minzoom)&&B(tt.maxzoom,Ke.maxzoom)||ce.push({command:bn.setLayerZoomRange,args:[je,Ke.minzoom,Ke.maxzoom]}),tt)Object.prototype.hasOwnProperty.call(tt,h)&&h!=="layout"&&h!=="paint"&&h!=="filter"&&h!=="metadata"&&h!=="minzoom"&&h!=="maxzoom"&&(h.indexOf("paint.")===0?Yi(tt[h],Ke[h],ce,je,h.slice(6),bn.setPaintProperty):B(tt[h],Ke[h])||ce.push({command:bn.setLayerProperty,args:[je,h,Ke[h]]}));for(h in Ke)Object.prototype.hasOwnProperty.call(Ke,h)&&!Object.prototype.hasOwnProperty.call(tt,h)&&h!=="layout"&&h!=="paint"&&h!=="filter"&&h!=="metadata"&&h!=="minzoom"&&h!=="maxzoom"&&(h.indexOf("paint.")===0?Yi(tt[h],Ke[h],ce,je,h.slice(6),bn.setPaintProperty):B(tt[h],Ke[h])||ce.push({command:bn.setLayerProperty,args:[je,h,Ke[h]]}))}else ce.push({command:bn.removeLayer,args:[je]}),d=De[De.lastIndexOf(je)+1],ce.push({command:bn.addLayer,args:[Ke,d]})}($,M.layers,L)}catch(N){console.warn("Unable to compute style diff:",N),L=[{command:bn.setStyle,args:[M]}]}return L}(this.serialize(),s).filter(w=>!(w.command in Ln));if(A.length===0)return!1;const y=A.filter(w=>!(w.command in wn));if(y.length>0)throw new Error(`Unimplemented: ${y.map(w=>w.command).join(", ")}.`);return A.forEach(w=>{w.command!=="setTransition"&&this[w.command].apply(this,w.args)}),this.stylesheet=s,!0}addImage(s,A){if(this.getImage(s))return this.fire(new a.ErrorEvent(new Error(`An image named "${s}" already exists.`)));this.imageManager.addImage(s,A),this._afterImageUpdated(s)}updateImage(s,A){this.imageManager.updateImage(s,A)}getImage(s){return this.imageManager.getImage(s)}removeImage(s){if(!this.getImage(s))return this.fire(new a.ErrorEvent(new Error(`An image named "${s}" does not exist.`)));this.imageManager.removeImage(s),this._afterImageUpdated(s)}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(),this._changedImages[s]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(s,A,y={}){if(this._checkLoaded(),this.sourceCaches[s]!==void 0)throw new Error(`Source "${s}" already exists.`);if(!A.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(A).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(A.type)>=0&&this._validate(a.validateStyle.source,`sources.${s}`,A,null,y))return;this.map&&this.map._collectResourceTiming&&(A.collectResourceTiming=!0);const w=this.sourceCaches[s]=new yn(s,A,this.dispatcher);w.style=this,w.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:w.serialize(),sourceId:s})),w.onAdd(this.map),this._changed=!0}removeSource(s){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===s)return this.fire(new a.ErrorEvent(new Error(`Source "${s}" cannot be removed while layer "${y}" is using it.`)));const A=this.sourceCaches[s];delete this.sourceCaches[s],delete this._updatedSources[s],A.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:s})),A.setEventedParent(null),A.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(s,A){if(this._checkLoaded(),this.sourceCaches[s]===void 0)throw new Error(`There is no source with this ID=${s}`);const y=this.sourceCaches[s].getSource();if(y.type!=="geojson")throw new Error(`geojsonSource.type is ${y.type}, which is !== 'geojson`);y.setData(A),this._changed=!0}getSource(s){return this.sourceCaches[s]&&this.sourceCaches[s].getSource()}addLayer(s,A,y={}){this._checkLoaded();const w=s.id;if(this.getLayer(w))return void this.fire(new a.ErrorEvent(new Error(`Layer "${w}" already exists on this map.`)));let M;if(s.type==="custom"){if(dn(this,a.validateCustomStyleLayer(s)))return;M=a.createStyleLayer(s)}else{if(typeof s.source=="object"&&(this.addSource(w,s.source),s=a.clone$1(s),s=a.extend(s,{source:w})),this._validate(a.validateStyle.layer,`layers.${w}`,s,{arrayIndex:-1},y))return;M=a.createStyleLayer(s),this._validateLayer(M),M.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[M.id]=M.serialize()}const L=A?this._order.indexOf(A):this._order.length;if(A&&L===-1)this.fire(new a.ErrorEvent(new Error(`Cannot add layer "${w}" before non-existing layer "${A}".`)));else{if(this._order.splice(L,0,w),this._layerOrderChanged=!0,this._layers[w]=M,this._removedLayers[w]&&M.source&&M.type!=="custom"){const N=this._removedLayers[w];delete this._removedLayers[w],N.type!==M.type?this._updatedSources[M.source]="clear":(this._updatedSources[M.source]="reload",this.sourceCaches[M.source].pause())}this._updateLayer(M),M.onAdd&&M.onAdd(this.map)}}moveLayer(s,A){if(this._checkLoaded(),this._changed=!0,!this._layers[s])return void this.fire(new a.ErrorEvent(new Error(`The layer '${s}' does not exist in the map's style and cannot be moved.`)));if(s===A)return;const y=this._order.indexOf(s);this._order.splice(y,1);const w=A?this._order.indexOf(A):this._order.length;A&&w===-1?this.fire(new a.ErrorEvent(new Error(`Cannot move layer "${s}" before non-existing layer "${A}".`))):(this._order.splice(w,0,s),this._layerOrderChanged=!0)}removeLayer(s){this._checkLoaded();const A=this._layers[s];if(!A)return void this.fire(new a.ErrorEvent(new Error(`Cannot remove non-existing layer "${s}".`)));A.setEventedParent(null);const y=this._order.indexOf(s);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[s]=A,delete this._layers[s],delete this._serializedLayers[s],delete this._updatedLayers[s],delete this._updatedPaintProps[s],A.onRemove&&A.onRemove(this.map)}getLayer(s){return this._layers[s]}hasLayer(s){return s in this._layers}setLayerZoomRange(s,A,y){this._checkLoaded();const w=this.getLayer(s);w?w.minzoom===A&&w.maxzoom===y||(A!=null&&(w.minzoom=A),y!=null&&(w.maxzoom=y),this._updateLayer(w)):this.fire(new a.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${s}".`)))}setFilter(s,A,y={}){this._checkLoaded();const w=this.getLayer(s);if(w){if(!B(w.filter,A))return A==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(a.validateStyle.filter,`layers.${w.id}.filter`,A,null,y)||(w.filter=a.clone$1(A),this._updateLayer(w)))}else this.fire(new a.ErrorEvent(new Error(`Cannot filter non-existing layer "${s}".`)))}getFilter(s){return a.clone$1(this.getLayer(s).filter)}setLayoutProperty(s,A,y,w={}){this._checkLoaded();const M=this.getLayer(s);M?B(M.getLayoutProperty(A),y)||(M.setLayoutProperty(A,y,w),this._updateLayer(M)):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${s}".`)))}getLayoutProperty(s,A){const y=this.getLayer(s);if(y)return y.getLayoutProperty(A);this.fire(new a.ErrorEvent(new Error(`Cannot get style of non-existing layer "${s}".`)))}setPaintProperty(s,A,y,w={}){this._checkLoaded();const M=this.getLayer(s);M?B(M.getPaintProperty(A),y)||(M.setPaintProperty(A,y,w)&&this._updateLayer(M),this._changed=!0,this._updatedPaintProps[s]=!0):this.fire(new a.ErrorEvent(new Error(`Cannot style non-existing layer "${s}".`)))}getPaintProperty(s,A){return this.getLayer(s).getPaintProperty(A)}setFeatureState(s,A){this._checkLoaded();const y=s.source,w=s.sourceLayer,M=this.sourceCaches[y];if(M===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const L=M.getSource().type;L==="geojson"&&w?this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):L!=="vector"||w?(s.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),M.setFeatureState(w,s.id,A)):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(s,A){this._checkLoaded();const y=s.source,w=this.sourceCaches[y];if(w===void 0)return void this.fire(new a.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const M=w.getSource().type,L=M==="vector"?s.sourceLayer:void 0;M!=="vector"||L?A&&typeof s.id!="string"&&typeof s.id!="number"?this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):w.removeFeatureState(L,s.id,A):this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(s){this._checkLoaded();const A=s.source,y=s.sourceLayer,w=this.sourceCaches[A];if(w!==void 0)return w.getSource().type!=="vector"||y?(s.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),w.getFeatureState(y,s.id)):void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.ErrorEvent(new Error(`The source '${A}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:a.mapObject(this.sourceCaches,s=>s.serialize()),layers:this._serializeLayers(this._order)},s=>s!==void 0)}_updateLayer(s){this._updatedLayers[s.id]=!0,s.source&&!this._updatedSources[s.source]&&this.sourceCaches[s.source].getSource().type!=="raster"&&(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(s){const A=L=>this._layers[L].type==="fill-extrusion",y={},w=[];for(let L=this._order.length-1;L>=0;L--){const N=this._order[L];if(A(N)){y[N]=L;for(const V of s){const $=V[N];if($)for(const Q of $)w.push(Q)}}}w.sort((L,N)=>N.intersectionZ-L.intersectionZ);const M=[];for(let L=this._order.length-1;L>=0;L--){const N=this._order[L];if(A(N))for(let V=w.length-1;V>=0;V--){const $=w[V].feature;if(y[$.layer.id]<L)break;M.push($),w.pop()}else for(const V of s){const $=V[N];if($)for(const Q of $)M.push(Q.feature)}}return M}queryRenderedFeatures(s,A,y){A&&A.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",A.filter,null,A);const w={};if(A&&A.layers){if(!Array.isArray(A.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const L of A.layers){const N=this._layers[L];if(!N)return this.fire(new a.ErrorEvent(new Error(`The layer '${L}' does not exist in the map's style and cannot be queried for features.`))),[];w[N.source]=!0}}const M=[];A.availableImages=this._availableImages;for(const L in this.sourceCaches)A.layers&&!w[L]||M.push(oi(this.sourceCaches[L],this._layers,this._serializedLayers,s,A,y));return this.placement&&M.push(function(L,N,V,$,Q,J,ce){const ye={},_e=J.queryRenderedSymbols($),oe=[];for(const ge of Object.keys(_e).map(Number))oe.push(ce[ge]);oe.sort(Ri);for(const ge of oe){const De=ge.featureIndex.lookupSymbolFeatures(_e[ge.bucketInstanceId],N,ge.bucketIndex,ge.sourceLayerIndex,Q.filter,Q.layers,Q.availableImages,L);for(const Ve in De){const Ee=ye[Ve]=ye[Ve]||[],Ze=De[Ve];Ze.sort((je,tt)=>{const Ke=ge.featureSortOrder;if(Ke){const d=Ke.indexOf(je.featureIndex);return Ke.indexOf(tt.featureIndex)-d}return tt.featureIndex-je.featureIndex});for(const je of Ze)Ee.push(je)}}for(const ge in ye)ye[ge].forEach(De=>{const Ve=De.feature,Ee=V[L[ge].source].getFeatureState(Ve.layer["source-layer"],Ve.id);Ve.source=Ve.layer.source,Ve.layer["source-layer"]&&(Ve.sourceLayer=Ve.layer["source-layer"]),Ve.state=Ee});return ye}(this._layers,this._serializedLayers,this.sourceCaches,s,A,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(M)}querySourceFeatures(s,A){A&&A.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",A.filter,null,A);const y=this.sourceCaches[s];return y?function(w,M){const L=w.getRenderableIds().map($=>w.getTileByID($)),N=[],V={};for(let $=0;$<L.length;$++){const Q=L[$],J=Q.tileID.canonical.key;V[J]||(V[J]=!0,Q.querySourceFeatures(N,M))}return N}(y,A):[]}addSourceType(s,A,y){return me.getSourceType(s)?y(new Error(`A source type called "${s}" already exists.`)):(me.setSourceType(s,A),A.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:A.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(s,A={}){this._checkLoaded();const y=this.light.getLight();let w=!1;for(const L in s)if(!B(s[L],y[L])){w=!0;break}if(!w)return;const M={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(s,A),this.light.updateTransitions(M)}_validate(s,A,y,w,M={}){return(!M||M.validate!==!1)&&dn(this,s.call(a.validateStyle,a.extend({key:A,style:this.serialize(),value:y,styleSpec:a.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const A=this.sourceCaches[s];A.setEventedParent(null),A.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(s){this.sourceCaches[s].clearTiles()}_reloadSource(s){this.sourceCaches[s].resume(),this.sourceCaches[s].reload()}_updateSources(s){for(const A in this.sourceCaches)this.sourceCaches[A].update(s,this.terrain)}_generateCollisionBoxes(){for(const s in this.sourceCaches)this._reloadSource(s)}_updatePlacement(s,A,y,w,M=!1){let L=!1,N=!1;const V={};for(const $ of this._order){const Q=this._layers[$];if(Q.type!=="symbol")continue;if(!V[Q.source]){const ce=this.sourceCaches[Q.source];V[Q.source]=ce.getRenderableIds(!0).map(ye=>ce.getTileByID(ye)).sort((ye,_e)=>_e.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(_e.tileID)?-1:1))}const J=this.crossTileSymbolIndex.addLayer(Q,V[Q.source],s.center.lng);L=L||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((M=M||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),s.zoom))&&(this.pauseablePlacement=new Ne(s,this.terrain,this._order,M,A,y,w,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,V),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),N=!0),L&&this.pauseablePlacement.placement.setStale()),N||L)for(const $ of this._order){const Q=this._layers[$];Q.type==="symbol"&&this.placement.updateLayerOpacities(Q,V[Q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const s in this.sourceCaches)this.sourceCaches[s].releaseSymbolFadeTiles()}getImages(s,A,y){this.imageManager.getImages(A.icons,y),this._updateTilesForChangedImages();const w=this.sourceCaches[A.source];w&&w.setDependencies(A.tileID.key,A.type,A.icons)}getGlyphs(s,A,y){this.glyphManager.getGlyphs(A.stacks,y)}getResource(s,A,y){return a.makeRequest(A,y)}}me.getSourceType=function(x){return Mn[x]},me.setSourceType=function(x,s){Mn[x]=s},me.registerForPluginStateChange=a.registerForPluginStateChange;var Qt="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const Bi={prelude:Rn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Rn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Rn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Rn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Rn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Rn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Rn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Rn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Rn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Rn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Rn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Rn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Rn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Rn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Rn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Rn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Rn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Rn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Rn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Rn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Rn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Rn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Rn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Rn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Qt),terrainDepth:Rn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Qt),terrainCoords:Rn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Qt)};function Rn(x,s){const A=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=s.match(/attribute ([\w]+) ([\w]+)/g),w=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=M?M.concat(w):w,N={};return{fragmentSource:x=x.replace(A,(V,$,Q,J,ce)=>(N[ce]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
varying ${Q} ${J} ${ce};
#else
uniform ${Q} ${J} u_${ce};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ce}
    ${Q} ${J} ${ce} = u_${ce};
#endif
`)),vertexSource:s=s.replace(A,(V,$,Q,J,ce)=>{const ye=J==="float"?"vec2":"vec4",_e=ce.match(/color/)?"color":ye;return N[ce]?$==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${Q} ${ye} a_${ce};
varying ${Q} ${J} ${ce};
#else
uniform ${Q} ${J} u_${ce};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = a_${ce};
#else
    ${Q} ${J} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${ce} = unpack_mix_${_e}(a_${ce}, u_${ce}_t);
#else
    ${Q} ${J} ${ce} = u_${ce};
#endif
`:$==="define"?`
#ifndef HAS_UNIFORM_u_${ce}
uniform lowp float u_${ce}_t;
attribute ${Q} ${ye} a_${ce};
#else
uniform ${Q} ${J} u_${ce};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ce}
    ${Q} ${J} ${ce} = a_${ce};
#else
    ${Q} ${J} ${ce} = u_${ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ce}
    ${Q} ${J} ${ce} = unpack_mix_${_e}(a_${ce}, u_${ce}_t);
#else
    ${Q} ${J} ${ce} = u_${ce};
#endif
`}),staticAttributes:y,staticUniforms:L}}class Ss{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(s,A,y,w,M,L,N,V,$){this.context=s;let Q=this.boundPaintVertexBuffers.length!==w.length;for(let J=0;!Q&&J<w.length;J++)this.boundPaintVertexBuffers[J]!==w[J]&&(Q=!0);s.extVertexArrayObject&&this.vao&&this.boundProgram===A&&this.boundLayoutVertexBuffer===y&&!Q&&this.boundIndexBuffer===M&&this.boundVertexOffset===L&&this.boundDynamicVertexBuffer===N&&this.boundDynamicVertexBuffer2===V&&this.boundDynamicVertexBuffer3===$?(s.bindVertexArrayOES.set(this.vao),N&&N.bind(),M&&M.dynamicDraw&&M.bind(),V&&V.bind(),$&&$.bind()):this.freshBind(A,y,w,M,L,N,V,$)}freshBind(s,A,y,w,M,L,N,V){let $;const Q=s.numAttributes,J=this.context,ce=J.gl;if(J.extVertexArrayObject)this.vao&&this.destroy(),this.vao=J.extVertexArrayObject.createVertexArrayOES(),J.bindVertexArrayOES.set(this.vao),$=0,this.boundProgram=s,this.boundLayoutVertexBuffer=A,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=w,this.boundVertexOffset=M,this.boundDynamicVertexBuffer=L,this.boundDynamicVertexBuffer2=N,this.boundDynamicVertexBuffer3=V;else{$=J.currentNumAttributes||0;for(let ye=Q;ye<$;ye++)ce.disableVertexAttribArray(ye)}A.enableAttributes(ce,s);for(const ye of y)ye.enableAttributes(ce,s);L&&L.enableAttributes(ce,s),N&&N.enableAttributes(ce,s),V&&V.enableAttributes(ce,s),A.bind(),A.setVertexAttribPointers(ce,s,M);for(const ye of y)ye.bind(),ye.setVertexAttribPointers(ce,s,M);L&&(L.bind(),L.setVertexAttribPointers(ce,s,M)),w&&w.bind(),N&&(N.bind(),N.setVertexAttribPointers(ce,s,M)),V&&(V.bind(),V.setVertexAttribPointers(ce,s,M)),J.currentNumAttributes=Q}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ms(x){const s=[];for(let A=0;A<x.length;A++){if(x[A]===null)continue;const y=x[A].split(" ");s.push(y.pop())}return s}class Xs{constructor(s,A,y,w,M,L,N){const V=s.gl;this.program=V.createProgram();const $=Ms(y.staticAttributes),Q=w?w.getBinderAttributes():[],J=$.concat(Q),ce=Bi.prelude.staticUniforms?Ms(Bi.prelude.staticUniforms):[],ye=y.staticUniforms?Ms(y.staticUniforms):[],_e=w?w.getBinderUniforms():[],oe=ce.concat(ye).concat(_e),ge=[];for(const Ke of oe)ge.indexOf(Ke)<0&&ge.push(Ke);const De=w?w.defines():[];L&&De.push("#define OVERDRAW_INSPECTOR;"),N&&De.push("#define TERRAIN3D;");const Ve=De.concat(Bi.prelude.fragmentSource,y.fragmentSource).join(`
`),Ee=De.concat(Bi.prelude.vertexSource,y.vertexSource).join(`
`),Ze=V.createShader(V.FRAGMENT_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);V.shaderSource(Ze,Ve),V.compileShader(Ze),V.attachShader(this.program,Ze);const je=V.createShader(V.VERTEX_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);V.shaderSource(je,Ee),V.compileShader(je),V.attachShader(this.program,je),this.attributes={};const tt={};this.numAttributes=J.length;for(let Ke=0;Ke<this.numAttributes;Ke++)J[Ke]&&(V.bindAttribLocation(this.program,Ke,J[Ke]),this.attributes[J[Ke]]=Ke);V.linkProgram(this.program),V.deleteShader(je),V.deleteShader(Ze);for(let Ke=0;Ke<ge.length;Ke++){const d=ge[Ke];if(d&&!tt[d]){const h=V.getUniformLocation(this.program,d);h&&(tt[d]=h)}}this.fixedUniforms=M(s,tt),this.terrainUniforms=((Ke,d)=>({u_depth:new a.Uniform1i(Ke,d.u_depth),u_terrain:new a.Uniform1i(Ke,d.u_terrain),u_terrain_dim:new a.Uniform1f(Ke,d.u_terrain_dim),u_terrain_matrix:new a.UniformMatrix4f(Ke,d.u_terrain_matrix),u_terrain_unpack:new a.Uniform4f(Ke,d.u_terrain_unpack),u_terrain_offset:new a.Uniform1f(Ke,d.u_terrain_offset),u_terrain_exaggeration:new a.Uniform1f(Ke,d.u_terrain_exaggeration)}))(s,tt),this.binderUniforms=w?w.getUniforms(s,tt):[]}draw(s,A,y,w,M,L,N,V,$,Q,J,ce,ye,_e,oe,ge,De,Ve){const Ee=s.gl;if(this.failedToCreate)return;if(s.program.set(this.program),s.setDepthMode(y),s.setStencilMode(w),s.setColorMode(M),s.setCullFace(L),V){s.activeTexture.set(Ee.TEXTURE2),Ee.bindTexture(Ee.TEXTURE_2D,V.depthTexture),s.activeTexture.set(Ee.TEXTURE3),Ee.bindTexture(Ee.TEXTURE_2D,V.texture);for(const je in this.terrainUniforms)this.terrainUniforms[je].set(V[je])}for(const je in this.fixedUniforms)this.fixedUniforms[je].set(N[je]);oe&&oe.setUniforms(s,this.binderUniforms,ye,{zoom:_e});let Ze=0;switch(A){case Ee.LINES:Ze=2;break;case Ee.TRIANGLES:Ze=3;break;case Ee.LINE_STRIP:Ze=1}for(const je of ce.get()){const tt=je.vaos||(je.vaos={});(tt[$]||(tt[$]=new Ss)).bind(s,this,Q,oe?oe.getPaintVertexBuffers():[],J,je.vertexOffset,ge,De,Ve),Ee.drawElements(A,je.primitiveLength*Ze,Ee.UNSIGNED_SHORT,je.primitiveOffset*Ze*2)}}}function Ae(x,s,A){const y=1/ai(A,1,s.transform.tileZoom),w=Math.pow(2,A.tileID.overscaledZ),M=A.tileSize*Math.pow(2,s.transform.tileZoom)/w,L=M*(A.tileID.canonical.x+A.tileID.wrap*w),N=M*A.tileID.canonical.y;return{u_image:0,u_texsize:A.imageAtlasTexture.size,u_scale:[y,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[L>>16,N>>16],u_pixel_coord_lower:[65535&L,65535&N]}}const rs=(x,s,A,y)=>{const w=s.style.light,M=w.properties.get("position"),L=[M.x,M.y,M.z],N=a.create$1();w.properties.get("anchor")==="viewport"&&a.fromRotation(N,-s.transform.angle),a.transformMat3(L,L,N);const V=w.properties.get("color");return{u_matrix:x,u_lightpos:L,u_lightintensity:w.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+A,u_opacity:y}},Kr=(x,s,A,y,w,M,L)=>a.extend(rs(x,s,A,y),Ae(M,s,L),{u_height_factor:-Math.pow(2,w.overscaledZ)/L.tileSize/8}),Ys=x=>({u_matrix:x}),Ks=(x,s,A,y)=>a.extend(Ys(x),Ae(A,s,y)),Js=(x,s)=>({u_matrix:x,u_world:s}),ka=(x,s,A,y,w)=>a.extend(Ks(x,s,A,y),{u_world:w}),Pa=(x,s,A,y)=>{const w=x.transform;let M,L;if(y.paint.get("circle-pitch-alignment")==="map"){const N=ai(A,1,w.zoom);M=!0,L=[N,N]}else M=!1,L=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(y.paint.get("circle-pitch-scale")==="map"),u_matrix:x.translatePosMatrix(s.posMatrix,A,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_pitch_with_map:+M,u_device_pixel_ratio:x.pixelRatio,u_extrude_scale:L}},go=(x,s,A)=>{const y=ai(A,1,s.zoom),w=Math.pow(2,s.zoom-A.tileID.overscaledZ),M=A.tileID.overscaleFactor();return{u_matrix:x,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:y,u_extrude_scale:[s.pixelsToGLUnits[0]/(y*w),s.pixelsToGLUnits[1]/(y*w)],u_overscale_factor:M}},ue=(x,s,A=1)=>({u_matrix:x,u_color:s,u_overlay:0,u_overlay_scale:A}),pe=x=>({u_matrix:x}),Ie=(x,s,A,y)=>({u_matrix:x,u_extrude_scale:ai(s,1,A),u_intensity:y});function qe(x,s){const A=Math.pow(2,s.canonical.z),y=s.canonical.y;return[new a.MercatorCoordinate(0,y/A).toLngLat().lat,new a.MercatorCoordinate(0,(y+1)/A).toLngLat().lat]}const ht=(x,s,A,y)=>{const w=x.transform;return{u_matrix:gi(x,s,A,y),u_ratio:1/ai(s,1,w.zoom),u_device_pixel_ratio:x.pixelRatio,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},zt=(x,s,A,y,w)=>a.extend(ht(x,s,A,w),{u_image:0,u_image_height:y}),An=(x,s,A,y,w)=>{const M=x.transform,L=pn(s,M);return{u_matrix:gi(x,s,A,w),u_texsize:s.imageAtlasTexture.size,u_ratio:1/ai(s,1,M.zoom),u_device_pixel_ratio:x.pixelRatio,u_image:0,u_scale:[L,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]]}},ei=(x,s,A,y,w,M)=>{const L=x.lineAtlas,N=pn(s,x.transform),V=A.layout.get("line-cap")==="round",$=L.getDash(y.from,V),Q=L.getDash(y.to,V),J=$.width*w.fromScale,ce=Q.width*w.toScale;return a.extend(ht(x,s,A,M),{u_patternscale_a:[N/J,-$.height/2],u_patternscale_b:[N/ce,-Q.height/2],u_sdfgamma:L.width/(256*Math.min(J,ce)*x.pixelRatio)/2,u_image:0,u_tex_y_a:$.y,u_tex_y_b:Q.y,u_mix:w.t})};function pn(x,s){return 1/ai(x,1,s.tileZoom)}function gi(x,s,A,y){return x.translatePosMatrix(y?y.posMatrix:s.tileID.posMatrix,s,A.paint.get("line-translate"),A.paint.get("line-translate-anchor"))}const In=(x,s,A,y,w)=>{return{u_matrix:x,u_tl_parent:s,u_scale_parent:A,u_buffer_scale:1,u_fade_t:y.mix,u_opacity:y.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(L=w.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(M=w.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:Tl(w.paint.get("raster-hue-rotate"))};var M,L};function Tl(x){x*=Math.PI/180;const s=Math.sin(x),A=Math.cos(x);return[(2*A+1)/3,(-Math.sqrt(3)*s-A+1)/3,(Math.sqrt(3)*s-A+1)/3]}const Sl=(x,s,A,y,w,M,L,N,V,$)=>{const Q=w.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Q.cameraToCenterDistance,u_pitch:Q.pitch/360*2*Math.PI,u_rotate_symbol:+A,u_aspect_ratio:Q.width/Q.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:L,u_coord_matrix:N,u_is_text:+V,u_pitch_with_map:+y,u_texsize:$,u_texture:0}},Ml=(x,s,A,y,w,M,L,N,V,$,Q)=>{const J=w.transform;return a.extend(Sl(x,s,A,y,w,M,L,N,V,$),{u_gamma_scale:y?Math.cos(J._pitch)*J.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:+Q})},Mu=(x,s,A,y,w,M,L,N,V,$)=>a.extend(Ml(x,s,A,y,w,M,L,N,!0,V,!0),{u_texsize_icon:$,u_texture_icon:1}),Eh=(x,s,A)=>({u_matrix:x,u_opacity:s,u_color:A}),Iu=(x,s,A,y,w,M)=>a.extend(function(L,N,V,$){const Q=V.imageManager.getPattern(L.from.toString()),J=V.imageManager.getPattern(L.to.toString()),{width:ce,height:ye}=V.imageManager.getPixelSize(),_e=Math.pow(2,$.tileID.overscaledZ),oe=$.tileSize*Math.pow(2,V.transform.tileZoom)/_e,ge=oe*($.tileID.canonical.x+$.tileID.wrap*_e),De=oe*$.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Q.tl,u_pattern_br_a:Q.br,u_pattern_tl_b:J.tl,u_pattern_br_b:J.br,u_texsize:[ce,ye],u_mix:N.t,u_pattern_size_a:Q.displaySize,u_pattern_size_b:J.displaySize,u_scale_a:N.fromScale,u_scale_b:N.toScale,u_tile_units_to_pixels:1/ai($,1,V.transform.tileZoom),u_pixel_coord_upper:[ge>>16,De>>16],u_pixel_coord_lower:[65535&ge,65535&De]}}(y,M,A,w),{u_matrix:x,u_opacity:s}),La={fillExtrusion:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_lightpos:new a.Uniform3f(x,s.u_lightpos),u_lightintensity:new a.Uniform1f(x,s.u_lightintensity),u_lightcolor:new a.Uniform3f(x,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(x,s.u_vertical_gradient),u_opacity:new a.Uniform1f(x,s.u_opacity)}),fillExtrusionPattern:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_lightpos:new a.Uniform3f(x,s.u_lightpos),u_lightintensity:new a.Uniform1f(x,s.u_lightintensity),u_lightcolor:new a.Uniform3f(x,s.u_lightcolor),u_vertical_gradient:new a.Uniform1f(x,s.u_vertical_gradient),u_height_factor:new a.Uniform1f(x,s.u_height_factor),u_image:new a.Uniform1i(x,s.u_image),u_texsize:new a.Uniform2f(x,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(x,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(x,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(x,s.u_scale),u_fade:new a.Uniform1f(x,s.u_fade),u_opacity:new a.Uniform1f(x,s.u_opacity)}),fill:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix)}),fillPattern:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_image:new a.Uniform1i(x,s.u_image),u_texsize:new a.Uniform2f(x,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(x,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(x,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(x,s.u_scale),u_fade:new a.Uniform1f(x,s.u_fade)}),fillOutline:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_world:new a.Uniform2f(x,s.u_world)}),fillOutlinePattern:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_world:new a.Uniform2f(x,s.u_world),u_image:new a.Uniform1i(x,s.u_image),u_texsize:new a.Uniform2f(x,s.u_texsize),u_pixel_coord_upper:new a.Uniform2f(x,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(x,s.u_pixel_coord_lower),u_scale:new a.Uniform3f(x,s.u_scale),u_fade:new a.Uniform1f(x,s.u_fade)}),circle:(x,s)=>({u_camera_to_center_distance:new a.Uniform1f(x,s.u_camera_to_center_distance),u_scale_with_map:new a.Uniform1i(x,s.u_scale_with_map),u_pitch_with_map:new a.Uniform1i(x,s.u_pitch_with_map),u_extrude_scale:new a.Uniform2f(x,s.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(x,s.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(x,s.u_matrix)}),collisionBox:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_camera_to_center_distance:new a.Uniform1f(x,s.u_camera_to_center_distance),u_pixels_to_tile_units:new a.Uniform1f(x,s.u_pixels_to_tile_units),u_extrude_scale:new a.Uniform2f(x,s.u_extrude_scale),u_overscale_factor:new a.Uniform1f(x,s.u_overscale_factor)}),collisionCircle:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_inv_matrix:new a.UniformMatrix4f(x,s.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(x,s.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(x,s.u_viewport_size)}),debug:(x,s)=>({u_color:new a.UniformColor(x,s.u_color),u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_overlay:new a.Uniform1i(x,s.u_overlay),u_overlay_scale:new a.Uniform1f(x,s.u_overlay_scale)}),clippingMask:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix)}),heatmap:(x,s)=>({u_extrude_scale:new a.Uniform1f(x,s.u_extrude_scale),u_intensity:new a.Uniform1f(x,s.u_intensity),u_matrix:new a.UniformMatrix4f(x,s.u_matrix)}),heatmapTexture:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_world:new a.Uniform2f(x,s.u_world),u_image:new a.Uniform1i(x,s.u_image),u_color_ramp:new a.Uniform1i(x,s.u_color_ramp),u_opacity:new a.Uniform1f(x,s.u_opacity)}),hillshade:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_image:new a.Uniform1i(x,s.u_image),u_latrange:new a.Uniform2f(x,s.u_latrange),u_light:new a.Uniform2f(x,s.u_light),u_shadow:new a.UniformColor(x,s.u_shadow),u_highlight:new a.UniformColor(x,s.u_highlight),u_accent:new a.UniformColor(x,s.u_accent)}),hillshadePrepare:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_image:new a.Uniform1i(x,s.u_image),u_dimension:new a.Uniform2f(x,s.u_dimension),u_zoom:new a.Uniform1f(x,s.u_zoom),u_unpack:new a.Uniform4f(x,s.u_unpack)}),line:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_ratio:new a.Uniform1f(x,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(x,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(x,s.u_units_to_pixels)}),lineGradient:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_ratio:new a.Uniform1f(x,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(x,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(x,s.u_units_to_pixels),u_image:new a.Uniform1i(x,s.u_image),u_image_height:new a.Uniform1f(x,s.u_image_height)}),linePattern:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_texsize:new a.Uniform2f(x,s.u_texsize),u_ratio:new a.Uniform1f(x,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(x,s.u_device_pixel_ratio),u_image:new a.Uniform1i(x,s.u_image),u_units_to_pixels:new a.Uniform2f(x,s.u_units_to_pixels),u_scale:new a.Uniform3f(x,s.u_scale),u_fade:new a.Uniform1f(x,s.u_fade)}),lineSDF:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_ratio:new a.Uniform1f(x,s.u_ratio),u_device_pixel_ratio:new a.Uniform1f(x,s.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(x,s.u_units_to_pixels),u_patternscale_a:new a.Uniform2f(x,s.u_patternscale_a),u_patternscale_b:new a.Uniform2f(x,s.u_patternscale_b),u_sdfgamma:new a.Uniform1f(x,s.u_sdfgamma),u_image:new a.Uniform1i(x,s.u_image),u_tex_y_a:new a.Uniform1f(x,s.u_tex_y_a),u_tex_y_b:new a.Uniform1f(x,s.u_tex_y_b),u_mix:new a.Uniform1f(x,s.u_mix)}),raster:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_tl_parent:new a.Uniform2f(x,s.u_tl_parent),u_scale_parent:new a.Uniform1f(x,s.u_scale_parent),u_buffer_scale:new a.Uniform1f(x,s.u_buffer_scale),u_fade_t:new a.Uniform1f(x,s.u_fade_t),u_opacity:new a.Uniform1f(x,s.u_opacity),u_image0:new a.Uniform1i(x,s.u_image0),u_image1:new a.Uniform1i(x,s.u_image1),u_brightness_low:new a.Uniform1f(x,s.u_brightness_low),u_brightness_high:new a.Uniform1f(x,s.u_brightness_high),u_saturation_factor:new a.Uniform1f(x,s.u_saturation_factor),u_contrast_factor:new a.Uniform1f(x,s.u_contrast_factor),u_spin_weights:new a.Uniform3f(x,s.u_spin_weights)}),symbolIcon:(x,s)=>({u_is_size_zoom_constant:new a.Uniform1i(x,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(x,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(x,s.u_size_t),u_size:new a.Uniform1f(x,s.u_size),u_camera_to_center_distance:new a.Uniform1f(x,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(x,s.u_pitch),u_rotate_symbol:new a.Uniform1i(x,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(x,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(x,s.u_fade_change),u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(x,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(x,s.u_coord_matrix),u_is_text:new a.Uniform1i(x,s.u_is_text),u_pitch_with_map:new a.Uniform1i(x,s.u_pitch_with_map),u_texsize:new a.Uniform2f(x,s.u_texsize),u_texture:new a.Uniform1i(x,s.u_texture)}),symbolSDF:(x,s)=>({u_is_size_zoom_constant:new a.Uniform1i(x,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(x,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(x,s.u_size_t),u_size:new a.Uniform1f(x,s.u_size),u_camera_to_center_distance:new a.Uniform1f(x,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(x,s.u_pitch),u_rotate_symbol:new a.Uniform1i(x,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(x,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(x,s.u_fade_change),u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(x,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(x,s.u_coord_matrix),u_is_text:new a.Uniform1i(x,s.u_is_text),u_pitch_with_map:new a.Uniform1i(x,s.u_pitch_with_map),u_texsize:new a.Uniform2f(x,s.u_texsize),u_texture:new a.Uniform1i(x,s.u_texture),u_gamma_scale:new a.Uniform1f(x,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(x,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(x,s.u_is_halo)}),symbolTextAndIcon:(x,s)=>({u_is_size_zoom_constant:new a.Uniform1i(x,s.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(x,s.u_is_size_feature_constant),u_size_t:new a.Uniform1f(x,s.u_size_t),u_size:new a.Uniform1f(x,s.u_size),u_camera_to_center_distance:new a.Uniform1f(x,s.u_camera_to_center_distance),u_pitch:new a.Uniform1f(x,s.u_pitch),u_rotate_symbol:new a.Uniform1i(x,s.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(x,s.u_aspect_ratio),u_fade_change:new a.Uniform1f(x,s.u_fade_change),u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(x,s.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(x,s.u_coord_matrix),u_is_text:new a.Uniform1i(x,s.u_is_text),u_pitch_with_map:new a.Uniform1i(x,s.u_pitch_with_map),u_texsize:new a.Uniform2f(x,s.u_texsize),u_texsize_icon:new a.Uniform2f(x,s.u_texsize_icon),u_texture:new a.Uniform1i(x,s.u_texture),u_texture_icon:new a.Uniform1i(x,s.u_texture_icon),u_gamma_scale:new a.Uniform1f(x,s.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(x,s.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(x,s.u_is_halo)}),background:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_opacity:new a.Uniform1f(x,s.u_opacity),u_color:new a.UniformColor(x,s.u_color)}),backgroundPattern:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_opacity:new a.Uniform1f(x,s.u_opacity),u_image:new a.Uniform1i(x,s.u_image),u_pattern_tl_a:new a.Uniform2f(x,s.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(x,s.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(x,s.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(x,s.u_pattern_br_b),u_texsize:new a.Uniform2f(x,s.u_texsize),u_mix:new a.Uniform1f(x,s.u_mix),u_pattern_size_a:new a.Uniform2f(x,s.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(x,s.u_pattern_size_b),u_scale_a:new a.Uniform1f(x,s.u_scale_a),u_scale_b:new a.Uniform1f(x,s.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(x,s.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(x,s.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(x,s.u_tile_units_to_pixels)}),terrain:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_texture:new a.Uniform1i(x,s.u_texture)}),terrainDepth:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix)}),terrainCoords:(x,s)=>({u_matrix:new a.UniformMatrix4f(x,s.u_matrix),u_texture:new a.Uniform1i(x,s.u_texture),u_terrain_coords_id:new a.Uniform1f(x,s.u_terrain_coords_id)})};class Ra{constructor(s,A,y){this.context=s;const w=s.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,A.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete A.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){const A=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),A.bufferSubData(A.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const wc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class bc{constructor(s,A,y,w){this.length=A.length,this.attributes=y,this.itemSize=A.bytesPerElement,this.dynamicDraw=w,this.context=s;const M=s.gl;this.buffer=M.createBuffer(),s.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,A.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete A.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){if(s.length!==this.length)throw new Error(`Length of new data is ${s.length}, which doesn't match current length of ${this.length}`);const A=this.context.gl;this.bind(),A.bufferSubData(A.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,A){for(let y=0;y<this.attributes.length;y++){const w=A.attributes[this.attributes[y].name];w!==void 0&&s.enableVertexAttribArray(w)}}setVertexAttribPointers(s,A,y){for(let w=0;w<this.attributes.length;w++){const M=this.attributes[w],L=A.attributes[M.name];L!==void 0&&s.vertexAttribPointer(L,M.components,s[wc[M.type]],!1,this.itemSize,M.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Dn{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ec extends Dn{getDefault(){return a.Color.transparent}set(s){const A=this.current;(s.r!==A.r||s.g!==A.g||s.b!==A.b||s.a!==A.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Cu extends Dn{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class Da extends Dn{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class za extends Dn{getDefault(){return[!0,!0,!0,!0]}set(s){const A=this.current;(s[0]!==A[0]||s[1]!==A[1]||s[2]!==A[2]||s[3]!==A[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class ku extends Dn{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Zn extends Dn{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class Po extends Dn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const A=this.current;(s.func!==A.func||s.ref!==A.ref||s.mask!==A.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Oi extends Dn{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const A=this.current;(s[0]!==A[0]||s[1]!==A[1]||s[2]!==A[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class ea extends Dn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;s?A.enable(A.STENCIL_TEST):A.disable(A.STENCIL_TEST),this.current=s,this.dirty=!1}}class Il extends Dn{getDefault(){return[0,1]}set(s){const A=this.current;(s[0]!==A[0]||s[1]!==A[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class ta extends Dn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;s?A.enable(A.DEPTH_TEST):A.disable(A.DEPTH_TEST),this.current=s,this.dirty=!1}}class Cl extends Dn{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Tc extends Dn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;s?A.enable(A.BLEND):A.disable(A.BLEND),this.current=s,this.dirty=!1}}class Sc extends Dn{getDefault(){const s=this.gl;return[s.ONE,s.ZERO]}set(s){const A=this.current;(s[0]!==A[0]||s[1]!==A[1]||this.dirty)&&(this.gl.blendFunc(s[0],s[1]),this.current=s,this.dirty=!1)}}class Ba extends Dn{getDefault(){return a.Color.transparent}set(s){const A=this.current;(s.r!==A.r||s.g!==A.g||s.b!==A.b||s.a!==A.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Oa extends Dn{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquation(s),this.current=s,this.dirty=!1)}}class os extends Dn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;s?A.enable(A.CULL_FACE):A.disable(A.CULL_FACE),this.current=s,this.dirty=!1}}class Is extends Dn{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class Pu extends Dn{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}class kl extends Dn{getDefault(){return null}set(s){(s!==this.current||this.dirty)&&(this.gl.useProgram(s),this.current=s,this.dirty=!1)}}class Cs extends Dn{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class ss extends Dn{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const A=this.current;(s[0]!==A[0]||s[1]!==A[1]||s[2]!==A[2]||s[3]!==A[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Lu extends Dn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;A.bindFramebuffer(A.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class Ru extends Dn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;A.bindRenderbuffer(A.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Fa extends Dn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;A.bindTexture(A.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class Pl extends Dn{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;A.bindBuffer(A.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Mc extends Dn{getDefault(){return null}set(s){const A=this.gl;A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Ll extends Dn{constructor(s){super(s),this.vao=s.extVertexArrayObject}getDefault(){return null}set(s){this.vao&&(s!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(s),this.current=s,this.dirty=!1)}}class na extends Dn{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;A.pixelStorei(A.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class Du extends Dn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class zu extends Dn{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const A=this.gl;A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Rl extends Dn{constructor(s,A){super(s),this.context=s,this.parent=A}getDefault(){return null}}class ks extends Rl{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const A=this.gl;A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Bu extends Rl{set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const A=this.gl;A.framebufferRenderbuffer(A.FRAMEBUFFER,A.DEPTH_ATTACHMENT,A.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class ia{constructor(s,A,y,w){this.context=s,this.width=A,this.height=y;const M=s.gl,L=this.framebuffer=M.createFramebuffer();if(this.colorAttachment=new ks(s,L),w&&(this.depthAttachment=new Bu(s,L)),M.checkFramebufferStatus(M.FRAMEBUFFER)!==M.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const s=this.context.gl,A=this.colorAttachment.get();if(A&&s.deleteTexture(A),this.depthAttachment){const y=this.depthAttachment.get();y&&s.deleteRenderbuffer(y)}s.deleteFramebuffer(this.framebuffer)}}class Yn{constructor(s,A,y){this.blendFunction=s,this.blendColor=A,this.mask=y}}Yn.Replace=[1,0],Yn.disabled=new Yn(Yn.Replace,a.Color.transparent,[!1,!1,!1,!1]),Yn.unblended=new Yn(Yn.Replace,a.Color.transparent,[!0,!0,!0,!0]),Yn.alphaBlended=new Yn([1,771],a.Color.transparent,[!0,!0,!0,!0]);class Na{constructor(s){this.gl=s,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ec(this),this.clearDepth=new Cu(this),this.clearStencil=new Da(this),this.colorMask=new za(this),this.depthMask=new ku(this),this.stencilMask=new Zn(this),this.stencilFunc=new Po(this),this.stencilOp=new Oi(this),this.stencilTest=new ea(this),this.depthRange=new Il(this),this.depthTest=new ta(this),this.depthFunc=new Cl(this),this.blend=new Tc(this),this.blendFunc=new Sc(this),this.blendColor=new Ba(this),this.blendEquation=new Oa(this),this.cullFace=new os(this),this.cullFaceSide=new Is(this),this.frontFace=new Pu(this),this.program=new kl(this),this.activeTexture=new Cs(this),this.viewport=new ss(this),this.bindFramebuffer=new Lu(this),this.bindRenderbuffer=new Ru(this),this.bindTexture=new Fa(this),this.bindVertexBuffer=new Pl(this),this.bindElementBuffer=new Mc(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ll(this),this.pixelStoreUnpack=new na(this),this.pixelStoreUnpackPremultiplyAlpha=new Du(this),this.pixelStoreUnpackFlipY=new zu(this),this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=s.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(s.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,A){return new Ra(this,s,A)}createVertexBuffer(s,A,y){return new bc(this,s,A,y)}createRenderbuffer(s,A,y){const w=this.gl,M=w.createRenderbuffer();return this.bindRenderbuffer.set(M),w.renderbufferStorage(w.RENDERBUFFER,s,A,y),this.bindRenderbuffer.set(null),M}createFramebuffer(s,A,y){return new ia(this,s,A,y)}clear({color:s,depth:A}){const y=this.gl;let w=0;s&&(w|=y.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),A!==void 0&&(w|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(A),this.depthMask.set(!0)),y.clear(w)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){B(s.blendFunction,Yn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor)),this.colorMask.set(s.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class En{constructor(s,A,y){this.func=s,this.mask=A,this.range=y}}En.ReadOnly=!1,En.ReadWrite=!0,En.disabled=new En(519,En.ReadOnly,[0,1]);const Bn=7680;class Qn{constructor(s,A,y,w,M,L){this.test=s,this.ref=A,this.mask=y,this.fail=w,this.depthFail=M,this.pass=L}}Qn.disabled=new Qn({func:519,mask:0},0,0,Bn,Bn,Bn);class jn{constructor(s,A,y){this.enable=s,this.mode=A,this.frontFace=y}}let Ua;function as(x,s,A,y,w,M,L){const N=x.context,V=N.gl,$=x.useProgram("collisionBox"),Q=[];let J=0,ce=0;for(let Ee=0;Ee<y.length;Ee++){const Ze=y[Ee],je=s.getTile(Ze),tt=je.getBucket(A);if(!tt)continue;let Ke=Ze.posMatrix;w[0]===0&&w[1]===0||(Ke=x.translatePosMatrix(Ze.posMatrix,je,w,M));const d=L?tt.textCollisionBox:tt.iconCollisionBox,h=tt.collisionCircleArray;if(h.length>0){const m=a.create(),_=Ke;a.mul(m,tt.placementInvProjMatrix,x.transform.glCoordMatrix),a.mul(m,m,tt.placementViewportMatrix),Q.push({circleArray:h,circleOffset:ce,transform:_,invTransform:m,coord:Ze}),J+=h.length/4,ce=J}d&&$.draw(N,V.LINES,En.disabled,Qn.disabled,x.colorModeForRenderPass(),jn.disabled,go(Ke,x.transform,je),x.style.terrain&&x.style.terrain.getTerrainData(Ze),A.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,null,x.transform.zoom,null,null,d.collisionVertexBuffer)}if(!L||!Q.length)return;const ye=x.useProgram("collisionCircle"),_e=new a.CollisionCircleLayoutArray;_e.resize(4*J),_e._trim();let oe=0;for(const Ee of Q)for(let Ze=0;Ze<Ee.circleArray.length/4;Ze++){const je=4*Ze,tt=Ee.circleArray[je+0],Ke=Ee.circleArray[je+1],d=Ee.circleArray[je+2],h=Ee.circleArray[je+3];_e.emplace(oe++,tt,Ke,d,h,0),_e.emplace(oe++,tt,Ke,d,h,1),_e.emplace(oe++,tt,Ke,d,h,2),_e.emplace(oe++,tt,Ke,d,h,3)}(!Ua||Ua.length<2*J)&&(Ua=function(Ee){const Ze=2*Ee,je=new a.QuadTriangleArray;je.resize(Ze),je._trim();for(let tt=0;tt<Ze;tt++){const Ke=6*tt;je.uint16[Ke+0]=4*tt+0,je.uint16[Ke+1]=4*tt+1,je.uint16[Ke+2]=4*tt+2,je.uint16[Ke+3]=4*tt+2,je.uint16[Ke+4]=4*tt+3,je.uint16[Ke+5]=4*tt+0}return je}(J));const ge=N.createIndexBuffer(Ua,!0),De=N.createVertexBuffer(_e,a.collisionCircleLayout.members,!0);for(const Ee of Q){const Ze={u_matrix:Ee.transform,u_inv_matrix:Ee.invTransform,u_camera_to_center_distance:(Ve=x.transform).cameraToCenterDistance,u_viewport_size:[Ve.width,Ve.height]};ye.draw(N,V.TRIANGLES,En.disabled,Qn.disabled,x.colorModeForRenderPass(),jn.disabled,Ze,x.style.terrain&&x.style.terrain.getTerrainData(Ee.coord),A.id,De,ge,a.SegmentVector.simpleSegment(0,2*Ee.circleOffset,Ee.circleArray.length,Ee.circleArray.length/2),null,x.transform.zoom,null,null,null)}var Ve;De.destroy(),ge.destroy()}jn.disabled=new jn(!1,1029,2305),jn.backCCW=new jn(!0,1029,2305);const Ou=a.identity(new Float32Array(16));function ra(x,s,A,y,w,M){const{horizontalAlign:L,verticalAlign:N}=a.getAnchorAlignment(x),V=-(L-.5)*s,$=-(N-.5)*A,Q=a.evaluateVariableOffset(x,y);return new a.pointGeometry((V/w+Q[0])*M,($/w+Q[1])*M)}function Fu(x,s,A,y,w,M,L,N,V,$,Q){const J=x.text.placedSymbolArray,ce=x.text.dynamicLayoutVertexArray,ye=x.icon.dynamicLayoutVertexArray,_e={};ce.clear();for(let oe=0;oe<J.length;oe++){const ge=J.get(oe),De=x.allowVerticalPlacement&&!ge.placedOrientation,Ve=ge.hidden||!ge.crossTileID||De?null:y[ge.crossTileID];if(Ve){const Ee=new a.pointGeometry(ge.anchorX,ge.anchorY),Ze=vn(Ee,A?L:M,Q),je=dr(w.cameraToCenterDistance,Ze.signedDistanceFromCamera);let tt=a.evaluateSizeForFeature(x.textSizeData,V,ge)*je/a.ONE_EM;A&&(tt*=x.tilePixelRatio/N);const{width:Ke,height:d,anchor:h,textOffset:m,textBoxScale:_}=Ve,v=ra(h,Ke,d,m,_,tt),E=A?vn(Ee.add(v),M,Q).point:Ze.point.add(s?v.rotate(-w.angle):v),I=x.allowVerticalPlacement&&ge.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let P=0;P<ge.numGlyphs;P++)a.addDynamicAttributes(ce,E,I);$&&ge.associatedIconIndex>=0&&(_e[ge.associatedIconIndex]={shiftedAnchor:E,angle:I})}else rn(ge.numGlyphs,ce)}if($){ye.clear();const oe=x.icon.placedSymbolArray;for(let ge=0;ge<oe.length;ge++){const De=oe.get(ge);if(De.hidden)rn(De.numGlyphs,ye);else{const Ve=_e[ge];if(Ve)for(let Ee=0;Ee<De.numGlyphs;Ee++)a.addDynamicAttributes(ye,Ve.shiftedAnchor,Ve.angle);else rn(De.numGlyphs,ye)}}x.icon.dynamicLayoutVertexBuffer.updateData(ye)}x.text.dynamicLayoutVertexBuffer.updateData(ce)}function Ic(x,s,A){return A.iconsInText&&s?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function Va(x,s,A,y,w,M,L,N,V,$,Q,J){const ce=x.context,ye=ce.gl,_e=x.transform,oe=N==="map",ge=V==="map",De=N!=="viewport"&&A.layout.get("symbol-placement")!=="point",Ve=oe&&!ge&&!De,Ee=!A.layout.get("symbol-sort-key").isConstant();let Ze=!1;const je=x.depthModeForSublayer(0,En.ReadOnly),tt=A.layout.get("text-variable-anchor"),Ke=[];for(const d of y){const h=s.getTile(d),m=h.getBucket(A);if(!m)continue;const _=w?m.text:m.icon;if(!_||!_.segments.get().length)continue;const v=_.programConfigurations.get(A.id),E=w||m.sdfIcons,I=w?m.textSizeData:m.iconSizeData,P=ge||_e.pitch!==0,O=x.useProgram(Ic(E,w,m),v),G=a.evaluateSizeForZoom(I,_e.zoom),X=x.style.terrain&&x.style.terrain.getTerrainData(d);let de,ve,Re,be,ze=[0,0],Je=null;if(w){if(ve=h.glyphAtlasTexture,Re=ye.LINEAR,de=h.glyphAtlasTexture.size,m.iconsInText){ze=h.imageAtlasTexture.size,Je=h.imageAtlasTexture;const tn=I.kind==="composite"||I.kind==="camera";be=P||x.options.rotating||x.options.zooming||tn?ye.LINEAR:ye.NEAREST}}else{const tn=A.layout.get("icon-size").constantOr(0)!==1||m.iconsNeedLinear;ve=h.imageAtlasTexture,Re=E||x.options.rotating||x.options.zooming||tn||P?ye.LINEAR:ye.NEAREST,de=h.imageAtlasTexture.size}const Ye=ai(h,1,x.transform.zoom),He=po(d.posMatrix,ge,oe,x.transform,Ye),$e=Ki(d.posMatrix,ge,oe,x.transform,Ye),Be=tt&&m.hasTextData(),bt=A.layout.get("icon-text-fit")!=="none"&&Be&&m.hasIconData();if(De){const tn=x.style.terrain?(fn,zn)=>x.style.terrain.getElevation(d,fn,zn):null,sn=A.layout.get("text-rotation-alignment")==="map";or(m,d.posMatrix,x,w,He,$e,ge,$,sn,tn)}const yt=x.translatePosMatrix(d.posMatrix,h,M,L),ot=De||w&&tt||bt?Ou:He,ut=x.translatePosMatrix($e,h,M,L,!0),cn=E&&A.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let on;on=E?m.iconsInText?Mu(I.kind,G,Ve,ge,x,yt,ot,ut,de,ze):Ml(I.kind,G,Ve,ge,x,yt,ot,ut,w,de,!0):Sl(I.kind,G,Ve,ge,x,yt,ot,ut,w,de);const Kt={program:O,buffers:_,uniformValues:on,atlasTexture:ve,atlasTextureIcon:Je,atlasInterpolation:Re,atlasInterpolationIcon:be,isSDF:E,hasHalo:cn};if(Ee&&m.canOverlap){Ze=!0;const tn=_.segments.get();for(const sn of tn)Ke.push({segments:new a.SegmentVector([sn]),sortKey:sn.sortKey,state:Kt,terrainData:X})}else Ke.push({segments:_.segments,sortKey:0,state:Kt,terrainData:X})}Ze&&Ke.sort((d,h)=>d.sortKey-h.sortKey);for(const d of Ke){const h=d.state;if(ce.activeTexture.set(ye.TEXTURE0),h.atlasTexture.bind(h.atlasInterpolation,ye.CLAMP_TO_EDGE),h.atlasTextureIcon&&(ce.activeTexture.set(ye.TEXTURE1),h.atlasTextureIcon&&h.atlasTextureIcon.bind(h.atlasInterpolationIcon,ye.CLAMP_TO_EDGE)),h.isSDF){const m=h.uniformValues;h.hasHalo&&(m.u_is_halo=1,ja(h.buffers,d.segments,A,x,h.program,je,Q,J,m,d.terrainData)),m.u_is_halo=0}ja(h.buffers,d.segments,A,x,h.program,je,Q,J,h.uniformValues,d.terrainData)}}function ja(x,s,A,y,w,M,L,N,V,$){const Q=y.context;w.draw(Q,Q.gl.TRIANGLES,M,L,N,jn.disabled,V,$,A.id,x.layoutVertexBuffer,x.indexBuffer,s,A.paint,y.transform.zoom,x.programConfigurations.get(A.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function oa(x,s,A,y,w,M,L){const N=x.context.gl,V=A.paint.get("fill-pattern"),$=V&&V.constantOr(1),Q=A.getCrossfadeParameters();let J,ce,ye,_e,oe;L?(ce=$&&!A.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",J=N.LINES):(ce=$?"fillPattern":"fill",J=N.TRIANGLES);for(const ge of y){const De=s.getTile(ge);if($&&!De.patternsLoaded())continue;const Ve=De.getBucket(A);if(!Ve)continue;const Ee=Ve.programConfigurations.get(A.id),Ze=x.useProgram(ce,Ee),je=x.style.terrain&&x.style.terrain.getTerrainData(ge);$&&(x.context.activeTexture.set(N.TEXTURE0),De.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Ee.updatePaintBuffers(Q));const tt=V.constantOr(null);if(tt&&De.imageAtlas){const h=De.imageAtlas,m=h.patternPositions[tt.to.toString()],_=h.patternPositions[tt.from.toString()];m&&_&&Ee.setConstantPatternPositions(m,_)}const Ke=je?ge:null,d=x.translatePosMatrix(Ke?Ke.posMatrix:ge.posMatrix,De,A.paint.get("fill-translate"),A.paint.get("fill-translate-anchor"));if(L){_e=Ve.indexBuffer2,oe=Ve.segments2;const h=[N.drawingBufferWidth,N.drawingBufferHeight];ye=ce==="fillOutlinePattern"&&$?ka(d,x,Q,De,h):Js(d,h)}else _e=Ve.indexBuffer,oe=Ve.segments,ye=$?Ks(d,x,Q,De):Ys(d);Ze.draw(x.context,J,w,x.stencilModeForClipping(ge),M,jn.disabled,ye,je,A.id,Ve.layoutVertexBuffer,_e,oe,A.paint,x.transform.zoom,Ee)}}function Ps(x,s,A,y,w,M,L){const N=x.context,V=N.gl,$=A.paint.get("fill-extrusion-pattern"),Q=$.constantOr(1),J=A.getCrossfadeParameters(),ce=A.paint.get("fill-extrusion-opacity");for(const ye of y){const _e=s.getTile(ye),oe=_e.getBucket(A);if(!oe)continue;const ge=x.style.terrain&&x.style.terrain.getTerrainData(ye),De=oe.programConfigurations.get(A.id),Ve=x.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",De);Q&&(x.context.activeTexture.set(V.TEXTURE0),_e.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),De.updatePaintBuffers(J));const Ee=$.constantOr(null);if(Ee&&_e.imageAtlas){const Ke=_e.imageAtlas,d=Ke.patternPositions[Ee.to.toString()],h=Ke.patternPositions[Ee.from.toString()];d&&h&&De.setConstantPatternPositions(d,h)}const Ze=x.translatePosMatrix(ye.posMatrix,_e,A.paint.get("fill-extrusion-translate"),A.paint.get("fill-extrusion-translate-anchor")),je=A.paint.get("fill-extrusion-vertical-gradient"),tt=Q?Kr(Ze,x,je,ce,ye,J,_e):rs(Ze,x,je,ce);Ve.draw(N,N.gl.TRIANGLES,w,M,L,jn.backCCW,tt,ge,A.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,A.paint,x.transform.zoom,De,x.style.terrain&&oe.centroidVertexBuffer)}}function Ga(x,s,A,y,w,M,L){const N=x.context,V=N.gl,$=A.fbo;if(!$)return;const Q=x.useProgram("hillshade"),J=x.style.terrain&&x.style.terrain.getTerrainData(s);N.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,$.colorAttachment.get()),Q.draw(N,V.TRIANGLES,w,M,L,jn.disabled,((ce,ye,_e,oe)=>{const ge=_e.paint.get("hillshade-shadow-color"),De=_e.paint.get("hillshade-highlight-color"),Ve=_e.paint.get("hillshade-accent-color");let Ee=_e.paint.get("hillshade-illumination-direction")*(Math.PI/180);_e.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ee-=ce.transform.angle);const Ze=!ce.options.moving;return{u_matrix:oe?oe.posMatrix:ce.transform.calculatePosMatrix(ye.tileID.toUnwrapped(),Ze),u_image:0,u_latrange:qe(0,ye.tileID),u_light:[_e.paint.get("hillshade-exaggeration"),Ee],u_shadow:ge,u_highlight:De,u_accent:Ve}})(x,A,y,J?s:null),J,y.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}function Ha(x,s,A,y,w,M){const L=x.context,N=L.gl,V=s.dem;if(V&&V.data){const $=V.dim,Q=V.stride,J=V.getPixels();if(L.activeTexture.set(N.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||x.getTileTexture(Q),s.demTexture){const ye=s.demTexture;ye.update(J,{premultiply:!1}),ye.bind(N.NEAREST,N.CLAMP_TO_EDGE)}else s.demTexture=new le(L,J,N.RGBA,{premultiply:!1}),s.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);L.activeTexture.set(N.TEXTURE0);let ce=s.fbo;if(!ce){const ye=new le(L,{width:$,height:$,data:null},N.RGBA);ye.bind(N.LINEAR,N.CLAMP_TO_EDGE),ce=s.fbo=L.createFramebuffer($,$,!0),ce.colorAttachment.set(ye.texture)}L.bindFramebuffer.set(ce.framebuffer),L.viewport.set([0,0,$,$]),x.useProgram("hillshadePrepare").draw(L,N.TRIANGLES,y,w,M,jn.disabled,((ye,_e)=>{const oe=_e.stride,ge=a.create();return a.ortho(ge,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(ge,ge,[0,-a.EXTENT,0]),{u_matrix:ge,u_image:1,u_dimension:[oe,oe],u_zoom:ye.overscaledZ,u_unpack:_e.getUnpackVector()}})(s.tileID,V),null,A.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Gn(x,s,A,y,w,M){const L=y.paint.get("raster-fade-duration");if(!M&&L>0){const N=a.exported.now(),V=(N-x.timeAdded)/L,$=s?(N-s.timeAdded)/L:-1,Q=A.getSource(),J=w.coveringZoomLevel({tileSize:Q.tileSize,roundZoom:Q.roundZoom}),ce=!s||Math.abs(s.tileID.overscaledZ-J)>Math.abs(x.tileID.overscaledZ-J),ye=ce&&x.refreshedUponExpiration?1:a.clamp(ce?V:1-$,0,1);return x.refreshedUponExpiration&&V>=1&&(x.refreshedUponExpiration=!1),s?{opacity:1,mix:1-ye}:{opacity:ye,mix:0}}return{opacity:1,mix:0}}const Dl=new a.Color(1,0,0,1),Jr=new a.Color(0,1,0,1),Nu=new a.Color(0,0,1,1),Cc=new a.Color(1,0,1,1),Uu=new a.Color(0,1,1,1);function Ls(x,s,A,y){Mi(x,0,s+A/2,x.transform.width,A,y)}function $a(x,s,A,y){Mi(x,s-A/2,0,A,x.transform.height,y)}function Mi(x,s,A,y,w,M){const L=x.context,N=L.gl;N.enable(N.SCISSOR_TEST),N.scissor(s*x.pixelRatio,A*x.pixelRatio,y*x.pixelRatio,w*x.pixelRatio),L.clear({color:M}),N.disable(N.SCISSOR_TEST)}function kc(x,s,A){const y=x.context,w=y.gl,M=A.posMatrix,L=x.useProgram("debug"),N=En.disabled,V=Qn.disabled,$=x.colorModeForRenderPass(),Q="$debug",J=x.style.terrain&&x.style.terrain.getTerrainData(A);y.activeTexture.set(w.TEXTURE0),x.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE);const ce=s.getTileByID(A.key).latestRawTileData,ye=Math.floor((ce&&ce.byteLength||0)/1024),_e=s.getTile(A).tileSize,oe=512/Math.min(_e,512)*(A.overscaledZ/x.transform.zoom)*.5;let ge=A.canonical.toString();A.overscaledZ!==A.canonical.z&&(ge+=` => ${A.overscaledZ}`),function(De,Ve){De.initDebugOverlayCanvas();const Ee=De.debugOverlayCanvas,Ze=De.context.gl,je=De.debugOverlayCanvas.getContext("2d");je.clearRect(0,0,Ee.width,Ee.height),je.shadowColor="white",je.shadowBlur=2,je.lineWidth=1.5,je.strokeStyle="white",je.textBaseline="top",je.font="bold 36px Open Sans, sans-serif",je.fillText(Ve,5,5),je.strokeText(Ve,5,5),De.debugOverlayTexture.update(Ee),De.debugOverlayTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE)}(x,`${ge} ${ye}kB`),L.draw(y,w.TRIANGLES,N,V,Yn.alphaBlended,jn.disabled,ue(M,a.Color.transparent,oe),null,Q,x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments),L.draw(y,w.LINE_STRIP,N,V,$,jn.disabled,ue(M,a.Color.red),J,Q,x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments)}function _o(x,s,A){const y=x.context,w=y.gl,M=x.colorModeForRenderPass(),L=new En(w.LEQUAL,En.ReadWrite,x.depthRangeFor3D),N=x.useProgram("terrain"),V=s.getTerrainMesh(),$=s.getTerrainData(A.tileID);y.bindFramebuffer.set(null),y.viewport.set([0,0,x.width,x.height]),y.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,s.getRTTFramebuffer().colorAttachment.get());const Q=x.transform.calculatePosMatrix(A.tileID.toUnwrapped());N.draw(y,w.TRIANGLES,L,Qn.disabled,M,jn.backCCW,{u_matrix:Q,u_texture:0},$,"terrain",V.vertexBuffer,V.indexBuffer,V.segments)}function Vu(x,s,A,y){const w=x.context,M=A.tileSize*s.qualityFactor;A.textures[y]||(A.textures[y]=x.getTileTexture(M)||new le(w,{width:M,height:M,data:null},w.gl.RGBA),A.textures[y].bind(w.gl.LINEAR,w.gl.CLAMP_TO_EDGE),y===0&&s.sourceCache.renderHistory.unshift(A.tileID.key));const L=s.getRTTFramebuffer();L.colorAttachment.set(A.textures[y].texture),w.bindFramebuffer.set(L.framebuffer),w.viewport.set([0,0,M,M])}class zl{constructor(s){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=s,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=s.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const s=this.painter.style,A=s.terrain;for(const y in s.sourceCaches){this._coordsDescendingInv[y]={};const w=s.sourceCaches[y].getVisibleCoordinates();for(const M of w){const L=A.sourceCache.getTerrainCoords(M);for(const N in L)this._coordsDescendingInv[y][N]||(this._coordsDescendingInv[y][N]=[]),this._coordsDescendingInv[y][N].push(L[N])}}for(const y of s._order){const w=s._layers[y],M=w.source;if(this._renderToTexture[w.type]&&!this._coordsDescendingInvStr[M]){this._coordsDescendingInvStr[M]={};for(const L in this._coordsDescendingInv[M])this._coordsDescendingInvStr[M][L]=this._coordsDescendingInv[M][L].map(N=>N.key).sort().join()}}return this._renderableTiles.forEach(y=>{for(const w in this._coordsDescendingInvStr){const M=this._coordsDescendingInvStr[w][y.tileID.key];M&&M!==y.textureCoords[w]&&y.clearTextures(this.painter),A.needsRerender(w,y.tileID)&&y.clearTextures(this.painter)}this._rerender[y.tileID.key]=!y.textures.length}),A.clearRerenderCache(),A.sourceCache.removeOutdated(this.painter),this}renderLayer(s){const A=s.type,y=this.painter,w=y.style._order,M=y.currentLayer,L=M+1===w.length;if(this._renderToTexture[A]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=A,this._stacks[this._stacks.length-1].push(w[M]),!L))return!0;if(this._renderToTexture[this._prevType]||A==="hillshade"||this._renderToTexture[A]&&L){this._prevType=A;const N=this._stacks.length-1,V=this._stacks[N]||[];for(const $ of this._renderableTiles){if(Vu(y,y.style.terrain,$,N),this._rerender[$.tileID.key]){y.context.clear({color:a.Color.transparent});for(let Q=0;Q<V.length;Q++){const J=y.style._layers[V[Q]],ce=J.source?this._coordsDescendingInv[J.source][$.tileID.key]:[$.tileID];y._renderTileClippingMasks(J,ce),y.renderLayer(y,y.style.sourceCaches[J.source],J,ce),J.source&&($.textureCoords[J.source]=this._coordsDescendingInvStr[J.source][$.tileID.key])}}_o(y,y.style.terrain,$)}if(A==="hillshade"){this._stacks.push([w[M]]);for(const $ of this._renderableTiles){const Q=this._coordsDescendingInv[s.source][$.tileID.key];Vu(y,y.style.terrain,$,this._stacks.length-1),y.context.clear({color:a.Color.transparent}),y._renderTileClippingMasks(s,Q),y.renderLayer(y,y.style.sourceCaches[s.source],s,Q),_o(y,y.style.terrain,$)}return!0}return this._renderToTexture[A]}return!1}}const Wa={symbol:function(x,s,A,y,w){if(x.renderPass!=="translucent")return;const M=Qn.disabled,L=x.colorModeForRenderPass();A.layout.get("text-variable-anchor")&&function(N,V,$,Q,J,ce,ye){const _e=V.transform,oe=J==="map",ge=ce==="map";for(const De of N){const Ve=Q.getTile(De),Ee=Ve.getBucket($);if(!Ee||!Ee.text||!Ee.text.segments.get().length)continue;const Ze=a.evaluateSizeForZoom(Ee.textSizeData,_e.zoom),je=ai(Ve,1,V.transform.zoom),tt=po(De.posMatrix,ge,oe,V.transform,je),Ke=$.layout.get("icon-text-fit")!=="none"&&Ee.hasIconData();if(Ze){const d=Math.pow(2,_e.zoom-Ve.tileID.overscaledZ);Fu(Ee,oe,ge,ye,_e,tt,De.posMatrix,d,Ze,Ke,V.style.terrain?(h,m)=>V.style.terrain.getElevation(De,h,m):null)}}}(y,x,A,s,A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),w),A.paint.get("icon-opacity").constantOr(1)!==0&&Va(x,s,A,y,!1,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),A.layout.get("icon-rotation-alignment"),A.layout.get("icon-pitch-alignment"),A.layout.get("icon-keep-upright"),M,L),A.paint.get("text-opacity").constantOr(1)!==0&&Va(x,s,A,y,!0,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),A.layout.get("text-keep-upright"),M,L),s.map.showCollisionBoxes&&(as(x,s,A,y,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),!0),as(x,s,A,y,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),!1))},circle:function(x,s,A,y){if(x.renderPass!=="translucent")return;const w=A.paint.get("circle-opacity"),M=A.paint.get("circle-stroke-width"),L=A.paint.get("circle-stroke-opacity"),N=!A.layout.get("circle-sort-key").isConstant();if(w.constantOr(1)===0&&(M.constantOr(1)===0||L.constantOr(1)===0))return;const V=x.context,$=V.gl,Q=x.depthModeForSublayer(0,En.ReadOnly),J=Qn.disabled,ce=x.colorModeForRenderPass(),ye=[];for(let _e=0;_e<y.length;_e++){const oe=y[_e],ge=s.getTile(oe),De=ge.getBucket(A);if(!De)continue;const Ve=De.programConfigurations.get(A.id),Ee=x.useProgram("circle",Ve),Ze=De.layoutVertexBuffer,je=De.indexBuffer,tt=x.style.terrain&&x.style.terrain.getTerrainData(oe),Ke={programConfiguration:Ve,program:Ee,layoutVertexBuffer:Ze,indexBuffer:je,uniformValues:Pa(x,oe,ge,A),terrainData:tt};if(N){const d=De.segments.get();for(const h of d)ye.push({segments:new a.SegmentVector([h]),sortKey:h.sortKey,state:Ke})}else ye.push({segments:De.segments,sortKey:0,state:Ke})}N&&ye.sort((_e,oe)=>_e.sortKey-oe.sortKey);for(const _e of ye){const{programConfiguration:oe,program:ge,layoutVertexBuffer:De,indexBuffer:Ve,uniformValues:Ee,terrainData:Ze}=_e.state;ge.draw(V,$.TRIANGLES,Q,J,ce,jn.disabled,Ee,Ze,A.id,De,Ve,_e.segments,A.paint,x.transform.zoom,oe)}},heatmap:function(x,s,A,y){if(A.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){const w=x.context,M=w.gl,L=Qn.disabled,N=new Yn([M.ONE,M.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(V,$,Q){const J=V.gl;V.activeTexture.set(J.TEXTURE1),V.viewport.set([0,0,$.width/4,$.height/4]);let ce=Q.heatmapFbo;if(ce)J.bindTexture(J.TEXTURE_2D,ce.colorAttachment.get()),V.bindFramebuffer.set(ce.framebuffer);else{const ye=J.createTexture();J.bindTexture(J.TEXTURE_2D,ye),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.LINEAR),ce=Q.heatmapFbo=V.createFramebuffer($.width/4,$.height/4,!1),function(_e,oe,ge,De){const Ve=_e.gl;Ve.texImage2D(Ve.TEXTURE_2D,0,Ve.RGBA,oe.width/4,oe.height/4,0,Ve.RGBA,_e.extRenderToTextureHalfFloat?_e.extTextureHalfFloat.HALF_FLOAT_OES:Ve.UNSIGNED_BYTE,null),De.colorAttachment.set(ge)}(V,$,ye,ce)}})(w,x,A),w.clear({color:a.Color.transparent});for(let V=0;V<y.length;V++){const $=y[V];if(s.hasRenderableParent($))continue;const Q=s.getTile($),J=Q.getBucket(A);if(!J)continue;const ce=J.programConfigurations.get(A.id),ye=x.useProgram("heatmap",ce),{zoom:_e}=x.transform;ye.draw(w,M.TRIANGLES,En.disabled,L,N,jn.disabled,Ie($.posMatrix,Q,_e,A.paint.get("heatmap-intensity")),null,A.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,A.paint,x.transform.zoom,ce)}w.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(w,M){const L=w.context,N=L.gl,V=M.heatmapFbo;if(!V)return;L.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,V.colorAttachment.get()),L.activeTexture.set(N.TEXTURE1);let $=M.colorRampTexture;$||($=M.colorRampTexture=new le(L,M.colorRamp,N.RGBA)),$.bind(N.LINEAR,N.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(L,N.TRIANGLES,En.disabled,Qn.disabled,w.colorModeForRenderPass(),jn.disabled,((Q,J,ce,ye)=>{const _e=a.create();a.ortho(_e,0,Q.width,Q.height,0,0,1);const oe=Q.context.gl;return{u_matrix:_e,u_world:[oe.drawingBufferWidth,oe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:J.paint.get("heatmap-opacity")}})(w,M),null,M.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,M.paint,w.transform.zoom)}(x,A))},line:function(x,s,A,y){if(x.renderPass!=="translucent")return;const w=A.paint.get("line-opacity"),M=A.paint.get("line-width");if(w.constantOr(1)===0||M.constantOr(1)===0)return;const L=x.depthModeForSublayer(0,En.ReadOnly),N=x.colorModeForRenderPass(),V=A.paint.get("line-dasharray"),$=A.paint.get("line-pattern"),Q=$.constantOr(1),J=A.paint.get("line-gradient"),ce=A.getCrossfadeParameters(),ye=Q?"linePattern":V?"lineSDF":J?"lineGradient":"line",_e=x.context,oe=_e.gl;let ge=!0;for(const De of y){const Ve=s.getTile(De);if(Q&&!Ve.patternsLoaded())continue;const Ee=Ve.getBucket(A);if(!Ee)continue;const Ze=Ee.programConfigurations.get(A.id),je=x.context.program.get(),tt=x.useProgram(ye,Ze),Ke=ge||tt.program!==je,d=x.style.terrain&&x.style.terrain.getTerrainData(De),h=$.constantOr(null);if(h&&Ve.imageAtlas){const v=Ve.imageAtlas,E=v.patternPositions[h.to.toString()],I=v.patternPositions[h.from.toString()];E&&I&&Ze.setConstantPatternPositions(E,I)}const m=d?De:null,_=Q?An(x,Ve,A,ce,m):V?ei(x,Ve,A,V,ce,m):J?zt(x,Ve,A,Ee.lineClipsArray.length,m):ht(x,Ve,A,m);if(Q)_e.activeTexture.set(oe.TEXTURE0),Ve.imageAtlasTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),Ze.updatePaintBuffers(ce);else if(V&&(Ke||x.lineAtlas.dirty))_e.activeTexture.set(oe.TEXTURE0),x.lineAtlas.bind(_e);else if(J){const v=Ee.gradients[A.id];let E=v.texture;if(A.gradientVersion!==v.version){let I=256;if(A.stepInterpolant){const P=s.getSource().maxzoom,O=De.canonical.z===P?Math.ceil(1<<x.transform.maxZoom-De.canonical.z):1;I=a.clamp(a.nextPowerOfTwo(Ee.maxLineLength/a.EXTENT*1024*O),256,_e.maxTextureSize)}v.gradient=a.renderColorRamp({expression:A.gradientExpression(),evaluationKey:"lineProgress",resolution:I,image:v.gradient||void 0,clips:Ee.lineClipsArray}),v.texture?v.texture.update(v.gradient):v.texture=new le(_e,v.gradient,oe.RGBA),v.version=A.gradientVersion,E=v.texture}_e.activeTexture.set(oe.TEXTURE0),E.bind(A.stepInterpolant?oe.NEAREST:oe.LINEAR,oe.CLAMP_TO_EDGE)}tt.draw(_e,oe.TRIANGLES,L,x.stencilModeForClipping(De),N,jn.disabled,_,d,A.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,A.paint,x.transform.zoom,Ze,Ee.layoutVertexBuffer2),ge=!1}},fill:function(x,s,A,y){const w=A.paint.get("fill-color"),M=A.paint.get("fill-opacity");if(M.constantOr(1)===0)return;const L=x.colorModeForRenderPass(),N=A.paint.get("fill-pattern"),V=x.opaquePassEnabledForLayer()&&!N.constantOr(1)&&w.constantOr(a.Color.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===V){const $=x.depthModeForSublayer(1,x.renderPass==="opaque"?En.ReadWrite:En.ReadOnly);oa(x,s,A,y,$,L,!1)}if(x.renderPass==="translucent"&&A.paint.get("fill-antialias")){const $=x.depthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,En.ReadOnly);oa(x,s,A,y,$,L,!0)}},"fill-extrusion":function(x,s,A,y){const w=A.paint.get("fill-extrusion-opacity");if(w!==0&&x.renderPass==="translucent"){const M=new En(x.context.gl.LEQUAL,En.ReadWrite,x.depthRangeFor3D);if(w!==1||A.paint.get("fill-extrusion-pattern").constantOr(1))Ps(x,s,A,y,M,Qn.disabled,Yn.disabled),Ps(x,s,A,y,M,x.stencilModeFor3D(),x.colorModeForRenderPass());else{const L=x.colorModeForRenderPass();Ps(x,s,A,y,M,Qn.disabled,L)}}},hillshade:function(x,s,A,y){if(x.renderPass!=="offscreen"&&x.renderPass!=="translucent")return;const w=x.context,M=x.depthModeForSublayer(0,En.ReadOnly),L=x.colorModeForRenderPass(),[N,V]=x.renderPass==="translucent"?x.stencilConfigForOverlap(y):[{},y];for(const $ of V){const Q=s.getTile($);Q.needsHillshadePrepare!==void 0&&Q.needsHillshadePrepare&&x.renderPass==="offscreen"?Ha(x,Q,A,M,Qn.disabled,L):x.renderPass==="translucent"&&Ga(x,$,Q,A,M,N[$.overscaledZ],L)}w.viewport.set([0,0,x.width,x.height])},raster:function(x,s,A,y){if(x.renderPass!=="translucent"||A.paint.get("raster-opacity")===0||!y.length)return;const w=x.context,M=w.gl,L=s.getSource(),N=x.useProgram("raster"),V=x.colorModeForRenderPass(),[$,Q]=L instanceof It?[{},y]:x.stencilConfigForOverlap(y),J=Q[Q.length-1].overscaledZ,ce=!x.options.moving;for(const ye of Q){const _e=x.depthModeForSublayer(ye.overscaledZ-J,A.paint.get("raster-opacity")===1?En.ReadWrite:En.ReadOnly,M.LESS),oe=s.getTile(ye);oe.registerFadeDuration(A.paint.get("raster-fade-duration"));const ge=s.findLoadedParent(ye,0),De=Gn(oe,ge,s,A,x.transform,x.style.terrain);let Ve,Ee;const Ze=A.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;w.activeTexture.set(M.TEXTURE0),oe.texture.bind(Ze,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),w.activeTexture.set(M.TEXTURE1),ge?(ge.texture.bind(Ze,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),Ve=Math.pow(2,ge.tileID.overscaledZ-oe.tileID.overscaledZ),Ee=[oe.tileID.canonical.x*Ve%1,oe.tileID.canonical.y*Ve%1]):oe.texture.bind(Ze,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);const je=x.style.terrain&&x.style.terrain.getTerrainData(ye),tt=je?ye:null,Ke=tt?tt.posMatrix:x.transform.calculatePosMatrix(ye.toUnwrapped(),ce),d=In(Ke,Ee||[0,0],Ve||1,De,A);L instanceof It?N.draw(w,M.TRIANGLES,_e,Qn.disabled,V,jn.disabled,d,je,A.id,L.boundsBuffer,x.quadTriangleIndexBuffer,L.boundsSegments):N.draw(w,M.TRIANGLES,_e,$[ye.overscaledZ],V,jn.disabled,d,je,A.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}},background:function(x,s,A,y){const w=A.paint.get("background-color"),M=A.paint.get("background-opacity");if(M===0)return;const L=x.context,N=L.gl,V=x.transform,$=V.tileSize,Q=A.paint.get("background-pattern");if(x.isPatternMissing(Q))return;const J=!Q&&w.a===1&&M===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass!==J)return;const ce=Qn.disabled,ye=x.depthModeForSublayer(0,J==="opaque"?En.ReadWrite:En.ReadOnly),_e=x.colorModeForRenderPass(),oe=x.useProgram(Q?"backgroundPattern":"background"),ge=y||V.coveringTiles({tileSize:$,terrain:x.style.terrain});Q&&(L.activeTexture.set(N.TEXTURE0),x.imageManager.bind(x.context));const De=A.getCrossfadeParameters();for(const Ve of ge){const Ee=y?Ve.posMatrix:x.transform.calculatePosMatrix(Ve.toUnwrapped()),Ze=Q?Iu(Ee,M,x,Q,{tileID:Ve,tileSize:$},De):Eh(Ee,M,w),je=x.style.terrain&&x.style.terrain.getTerrainData(Ve);oe.draw(L,N.TRIANGLES,ye,ce,_e,jn.disabled,Ze,je,A.id,x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}},debug:function(x,s,A){for(let y=0;y<A.length;y++)kc(x,s,A[y])},custom:function(x,s,A){const y=x.context,w=A.implementation;if(x.renderPass==="offscreen"){const M=w.prerender;M&&(x.setCustomLayerDefaults(),y.setColorMode(x.colorModeForRenderPass()),M.call(w,y.gl,x.transform.customLayerMatrix()),y.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),y.setColorMode(x.colorModeForRenderPass()),y.setStencilMode(Qn.disabled);const M=w.renderingMode==="3d"?new En(x.context.gl.LEQUAL,En.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,En.ReadOnly);y.setDepthMode(M),w.render(y.gl,x.transform.customLayerMatrix()),y.setDirty(),x.setBaseState(),y.bindFramebuffer.set(null)}}};class Ar{constructor(s,A){this.context=new Na(s),this.transform=A,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.create(),renderTime:0},this.setup(),this.numSublayers=yn.maxUnderzooming+yn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ft,this.gpuTimers={}}resize(s,A,y){if(this.width=s*y,this.height=A*y,this.pixelRatio=y,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const w of this.style._order)this.style._layers[w].resize()}setup(){const s=this.context,A=new a.PosArray;A.emplaceBack(0,0),A.emplaceBack(a.EXTENT,0),A.emplaceBack(0,a.EXTENT),A.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=s.createVertexBuffer(A,en.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const y=new a.PosArray;y.emplaceBack(0,0),y.emplaceBack(a.EXTENT,0),y.emplaceBack(0,a.EXTENT),y.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=s.createVertexBuffer(y,en.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const w=new a.RasterBoundsArray;w.emplaceBack(0,0,0,0),w.emplaceBack(a.EXTENT,0,a.EXTENT,0),w.emplaceBack(0,a.EXTENT,0,a.EXTENT),w.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.rasterBoundsBuffer=s.createVertexBuffer(w,pt.members),this.rasterBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const M=new a.PosArray;M.emplaceBack(0,0),M.emplaceBack(1,0),M.emplaceBack(0,1),M.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(M,en.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const L=new a.LineStripIndexArray;L.emplaceBack(0),L.emplaceBack(1),L.emplaceBack(3),L.emplaceBack(2),L.emplaceBack(0),this.tileBorderIndexBuffer=s.createIndexBuffer(L);const N=new a.TriangleIndexArray;N.emplaceBack(0,1,2),N.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(N),this.emptyTexture=new le(s,{width:1,height:1,data:new Uint8Array([0,0,0,0])},s.gl.RGBA);const V=this.context.gl;this.stencilClearMode=new Qn({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO)}clearStencil(){const s=this.context,A=s.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const y=a.create();a.ortho(y,0,this.width,this.height,0,0,1),a.scale(y,y,[A.drawingBufferWidth,A.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(s,A.TRIANGLES,En.disabled,this.stencilClearMode,Yn.disabled,jn.disabled,pe(y),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(s,A){if(this.currentStencilSource===s.source||!s.isTileClipped()||!A||!A.length)return;this.currentStencilSource=s.source;const y=this.context,w=y.gl;this.nextStencilID+A.length>256&&this.clearStencil(),y.setColorMode(Yn.disabled),y.setDepthMode(En.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of A){const N=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,V=this.style.terrain&&this.style.terrain.getTerrainData(L);M.draw(y,w.TRIANGLES,En.disabled,new Qn({func:w.ALWAYS,mask:0},N,255,w.KEEP,w.KEEP,w.REPLACE),Yn.disabled,jn.disabled,pe(L.posMatrix),V,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,A=this.context.gl;return new Qn({func:A.NOTEQUAL,mask:255},s,255,A.KEEP,A.KEEP,A.REPLACE)}stencilModeForClipping(s){const A=this.context.gl;return new Qn({func:A.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,A.KEEP,A.KEEP,A.REPLACE)}stencilConfigForOverlap(s){const A=this.context.gl,y=s.sort((L,N)=>N.overscaledZ-L.overscaledZ),w=y[y.length-1].overscaledZ,M=y[0].overscaledZ-w+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();const L={};for(let N=0;N<M;N++)L[N+w]=new Qn({func:A.GEQUAL,mask:255},N+this.nextStencilID,255,A.KEEP,A.KEEP,A.REPLACE);return this.nextStencilID+=M,[L,y]}return[{[w]:Qn.disabled},y]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new Yn([s.CONSTANT_COLOR,s.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Yn.unblended:Yn.alphaBlended}depthModeForSublayer(s,A,y){if(!this.opaquePassEnabledForLayer())return En.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new En(y||this.context.gl.LEQUAL,A,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(s,A){this.style=s,this.options=A,this.lineAtlas=s.lineAtlas,this.imageManager=s.imageManager,this.glyphManager=s.glyphManager,this.symbolFadeChange=s.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const y=this.style._order,w=this.style.sourceCaches,M=this.style.terrain&&new zl(this);for(const $ in w){const Q=w[$];Q.used&&Q.prepare(this.context)}const L={},N={},V={};for(const $ in w){const Q=w[$];L[$]=Q.getVisibleCoordinates(),N[$]=L[$].slice().reverse(),V[$]=Q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<y.length;$++)if(this.style._layers[y[$]].is3D()){this.opaquePassCutoff=$;break}if(M){this.opaquePassCutoff=0;const $=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!a.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||$.length)&&(a.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(Q,J){const ce=Q.context,ye=ce.gl,_e=Yn.unblended,oe=new En(ye.LEQUAL,En.ReadWrite,[0,1]),ge=J.getTerrainMesh(),De=J.sourceCache.getRenderableTiles(),Ve=Q.useProgram("terrainDepth");ce.bindFramebuffer.set(J.getFramebuffer("depth").framebuffer),ce.viewport.set([0,0,Q.width/devicePixelRatio,Q.height/devicePixelRatio]),ce.clear({color:a.Color.transparent,depth:1});for(const Ee of De){const Ze=J.getTerrainData(Ee.tileID),je=Q.transform.calculatePosMatrix(Ee.tileID.toUnwrapped());Ve.draw(ce,ye.TRIANGLES,oe,Qn.disabled,_e,jn.backCCW,{u_matrix:je},Ze,"terrain",ge.vertexBuffer,ge.indexBuffer,ge.segments)}ce.bindFramebuffer.set(null),ce.viewport.set([0,0,Q.width,Q.height])}(this,this.style.terrain),function(Q,J){const ce=Q.context,ye=ce.gl,_e=Yn.unblended,oe=new En(ye.LEQUAL,En.ReadWrite,[0,1]),ge=J.getTerrainMesh(),De=J.getCoordsTexture(),Ve=J.sourceCache.getRenderableTiles(),Ee=Q.useProgram("terrainCoords");ce.bindFramebuffer.set(J.getFramebuffer("coords").framebuffer),ce.viewport.set([0,0,Q.width/devicePixelRatio,Q.height/devicePixelRatio]),ce.clear({color:a.Color.transparent,depth:1}),J.coordsIndex=[];for(const Ze of Ve){const je=J.getTerrainData(Ze.tileID);ce.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_2D,De.texture);const tt=Q.transform.calculatePosMatrix(Ze.tileID.toUnwrapped());Ee.draw(ce,ye.TRIANGLES,oe,Qn.disabled,_e,jn.backCCW,{u_matrix:tt,u_terrain_coords_id:(255-J.coordsIndex.length)/255,u_texture:0},je,"terrain",ge.vertexBuffer,ge.indexBuffer,ge.segments),J.coordsIndex.push(Ze.tileID.key)}ce.bindFramebuffer.set(null),ce.viewport.set([0,0,Q.width,Q.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const $ of y){const Q=this.style._layers[$];if(!Q.hasOffscreenPass()||Q.isHidden(this.transform.zoom))continue;const J=N[Q.source];(Q.type==="custom"||J.length)&&this.renderLayer(this,w[Q.source],Q,J)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:A.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=A.showOverdrawInspector,this.depthRangeFor3D=[0,1-(s._order.length+2)*this.numSublayers*this.depthEpsilon],!M)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const $=this.style._layers[y[this.currentLayer]],Q=w[$.source],J=L[$.source];this._renderTileClippingMasks($,J),this.renderLayer(this,Q,$,J)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const $=this.style._layers[y[this.currentLayer]],Q=w[$.source];if(M&&M.renderLayer($))continue;const J=($.type==="symbol"?V:N)[$.source];this._renderTileClippingMasks($,L[$.source]),this.renderLayer(this,Q,$,J)}if(this.options.showTileBoundaries){let $,Q;Object.values(this.style._layers).forEach(J=>{J.source&&!J.isHidden(this.transform.zoom)&&(J.source!==(Q&&Q.id)&&(Q=this.style.sourceCaches[J.source]),(!$||$.getSource().maxzoom<Q.getSource().maxzoom)&&($=Q))}),$&&Wa.debug(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){const Q=$.transform.padding;Ls($,$.transform.height-(Q.top||0),3,Dl),Ls($,Q.bottom||0,3,Jr),$a($,Q.left||0,3,Nu),$a($,$.transform.width-(Q.right||0),3,Cc);const J=$.transform.centerPoint;(function(ce,ye,_e,oe){Mi(ce,ye-1,_e-10,2,20,oe),Mi(ce,ye-10,_e-1,20,2,oe)})($,J.x,$.transform.height-J.y,Uu)}(this),this.context.setDefault()}renderLayer(s,A,y,w){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="custom"||(w||[]).length)&&(this.id=y.id,this.gpuTimingStart(y),Wa[y.type](s,A,y,w,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const A=this.context.extTimerQuery;let y=this.gpuTimers[s.id];y||(y=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:A.createQueryEXT()}),y.calls++,A.beginQueryEXT(A.TIME_ELAPSED_EXT,y.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;s.endQueryEXT(s.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}queryGpuTimers(s){const A={};for(const y in s){const w=s[y],M=this.context.extTimerQuery,L=M.getQueryObjectEXT(w.query,M.QUERY_RESULT_EXT)/1e6;M.deleteQueryEXT(w.query),A[y]=L}return A}translatePosMatrix(s,A,y,w,M){if(!y[0]&&!y[1])return s;const L=M?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(L){const $=Math.sin(L),Q=Math.cos(L);y=[y[0]*Q-y[1]*$,y[0]*$+y[1]*Q]}const N=[M?y[0]:ai(A,y[0],this.transform.zoom),M?y[1]:ai(A,y[1],this.transform.zoom),0],V=new Float32Array(16);return a.translate(V,s,N),V}saveTileTexture(s){const A=this._tileTextures[s.size[0]];A?A.push(s):this._tileTextures[s.size[0]]=[s]}getTileTexture(s){const A=this._tileTextures[s];return A&&A.length>0?A.pop():null}isPatternMissing(s){if(!s)return!1;if(!s.from||!s.to)return!0;const A=this.imageManager.getPattern(s.from.toString()),y=this.imageManager.getPattern(s.to.toString());return!A||!y}useProgram(s,A){this.cache=this.cache||{};const y=s+(A?A.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[y]||(this.cache[y]=new Xs(this.context,s,Bi[s],A,La[s],this._showOverdrawInspector,this.style.terrain)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new le(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Za{constructor(s,A){this.points=s,this.planes=A}static fromInvProjectionMatrix(s,A,y){const w=Math.pow(2,y),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const V=1/(N=a.transformMat4([],N,s))[3]/A*w;return a.mul$1(N,N,[V,V,1/N[3],V])}),L=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const V=a.sub([],M[N[0]],M[N[1]]),$=a.sub([],M[N[2]],M[N[1]]),Q=a.normalize([],a.cross([],V,$)),J=-a.dot(Q,M[N[1]]);return Q.concat(J)});return new Za(M,L)}}class Rs{constructor(s,A){this.min=s,this.max=A,this.center=a.scale$1([],a.add([],this.min,this.max),.5)}quadrant(s){const A=[s%2==0,s<2],y=a.clone$2(this.min),w=a.clone$2(this.max);for(let M=0;M<A.length;M++)y[M]=A[M]?this.min[M]:this.center[M],w[M]=A[M]?this.center[M]:this.max[M];return w[2]=this.max[2],new Rs(y,w)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}intersects(s){const A=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let y=!0;for(let w=0;w<s.planes.length;w++){const M=s.planes[w];let L=0;for(let N=0;N<A.length;N++)a.dot$1(M,A[N])>=0&&L++;if(L===0)return 0;L!==A.length&&(y=!1)}if(y)return 2;for(let w=0;w<3;w++){let M=Number.MAX_VALUE,L=-Number.MAX_VALUE;for(let N=0;N<s.points.length;N++){const V=s.points[N][w]-this.min[w];M=Math.min(M,V),L=Math.max(L,V)}if(L<0||M>this.max[w]-this.min[w])return 0}return 1}}class eo{constructor(s=0,A=0,y=0,w=0){if(isNaN(s)||s<0||isNaN(A)||A<0||isNaN(y)||y<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=A,this.left=y,this.right=w}interpolate(s,A,y){return A.top!=null&&s.top!=null&&(this.top=a.number(s.top,A.top,y)),A.bottom!=null&&s.bottom!=null&&(this.bottom=a.number(s.bottom,A.bottom,y)),A.left!=null&&s.left!=null&&(this.left=a.number(s.left,A.left,y)),A.right!=null&&s.right!=null&&(this.right=a.number(s.right,A.right,y)),this}getCenter(s,A){const y=a.clamp((this.left+s-this.right)/2,0,s),w=a.clamp((this.top+A-this.bottom)/2,0,A);return new a.pointGeometry(y,w)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new eo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Lo{constructor(s,A,y,w,M){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=M===void 0||!!M,this._minZoom=s||0,this._maxZoom=A||22,this._minPitch=y??0,this._maxPitch=w??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new eo,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const s=new Lo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return s.tileSize=this.tileSize,s.latRange=this.latRange,s.width=this.width,s.height=this.height,s._center=this._center,s._elevation=this._elevation,s.zoom=this.zoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._calcMatrices(),s}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(s){const A=-a.wrap(s,-180,180)*Math.PI/180;var y;this.angle!==A&&(this._unmodified=!1,this.angle=A,this._calcMatrices(),this.rotationMatrix=(y=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),function(w,M,L){var N=M[0],V=M[1],$=M[2],Q=M[3],J=Math.sin(L),ce=Math.cos(L);w[0]=N*ce+$*J,w[1]=V*ce+Q*J,w[2]=N*-J+$*ce,w[3]=V*-J+Q*ce}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const A=a.clamp(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==A&&(this._unmodified=!1,this._pitch=A,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=s/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(s){const A=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==A&&(this._unmodified=!1,this._zoom=A,this.scale=this.zoomScale(A),this.tileZoom=Math.floor(A),this.zoomFraction=A-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(s){s!==this._elevation&&(this._elevation=s,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,A,y){this._unmodified=!1,this._edgeInsets.interpolate(s,A,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const A=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,A)}getVisibleUnwrappedCoordinates(s){const A=[new a.UnwrappedTileID(0,s)];if(this._renderWorldCopies){const y=this.pointCoordinate(new a.pointGeometry(0,0)),w=this.pointCoordinate(new a.pointGeometry(this.width,0)),M=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),L=this.pointCoordinate(new a.pointGeometry(0,this.height)),N=Math.floor(Math.min(y.x,w.x,M.x,L.x)),V=Math.floor(Math.max(y.x,w.x,M.x,L.x)),$=1;for(let Q=N-$;Q<=V+$;Q++)Q!==0&&A.push(new a.UnwrappedTileID(Q,s))}return A}coveringTiles(s){var A,y;let w=this.coveringZoomLevel(s);const M=w;if(s.minzoom!==void 0&&w<s.minzoom)return[];s.maxzoom!==void 0&&w>s.maxzoom&&(w=s.maxzoom);const L=this.pointCoordinate(this.getCameraPoint()),N=a.MercatorCoordinate.fromLngLat(this.center),V=Math.pow(2,w),$=[V*L.x,V*L.y,0],Q=[V*N.x,V*N.y,0],J=Za.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,w);let ce=s.minzoom||0;!s.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ce=w);const ye=s.terrain?2/Math.min(this.tileSize,s.tileSize)*this.tileSize:3,_e=Ee=>({aabb:new Rs([Ee*V,0,0],[(Ee+1)*V,V,0]),zoom:0,x:0,y:0,wrap:Ee,fullyVisible:!1}),oe=[],ge=[],De=w,Ve=s.reparseOverscaled?M:w;if(this._renderWorldCopies)for(let Ee=1;Ee<=3;Ee++)oe.push(_e(-Ee)),oe.push(_e(Ee));for(oe.push(_e(0));oe.length>0;){const Ee=oe.pop(),Ze=Ee.x,je=Ee.y;let tt=Ee.fullyVisible;if(!tt){const v=Ee.aabb.intersects(J);if(v===0)continue;tt=v===2}const Ke=s.terrain?$:Q,d=Ee.aabb.distanceX(Ke),h=Ee.aabb.distanceY(Ke),m=Math.max(Math.abs(d),Math.abs(h)),_=ye+(1<<De-Ee.zoom)-2;if(Ee.zoom===De||m>_&&Ee.zoom>=ce){const v=De-Ee.zoom,E=$[0]-.5-(Ze<<v),I=$[1]-.5-(je<<v);ge.push({tileID:new a.OverscaledTileID(Ee.zoom===De?Ve:Ee.zoom,Ee.wrap,Ee.zoom,Ze,je),distanceSq:a.sqrLen([Q[0]-.5-Ze,Q[1]-.5-je]),tileDistanceToCamera:Math.sqrt(E*E+I*I)})}else for(let v=0;v<4;v++){const E=(Ze<<1)+v%2,I=(je<<1)+(v>>1),P=Ee.zoom+1;let O=Ee.aabb.quadrant(v);if(s.terrain){const G=new a.OverscaledTileID(P,Ee.wrap,P,E,I),X=s.terrain.getMinMaxElevation(G),de=(A=X.minElevation)!==null&&A!==void 0?A:this.elevation,ve=(y=X.maxElevation)!==null&&y!==void 0?y:this.elevation;O=new Rs([O.min[0],O.min[1],de],[O.max[0],O.max[1],ve])}oe.push({aabb:O,zoom:P,x:E,y:I,wrap:Ee.wrap,fullyVisible:tt})}}return ge.sort((Ee,Ze)=>Ee.distanceSq-Ze.distanceSq).map(Ee=>Ee.tileID)}resize(s,A){this.width=s,this.height=A,this.pixelsToGLUnits=[2/s,-2/A],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const A=a.clamp(s.lat,-this.maxValidLatitude,this.maxValidLatitude);return new a.pointGeometry(a.mercatorXfromLng(s.lng)*this.worldSize,a.mercatorYfromLat(A)*this.worldSize)}unproject(s){return new a.MercatorCoordinate(s.x/this.worldSize,s.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(s){this.freezeElevation||(this.elevation=s?this.getElevation(this._center,s):0)}getElevation(s,A){const y=a.MercatorCoordinate.fromLngLat(s),w=(1<<this.tileZoom)*a.EXTENT,M=y.x*w,L=y.y*w,N=Math.floor(M/a.EXTENT),V=Math.floor(L/a.EXTENT),$=new a.OverscaledTileID(this.tileZoom,0,this.tileZoom,N,V);return A.getElevation($,M%a.EXTENT,L%a.EXTENT,a.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(s){const A=this.pointLocation(this.centerPoint,s),y=this.getElevation(A,s);if(!(this.elevation-y))return;const w=this.getCameraPosition(),M=a.MercatorCoordinate.fromLngLat(w.lngLat,w.altitude),L=a.MercatorCoordinate.fromLngLat(A,y),N=M.x-L.x,V=M.y-L.y,$=M.z-L.z,Q=Math.sqrt(N*N+V*V+$*$),J=this.scaleZoom(this.cameraToCenterDistance/Q/this.tileSize);this._elevation=y,this._center=A,this.zoom=J}setLocationAtPoint(s,A){const y=this.pointCoordinate(A),w=this.pointCoordinate(this.centerPoint),M=this.locationCoordinate(s),L=new a.MercatorCoordinate(M.x-(y.x-w.x),M.y-(y.y-w.y));this.center=this.coordinateLocation(L),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(s,A){return A?this.coordinatePoint(this.locationCoordinate(s),this.getElevation(s,A),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(s))}pointLocation(s,A){return this.coordinateLocation(this.pointCoordinate(s,A))}locationCoordinate(s){return a.MercatorCoordinate.fromLngLat(s)}coordinateLocation(s){return s&&s.toLngLat()}pointCoordinate(s,A){if(A){const ce=A.pointCoordinate(s);if(ce!=null)return ce}const y=[s.x,s.y,0,1],w=[s.x,s.y,1,1];a.transformMat4(y,y,this.pixelMatrixInverse),a.transformMat4(w,w,this.pixelMatrixInverse);const M=y[3],L=w[3],N=y[1]/M,V=w[1]/L,$=y[2]/M,Q=w[2]/L,J=$===Q?0:(0-$)/(Q-$);return new a.MercatorCoordinate(a.number(y[0]/M,w[0]/L,J)/this.worldSize,a.number(N,V,J)/this.worldSize)}coordinatePoint(s,A=0,y=this.pixelMatrix){const w=[s.x*this.worldSize,s.y*this.worldSize,A,1];return a.transformMat4(w,w,y),new a.pointGeometry(w[0]/w[3],w[1]/w[3])}getBounds(){const s=Math.max(0,this.height/2-this.getHorizon());return new a.LngLatBounds().extend(this.pointLocation(new a.pointGeometry(0,s))).extend(this.pointLocation(new a.pointGeometry(this.width,s))).extend(this.pointLocation(new a.pointGeometry(this.width,this.height))).extend(this.pointLocation(new a.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new a.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(s){s?(this.lngRange=[s.getWest(),s.getEast()],this.latRange=[s.getSouth(),s.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(s,A=!1){const y=s.key,w=A?this._alignedPosMatrixCache:this._posMatrixCache;if(w[y])return w[y];const M=s.canonical,L=this.worldSize/this.zoomScale(M.z),N=M.x+Math.pow(2,M.z)*s.wrap,V=a.identity(new Float64Array(16));return a.translate(V,V,[N*L,M.y*L,0]),a.scale(V,V,[L/a.EXTENT,L/a.EXTENT,1]),a.multiply(V,A?this.alignedProjMatrix:this.projMatrix,V),w[y]=new Float32Array(V),w[y]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let s,A,y,w,M=-90,L=90,N=-180,V=180;const $=this.size,Q=this._unmodified;if(this.latRange){const ye=this.latRange;M=a.mercatorYfromLat(ye[1])*this.worldSize,L=a.mercatorYfromLat(ye[0])*this.worldSize,s=L-M<$.y?$.y/(L-M):0}if(this.lngRange){const ye=this.lngRange;N=a.wrap(a.mercatorXfromLng(ye[0])*this.worldSize,0,this.worldSize),V=a.wrap(a.mercatorXfromLng(ye[1])*this.worldSize,0,this.worldSize),V<N&&(V+=this.worldSize),A=V-N<$.x?$.x/(V-N):0}const J=this.point,ce=Math.max(A||0,s||0);if(ce)return this.center=this.unproject(new a.pointGeometry(A?(V+N)/2:J.x,s?(L+M)/2:J.y)),this.zoom+=this.scaleZoom(ce),this._unmodified=Q,void(this._constraining=!1);if(this.latRange){const ye=J.y,_e=$.y/2;ye-_e<M&&(w=M+_e),ye+_e>L&&(w=L-_e)}if(this.lngRange){const ye=(N+V)/2,_e=a.wrap(J.x,ye-this.worldSize/2,ye+this.worldSize/2),oe=$.x/2;_e-oe<N&&(y=N+oe),_e+oe>V&&(y=V-oe)}y===void 0&&w===void 0||(this.center=this.unproject(new a.pointGeometry(y!==void 0?y:J.x,w!==void 0?w:J.y)).wrap()),this._unmodified=Q,this._constraining=!1}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,A=this.point.x,y=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let w=a.identity(new Float64Array(16));a.scale(w,w,[this.width/2,-this.height/2,1]),a.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=a.identity(new Float64Array(16)),a.scale(w,w,[1,-1,1]),a.translate(w,w,[-1,-1,0]),a.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const M=Math.PI/2+this._pitch,L=this._fov*(.5+s.y/this.height),N=Math.sin(L)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-M-L,.01,Math.PI-.01)),V=this.getHorizon(),$=2*Math.atan(V/this.cameraToCenterDistance)*(.5+s.y/(2*V)),Q=Math.sin($)*this.cameraToSeaLevelDistance/Math.sin(a.clamp(Math.PI-M-$,.01,Math.PI-.01)),J=Math.cos(Math.PI/2-this._pitch)*N+this.cameraToSeaLevelDistance,ce=Math.cos(Math.PI/2-this._pitch)*Q+this.cameraToSeaLevelDistance,ye=1.01*Math.min(J,ce),_e=this.height/50;w=new Float64Array(16),a.perspective(w,this._fov,this.width/this.height,_e,ye),w[8]=2*-s.x/this.width,w[9]=2*s.y/this.height,a.scale(w,w,[1,-1,1]),a.translate(w,w,[0,0,-this.cameraToCenterDistance]),a.rotateX(w,w,this._pitch),a.rotateZ(w,w,this.angle),a.translate(w,w,[-A,-y,0]),this.mercatorMatrix=a.scale([],w,[this.worldSize,this.worldSize,this.worldSize]),a.scale(w,w,[1,1,this._pixelPerMeter]),this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,w),a.translate(w,w,[0,0,-this.elevation]),this.projMatrix=w,this.invProjMatrix=a.invert([],w),this.pixelMatrix3D=a.multiply(new Float64Array(16),this.labelPlaneMatrix,w);const oe=this.width%2/2,ge=this.height%2/2,De=Math.cos(this.angle),Ve=Math.sin(this.angle),Ee=A-Math.round(A)+De*oe+Ve*ge,Ze=y-Math.round(y)+De*ge+Ve*oe,je=new Float64Array(w);if(a.translate(je,je,[Ee>.5?Ee-1:Ee,Ze>.5?Ze-1:Ze,0]),this.alignedProjMatrix=je,w=a.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");this.pixelMatrixInverse=w,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const s=this.pointCoordinate(new a.pointGeometry(0,0)),A=[s.x*this.worldSize,s.y*this.worldSize,0,1];return a.transformMat4(A,A,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,s))}getCameraQueryGeometry(s){const A=this.getCameraPoint();if(s.length===1)return[s[0],A];{let y=A.x,w=A.y,M=A.x,L=A.y;for(const N of s)y=Math.min(y,N.x),w=Math.min(w,N.y),M=Math.max(M,N.x),L=Math.max(L,N.y);return[new a.pointGeometry(y,w),new a.pointGeometry(M,w),new a.pointGeometry(M,L),new a.pointGeometry(y,L),new a.pointGeometry(y,w)]}}}class sa{constructor(s){this._hashName=s&&encodeURIComponent(s),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(A,y){let w=!1,M=null;const L=()=>{M=null,w&&(A(),M=setTimeout(L,300),w=!1)};return()=>(w=!0,M||L(),M)}(this._updateHashUnthrottled.bind(this))}addTo(s){return this._map=s,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(s){const A=this._map.getCenter(),y=Math.round(100*this._map.getZoom())/100,w=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),M=Math.pow(10,w),L=Math.round(A.lng*M)/M,N=Math.round(A.lat*M)/M,V=this._map.getBearing(),$=this._map.getPitch();let Q="";if(Q+=s?`/${L}/${N}/${y}`:`${y}/${N}/${L}`,(V||$)&&(Q+="/"+Math.round(10*V)/10),$&&(Q+=`/${Math.round($)}`),this._hashName){const J=this._hashName;let ce=!1;const ye=window.location.hash.slice(1).split("&").map(_e=>{const oe=_e.split("=")[0];return oe===J?(ce=!0,`${oe}=${Q}`):_e}).filter(_e=>_e);return ce||ye.push(`${J}=${Q}`),`#${ye.join("&")}`}return`#${Q}`}_getCurrentHash(){const s=window.location.hash.replace("#","");if(this._hashName){let A;return s.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(A=y)}),(A&&A[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._getCurrentHash();if(s.length>=3&&!s.some(A=>isNaN(A))){const A=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:A,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){const s=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,s)}catch{}}}const qa={linearity:.3,easing:a.bezier(0,0,.3,1)},Pc=a.extend({deceleration:2500,maxSpeed:1400},qa),ju=a.extend({deceleration:20,maxSpeed:1400},qa),Bl=a.extend({deceleration:1e3,maxSpeed:360},qa),aa=a.extend({deceleration:1e3,maxSpeed:90},qa);class Gu{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,A=a.exported.now();for(;s.length>0&&A-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const A={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:M}of this._inertiaBuffer)A.zoom+=M.zoomDelta||0,A.bearing+=M.bearingDelta||0,A.pitch+=M.pitchDelta||0,M.panDelta&&A.pan._add(M.panDelta),M.around&&(A.around=M.around),M.pinchAround&&(A.pinchAround=M.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(A.pan.mag()){const M=ca(A.pan.mag(),y,a.extend({},Pc,s||{}));w.offset=A.pan.mult(M.amount/A.pan.mag()),w.center=this._map.transform.center,la(w,M)}if(A.zoom){const M=ca(A.zoom,y,ju);w.zoom=this._map.transform.zoom+M.amount,la(w,M)}if(A.bearing){const M=ca(A.bearing,y,Bl);w.bearing=this._map.transform.bearing+a.clamp(M.amount,-179,179),la(w,M)}if(A.pitch){const M=ca(A.pitch,y,aa);w.pitch=this._map.transform.pitch+M.amount,la(w,M)}if(w.zoom||w.bearing){const M=A.pinchAround===void 0?A.around:A.pinchAround;w.around=M?this._map.unproject(M):this._map.getCenter()}return this.clear(),a.extend(w,{noMoveStart:!0})}}function la(x,s){(!x.duration||x.duration<s.duration)&&(x.duration=s.duration,x.easing=s.easing)}function ca(x,s,A){const{maxSpeed:y,linearity:w,deceleration:M}=A,L=a.clamp(x*w/(s/1e3),-y,y),N=Math.abs(L)/(M*w);return{easing:A.easing,duration:1e3*N,amount:L*(N/2)}}class Hi extends a.Event{constructor(s,A,y,w={}){const M=D.mousePos(A.getCanvasContainer(),y),L=A.unproject(M);super(s,a.extend({point:M,lngLat:L,originalEvent:y},w)),this._defaultPrevented=!1,this.target=A}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class yo extends a.Event{constructor(s,A,y){const w=s==="touchend"?y.changedTouches:y.touches,M=D.touchPos(A.getCanvasContainer(),w),L=M.map(V=>A.unproject(V)),N=M.reduce((V,$,Q,J)=>V.add($.div(J.length)),new a.pointGeometry(0,0));super(s,{points:M,point:N,lngLats:L,lngLat:A.unproject(N),originalEvent:y}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Tr extends a.Event{constructor(s,A,y){super(s,{originalEvent:y}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Qa{constructor(s,A){this._map=s,this._clickTolerance=A.clickTolerance}reset(){delete this._mousedownPos}wheel(s){return this._firePreventable(new Tr(s.type,this._map,s))}mousedown(s,A){return this._mousedownPos=A,this._firePreventable(new Hi(s.type,this._map,s))}mouseup(s){this._map.fire(new Hi(s.type,this._map,s))}click(s,A){this._mousedownPos&&this._mousedownPos.dist(A)>=this._clickTolerance||this._map.fire(new Hi(s.type,this._map,s))}dblclick(s){return this._firePreventable(new Hi(s.type,this._map,s))}mouseover(s){this._map.fire(new Hi(s.type,this._map,s))}mouseout(s){this._map.fire(new Hi(s.type,this._map,s))}touchstart(s){return this._firePreventable(new yo(s.type,this._map,s))}touchmove(s){this._map.fire(new yo(s.type,this._map,s))}touchend(s){this._map.fire(new yo(s.type,this._map,s))}touchcancel(s){this._map.fire(new yo(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ls{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(s){this._map.fire(new Hi(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Hi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._ignoreContextMenu||this._map.fire(new Hi(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hu{constructor(s,A){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=A.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,A){this.isEnabled()&&s.shiftKey&&s.button===0&&(D.disableDrag(),this._startPos=this._lastPos=A,this._active=!0)}mousemoveWindow(s,A){if(!this._active)return;const y=A;if(this._lastPos.equals(y)||!this._box&&y.dist(this._startPos)<this._clickTolerance)return;const w=this._startPos;this._lastPos=y,this._box||(this._box=D.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const M=Math.min(w.x,y.x),L=Math.max(w.x,y.x),N=Math.min(w.y,y.y),V=Math.max(w.y,y.y);D.setTransform(this._box,`translate(${M}px,${N}px)`),this._box.style.width=L-M+"px",this._box.style.height=V-N+"px"}mouseupWindow(s,A){if(!this._active||s.button!==0)return;const y=this._startPos,w=A;if(this.reset(),D.suppressClick(),y.x!==w.x||y.y!==w.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:s})),{cameraAnimation:M=>M.fitScreenCoordinates(y,w,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",s)}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(s,A){return this._map.fire(new a.Event(s,{originalEvent:A}))}}function Ro(x,s){if(x.length!==s.length)throw new Error(`The number of touches and points are not equal - touches ${x.length}, points ${s.length}`);const A={};for(let y=0;y<x.length;y++)A[x[y].identifier]=s[y];return A}class Xa{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(s,A,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=s.timeStamp),y.length===this.numTouches&&(this.centroid=function(w){const M=new a.pointGeometry(0,0);for(const L of w)M._add(L);return M.div(w.length)}(A),this.touches=Ro(y,A)))}touchmove(s,A,y){if(this.aborted||!this.centroid)return;const w=Ro(y,A);for(const M in this.touches){const L=this.touches[M],N=w[M];(!N||N.dist(L)>30)&&(this.aborted=!0)}}touchend(s,A,y){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class Lc{constructor(s){this.singleTap=new Xa(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(s,A,y){this.singleTap.touchstart(s,A,y)}touchmove(s,A,y){this.singleTap.touchmove(s,A,y)}touchend(s,A,y){const w=this.singleTap.touchend(s,A,y);if(w){const M=s.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(w)<30;if(M&&L||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class Th{constructor(){this._zoomIn=new Lc({numTouches:1,numTaps:2}),this._zoomOut=new Lc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,A,y){this._zoomIn.touchstart(s,A,y),this._zoomOut.touchstart(s,A,y)}touchmove(s,A,y){this._zoomIn.touchmove(s,A,y),this._zoomOut.touchmove(s,A,y)}touchend(s,A,y){const w=this._zoomIn.touchend(s,A,y),M=this._zoomOut.touchend(s,A,y);return w?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()+1,around:L.unproject(w)},{originalEvent:s})}):M?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:L=>L.easeTo({duration:300,zoom:L.getZoom()-1,around:L.unproject(M)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Sh={0:1,2:2};class ua{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(s,A){return!1}_move(s,A){return{}}mousedown(s,A){if(this._lastPoint)return;const y=D.mouseButton(s);this._correctButton(s,y)&&(this._lastPoint=A,this._eventButton=y)}mousemoveWindow(s,A){const y=this._lastPoint;if(y){if(s.preventDefault(),function(w,M){const L=Sh[M];return w.buttons===void 0||(w.buttons&L)!==L}(s,this._eventButton))this.reset();else if(this._moved||!(A.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=A,this._move(y,A)}}mouseupWindow(s){this._lastPoint&&D.mouseButton(s)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fa extends ua{mousedown(s,A){super.mousedown(s,A),this._lastPoint&&(this._active=!0)}_correctButton(s,A){return A===0&&!s.ctrlKey}_move(s,A){return{around:A,panDelta:A.sub(s)}}}class to extends ua{_correctButton(s,A){return A===0&&s.ctrlKey||A===2}_move(s,A){const y=.8*(A.x-s.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(s){s.preventDefault()}}class Pt extends ua{_correctButton(s,A){return A===0&&s.ctrlKey||A===2}_move(s,A){const y=-.5*(A.y-s.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(s){s.preventDefault()}}class $u{constructor(s,A){this._minTouches=s.cooperativeGestures?2:1,this._clickTolerance=s.clickTolerance||1,this._map=A,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(s,A,y){return this._calculateTransform(s,A,y)}touchmove(s,A,y){if(this._map._cooperativeGestures&&(this._minTouches===2&&y.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(s,!1,y.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(y.length<this._minTouches))return s.preventDefault(),this._calculateTransform(s,A,y)}touchend(s,A,y){this._calculateTransform(s,A,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,A,y){y.length>0&&(this._active=!0);const w=Ro(y,A),M=new a.pointGeometry(0,0),L=new a.pointGeometry(0,0);let N=0;for(const $ in w){const Q=w[$],J=this._touches[$];J&&(M._add(Q),L._add(Q.sub(J)),N++,w[$]=Q)}if(this._touches=w,N<this._minTouches||!L.mag())return;const V=L.div(N);return this._sum._add(V),this._sum.mag()<this._clickTolerance?void 0:{around:M.div(N),panDelta:V}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ds{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(s){}_move(s,A,y){return{}}touchstart(s,A,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([A[0],A[1]]))}touchmove(s,A,y){if(!this._firstTwoTouches)return;s.preventDefault();const[w,M]=this._firstTwoTouches,L=cs(y,A,w),N=cs(y,A,M);if(!L||!N)return;const V=this._aroundCenter?null:L.add(N).div(2);return this._move([L,N],V,s)}touchend(s,A,y){if(!this._firstTwoTouches)return;const[w,M]=this._firstTwoTouches,L=cs(y,A,w),N=cs(y,A,M);L&&N||(this._active&&D.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function cs(x,s,A){for(let y=0;y<x.length;y++)if(x[y].identifier===A)return s[y]}function Rc(x,s){return Math.log(x/s)/Math.LN2}class St extends Ds{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,A){const y=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(Rc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Rc(this._distance,y),pinchAround:A}}}function Ol(x,s){return 180*x.angleWith(s)/Math.PI}class Wu extends Ds{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,A){const y=this._vector;if(this._vector=s[0].sub(s[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ol(this._vector,y),pinchAround:A}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const A=25/(Math.PI*this._minDiameter)*360,y=Ol(s,this._startVector);return Math.abs(y)<A}}function Dc(x){return Math.abs(x.y)>Math.abs(x.x)}class Fl extends Ds{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(s,A,y){super.touchstart(s,A,y),this._currentTouchCount=y.length}_start(s){this._lastPoints=s,Dc(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,A,y){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const w=s[0].sub(this._lastPoints[0]),M=s[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(w,M,y.timeStamp),this._valid?(this._lastPoints=s,this._active=!0,{pitchDelta:(w.y+M.y)/2*-.5}):void 0}gestureBeginsVertically(s,A,y){if(this._valid!==void 0)return this._valid;const w=s.mag()>=2,M=A.mag()>=2;if(!w&&!M)return;if(!w||!M)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;const L=s.y>0==A.y>0;return Dc(s)&&Dc(A)&&L}}const vo={panStep:100,bearingStep:15,pitchStep:10};class zc{constructor(){const s=vo;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let A=0,y=0,w=0,M=0,L=0;switch(s.keyCode){case 61:case 107:case 171:case 187:A=1;break;case 189:case 109:case 173:A=-1;break;case 37:s.shiftKey?y=-1:(s.preventDefault(),M=-1);break;case 39:s.shiftKey?y=1:(s.preventDefault(),M=1);break;case 38:s.shiftKey?w=1:(s.preventDefault(),L=-1);break;case 40:s.shiftKey?w=-1:(s.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(y=0,w=0),{cameraAnimation:N=>{const V=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:Mh,zoom:A?Math.round(V)+A*(s.shiftKey?2:1):V,bearing:N.getBearing()+y*this._bearingStep,pitch:N.getPitch()+w*this._pitchStep,offset:[-M*this._panStep,-L*this._panStep],center:N.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Mh(x){return x*(2-x)}const Zu=4.000244140625;class Bc{constructor(s,A){this._map=s,this._el=s.getCanvasContainer(),this._handler=A,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=s&&s.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;s.preventDefault()}let A=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const y=a.exported.now(),w=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,A!==0&&A%Zu==0?this._type="wheel":A!==0&&Math.abs(A)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=A,this._timeout=setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(w*A)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,A+=this._lastValue)),s.shiftKey&&A&&(A/=4),this._type&&(this._lastWheelEvent=s,this._delta-=A,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const A=D.mousePos(this._el,s);this._around=a.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(A)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;if(this._delta!==0){const N=this._type==="wheel"&&Math.abs(this._delta)>Zu?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&V!==0&&(V=1/V);const $=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom($*V))),this._type==="wheel"&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const A=typeof this._targetZoom=="number"?this._targetZoom:s.zoom,y=this._startZoom,w=this._easing;let M,L=!1;if(this._type==="wheel"&&y&&w){const N=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),V=w(N);M=a.number(y,A,V),N<1?this._frameId||(this._frameId=!0):L=!0}else M=A,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:M-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let A=a.ease;if(this._prevEase){const y=this._prevEase,w=(a.exported.now()-y.start)/y.duration,M=y.easing(w+.01)-y.easing(w),L=.27/Math.sqrt(M*M+1e-4)*.01,N=Math.sqrt(.0729-L*L);A=a.bezier(L,N,.25,1)}return this._prevEase={start:a.exported.now(),duration:s,easing:A},A}reset(){this._active=!1}}class Oc{constructor(s,A){this._clickZoom=s,this._tapZoom=A}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Fc{constructor(){this.reset()}reset(){this._active=!1}dblclick(s,A){return s.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(s.shiftKey?-1:1),around:y.unproject(A)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xo{constructor(){this._tap=new Lc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(s,A,y){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=A[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(s,A,y))}touchmove(s,A,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const w=A[0],M=w.y-this._swipePoint.y;return this._swipePoint=w,s.preventDefault(),this._active=!0,{zoomDelta:M/128}}}else this._tap.touchmove(s,A,y)}touchend(s,A,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(s,A,y)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sr{constructor(s,A,y){this._el=s,this._mousePan=A,this._touchPan=y}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Do{constructor(s,A,y){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=A,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class qu{constructor(s,A,y,w){this._el=s,this._touchZoom=A,this._touchRotate=y,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ha=x=>x.zoom||x.drag||x.pitch||x.rotate;class Nc extends a.Event{}function Ya(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}class Qu{constructor(s,A){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Gu(s),this._bearingSnap=A.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(A),a.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,M,L]of this._listeners)D.addEventListener(w,M,w===document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(const[s,A,y]of this._listeners)D.removeEventListener(s,A,s===document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(s){const A=this._map,y=A.getCanvasContainer();this._add("mapEvent",new Qa(A,s));const w=A.boxZoom=new Hu(A,s);this._add("boxZoom",w);const M=new Th,L=new Fc;A.doubleClickZoom=new Oc(L,M),this._add("tapZoom",M),this._add("clickZoom",L);const N=new xo;this._add("tapDragZoom",N);const V=A.touchPitch=new Fl(A);this._add("touchPitch",V);const $=new to(s),Q=new Pt(s);A.dragRotate=new Do(s,$,Q),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",Q,["mouseRotate"]);const J=new fa(s),ce=new $u(s,A);A.dragPan=new sr(y,J,ce),this._add("mousePan",J),this._add("touchPan",ce,["touchZoom","touchRotate"]);const ye=new Wu,_e=new St;A.touchZoomRotate=new qu(y,_e,ye,N),this._add("touchRotate",ye,["touchPan","touchZoom"]),this._add("touchZoom",_e,["touchPan","touchRotate"]);const oe=A.scrollZoom=new Bc(A,this);this._add("scrollZoom",oe,["mousePan"]);const ge=A.keyboard=new zc;this._add("keyboard",ge),this._add("blockableMapEvent",new ls(A));for(const De of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[De]&&A[De].enable(s[De])}_add(s,A,y){this._handlers.push({handlerName:s,handler:A,allowed:y}),this._handlersById[s]=A}stop(s){if(!this._updatingCamera){for(const{handler:A}of this._handlers)A.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[]}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ha(this._eventsInProgress)||this.isZooming()}_blockedByActive(s,A,y){for(const w in s)if(w!==y&&(!A||A.indexOf(w)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const A=[];for(const y of s)this._el.contains(y.target)&&A.push(y);return A}handleEvent(s,A){if(s.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const y=s.type==="renderFrame"?void 0:s,w={needsRenderFrame:!1},M={},L={},N=s.touches,V=N?this._getMapTouches(N):void 0,$=V?D.touchPos(this._el,V):D.mousePos(this._el,s);for(const{handlerName:ce,handler:ye,allowed:_e}of this._handlers){if(!ye.isEnabled())continue;let oe;this._blockedByActive(L,_e,ce)?ye.reset():ye[A||s.type]&&(oe=ye[A||s.type](s,$,V),this.mergeHandlerResult(w,M,oe,ce,y),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()),(oe||ye.isActive())&&(L[ce]=ye)}const Q={};for(const ce in this._previousActiveHandlers)L[ce]||(Q[ce]=y);this._previousActiveHandlers=L,(Object.keys(Q).length||Ya(w))&&(this._changes.push([w,M,Q]),this._triggerRenderFrame()),(Object.keys(L).length||Ya(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=w;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))}mergeHandlerResult(s,A,y,w,M){if(!y)return;a.extend(s,y);const L={handlerName:w,originalEvent:y.originalEvent||M};y.zoomDelta!==void 0&&(A.zoom=L),y.panDelta!==void 0&&(A.drag=L),y.pitchDelta!==void 0&&(A.pitch=L),y.bearingDelta!==void 0&&(A.rotate=L)}_applyChanges(){const s={},A={},y={};for(const[w,M,L]of this._changes)w.panDelta&&(s.panDelta=(s.panDelta||new a.pointGeometry(0,0))._add(w.panDelta)),w.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(s.around=w.around),w.pinchAround!==void 0&&(s.pinchAround=w.pinchAround),w.noInertia&&(s.noInertia=w.noInertia),a.extend(A,M),a.extend(y,L);this._updateMapTransform(s,A,y),this._changes=[]}_updateMapTransform(s,A,y){const w=this._map,M=w.transform,L=w.style&&w.style.terrain;if(!(Ya(s)||L&&this._drag))return this._fireEvents(A,y,!0);let{panDelta:N,zoomDelta:V,bearingDelta:$,pitchDelta:Q,around:J,pinchAround:ce}=s;ce!==void 0&&(J=ce),w._stop(!0),J=J||w.transform.centerPoint;const ye=M.pointLocation(N?J.sub(N):J);$&&(M.bearing+=$),Q&&(M.pitch+=Q),V&&(M.zoom+=V),L?A.drag&&!this._drag?(this._drag={center:M.centerPoint,lngLat:M.pointLocation(J),point:J,handlerName:A.drag.handlerName},w.fire(new a.Event("freezeElevation",{freeze:!0}))):this._drag&&y[this._drag.handlerName]?(w.fire(new a.Event("freezeElevation",{freeze:!1})),this._drag=null):A.drag&&this._drag&&(M.center=M.pointLocation(M.centerPoint.sub(N))):M.setLocationAtPoint(ye,J),this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(A,y,!0)}_fireEvents(s,A,y){const w=ha(this._eventsInProgress),M=ha(s),L={};for(const Q in s){const{originalEvent:J}=s[Q];this._eventsInProgress[Q]||(L[`${Q}start`]=J),this._eventsInProgress[Q]=s[Q]}!w&&M&&this._fireEvent("movestart",M.originalEvent);for(const Q in L)this._fireEvent(Q,L[Q]);M&&this._fireEvent("move",M.originalEvent);for(const Q in s){const{originalEvent:J}=s[Q];this._fireEvent(Q,J)}const N={};let V;for(const Q in this._eventsInProgress){const{handlerName:J,originalEvent:ce}=this._eventsInProgress[Q];this._handlersById[J].isActive()||(delete this._eventsInProgress[Q],V=A[J]||ce,N[`${Q}end`]=V)}for(const Q in N)this._fireEvent(Q,N[Q]);const $=ha(this._eventsInProgress);if(y&&(w||M)&&!$){this._updatingCamera=!0;const Q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),J=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;Q?(J(Q.bearing||this._map.getBearing())&&(Q.bearing=0),this._map.easeTo(Q,{originalEvent:V})):(this._map.fire(new a.Event("moveend",{originalEvent:V})),J(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,A){this._map.fire(new a.Event(s,A?{originalEvent:A}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{delete this._frameId,this.handleEvent(new Nc("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Fr={extend:(x,...s)=>a.extend(x,...s),run(x){x()},logToElement(x,s=!1,A="log"){const y=window.document.getElementById(A);y&&(s&&(y.innerHTML=""),y.innerHTML+=`<br>${x}`)}};class Kn extends a.Evented{constructor(s,A){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=A.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(s,A){return this.jumpTo({center:s},A)}panBy(s,A,y){return s=a.pointGeometry.convert(s).mult(-1),this.panTo(this.transform.center,a.extend({offset:s},A),y)}panTo(s,A,y){return this.easeTo(a.extend({center:s},A),y)}getZoom(){return this.transform.zoom}setZoom(s,A){return this.jumpTo({zoom:s},A),this}zoomTo(s,A,y){return this.easeTo(a.extend({zoom:s},A),y)}zoomIn(s,A){return this.zoomTo(this.getZoom()+1,s,A),this}zoomOut(s,A){return this.zoomTo(this.getZoom()-1,s,A),this}getBearing(){return this.transform.bearing}setBearing(s,A){return this.jumpTo({bearing:s},A),this}getPadding(){return this.transform.padding}setPadding(s,A){return this.jumpTo({padding:s},A),this}rotateTo(s,A,y){return this.easeTo(a.extend({bearing:s},A),y)}resetNorth(s,A){return this.rotateTo(0,a.extend({duration:1e3},s),A),this}resetNorthPitch(s,A){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},s),A),this}snapToNorth(s,A){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,A):this}getPitch(){return this.transform.pitch}setPitch(s,A){return this.jumpTo({pitch:s},A),this}cameraForBounds(s,A){s=a.LngLatBounds.convert(s);const y=A&&A.bearing||0;return this._cameraForBoxAndBearing(s.getNorthWest(),s.getSouthEast(),y,A)}_cameraForBoxAndBearing(s,A,y,w){const M={top:0,bottom:0,right:0,left:0};if(typeof(w=a.extend({padding:M,offset:[0,0],maxZoom:this.transform.maxZoom},w)).padding=="number"){const je=w.padding;w.padding={top:je,bottom:je,right:je,left:je}}w.padding=a.extend(M,w.padding);const L=this.transform,N=L.padding,V=L.project(a.LngLat.convert(s)),$=L.project(a.LngLat.convert(A)),Q=V.rotate(-y*Math.PI/180),J=$.rotate(-y*Math.PI/180),ce=new a.pointGeometry(Math.max(Q.x,J.x),Math.max(Q.y,J.y)),ye=new a.pointGeometry(Math.min(Q.x,J.x),Math.min(Q.y,J.y)),_e=ce.sub(ye),oe=(L.width-(N.left+N.right+w.padding.left+w.padding.right))/_e.x,ge=(L.height-(N.top+N.bottom+w.padding.top+w.padding.bottom))/_e.y;if(ge<0||oe<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const De=Math.min(L.scaleZoom(L.scale*Math.min(oe,ge)),w.maxZoom),Ve=a.pointGeometry.convert(w.offset),Ee=new a.pointGeometry((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(y*Math.PI/180),Ze=Ve.add(Ee).mult(L.scale/L.zoomScale(De));return{center:L.unproject(V.add($).div(2).sub(Ze)),zoom:De,bearing:y}}fitBounds(s,A,y){return this._fitInternal(this.cameraForBounds(s,A),A,y)}fitScreenCoordinates(s,A,y,w,M){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(s)),this.transform.pointLocation(a.pointGeometry.convert(A)),y,w),w,M)}_fitInternal(s,A,y){return s?(delete(A=a.extend(s,A)).padding,A.linear?this.easeTo(A,y):this.flyTo(A,y)):this}jumpTo(s,A){this.stop();const y=this.transform;let w=!1,M=!1,L=!1;return"zoom"in s&&y.zoom!==+s.zoom&&(w=!0,y.zoom=+s.zoom),s.center!==void 0&&(y.center=a.LngLat.convert(s.center)),"bearing"in s&&y.bearing!==+s.bearing&&(M=!0,y.bearing=+s.bearing),"pitch"in s&&y.pitch!==+s.pitch&&(L=!0,y.pitch=+s.pitch),s.padding==null||y.isPaddingEqual(s.padding)||(y.padding=s.padding),this.fire(new a.Event("movestart",A)).fire(new a.Event("move",A)),w&&this.fire(new a.Event("zoomstart",A)).fire(new a.Event("zoom",A)).fire(new a.Event("zoomend",A)),M&&this.fire(new a.Event("rotatestart",A)).fire(new a.Event("rotate",A)).fire(new a.Event("rotateend",A)),L&&this.fire(new a.Event("pitchstart",A)).fire(new a.Event("pitch",A)).fire(new a.Event("pitchend",A)),this.fire(new a.Event("moveend",A))}calculateCameraOptionsFromTo(s,A,y,w=0){const M=a.MercatorCoordinate.fromLngLat(s,A),L=a.MercatorCoordinate.fromLngLat(y,w),N=L.x-M.x,V=L.y-M.y,$=L.z-M.z,Q=Math.hypot(N,V,$);if(Q===0)throw new Error("Can't calculate camera options with same From and To");const J=Math.hypot(N,V),ce=this.transform.scaleZoom(this.transform.cameraToCenterDistance/Q/this.transform.tileSize),ye=180*Math.atan2(N,-V)/Math.PI;let _e=180*Math.acos(J/Q)/Math.PI;return _e=$<0?90-_e:90+_e,{center:L.toLngLat(),zoom:ce,pitch:_e,bearing:ye}}easeTo(s,A){this._stop(!1,s.easeId),((s=a.extend({offset:[0,0],duration:500,easing:a.ease},s)).animate===!1||!s.essential&&a.exported.prefersReducedMotion)&&(s.duration=0);const y=this.transform,w=this.getZoom(),M=this.getBearing(),L=this.getPitch(),N=this.getPadding(),V="zoom"in s?+s.zoom:w,$="bearing"in s?this._normalizeBearing(s.bearing,M):M,Q="pitch"in s?+s.pitch:L,J="padding"in s?s.padding:y.padding,ce=a.pointGeometry.convert(s.offset);let ye=y.centerPoint.add(ce);const _e=y.pointLocation(ye),oe=a.LngLat.convert(s.center||_e);this._normalizeCenter(oe);const ge=y.project(_e),De=y.project(oe).sub(ge),Ve=y.zoomScale(V-w);let Ee,Ze;s.around&&(Ee=a.LngLat.convert(s.around),Ze=y.locationPoint(Ee));const je={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||V!==w,this._rotating=this._rotating||M!==$,this._pitching=this._pitching||Q!==L,this._padding=!y.isPaddingEqual(J),this._easeId=s.easeId,this._prepareEase(A,s.noMoveStart,je),this._ease(tt=>{if(this._zooming&&(y.zoom=a.number(w,V,tt)),this._rotating&&(y.bearing=a.number(M,$,tt)),this._pitching&&(y.pitch=a.number(L,Q,tt)),this._padding&&(y.interpolatePadding(N,J,tt),ye=y.centerPoint.add(ce)),Ee)y.setLocationAtPoint(Ee,Ze);else{const Ke=y.zoomScale(y.zoom-w),d=V>w?Math.min(2,Ve):Math.max(.5,Ve),h=Math.pow(d,1-tt),m=y.unproject(ge.add(De.mult(tt*h)).mult(Ke));y.setLocationAtPoint(y.renderWorldCopies?m.wrap():m,ye)}this._fireMoveEvents(A)},tt=>{this._afterEase(A,tt)},s),this}_prepareEase(s,A,y={}){this._moving=!0,this.fire(new a.Event("freezeElevation",{freeze:!0})),A||y.moving||this.fire(new a.Event("movestart",s)),this._zooming&&!y.zooming&&this.fire(new a.Event("zoomstart",s)),this._rotating&&!y.rotating&&this.fire(new a.Event("rotatestart",s)),this._pitching&&!y.pitching&&this.fire(new a.Event("pitchstart",s))}_fireMoveEvents(s){this.fire(new a.Event("move",s)),this._zooming&&this.fire(new a.Event("zoom",s)),this._rotating&&this.fire(new a.Event("rotate",s)),this._pitching&&this.fire(new a.Event("pitch",s))}_afterEase(s,A){if(this._easeId&&A&&this._easeId===A)return;delete this._easeId,this.fire(new a.Event("freezeElevation",{freeze:!1}));const y=this._zooming,w=this._rotating,M=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new a.Event("zoomend",s)),w&&this.fire(new a.Event("rotateend",s)),M&&this.fire(new a.Event("pitchend",s)),this.fire(new a.Event("moveend",s))}flyTo(s,A){if(!s.essential&&a.exported.prefersReducedMotion){const P=a.pick(s,["center","zoom","bearing","pitch","around"]);return this.jumpTo(P,A)}this.stop(),s=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},s);const y=this.transform,w=this.getZoom(),M=this.getBearing(),L=this.getPitch(),N=this.getPadding(),V="zoom"in s?a.clamp(+s.zoom,y.minZoom,y.maxZoom):w,$="bearing"in s?this._normalizeBearing(s.bearing,M):M,Q="pitch"in s?+s.pitch:L,J="padding"in s?s.padding:y.padding,ce=y.zoomScale(V-w),ye=a.pointGeometry.convert(s.offset);let _e=y.centerPoint.add(ye);const oe=y.pointLocation(_e),ge=a.LngLat.convert(s.center||oe);this._normalizeCenter(ge);const De=y.project(oe),Ve=y.project(ge).sub(De);let Ee=s.curve;const Ze=Math.max(y.width,y.height),je=Ze/ce,tt=Ve.mag();if("minZoom"in s){const P=a.clamp(Math.min(s.minZoom,w,V),y.minZoom,y.maxZoom),O=Ze/y.zoomScale(P-w);Ee=Math.sqrt(O/tt*2)}const Ke=Ee*Ee;function d(P){const O=(je*je-Ze*Ze+(P?-1:1)*Ke*Ke*tt*tt)/(2*(P?je:Ze)*Ke*tt);return Math.log(Math.sqrt(O*O+1)-O)}function h(P){return(Math.exp(P)-Math.exp(-P))/2}function m(P){return(Math.exp(P)+Math.exp(-P))/2}const _=d(0);let v=function(P){return m(_)/m(_+Ee*P)},E=function(P){return Ze*((m(_)*(h(O=_+Ee*P)/m(O))-h(_))/Ke)/tt;var O},I=(d(1)-_)/Ee;if(Math.abs(tt)<1e-6||!isFinite(I)){if(Math.abs(Ze-je)<1e-6)return this.easeTo(s,A);const P=je<Ze?-1:1;I=Math.abs(Math.log(je/Ze))/Ee,E=function(){return 0},v=function(O){return Math.exp(P*Ee*O)}}return s.duration="duration"in s?+s.duration:1e3*I/("screenSpeed"in s?+s.screenSpeed/Ee:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0),this._zooming=!0,this._rotating=M!==$,this._pitching=Q!==L,this._padding=!y.isPaddingEqual(J),this._prepareEase(A,!1),this._ease(P=>{const O=P*I,G=1/v(O);y.zoom=P===1?V:w+y.scaleZoom(G),this._rotating&&(y.bearing=a.number(M,$,P)),this._pitching&&(y.pitch=a.number(L,Q,P)),this._padding&&(y.interpolatePadding(N,J,P),_e=y.centerPoint.add(ye));const X=P===1?ge:y.unproject(De.add(Ve.mult(E(O))).mult(G));y.setLocationAtPoint(y.renderWorldCopies?X.wrap():X,_e),this._fireMoveEvents(A)},()=>this._afterEase(A),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(s,A){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,A)}if(!s){const y=this.handlers;y&&y.stop(!1)}return this}_ease(s,A,y){y.animate===!1||y.duration===0?(s(1),A()):(this._easeStart=a.exported.now(),this._easeOptions=y,this._onEaseFrame=s,this._onEaseEnd=A,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,A){s=a.wrap(s,-180,180);const y=Math.abs(s-A);return Math.abs(s-360-A)<y&&(s-=360),Math.abs(s+360-A)<y&&(s+=360),s}_normalizeCenter(s){const A=this.transform;if(!A.renderWorldCopies||A.lngRange)return;const y=s.lng-A.center.lng;s.lng+=y>180?-360:y<-180?360:0}}class Ka{constructor(s={}){this.options=s,a.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){return this._map=s,this._compact=this.options&&this.options.compact,this._container=D.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(s,A){const y=this._map._getUIString(`AttributionControl.${A}`);s.title=y,s.setAttribute("aria-label",y)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let s=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=s.concat(this.options.customAttribution.map(w=>typeof w!="string"?"":w)):typeof this.options.customAttribution=="string"&&s.push(this.options.customAttribution)),this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const A=this._map.style.sourceCaches;for(const w in A){const M=A[w];if(M.used||M.usedForTerrain){const L=M.getSource();L.attribution&&s.indexOf(L.attribution)<0&&s.push(L.attribution)}}s=s.filter(w=>String(w).trim()),s.sort((w,M)=>w.length-M.length),s=s.filter((w,M)=>{for(let L=M+1;L<s.length;L++)if(s[L].indexOf(w)>=0)return!1;return!0});const y=s.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,s.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Nl{constructor(s={}){this.options=s,a.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(s){this._map=s,this._compact=this.options&&this.options.compact,this._container=D.create("div","maplibregl-ctrl mapboxgl-ctrl");const A=D.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return A.target="_blank",A.rel="noopener nofollow",A.href="https://maplibre.org/",A.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),A.setAttribute("rel","noopener nofollow"),this._container.appendChild(A),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){D.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const s=this._container.children;if(s.length){const A=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&A.classList.add("maplibregl-compact","mapboxgl-compact"):A.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Xu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const A=++this._id;return this._queue.push({callback:s,id:A,cancelled:!1}),A}remove(s){const A=this._currentlyRunning,y=A?this._queue.concat(A):this._queue;for(const w of y)if(w.id===s)return void(w.cancelled=!0)}run(s=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const A=this._currentlyRunning=this._queue;this._queue=[];for(const y of A)if(!y.cancelled&&(y.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Yu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Uc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Ku={showCompass:!0,showZoom:!0,visualizePitch:!1};class Hn{constructor(s,A,y=!1){this._clickTolerance=10,this.element=A,this.mouseRotate=new to({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,y&&(this.mousePitch=new Pt({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(A,"mousedown",this.mousedown),D.addEventListener(A,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(A,"touchmove",this.touchmove),D.addEventListener(A,"touchend",this.touchend),D.addEventListener(A,"touchcancel",this.reset)}down(s,A){this.mouseRotate.mousedown(s,A),this.mousePitch&&this.mousePitch.mousedown(s,A),D.disableDrag()}move(s,A){const y=this.map,w=this.mouseRotate.mousemoveWindow(s,A);if(w&&w.bearingDelta&&y.setBearing(y.getBearing()+w.bearingDelta),this.mousePitch){const M=this.mousePitch.mousemoveWindow(s,A);M&&M.pitchDelta&&y.setPitch(y.getPitch()+M.pitchDelta)}}off(){const s=this.element;D.removeEventListener(s,"mousedown",this.mousedown),D.removeEventListener(s,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(s,"touchmove",this.touchmove),D.removeEventListener(s,"touchend",this.touchend),D.removeEventListener(s,"touchcancel",this.reset),this.offTemp()}offTemp(){D.enableDrag(),D.removeEventListener(window,"mousemove",this.mousemove),D.removeEventListener(window,"mouseup",this.mouseup)}mousedown(s){this.down(a.extend({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),D.mousePos(this.element,s)),D.addEventListener(window,"mousemove",this.mousemove),D.addEventListener(window,"mouseup",this.mouseup)}mousemove(s){this.move(s,D.mousePos(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Ja(x,s,A){if(x=new a.LngLat(x.lng,x.lat),s){const y=new a.LngLat(x.lng-360,x.lat),w=new a.LngLat(x.lng+360,x.lat),M=A.locationPoint(x).distSqr(s);A.locationPoint(y).distSqr(s)<M?x=y:A.locationPoint(w).distSqr(s)<M&&(x=w)}for(;Math.abs(x.lng-A.center.lng)>180;){const y=A.locationPoint(x);if(y.x>=0&&y.y>=0&&y.x<=A.width&&y.y<=A.height)break;x.lng>A.center.lng?x.lng-=360:x.lng+=360}return x}const Ut={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qt(x,s,A){const y=x.classList;for(const w in Ut)y.remove(`maplibregl-${A}-anchor-${w}`,`mapboxgl-${A}-anchor-${w}`);y.add(`maplibregl-${A}-anchor-${s}`,`mapboxgl-${A}-anchor-${s}`)}class $i extends a.Evented{constructor(s,A){if(super(),(s instanceof HTMLElement||A)&&(s=a.extend({element:s},A)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment!=="auto"?s.pitchAlignment:this._rotationAlignment,s&&s.element)this._element=s.element,this._offset=a.pointGeometry.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");const y=D.createNS("http://www.w3.org/2000/svg","svg"),w=41,M=27;y.setAttributeNS(null,"display","block"),y.setAttributeNS(null,"height",`${w}px`),y.setAttributeNS(null,"width",`${M}px`),y.setAttributeNS(null,"viewBox",`0 0 ${M} ${w}`);const L=D.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"stroke","none"),L.setAttributeNS(null,"stroke-width","1"),L.setAttributeNS(null,"fill","none"),L.setAttributeNS(null,"fill-rule","evenodd");const N=D.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill-rule","nonzero");const V=D.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(3.0, 29.0)"),V.setAttributeNS(null,"fill","#000000");const $=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ve of $){const Ee=D.createNS("http://www.w3.org/2000/svg","ellipse");Ee.setAttributeNS(null,"opacity","0.04"),Ee.setAttributeNS(null,"cx","10.5"),Ee.setAttributeNS(null,"cy","5.80029008"),Ee.setAttributeNS(null,"rx",Ve.rx),Ee.setAttributeNS(null,"ry",Ve.ry),V.appendChild(Ee)}const Q=D.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"fill",this._color);const J=D.createNS("http://www.w3.org/2000/svg","path");J.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Q.appendChild(J);const ce=D.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"opacity","0.25"),ce.setAttributeNS(null,"fill","#000000");const ye=D.createNS("http://www.w3.org/2000/svg","path");ye.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ce.appendChild(ye);const _e=D.createNS("http://www.w3.org/2000/svg","g");_e.setAttributeNS(null,"transform","translate(6.0, 7.0)"),_e.setAttributeNS(null,"fill","#FFFFFF");const oe=D.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ge=D.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#000000"),ge.setAttributeNS(null,"opacity","0.25"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962");const De=D.createNS("http://www.w3.org/2000/svg","circle");De.setAttributeNS(null,"fill","#FFFFFF"),De.setAttributeNS(null,"cx","5.5"),De.setAttributeNS(null,"cy","5.5"),De.setAttributeNS(null,"r","5.4999962"),oe.appendChild(ge),oe.appendChild(De),N.appendChild(V),N.appendChild(Q),N.appendChild(ce),N.appendChild(_e),N.appendChild(oe),y.appendChild(N),y.setAttributeNS(null,"height",w*this._scale+"px"),y.setAttributeNS(null,"width",M*this._scale+"px"),this._element.appendChild(y),this._offset=a.pointGeometry.convert(s&&s.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()}),qt(this._element,this._anchor,"marker"),this._popup=null}addTo(s){return this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._update),s.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=a.LngLat.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(s){const A=s.code,y=s.charCode||s.keyCode;A!=="Space"&&A!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(s){const A=s.originalEvent.target,y=this._element;this._popup&&(A===y||y.contains(A))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?s.remove():s.addTo(this._map),this):this}_update(s){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Ja(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let A="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?A=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(A=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y=`rotateX(${this._map.getPitch()}deg)`),s&&s.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,`${Ut[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${A}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const w=this._map.unproject(this._pos),M=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=w.distanceTo(this._lngLat)>20*M?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(s){return this._offset=a.pointGeometry.convert(s),this._update(),this}_onMove(s){if(!this._isDragging){const A=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=A}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(s){this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(s){return this._draggable=!!s,this._map&&(s?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s&&s!=="auto"?s:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Vc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let us,Wi=0,zo=!1;const no={maxWidth:100,unit:"metric"};function jc(x,s,A){const y=A&&A.maxWidth||100,w=x._container.clientHeight/2,M=x.unproject([0,w]),L=x.unproject([y,w]),N=M.distanceTo(L);if(A&&A.unit==="imperial"){const V=3.2808*N;V>5280?Bo(s,y,V/5280,x._getUIString("ScaleControl.Miles")):Bo(s,y,V,x._getUIString("ScaleControl.Feet"))}else A&&A.unit==="nautical"?Bo(s,y,N/1852,x._getUIString("ScaleControl.NauticalMiles")):N>=1e3?Bo(s,y,N/1e3,x._getUIString("ScaleControl.Kilometers")):Bo(s,y,N,x._getUIString("ScaleControl.Meters"))}function Bo(x,s,A,y){const w=function(M){const L=Math.pow(10,`${Math.floor(M)}`.length-1);let N=M/L;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function(V){const $=Math.pow(10,Math.ceil(-Math.log(V)/Math.LN10));return Math.round(V*$)/$}(N),L*N}(A);x.style.width=s*(w/A)+"px",x.innerHTML=`${w}&nbsp;${y}`}const li={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},bi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Gc(x){if(x){if(typeof x=="number"){const s=Math.round(Math.sqrt(.5*Math.pow(x,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,x),"top-left":new a.pointGeometry(s,s),"top-right":new a.pointGeometry(-s,s),bottom:new a.pointGeometry(0,-x),"bottom-left":new a.pointGeometry(s,-s),"bottom-right":new a.pointGeometry(-s,-s),left:new a.pointGeometry(x,0),right:new a.pointGeometry(-x,0)}}if(x instanceof a.pointGeometry||Array.isArray(x)){const s=a.pointGeometry.convert(x);return{center:s,top:s,"top-left":s,"top-right":s,bottom:s,"bottom-left":s,"bottom-right":s,left:s,right:s}}return{center:a.pointGeometry.convert(x.center||[0,0]),top:a.pointGeometry.convert(x.top||[0,0]),"top-left":a.pointGeometry.convert(x["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(x["top-right"]||[0,0]),bottom:a.pointGeometry.convert(x.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(x["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(x["bottom-right"]||[0,0]),left:a.pointGeometry.convert(x.left||[0,0]),right:a.pointGeometry.convert(x.right||[0,0])}}return Gc(new a.pointGeometry(0,0))}const zs={supported:T,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Kn{constructor(x){var s;if(a.PerformanceUtils.mark(a.PerformanceMarkers.create),(x=a.extend({},Uc,x)).minZoom!=null&&x.maxZoom!=null&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(x.minPitch!=null&&x.maxPitch!=null&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(x.minPitch!=null&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(x.maxPitch!=null&&x.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Lo(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies),{bearingSnap:x.bearingSnap}),this._interactive=x.interactive,this._cooperativeGestures=x.cooperativeGestures,this._maxTileCacheSize=x.maxTileCacheSize,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._crossSourceCollisions=x.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=x.collectResourceTiming,this._renderTaskQueue=new Xu,this._controls=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Yu,x.locale),this._clickTolerance=x.clickTolerance,this._pixelRatio=(s=x.pixelRatio)!==null&&s!==void 0?s:devicePixelRatio,this._requestManager=new K(x.transformRequest),typeof x.container=="string"){if(this._container=document.getElementById(x.container),!this._container)throw new Error(`Container '${x.container}' not found.`)}else{if(!(x.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(x.maxBounds&&this.setMaxBounds(x.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Qu(this,x),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=x.hash&&new sa(typeof x.hash=="string"&&x.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch}),x.bounds&&(this.resize(),this.fitBounds(x.bounds,a.extend({},x.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=x.localIdeographFontFamily,x.style&&this.setStyle(x.style,{localIdeographFontFamily:x.localIdeographFontFamily}),x.attributionControl&&this.addControl(new Ka({customAttribution:x.customAttribution})),x.maplibreLogo&&this.addControl(new Nl,x.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new a.Event(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new a.Event(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new a.Event("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(x,s){if(s===void 0&&(s=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const A=x.onAdd(this);this._controls.push(x);const y=this._controlPositions[s];return s.indexOf("bottom")!==-1?y.insertBefore(A,y.firstChild):y.appendChild(A),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(x);return s>-1&&this._controls.splice(s,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}calculateCameraOptionsFromTo(x,s,A,y){return y==null&&this.style.terrain&&(y=this.transform.getElevation(A,this.style.terrain)),super.calculateCameraOptionsFromTo(x,s,A,y)}resize(x){const s=this._containerDimensions(),A=s[0],y=s[1];this._resizeCanvas(A,y,this.getPixelRatio()),this.transform.resize(A,y),this.painter.resize(A,y,this.getPixelRatio());const w=!this._moving;return w&&(this.stop(),this.fire(new a.Event("movestart",x)).fire(new a.Event("move",x))),this.fire(new a.Event("resize",x)),w&&this.fire(new a.Event("moveend",x)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(x){const[s,A]=this._containerDimensions();this._pixelRatio=x,this._resizeCanvas(s,A,x),this.painter.resize(s,A,x)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(x){return this.transform.setMaxBounds(a.LngLatBounds.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x&&this.setZoom(x),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x&&this.setZoom(x),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x&&this.setPitch(x),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x&&this.setPitch(x),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.renderWorldCopies=x,this._update()}project(x){return this.transform.locationPoint(a.LngLat.convert(x),this.style&&this.style.terrain)}unproject(x){return this.transform.pointLocation(a.pointGeometry.convert(x),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(x,s,A){if(x==="mouseenter"||x==="mouseover"){let y=!1;return{layer:s,listener:A,delegates:{mousemove:M=>{const L=this.getLayer(s)?this.queryRenderedFeatures(M.point,{layers:[s]}):[];L.length?y||(y=!0,A.call(this,new Hi(x,this,M.originalEvent,{features:L}))):y=!1},mouseout:()=>{y=!1}}}}if(x==="mouseleave"||x==="mouseout"){let y=!1;return{layer:s,listener:A,delegates:{mousemove:L=>{(this.getLayer(s)?this.queryRenderedFeatures(L.point,{layers:[s]}):[]).length?y=!0:y&&(y=!1,A.call(this,new Hi(x,this,L.originalEvent)))},mouseout:L=>{y&&(y=!1,A.call(this,new Hi(x,this,L.originalEvent)))}}}}{const y=w=>{const M=this.getLayer(s)?this.queryRenderedFeatures(w.point,{layers:[s]}):[];M.length&&(w.features=M,A.call(this,w),delete w.features)};return{layer:s,listener:A,delegates:{[x]:y}}}}on(x,s,A){if(A===void 0)return super.on(x,s);const y=this._createDelegatedListener(x,s,A);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(y);for(const w in y.delegates)this.on(w,y.delegates[w]);return this}once(x,s,A){if(A===void 0)return super.once(x,s);const y=this._createDelegatedListener(x,s,A);for(const w in y.delegates)this.once(w,y.delegates[w]);return this}off(x,s,A){return A===void 0?super.off(x,s):(this._delegatedListeners&&this._delegatedListeners[x]&&(y=>{const w=this._delegatedListeners[x];for(let M=0;M<w.length;M++){const L=w[M];if(L.layer===s&&L.listener===A){for(const N in L.delegates)this.off(N,L.delegates[N]);return w.splice(M,1),this}}})(),this)}queryRenderedFeatures(x,s){if(!this.style)return[];let A;if(s!==void 0||x===void 0||x instanceof a.pointGeometry||Array.isArray(x)||(s=x,x=void 0),s=s||{},(x=x||[[0,0],[this.transform.width,this.transform.height]])instanceof a.pointGeometry||typeof x[0]=="number")A=[a.pointGeometry.convert(x)];else{const y=a.pointGeometry.convert(x[0]),w=a.pointGeometry.convert(x[1]);A=[y,new a.pointGeometry(w.x,y.y),w,new a.pointGeometry(y.x,w.y),y]}return this.style.queryRenderedFeatures(A,s,this.transform)}querySourceFeatures(x,s){return this.style.querySourceFeatures(x,s)}setStyle(x,s){return(s=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},s)).diff!==!1&&s.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&x?(this._diffStyle(x,s),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._updateStyle(x,s))}setTransformRequest(x){return this._requestManager.setTransformRequest(x),this}_getUIString(x){const s=this._locale[x];if(s==null)throw new Error(`Missing UI string '${x}'`);return s}_updateStyle(x,s){return this.style&&(this.style.setEventedParent(null),this.style._remove()),x?(this.style=new me(this,s||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x):this.style.loadJSON(x),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new me(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,s){if(typeof x=="string"){const A=this._requestManager.transformRequest(x,a.ResourceType.Style);a.getJSON(A,(y,w)=>{y?this.fire(new a.ErrorEvent(y)):w&&this._updateDiff(w,s)})}else typeof x=="object"&&this._updateDiff(x,s)}_updateDiff(x,s){try{this.style.setState(x)&&this._update(!0)}catch(A){a.warnOnce(`Unable to perform style diff: ${A.message||A.error||A}.  Rebuilding the style from scratch.`),this._updateStyle(x,s)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(x,s){return this._lazyInitEmptyStyle(),this.style.addSource(x,s),this._update(!0)}isSourceLoaded(x){const s=this.style&&this.style.sourceCaches[x];if(s!==void 0)return s.loaded();this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${x}'`)))}setTerrain(x){return this.style.setTerrain(x),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const x=this.style&&this.style.sourceCaches;for(const s in x){const A=x[s]._tiles;for(const y in A){const w=A[y];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}addSourceType(x,s,A){return this._lazyInitEmptyStyle(),this.style.addSourceType(x,s,A)}removeSource(x){return this.style.removeSource(x),this._update(!0)}getSource(x){return this.style.getSource(x)}addImage(x,s,{pixelRatio:A=1,sdf:y=!1,stretchX:w,stretchY:M,content:L}={}){if(this._lazyInitEmptyStyle(),s instanceof HTMLImageElement||a.isImageBitmap(s)){const{width:N,height:V,data:$}=a.exported.getImageData(s);this.style.addImage(x,{data:new a.RGBAImage({width:N,height:V},$),pixelRatio:A,stretchX:w,stretchY:M,content:L,sdf:y,version:0})}else{if(s.width===void 0||s.height===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:N,height:V,data:$}=s,Q=s;this.style.addImage(x,{data:new a.RGBAImage({width:N,height:V},new Uint8Array($)),pixelRatio:A,stretchX:w,stretchY:M,content:L,sdf:y,version:0,userImage:Q}),Q.onAdd&&Q.onAdd(this,x)}}}updateImage(x,s){const A=this.style.getImage(x);if(!A)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=s instanceof HTMLImageElement||a.isImageBitmap(s)?a.exported.getImageData(s):s,{width:w,height:M,data:L}=y;if(w===void 0||M===void 0)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(w!==A.data.width||M!==A.data.height)return this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const N=!(s instanceof HTMLImageElement||a.isImageBitmap(s));A.data.replace(L,N),this.style.updateImage(x,A)}hasImage(x){return x?!!this.style.getImage(x):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x,s){a.getImage(this._requestManager.transformRequest(x,a.ResourceType.Image),s)}listImages(){return this.style.listImages()}addLayer(x,s){return this._lazyInitEmptyStyle(),this.style.addLayer(x,s),this._update(!0)}moveLayer(x,s){return this.style.moveLayer(x,s),this._update(!0)}removeLayer(x){return this.style.removeLayer(x),this._update(!0)}getLayer(x){return this.style.getLayer(x)}setLayerZoomRange(x,s,A){return this.style.setLayerZoomRange(x,s,A),this._update(!0)}setFilter(x,s,A={}){return this.style.setFilter(x,s,A),this._update(!0)}getFilter(x){return this.style.getFilter(x)}setPaintProperty(x,s,A,y={}){return this.style.setPaintProperty(x,s,A,y),this._update(!0)}getPaintProperty(x,s){return this.style.getPaintProperty(x,s)}setLayoutProperty(x,s,A,y={}){return this.style.setLayoutProperty(x,s,A,y),this._update(!0)}getLayoutProperty(x,s){return this.style.getLayoutProperty(x,s)}setLight(x,s={}){return this._lazyInitEmptyStyle(),this.style.setLight(x,s),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(x,s){return this.style.setFeatureState(x,s),this._update()}removeFeatureState(x,s){return this.style.removeFeatureState(x,s),this._update()}getFeatureState(x){return this.style.getFeatureState(x)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let x=0,s=0;return this._container&&(x=this._container.clientWidth||400,s=this._container.clientHeight||300),[x,s]}_setupContainer(){const x=this._container;x.classList.add("maplibregl-map","mapboxgl-map");const s=this._canvasContainer=D.create("div","maplibregl-canvas-container mapboxgl-canvas-container",x);this._interactive&&s.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=D.create("canvas","maplibregl-canvas mapboxgl-canvas",s),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const A=this._containerDimensions();this._resizeCanvas(A[0],A[1],this.getPixelRatio());const y=this._controlContainer=D.create("div","maplibregl-control-container mapboxgl-control-container",x),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{w[M]=D.create("div",`maplibregl-ctrl-${M} mapboxgl-ctrl-${M}`,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const x=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=D.create("div","maplibregl-cooperative-gesture-screen",x);let s="Control",A=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(A=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",s="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${A}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",y=>{y.key===s&&(this._metaPress=!0)}),document.addEventListener("keyup",y=>{y.key===s&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",y=>{this._onCooperativeGesture(y,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(x,s,A){this._canvas.width=A*x,this._canvas.height=A*s,this._canvas.style.width=`${x}px`,this._canvas.style.height=`${s}px`}_setupPainter(){const x=a.extend({},T.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl",x)||this._canvas.getContext("experimental-webgl",x);s?(this.painter=new Ar(s,this.transform),a.exported$1.testSupport(s)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(x){x.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:x}))}_contextRestored(x){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:x}))}_onMapScroll(x){if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(x,s,A){return!s&&A<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_render(x){let s,A=0;const y=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(s=y.createQueryEXT(),y.beginQueryEXT(y.TIME_ELAPSED_EXT,s),A=a.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),this._removed)return;let w=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const L=this.transform.zoom,N=a.exported.now();this.style.zoomHistory.update(L,N);const V=new a.EvaluationParameters(L,{now:N,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),$=V.crossFadingFactor();$===1&&$===this._crossFadingFactor||(w=!0,this._crossFadingFactor=$),this.style.update(V)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.load),this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||w)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const L=a.exported.now()-A;y.endQueryEXT(y.TIME_ELAPSED_EXT,s),setTimeout(()=>{const N=y.getQueryObjectEXT(s,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(s),this.fire(new a.Event("gpu-timing-frame",{cpuTime:L,gpuTime:N}))},50)}if(this.listens("gpu-timing-layer")){const L=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(L);this.fire(new a.Event("gpu-timing-layer",{layerTimes:N}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty;return M||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.Event("idle")),!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,a.PerformanceUtils.mark(a.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const x=this.painter.context.gl.getExtension("WEBGL_lose_context");x&&x.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),D.remove(this._canvasContainer),D.remove(this._controlContainer),this._cooperativeGestures&&D.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),a.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=a.exported.frame(x=>{a.PerformanceUtils.frame(x),this._frame=null,this._render(x)}))}_onWindowOnline(){this._update()}_onWindowResize(x){this._trackResize&&this.resize({originalEvent:x})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}_setCacheLimits(x,s){a.setCacheLimits(x,s)}get version(){return"2.4.0"}},NavigationControl:class{constructor(x){this.options=a.extend({},Ku,x),this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",s=>this._map.zoomIn({},{originalEvent:s})),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",s=>this._map.zoomOut({},{originalEvent:s})),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",s=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}),this._compassIcon=D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const x=this._map.getZoom(),s=x===this._map.getMaxZoom(),A=x===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=A,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",A.toString())}_rotateCompassArrow(){const x=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=x}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Hn(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(x,s){const A=D.create("button",x,this._container);return A.type="button",A.addEventListener("click",s),A}_setButtonTitle(x,s){const A=this._map._getUIString(`NavigationControl.${s}`);x.title=A,x.setAttribute("aria-label",A)}},GeolocateControl:class extends a.Evented{constructor(x){super(),this.options=a.extend({},Vc,x),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(x){var s;return this._map=x,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),s=this._setupUI,us!==void 0?s(us):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(A=>{us=A.state!=="denied",s(us)}):(us=!!window.navigator.geolocation,s(us)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Wi=0,zo=!1}_isOutOfMapMaxBounds(x){const s=this._map.getMaxBounds(),A=x.coords;return s&&(A.longitude<s.getWest()||A.longitude>s.getEast()||A.latitude<s.getSouth()||A.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(x){if(this._map){if(this._isOutOfMapMaxBounds(x))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",x)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=x,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(x),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(x),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",x)),this._finish()}}_updateCamera(x){const s=new a.LngLat(x.coords.longitude,x.coords.latitude),A=x.coords.accuracy,y=this._map.getBearing(),w=a.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(A),w,{geolocateSource:!0})}_updateMarker(x){if(x){const s=new a.LngLat(x.coords.longitude,x.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=x.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const x=this._map._container.clientHeight/2,s=this._map.unproject([0,x]),A=this._map.unproject([1,x]),y=s.distanceTo(A),w=Math.ceil(2*this._accuracy/y);this._circleElement.style.width=`${w}px`,this._circleElement.style.height=`${w}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(x){if(this._map){if(this.options.trackUserLocation)if(x.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(x.code===3&&zo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",x)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(x){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=D.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",x===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new $i(this._dotElement),this._circleElement=D.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $i({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Wi--,zo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let x;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Wi++,Wi>1?(x={maximumAge:6e5,timeout:0},zo=!0):(x=this.options.positionOptions,zo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ka,LogoControl:Nl,ScaleControl:class{constructor(x){this.options=a.extend({},no,x),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){jc(this._map,this._container,this.options)}onAdd(x){return this._map=x,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(x){this.options.unit=x,jc(this._map,this._container,this.options)}},FullscreenControl:class{constructor(x){this._fullscreen=!1,x&&x.container&&(x.container instanceof HTMLElement?this._container=x.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){D.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const x=this._fullscreenButton=D.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(x){this.options=x,a.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(x){return this._map=x,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=D.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),D.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){D.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends a.Evented{constructor(x){super(),this.options=a.extend(Object.create(li),x),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(x){return this._lngLat=a.LngLat.convert(x),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(document.createTextNode(x))}setHTML(x){const s=document.createDocumentFragment(),A=document.createElement("body");let y;for(A.innerHTML=x;y=A.firstChild,y;)s.appendChild(y);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(x){this._container&&this._container.classList.add(x)}removeClassName(x){this._container&&this._container.classList.remove(x)}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){if(this._container)return this._container.classList.toggle(x)}_createCloseButton(){this.options.closeButton&&(this._closeButton=D.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(x){this._update(x.point)}_onMouseMove(x){this._update(x.point)}_onDrag(x){this._update(x.point)}_update(x){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=D.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(M=>this._container.classList.add(M)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ja(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!x))return;const s=this._pos=this._trackPointer&&x?x:this._map.project(this._lngLat);let A=this.options.anchor;const y=Gc(this.options.offset);if(!A){const M=this._container.offsetWidth,L=this._container.offsetHeight;let N;N=s.y+y.bottom.y<L?["top"]:s.y>this._map.transform.height-L?["bottom"]:[],s.x<M/2?N.push("left"):s.x>this._map.transform.width-M/2&&N.push("right"),A=N.length===0?"bottom":N.join("-")}const w=s.add(y[A]).round();D.setTransform(this._container,`${Ut[A]} translate(${w.x}px,${w.y}px)`),qt(this._container,A,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(bi);x&&x.focus()}_onClose(){this.remove()}},Marker:$i,Style:me,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,Evented:a.Evented,AJAXError:a.AJAXError,config:a.config,CanvasSource:kn,GeoJSONSource:Sn,ImageSource:It,RasterDEMTileSource:Mt,RasterTileSource:jt,VectorTileSource:Rt,VideoSource:Jt,prewarm:function(){Gi().acquire(pi)},clearPrewarmedResources:function(){const x=hr;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(pi),hr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return Si.workerCount},set workerCount(x){Si.workerCount=x},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(x){a.config.MAX_PARALLEL_IMAGE_REQUESTS=x},clearStorage(x){a.clearTileCache(x)},workerUrl:"",addProtocol(x,s){a.config.REGISTERED_PROTOCOLS[x]=s},removeProtocol(x){delete a.config.REGISTERED_PROTOCOLS[x]}};return Fr.extend(zs,{isSafari:a.isSafari,getPerformanceMetrics:a.PerformanceUtils.getPerformanceMetrics}),zs});var p=r;return p})})(W6);var JF=W6.exports;const eN=fm(JF);var q6={exports:{}},es={},Q6={exports:{}},X6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(pt,It){var Jt=pt.length;pt.push(It);e:for(;0<Jt;){var kn=Jt-1>>>1,Mn=pt[kn];if(0<r(Mn,It))pt[kn]=It,pt[Jt]=Mn,Jt=kn;else break e}}function n(pt){return pt.length===0?null:pt[0]}function i(pt){if(pt.length===0)return null;var It=pt[0],Jt=pt.pop();if(Jt!==It){pt[0]=Jt;e:for(var kn=0,Mn=pt.length,ri=Mn>>>1;kn<ri;){var oi=2*(kn+1)-1,Ri=pt[oi],Ai=oi+1,Nn=pt[Ai];if(0>r(Ri,Jt))Ai<Mn&&0>r(Nn,Ri)?(pt[kn]=Nn,pt[Ai]=Jt,kn=Ai):(pt[kn]=Ri,pt[oi]=Jt,kn=oi);else if(Ai<Mn&&0>r(Nn,Jt))pt[kn]=Nn,pt[Ai]=Jt,kn=Ai;else break e}}return It}function r(pt,It){var Jt=pt.sortIndex-It.sortIndex;return Jt!==0?Jt:pt.id-It.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var p=Date,a=p.now();t.unstable_now=function(){return p.now()-a}}var T=[],k=[],z=1,B=null,D=3,K=!1,ee=!1,le=!1,Ce=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,ne=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function te(pt){for(var It=n(k);It!==null;){if(It.callback===null)i(k);else if(It.startTime<=pt)i(k),It.sortIndex=It.expirationTime,e(T,It);else break;It=n(k)}}function xe(pt){if(le=!1,te(pt),!ee)if(n(T)!==null)ee=!0,Mt(Le);else{var It=n(k);It!==null&&Sn(xe,It.startTime-pt)}}function Le(pt,It){ee=!1,le&&(le=!1,se(it),it=-1),K=!0;var Jt=D;try{for(te(It),B=n(T);B!==null&&(!(B.expirationTime>It)||pt&&!Xe());){var kn=B.callback;if(typeof kn=="function"){B.callback=null,D=B.priorityLevel;var Mn=kn(B.expirationTime<=It);It=t.unstable_now(),typeof Mn=="function"?B.callback=Mn:B===n(T)&&i(T),te(It)}else i(T);B=n(T)}if(B!==null)var ri=!0;else{var oi=n(k);oi!==null&&Sn(xe,oi.startTime-It),ri=!1}return ri}finally{B=null,D=Jt,K=!1}}var Ge=!1,nt=null,it=-1,dt=5,ct=-1;function Xe(){return!(t.unstable_now()-ct<dt)}function Bt(){if(nt!==null){var pt=t.unstable_now();ct=pt;var It=!0;try{It=nt(!0,pt)}finally{It?Rt():(Ge=!1,nt=null)}}else Ge=!1}var Rt;if(typeof ne=="function")Rt=function(){ne(Bt)};else if(typeof MessageChannel<"u"){var jt=new MessageChannel,_n=jt.port2;jt.port1.onmessage=Bt,Rt=function(){_n.postMessage(null)}}else Rt=function(){Ce(Bt,0)};function Mt(pt){nt=pt,Ge||(Ge=!0,Rt())}function Sn(pt,It){it=Ce(function(){pt(t.unstable_now())},It)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(pt){pt.callback=null},t.unstable_continueExecution=function(){ee||K||(ee=!0,Mt(Le))},t.unstable_forceFrameRate=function(pt){0>pt||125<pt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):dt=0<pt?Math.floor(1e3/pt):5},t.unstable_getCurrentPriorityLevel=function(){return D},t.unstable_getFirstCallbackNode=function(){return n(T)},t.unstable_next=function(pt){switch(D){case 1:case 2:case 3:var It=3;break;default:It=D}var Jt=D;D=It;try{return pt()}finally{D=Jt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(pt,It){switch(pt){case 1:case 2:case 3:case 4:case 5:break;default:pt=3}var Jt=D;D=pt;try{return It()}finally{D=Jt}},t.unstable_scheduleCallback=function(pt,It,Jt){var kn=t.unstable_now();switch(typeof Jt=="object"&&Jt!==null?(Jt=Jt.delay,Jt=typeof Jt=="number"&&0<Jt?kn+Jt:kn):Jt=kn,pt){case 1:var Mn=-1;break;case 2:Mn=250;break;case 5:Mn=1073741823;break;case 4:Mn=1e4;break;default:Mn=5e3}return Mn=Jt+Mn,pt={id:z++,callback:It,priorityLevel:pt,startTime:Jt,expirationTime:Mn,sortIndex:-1},Jt>kn?(pt.sortIndex=Jt,e(k,pt),n(T)===null&&pt===n(k)&&(le?(se(it),it=-1):le=!0,Sn(xe,Jt-kn))):(pt.sortIndex=Mn,e(T,pt),ee||K||(ee=!0,Mt(Le))),pt},t.unstable_shouldYield=Xe,t.unstable_wrapCallback=function(pt){var It=D;return function(){var Jt=D;D=It;try{return pt.apply(this,arguments)}finally{D=Jt}}}})(X6);Q6.exports=X6;var tN=Q6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y6=Dt,Ko=tN;function mt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var K6=new Set,Fd={};function Eu(t,e){sh(t,e),sh(t+"Capture",e)}function sh(t,e){for(Fd[t]=e,t=0;t<e.length;t++)K6.add(e[t])}var _l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f_=Object.prototype.hasOwnProperty,nN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Lb={},Rb={};function iN(t){return f_.call(Rb,t)?!0:f_.call(Lb,t)?!1:nN.test(t)?Rb[t]=!0:(Lb[t]=!0,!1)}function rN(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function oN(t,e,n,i){if(e===null||typeof e>"u"||rN(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ao(t,e,n,i,r,c,p){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=c,this.removeEmptyString=p}var Lr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Lr[t]=new Ao(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Lr[e]=new Ao(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Lr[t]=new Ao(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Lr[t]=new Ao(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Lr[t]=new Ao(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Lr[t]=new Ao(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Lr[t]=new Ao(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Lr[t]=new Ao(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Lr[t]=new Ao(t,5,!1,t.toLowerCase(),null,!1,!1)});var Jy=/[\-:]([a-z])/g;function e2(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Jy,e2);Lr[e]=new Ao(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Jy,e2);Lr[e]=new Ao(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Jy,e2);Lr[e]=new Ao(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Lr[t]=new Ao(t,1,!1,t.toLowerCase(),null,!1,!1)});Lr.xlinkHref=new Ao("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Lr[t]=new Ao(t,1,!1,t.toLowerCase(),null,!0,!0)});function t2(t,e,n,i){var r=Lr.hasOwnProperty(e)?Lr[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(oN(e,n,r,i)&&(n=null),i||r===null?iN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var El=Y6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d0=Symbol.for("react.element"),Ef=Symbol.for("react.portal"),Tf=Symbol.for("react.fragment"),n2=Symbol.for("react.strict_mode"),h_=Symbol.for("react.profiler"),J6=Symbol.for("react.provider"),e9=Symbol.for("react.context"),i2=Symbol.for("react.forward_ref"),d_=Symbol.for("react.suspense"),A_=Symbol.for("react.suspense_list"),r2=Symbol.for("react.memo"),Yl=Symbol.for("react.lazy"),t9=Symbol.for("react.offscreen"),Db=Symbol.iterator;function Kh(t){return t===null||typeof t!="object"?null:(t=Db&&t[Db]||t["@@iterator"],typeof t=="function"?t:null)}var Li=Object.assign,Kg;function fd(t){if(Kg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Kg=e&&e[1]||""}return`
`+Kg+t}var Jg=!1;function e1(t,e){if(!t||Jg)return"";Jg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(k){var i=k}Reflect.construct(t,[],e)}else{try{e.call()}catch(k){i=k}t.call(e.prototype)}else{try{throw Error()}catch(k){i=k}t()}}catch(k){if(k&&i&&typeof k.stack=="string"){for(var r=k.stack.split(`
`),c=i.stack.split(`
`),p=r.length-1,a=c.length-1;1<=p&&0<=a&&r[p]!==c[a];)a--;for(;1<=p&&0<=a;p--,a--)if(r[p]!==c[a]){if(p!==1||a!==1)do if(p--,a--,0>a||r[p]!==c[a]){var T=`
`+r[p].replace(" at new "," at ");return t.displayName&&T.includes("<anonymous>")&&(T=T.replace("<anonymous>",t.displayName)),T}while(1<=p&&0<=a);break}}}finally{Jg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?fd(t):""}function sN(t){switch(t.tag){case 5:return fd(t.type);case 16:return fd("Lazy");case 13:return fd("Suspense");case 19:return fd("SuspenseList");case 0:case 2:case 15:return t=e1(t.type,!1),t;case 11:return t=e1(t.type.render,!1),t;case 1:return t=e1(t.type,!0),t;default:return""}}function p_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Tf:return"Fragment";case Ef:return"Portal";case h_:return"Profiler";case n2:return"StrictMode";case d_:return"Suspense";case A_:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case e9:return(t.displayName||"Context")+".Consumer";case J6:return(t._context.displayName||"Context")+".Provider";case i2:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case r2:return e=t.displayName||null,e!==null?e:p_(t.type)||"Memo";case Yl:e=t._payload,t=t._init;try{return p_(t(e))}catch{}}return null}function aN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return p_(e);case 8:return e===n2?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function gc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function n9(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function lN(t){var e=n9(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,c=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(p){i=""+p,c.call(this,p)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(p){i=""+p},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function A0(t){t._valueTracker||(t._valueTracker=lN(t))}function i9(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=n9(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function wp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function m_(t,e){var n=e.checked;return Li({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function zb(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=gc(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function r9(t,e){e=e.checked,e!=null&&t2(t,"checked",e,!1)}function g_(t,e){r9(t,e);var n=gc(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?__(t,e.type,n):e.hasOwnProperty("defaultValue")&&__(t,e.type,gc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Bb(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function __(t,e,n){(e!=="number"||wp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var hd=Array.isArray;function Uf(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+gc(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function y_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(mt(91));return Li({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ob(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(mt(92));if(hd(n)){if(1<n.length)throw Error(mt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:gc(n)}}function o9(t,e){var n=gc(e.value),i=gc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function Fb(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function s9(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function v_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?s9(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var p0,a9=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(p0=p0||document.createElement("div"),p0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=p0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Nd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var vd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cN=["Webkit","ms","Moz","O"];Object.keys(vd).forEach(function(t){cN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vd[e]=vd[t]})});function l9(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||vd.hasOwnProperty(t)&&vd[t]?(""+e).trim():e+"px"}function c9(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=l9(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var uN=Li({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function x_(t,e){if(e){if(uN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(mt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(mt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(mt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(mt(62))}}function w_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var b_=null;function o2(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var E_=null,Vf=null,jf=null;function Nb(t){if(t=wA(t)){if(typeof E_!="function")throw Error(mt(280));var e=t.stateNode;e&&(e=wm(e),E_(t.stateNode,t.type,e))}}function u9(t){Vf?jf?jf.push(t):jf=[t]:Vf=t}function f9(){if(Vf){var t=Vf,e=jf;if(jf=Vf=null,Nb(t),e)for(t=0;t<e.length;t++)Nb(e[t])}}function h9(t,e){return t(e)}function d9(){}var t1=!1;function A9(t,e,n){if(t1)return t(e,n);t1=!0;try{return h9(t,e,n)}finally{t1=!1,(Vf!==null||jf!==null)&&(d9(),f9())}}function Ud(t,e){var n=t.stateNode;if(n===null)return null;var i=wm(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(mt(231,e,typeof n));return n}var T_=!1;if(_l)try{var Jh={};Object.defineProperty(Jh,"passive",{get:function(){T_=!0}}),window.addEventListener("test",Jh,Jh),window.removeEventListener("test",Jh,Jh)}catch{T_=!1}function fN(t,e,n,i,r,c,p,a,T){var k=Array.prototype.slice.call(arguments,3);try{e.apply(n,k)}catch(z){this.onError(z)}}var xd=!1,bp=null,Ep=!1,S_=null,hN={onError:function(t){xd=!0,bp=t}};function dN(t,e,n,i,r,c,p,a,T){xd=!1,bp=null,fN.apply(hN,arguments)}function AN(t,e,n,i,r,c,p,a,T){if(dN.apply(this,arguments),xd){if(xd){var k=bp;xd=!1,bp=null}else throw Error(mt(198));Ep||(Ep=!0,S_=k)}}function Tu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function p9(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ub(t){if(Tu(t)!==t)throw Error(mt(188))}function pN(t){var e=t.alternate;if(!e){if(e=Tu(t),e===null)throw Error(mt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var c=r.alternate;if(c===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===c.child){for(c=r.child;c;){if(c===n)return Ub(r),t;if(c===i)return Ub(r),e;c=c.sibling}throw Error(mt(188))}if(n.return!==i.return)n=r,i=c;else{for(var p=!1,a=r.child;a;){if(a===n){p=!0,n=r,i=c;break}if(a===i){p=!0,i=r,n=c;break}a=a.sibling}if(!p){for(a=c.child;a;){if(a===n){p=!0,n=c,i=r;break}if(a===i){p=!0,i=c,n=r;break}a=a.sibling}if(!p)throw Error(mt(189))}}if(n.alternate!==i)throw Error(mt(190))}if(n.tag!==3)throw Error(mt(188));return n.stateNode.current===n?t:e}function m9(t){return t=pN(t),t!==null?g9(t):null}function g9(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=g9(t);if(e!==null)return e;t=t.sibling}return null}var _9=Ko.unstable_scheduleCallback,Vb=Ko.unstable_cancelCallback,mN=Ko.unstable_shouldYield,gN=Ko.unstable_requestPaint,Qi=Ko.unstable_now,_N=Ko.unstable_getCurrentPriorityLevel,s2=Ko.unstable_ImmediatePriority,y9=Ko.unstable_UserBlockingPriority,Tp=Ko.unstable_NormalPriority,yN=Ko.unstable_LowPriority,v9=Ko.unstable_IdlePriority,_m=null,Ea=null;function vN(t){if(Ea&&typeof Ea.onCommitFiberRoot=="function")try{Ea.onCommitFiberRoot(_m,t,void 0,(t.current.flags&128)===128)}catch{}}var Zs=Math.clz32?Math.clz32:bN,xN=Math.log,wN=Math.LN2;function bN(t){return t>>>=0,t===0?32:31-(xN(t)/wN|0)|0}var m0=64,g0=4194304;function dd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Sp(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,c=t.pingedLanes,p=n&268435455;if(p!==0){var a=p&~r;a!==0?i=dd(a):(c&=p,c!==0&&(i=dd(c)))}else p=n&~r,p!==0?i=dd(p):c!==0&&(i=dd(c));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,c=e&-e,r>=c||r===16&&(c&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Zs(e),r=1<<n,i|=t[n],e&=~r;return i}function EN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TN(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,c=t.pendingLanes;0<c;){var p=31-Zs(c),a=1<<p,T=r[p];T===-1?(!(a&n)||a&i)&&(r[p]=EN(a,e)):T<=e&&(t.expiredLanes|=a),c&=~a}}function M_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function x9(){var t=m0;return m0<<=1,!(m0&4194240)&&(m0=64),t}function n1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function vA(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Zs(e),t[e]=n}function SN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Zs(n),c=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~c}}function a2(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Zs(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Jn=0;function w9(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var b9,l2,E9,T9,S9,I_=!1,_0=[],lc=null,cc=null,uc=null,Vd=new Map,jd=new Map,Jl=[],MN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jb(t,e){switch(t){case"focusin":case"focusout":lc=null;break;case"dragenter":case"dragleave":cc=null;break;case"mouseover":case"mouseout":uc=null;break;case"pointerover":case"pointerout":Vd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":jd.delete(e.pointerId)}}function ed(t,e,n,i,r,c){return t===null||t.nativeEvent!==c?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:c,targetContainers:[r]},e!==null&&(e=wA(e),e!==null&&l2(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function IN(t,e,n,i,r){switch(e){case"focusin":return lc=ed(lc,t,e,n,i,r),!0;case"dragenter":return cc=ed(cc,t,e,n,i,r),!0;case"mouseover":return uc=ed(uc,t,e,n,i,r),!0;case"pointerover":var c=r.pointerId;return Vd.set(c,ed(Vd.get(c)||null,t,e,n,i,r)),!0;case"gotpointercapture":return c=r.pointerId,jd.set(c,ed(jd.get(c)||null,t,e,n,i,r)),!0}return!1}function M9(t){var e=ou(t.target);if(e!==null){var n=Tu(e);if(n!==null){if(e=n.tag,e===13){if(e=p9(n),e!==null){t.blockedOn=e,S9(t.priority,function(){E9(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function W0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=C_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);b_=i,n.target.dispatchEvent(i),b_=null}else return e=wA(n),e!==null&&l2(e),t.blockedOn=n,!1;e.shift()}return!0}function Gb(t,e,n){W0(t)&&n.delete(e)}function CN(){I_=!1,lc!==null&&W0(lc)&&(lc=null),cc!==null&&W0(cc)&&(cc=null),uc!==null&&W0(uc)&&(uc=null),Vd.forEach(Gb),jd.forEach(Gb)}function td(t,e){t.blockedOn===e&&(t.blockedOn=null,I_||(I_=!0,Ko.unstable_scheduleCallback(Ko.unstable_NormalPriority,CN)))}function Gd(t){function e(r){return td(r,t)}if(0<_0.length){td(_0[0],t);for(var n=1;n<_0.length;n++){var i=_0[n];i.blockedOn===t&&(i.blockedOn=null)}}for(lc!==null&&td(lc,t),cc!==null&&td(cc,t),uc!==null&&td(uc,t),Vd.forEach(e),jd.forEach(e),n=0;n<Jl.length;n++)i=Jl[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Jl.length&&(n=Jl[0],n.blockedOn===null);)M9(n),n.blockedOn===null&&Jl.shift()}var Gf=El.ReactCurrentBatchConfig,Mp=!0;function kN(t,e,n,i){var r=Jn,c=Gf.transition;Gf.transition=null;try{Jn=1,c2(t,e,n,i)}finally{Jn=r,Gf.transition=c}}function PN(t,e,n,i){var r=Jn,c=Gf.transition;Gf.transition=null;try{Jn=4,c2(t,e,n,i)}finally{Jn=r,Gf.transition=c}}function c2(t,e,n,i){if(Mp){var r=C_(t,e,n,i);if(r===null)h1(t,e,i,Ip,n),jb(t,i);else if(IN(r,t,e,n,i))i.stopPropagation();else if(jb(t,i),e&4&&-1<MN.indexOf(t)){for(;r!==null;){var c=wA(r);if(c!==null&&b9(c),c=C_(t,e,n,i),c===null&&h1(t,e,i,Ip,n),c===r)break;r=c}r!==null&&i.stopPropagation()}else h1(t,e,i,null,n)}}var Ip=null;function C_(t,e,n,i){if(Ip=null,t=o2(i),t=ou(t),t!==null)if(e=Tu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=p9(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ip=t,null}function I9(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_N()){case s2:return 1;case y9:return 4;case Tp:case yN:return 16;case v9:return 536870912;default:return 16}default:return 16}}var rc=null,u2=null,Z0=null;function C9(){if(Z0)return Z0;var t,e=u2,n=e.length,i,r="value"in rc?rc.value:rc.textContent,c=r.length;for(t=0;t<n&&e[t]===r[t];t++);var p=n-t;for(i=1;i<=p&&e[n-i]===r[c-i];i++);return Z0=r.slice(t,1<i?1-i:void 0)}function q0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function y0(){return!0}function Hb(){return!1}function ts(t){function e(n,i,r,c,p){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=c,this.target=p,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(c):c[a]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?y0:Hb,this.isPropagationStopped=Hb,this}return Li(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=y0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=y0)},persist:function(){},isPersistent:y0}),e}var xh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},f2=ts(xh),xA=Li({},xh,{view:0,detail:0}),LN=ts(xA),i1,r1,nd,ym=Li({},xA,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:h2,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==nd&&(nd&&t.type==="mousemove"?(i1=t.screenX-nd.screenX,r1=t.screenY-nd.screenY):r1=i1=0,nd=t),i1)},movementY:function(t){return"movementY"in t?t.movementY:r1}}),$b=ts(ym),RN=Li({},ym,{dataTransfer:0}),DN=ts(RN),zN=Li({},xA,{relatedTarget:0}),o1=ts(zN),BN=Li({},xh,{animationName:0,elapsedTime:0,pseudoElement:0}),ON=ts(BN),FN=Li({},xh,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),NN=ts(FN),UN=Li({},xh,{data:0}),Wb=ts(UN),VN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=GN[t])?!!e[t]:!1}function h2(){return HN}var $N=Li({},xA,{key:function(t){if(t.key){var e=VN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=q0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:h2,charCode:function(t){return t.type==="keypress"?q0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?q0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),WN=ts($N),ZN=Li({},ym,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zb=ts(ZN),qN=Li({},xA,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:h2}),QN=ts(qN),XN=Li({},xh,{propertyName:0,elapsedTime:0,pseudoElement:0}),YN=ts(XN),KN=Li({},ym,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),JN=ts(KN),eU=[9,13,27,32],d2=_l&&"CompositionEvent"in window,wd=null;_l&&"documentMode"in document&&(wd=document.documentMode);var tU=_l&&"TextEvent"in window&&!wd,k9=_l&&(!d2||wd&&8<wd&&11>=wd),qb=String.fromCharCode(32),Qb=!1;function P9(t,e){switch(t){case"keyup":return eU.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function L9(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Sf=!1;function nU(t,e){switch(t){case"compositionend":return L9(e);case"keypress":return e.which!==32?null:(Qb=!0,qb);case"textInput":return t=e.data,t===qb&&Qb?null:t;default:return null}}function iU(t,e){if(Sf)return t==="compositionend"||!d2&&P9(t,e)?(t=C9(),Z0=u2=rc=null,Sf=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return k9&&e.locale!=="ko"?null:e.data;default:return null}}var rU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!rU[t.type]:e==="textarea"}function R9(t,e,n,i){u9(i),e=Cp(e,"onChange"),0<e.length&&(n=new f2("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var bd=null,Hd=null;function oU(t){H9(t,0)}function vm(t){var e=Cf(t);if(i9(e))return t}function sU(t,e){if(t==="change")return e}var D9=!1;if(_l){var s1;if(_l){var a1="oninput"in document;if(!a1){var Yb=document.createElement("div");Yb.setAttribute("oninput","return;"),a1=typeof Yb.oninput=="function"}s1=a1}else s1=!1;D9=s1&&(!document.documentMode||9<document.documentMode)}function Kb(){bd&&(bd.detachEvent("onpropertychange",z9),Hd=bd=null)}function z9(t){if(t.propertyName==="value"&&vm(Hd)){var e=[];R9(e,Hd,t,o2(t)),A9(oU,e)}}function aU(t,e,n){t==="focusin"?(Kb(),bd=e,Hd=n,bd.attachEvent("onpropertychange",z9)):t==="focusout"&&Kb()}function lU(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return vm(Hd)}function cU(t,e){if(t==="click")return vm(e)}function uU(t,e){if(t==="input"||t==="change")return vm(e)}function fU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Qs=typeof Object.is=="function"?Object.is:fU;function $d(t,e){if(Qs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!f_.call(e,r)||!Qs(t[r],e[r]))return!1}return!0}function Jb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function e3(t,e){var n=Jb(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Jb(n)}}function B9(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?B9(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function O9(){for(var t=window,e=wp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=wp(t.document)}return e}function A2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function hU(t){var e=O9(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&B9(n.ownerDocument.documentElement,n)){if(i!==null&&A2(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,c=Math.min(i.start,r);i=i.end===void 0?c:Math.min(i.end,r),!t.extend&&c>i&&(r=i,i=c,c=r),r=e3(n,c);var p=e3(n,i);r&&p&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==p.node||t.focusOffset!==p.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),c>i?(t.addRange(e),t.extend(p.node,p.offset)):(e.setEnd(p.node,p.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var dU=_l&&"documentMode"in document&&11>=document.documentMode,Mf=null,k_=null,Ed=null,P_=!1;function t3(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;P_||Mf==null||Mf!==wp(i)||(i=Mf,"selectionStart"in i&&A2(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ed&&$d(Ed,i)||(Ed=i,i=Cp(k_,"onSelect"),0<i.length&&(e=new f2("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Mf)))}function v0(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var If={animationend:v0("Animation","AnimationEnd"),animationiteration:v0("Animation","AnimationIteration"),animationstart:v0("Animation","AnimationStart"),transitionend:v0("Transition","TransitionEnd")},l1={},F9={};_l&&(F9=document.createElement("div").style,"AnimationEvent"in window||(delete If.animationend.animation,delete If.animationiteration.animation,delete If.animationstart.animation),"TransitionEvent"in window||delete If.transitionend.transition);function xm(t){if(l1[t])return l1[t];if(!If[t])return t;var e=If[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in F9)return l1[t]=e[n];return t}var N9=xm("animationend"),U9=xm("animationiteration"),V9=xm("animationstart"),j9=xm("transitionend"),G9=new Map,n3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yc(t,e){G9.set(t,e),Eu(e,[t])}for(var c1=0;c1<n3.length;c1++){var u1=n3[c1],AU=u1.toLowerCase(),pU=u1[0].toUpperCase()+u1.slice(1);yc(AU,"on"+pU)}yc(N9,"onAnimationEnd");yc(U9,"onAnimationIteration");yc(V9,"onAnimationStart");yc("dblclick","onDoubleClick");yc("focusin","onFocus");yc("focusout","onBlur");yc(j9,"onTransitionEnd");sh("onMouseEnter",["mouseout","mouseover"]);sh("onMouseLeave",["mouseout","mouseover"]);sh("onPointerEnter",["pointerout","pointerover"]);sh("onPointerLeave",["pointerout","pointerover"]);Eu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Eu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Eu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Eu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Eu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Eu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ad="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mU=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ad));function i3(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,AN(i,e,void 0,t),t.currentTarget=null}function H9(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var c=void 0;if(e)for(var p=i.length-1;0<=p;p--){var a=i[p],T=a.instance,k=a.currentTarget;if(a=a.listener,T!==c&&r.isPropagationStopped())break e;i3(r,a,k),c=T}else for(p=0;p<i.length;p++){if(a=i[p],T=a.instance,k=a.currentTarget,a=a.listener,T!==c&&r.isPropagationStopped())break e;i3(r,a,k),c=T}}}if(Ep)throw t=S_,Ep=!1,S_=null,t}function yi(t,e){var n=e[B_];n===void 0&&(n=e[B_]=new Set);var i=t+"__bubble";n.has(i)||($9(e,t,2,!1),n.add(i))}function f1(t,e,n){var i=0;e&&(i|=4),$9(n,t,i,e)}var x0="_reactListening"+Math.random().toString(36).slice(2);function Wd(t){if(!t[x0]){t[x0]=!0,K6.forEach(function(n){n!=="selectionchange"&&(mU.has(n)||f1(n,!1,t),f1(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[x0]||(e[x0]=!0,f1("selectionchange",!1,e))}}function $9(t,e,n,i){switch(I9(e)){case 1:var r=kN;break;case 4:r=PN;break;default:r=c2}n=r.bind(null,e,n,t),r=void 0,!T_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function h1(t,e,n,i,r){var c=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var p=i.tag;if(p===3||p===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(p===4)for(p=i.return;p!==null;){var T=p.tag;if((T===3||T===4)&&(T=p.stateNode.containerInfo,T===r||T.nodeType===8&&T.parentNode===r))return;p=p.return}for(;a!==null;){if(p=ou(a),p===null)return;if(T=p.tag,T===5||T===6){i=c=p;continue e}a=a.parentNode}}i=i.return}A9(function(){var k=c,z=o2(n),B=[];e:{var D=G9.get(t);if(D!==void 0){var K=f2,ee=t;switch(t){case"keypress":if(q0(n)===0)break e;case"keydown":case"keyup":K=WN;break;case"focusin":ee="focus",K=o1;break;case"focusout":ee="blur",K=o1;break;case"beforeblur":case"afterblur":K=o1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":K=$b;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":K=DN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":K=QN;break;case N9:case U9:case V9:K=ON;break;case j9:K=YN;break;case"scroll":K=LN;break;case"wheel":K=JN;break;case"copy":case"cut":case"paste":K=NN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":K=Zb}var le=(e&4)!==0,Ce=!le&&t==="scroll",se=le?D!==null?D+"Capture":null:D;le=[];for(var ne=k,te;ne!==null;){te=ne;var xe=te.stateNode;if(te.tag===5&&xe!==null&&(te=xe,se!==null&&(xe=Ud(ne,se),xe!=null&&le.push(Zd(ne,xe,te)))),Ce)break;ne=ne.return}0<le.length&&(D=new K(D,ee,null,n,z),B.push({event:D,listeners:le}))}}if(!(e&7)){e:{if(D=t==="mouseover"||t==="pointerover",K=t==="mouseout"||t==="pointerout",D&&n!==b_&&(ee=n.relatedTarget||n.fromElement)&&(ou(ee)||ee[yl]))break e;if((K||D)&&(D=z.window===z?z:(D=z.ownerDocument)?D.defaultView||D.parentWindow:window,K?(ee=n.relatedTarget||n.toElement,K=k,ee=ee?ou(ee):null,ee!==null&&(Ce=Tu(ee),ee!==Ce||ee.tag!==5&&ee.tag!==6)&&(ee=null)):(K=null,ee=k),K!==ee)){if(le=$b,xe="onMouseLeave",se="onMouseEnter",ne="mouse",(t==="pointerout"||t==="pointerover")&&(le=Zb,xe="onPointerLeave",se="onPointerEnter",ne="pointer"),Ce=K==null?D:Cf(K),te=ee==null?D:Cf(ee),D=new le(xe,ne+"leave",K,n,z),D.target=Ce,D.relatedTarget=te,xe=null,ou(z)===k&&(le=new le(se,ne+"enter",ee,n,z),le.target=te,le.relatedTarget=Ce,xe=le),Ce=xe,K&&ee)t:{for(le=K,se=ee,ne=0,te=le;te;te=_f(te))ne++;for(te=0,xe=se;xe;xe=_f(xe))te++;for(;0<ne-te;)le=_f(le),ne--;for(;0<te-ne;)se=_f(se),te--;for(;ne--;){if(le===se||se!==null&&le===se.alternate)break t;le=_f(le),se=_f(se)}le=null}else le=null;K!==null&&r3(B,D,K,le,!1),ee!==null&&Ce!==null&&r3(B,Ce,ee,le,!0)}}e:{if(D=k?Cf(k):window,K=D.nodeName&&D.nodeName.toLowerCase(),K==="select"||K==="input"&&D.type==="file")var Le=sU;else if(Xb(D))if(D9)Le=uU;else{Le=lU;var Ge=aU}else(K=D.nodeName)&&K.toLowerCase()==="input"&&(D.type==="checkbox"||D.type==="radio")&&(Le=cU);if(Le&&(Le=Le(t,k))){R9(B,Le,n,z);break e}Ge&&Ge(t,D,k),t==="focusout"&&(Ge=D._wrapperState)&&Ge.controlled&&D.type==="number"&&__(D,"number",D.value)}switch(Ge=k?Cf(k):window,t){case"focusin":(Xb(Ge)||Ge.contentEditable==="true")&&(Mf=Ge,k_=k,Ed=null);break;case"focusout":Ed=k_=Mf=null;break;case"mousedown":P_=!0;break;case"contextmenu":case"mouseup":case"dragend":P_=!1,t3(B,n,z);break;case"selectionchange":if(dU)break;case"keydown":case"keyup":t3(B,n,z)}var nt;if(d2)e:{switch(t){case"compositionstart":var it="onCompositionStart";break e;case"compositionend":it="onCompositionEnd";break e;case"compositionupdate":it="onCompositionUpdate";break e}it=void 0}else Sf?P9(t,n)&&(it="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(it="onCompositionStart");it&&(k9&&n.locale!=="ko"&&(Sf||it!=="onCompositionStart"?it==="onCompositionEnd"&&Sf&&(nt=C9()):(rc=z,u2="value"in rc?rc.value:rc.textContent,Sf=!0)),Ge=Cp(k,it),0<Ge.length&&(it=new Wb(it,t,null,n,z),B.push({event:it,listeners:Ge}),nt?it.data=nt:(nt=L9(n),nt!==null&&(it.data=nt)))),(nt=tU?nU(t,n):iU(t,n))&&(k=Cp(k,"onBeforeInput"),0<k.length&&(z=new Wb("onBeforeInput","beforeinput",null,n,z),B.push({event:z,listeners:k}),z.data=nt))}H9(B,e)})}function Zd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Cp(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,c=r.stateNode;r.tag===5&&c!==null&&(r=c,c=Ud(t,n),c!=null&&i.unshift(Zd(t,c,r)),c=Ud(t,e),c!=null&&i.push(Zd(t,c,r))),t=t.return}return i}function _f(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function r3(t,e,n,i,r){for(var c=e._reactName,p=[];n!==null&&n!==i;){var a=n,T=a.alternate,k=a.stateNode;if(T!==null&&T===i)break;a.tag===5&&k!==null&&(a=k,r?(T=Ud(n,c),T!=null&&p.unshift(Zd(n,T,a))):r||(T=Ud(n,c),T!=null&&p.push(Zd(n,T,a)))),n=n.return}p.length!==0&&t.push({event:e,listeners:p})}var gU=/\r\n?/g,_U=/\u0000|\uFFFD/g;function o3(t){return(typeof t=="string"?t:""+t).replace(gU,`
`).replace(_U,"")}function w0(t,e,n){if(e=o3(e),o3(t)!==e&&n)throw Error(mt(425))}function kp(){}var L_=null,R_=null;function D_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var z_=typeof setTimeout=="function"?setTimeout:void 0,yU=typeof clearTimeout=="function"?clearTimeout:void 0,s3=typeof Promise=="function"?Promise:void 0,vU=typeof queueMicrotask=="function"?queueMicrotask:typeof s3<"u"?function(t){return s3.resolve(null).then(t).catch(xU)}:z_;function xU(t){setTimeout(function(){throw t})}function d1(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),Gd(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);Gd(e)}function fc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function a3(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var wh=Math.random().toString(36).slice(2),va="__reactFiber$"+wh,qd="__reactProps$"+wh,yl="__reactContainer$"+wh,B_="__reactEvents$"+wh,wU="__reactListeners$"+wh,bU="__reactHandles$"+wh;function ou(t){var e=t[va];if(e)return e;for(var n=t.parentNode;n;){if(e=n[yl]||n[va]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=a3(t);t!==null;){if(n=t[va])return n;t=a3(t)}return e}t=n,n=t.parentNode}return null}function wA(t){return t=t[va]||t[yl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Cf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(mt(33))}function wm(t){return t[qd]||null}var O_=[],kf=-1;function vc(t){return{current:t}}function vi(t){0>kf||(t.current=O_[kf],O_[kf]=null,kf--)}function di(t,e){kf++,O_[kf]=t.current,t.current=e}var _c={},qr=vc(_c),So=vc(!1),mu=_c;function ah(t,e){var n=t.type.contextTypes;if(!n)return _c;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},c;for(c in n)r[c]=e[c];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Mo(t){return t=t.childContextTypes,t!=null}function Pp(){vi(So),vi(qr)}function l3(t,e,n){if(qr.current!==_c)throw Error(mt(168));di(qr,e),di(So,n)}function W9(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(mt(108,aN(t)||"Unknown",r));return Li({},n,i)}function Lp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_c,mu=qr.current,di(qr,t),di(So,So.current),!0}function c3(t,e,n){var i=t.stateNode;if(!i)throw Error(mt(169));n?(t=W9(t,e,mu),i.__reactInternalMemoizedMergedChildContext=t,vi(So),vi(qr),di(qr,t)):vi(So),di(So,n)}var cl=null,bm=!1,A1=!1;function Z9(t){cl===null?cl=[t]:cl.push(t)}function EU(t){bm=!0,Z9(t)}function xc(){if(!A1&&cl!==null){A1=!0;var t=0,e=Jn;try{var n=cl;for(Jn=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}cl=null,bm=!1}catch(r){throw cl!==null&&(cl=cl.slice(t+1)),_9(s2,xc),r}finally{Jn=e,A1=!1}}return null}var Pf=[],Lf=0,Rp=null,Dp=0,gs=[],_s=0,gu=null,hl=1,dl="";function tu(t,e){Pf[Lf++]=Dp,Pf[Lf++]=Rp,Rp=t,Dp=e}function q9(t,e,n){gs[_s++]=hl,gs[_s++]=dl,gs[_s++]=gu,gu=t;var i=hl;t=dl;var r=32-Zs(i)-1;i&=~(1<<r),n+=1;var c=32-Zs(e)+r;if(30<c){var p=r-r%5;c=(i&(1<<p)-1).toString(32),i>>=p,r-=p,hl=1<<32-Zs(e)+r|n<<r|i,dl=c+t}else hl=1<<c|n<<r|i,dl=t}function p2(t){t.return!==null&&(tu(t,1),q9(t,1,0))}function m2(t){for(;t===Rp;)Rp=Pf[--Lf],Pf[Lf]=null,Dp=Pf[--Lf],Pf[Lf]=null;for(;t===gu;)gu=gs[--_s],gs[_s]=null,dl=gs[--_s],gs[_s]=null,hl=gs[--_s],gs[_s]=null}var Yo=null,qo=null,Ti=!1,Gs=null;function Q9(t,e){var n=ys(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function u3(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Yo=t,qo=fc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Yo=t,qo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=gu!==null?{id:hl,overflow:dl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ys(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Yo=t,qo=null,!0):!1;default:return!1}}function F_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function N_(t){if(Ti){var e=qo;if(e){var n=e;if(!u3(t,e)){if(F_(t))throw Error(mt(418));e=fc(n.nextSibling);var i=Yo;e&&u3(t,e)?Q9(i,n):(t.flags=t.flags&-4097|2,Ti=!1,Yo=t)}}else{if(F_(t))throw Error(mt(418));t.flags=t.flags&-4097|2,Ti=!1,Yo=t}}}function f3(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Yo=t}function b0(t){if(t!==Yo)return!1;if(!Ti)return f3(t),Ti=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!D_(t.type,t.memoizedProps)),e&&(e=qo)){if(F_(t))throw X9(),Error(mt(418));for(;e;)Q9(t,e),e=fc(e.nextSibling)}if(f3(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(mt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){qo=fc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}qo=null}}else qo=Yo?fc(t.stateNode.nextSibling):null;return!0}function X9(){for(var t=qo;t;)t=fc(t.nextSibling)}function lh(){qo=Yo=null,Ti=!1}function g2(t){Gs===null?Gs=[t]:Gs.push(t)}var TU=El.ReactCurrentBatchConfig;function Vs(t,e){if(t&&t.defaultProps){e=Li({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var zp=vc(null),Bp=null,Rf=null,_2=null;function y2(){_2=Rf=Bp=null}function v2(t){var e=zp.current;vi(zp),t._currentValue=e}function U_(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Hf(t,e){Bp=t,_2=Rf=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Eo=!0),t.firstContext=null)}function bs(t){var e=t._currentValue;if(_2!==t)if(t={context:t,memoizedValue:e,next:null},Rf===null){if(Bp===null)throw Error(mt(308));Rf=t,Bp.dependencies={lanes:0,firstContext:t}}else Rf=Rf.next=t;return e}var su=null;function x2(t){su===null?su=[t]:su.push(t)}function Y9(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,x2(e)):(n.next=r.next,r.next=n),e.interleaved=n,vl(t,i)}function vl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Kl=!1;function w2(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function K9(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Al(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function hc(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Wn&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,vl(t,n)}return r=i.interleaved,r===null?(e.next=e,x2(i)):(e.next=r.next,r.next=e),i.interleaved=e,vl(t,n)}function Q0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,a2(t,n)}}function h3(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var p={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};c===null?r=c=p:c=c.next=p,n=n.next}while(n!==null);c===null?r=c=e:c=c.next=e}else r=c=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:c,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Op(t,e,n,i){var r=t.updateQueue;Kl=!1;var c=r.firstBaseUpdate,p=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var T=a,k=T.next;T.next=null,p===null?c=k:p.next=k,p=T;var z=t.alternate;z!==null&&(z=z.updateQueue,a=z.lastBaseUpdate,a!==p&&(a===null?z.firstBaseUpdate=k:a.next=k,z.lastBaseUpdate=T))}if(c!==null){var B=r.baseState;p=0,z=k=T=null,a=c;do{var D=a.lane,K=a.eventTime;if((i&D)===D){z!==null&&(z=z.next={eventTime:K,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var ee=t,le=a;switch(D=e,K=n,le.tag){case 1:if(ee=le.payload,typeof ee=="function"){B=ee.call(K,B,D);break e}B=ee;break e;case 3:ee.flags=ee.flags&-65537|128;case 0:if(ee=le.payload,D=typeof ee=="function"?ee.call(K,B,D):ee,D==null)break e;B=Li({},B,D);break e;case 2:Kl=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,D=r.effects,D===null?r.effects=[a]:D.push(a))}else K={eventTime:K,lane:D,tag:a.tag,payload:a.payload,callback:a.callback,next:null},z===null?(k=z=K,T=B):z=z.next=K,p|=D;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;D=a,a=D.next,D.next=null,r.lastBaseUpdate=D,r.shared.pending=null}}while(1);if(z===null&&(T=B),r.baseState=T,r.firstBaseUpdate=k,r.lastBaseUpdate=z,e=r.shared.interleaved,e!==null){r=e;do p|=r.lane,r=r.next;while(r!==e)}else c===null&&(r.shared.lanes=0);yu|=p,t.lanes=p,t.memoizedState=B}}function d3(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(mt(191,r));r.call(i)}}}var J9=new Y6.Component().refs;function V_(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Li({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Em={isMounted:function(t){return(t=t._reactInternals)?Tu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=fo(),r=Ac(t),c=Al(i,r);c.payload=e,n!=null&&(c.callback=n),e=hc(t,c,r),e!==null&&(qs(e,t,r,i),Q0(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=fo(),r=Ac(t),c=Al(i,r);c.tag=1,c.payload=e,n!=null&&(c.callback=n),e=hc(t,c,r),e!==null&&(qs(e,t,r,i),Q0(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fo(),i=Ac(t),r=Al(n,i);r.tag=2,e!=null&&(r.callback=e),e=hc(t,r,i),e!==null&&(qs(e,t,i,n),Q0(e,t,i))}};function A3(t,e,n,i,r,c,p){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,c,p):e.prototype&&e.prototype.isPureReactComponent?!$d(n,i)||!$d(r,c):!0}function e4(t,e,n){var i=!1,r=_c,c=e.contextType;return typeof c=="object"&&c!==null?c=bs(c):(r=Mo(e)?mu:qr.current,i=e.contextTypes,c=(i=i!=null)?ah(t,r):_c),e=new e(n,c),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Em,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=c),e}function p3(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&Em.enqueueReplaceState(e,e.state,null)}function j_(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=J9,w2(t);var c=e.contextType;typeof c=="object"&&c!==null?r.context=bs(c):(c=Mo(e)?mu:qr.current,r.context=ah(t,c)),r.state=t.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(V_(t,e,c,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Em.enqueueReplaceState(r,r.state,null),Op(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function id(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(mt(309));var i=n.stateNode}if(!i)throw Error(mt(147,t));var r=i,c=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(p){var a=r.refs;a===J9&&(a=r.refs={}),p===null?delete a[c]:a[c]=p},e._stringRef=c,e)}if(typeof t!="string")throw Error(mt(284));if(!n._owner)throw Error(mt(290,t))}return t}function E0(t,e){throw t=Object.prototype.toString.call(e),Error(mt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function m3(t){var e=t._init;return e(t._payload)}function t4(t){function e(se,ne){if(t){var te=se.deletions;te===null?(se.deletions=[ne],se.flags|=16):te.push(ne)}}function n(se,ne){if(!t)return null;for(;ne!==null;)e(se,ne),ne=ne.sibling;return null}function i(se,ne){for(se=new Map;ne!==null;)ne.key!==null?se.set(ne.key,ne):se.set(ne.index,ne),ne=ne.sibling;return se}function r(se,ne){return se=pc(se,ne),se.index=0,se.sibling=null,se}function c(se,ne,te){return se.index=te,t?(te=se.alternate,te!==null?(te=te.index,te<ne?(se.flags|=2,ne):te):(se.flags|=2,ne)):(se.flags|=1048576,ne)}function p(se){return t&&se.alternate===null&&(se.flags|=2),se}function a(se,ne,te,xe){return ne===null||ne.tag!==6?(ne=x1(te,se.mode,xe),ne.return=se,ne):(ne=r(ne,te),ne.return=se,ne)}function T(se,ne,te,xe){var Le=te.type;return Le===Tf?z(se,ne,te.props.children,xe,te.key):ne!==null&&(ne.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===Yl&&m3(Le)===ne.type)?(xe=r(ne,te.props),xe.ref=id(se,ne,te),xe.return=se,xe):(xe=tp(te.type,te.key,te.props,null,se.mode,xe),xe.ref=id(se,ne,te),xe.return=se,xe)}function k(se,ne,te,xe){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==te.containerInfo||ne.stateNode.implementation!==te.implementation?(ne=w1(te,se.mode,xe),ne.return=se,ne):(ne=r(ne,te.children||[]),ne.return=se,ne)}function z(se,ne,te,xe,Le){return ne===null||ne.tag!==7?(ne=fu(te,se.mode,xe,Le),ne.return=se,ne):(ne=r(ne,te),ne.return=se,ne)}function B(se,ne,te){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return ne=x1(""+ne,se.mode,te),ne.return=se,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case d0:return te=tp(ne.type,ne.key,ne.props,null,se.mode,te),te.ref=id(se,null,ne),te.return=se,te;case Ef:return ne=w1(ne,se.mode,te),ne.return=se,ne;case Yl:var xe=ne._init;return B(se,xe(ne._payload),te)}if(hd(ne)||Kh(ne))return ne=fu(ne,se.mode,te,null),ne.return=se,ne;E0(se,ne)}return null}function D(se,ne,te,xe){var Le=ne!==null?ne.key:null;if(typeof te=="string"&&te!==""||typeof te=="number")return Le!==null?null:a(se,ne,""+te,xe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case d0:return te.key===Le?T(se,ne,te,xe):null;case Ef:return te.key===Le?k(se,ne,te,xe):null;case Yl:return Le=te._init,D(se,ne,Le(te._payload),xe)}if(hd(te)||Kh(te))return Le!==null?null:z(se,ne,te,xe,null);E0(se,te)}return null}function K(se,ne,te,xe,Le){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return se=se.get(te)||null,a(ne,se,""+xe,Le);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case d0:return se=se.get(xe.key===null?te:xe.key)||null,T(ne,se,xe,Le);case Ef:return se=se.get(xe.key===null?te:xe.key)||null,k(ne,se,xe,Le);case Yl:var Ge=xe._init;return K(se,ne,te,Ge(xe._payload),Le)}if(hd(xe)||Kh(xe))return se=se.get(te)||null,z(ne,se,xe,Le,null);E0(ne,xe)}return null}function ee(se,ne,te,xe){for(var Le=null,Ge=null,nt=ne,it=ne=0,dt=null;nt!==null&&it<te.length;it++){nt.index>it?(dt=nt,nt=null):dt=nt.sibling;var ct=D(se,nt,te[it],xe);if(ct===null){nt===null&&(nt=dt);break}t&&nt&&ct.alternate===null&&e(se,nt),ne=c(ct,ne,it),Ge===null?Le=ct:Ge.sibling=ct,Ge=ct,nt=dt}if(it===te.length)return n(se,nt),Ti&&tu(se,it),Le;if(nt===null){for(;it<te.length;it++)nt=B(se,te[it],xe),nt!==null&&(ne=c(nt,ne,it),Ge===null?Le=nt:Ge.sibling=nt,Ge=nt);return Ti&&tu(se,it),Le}for(nt=i(se,nt);it<te.length;it++)dt=K(nt,se,it,te[it],xe),dt!==null&&(t&&dt.alternate!==null&&nt.delete(dt.key===null?it:dt.key),ne=c(dt,ne,it),Ge===null?Le=dt:Ge.sibling=dt,Ge=dt);return t&&nt.forEach(function(Xe){return e(se,Xe)}),Ti&&tu(se,it),Le}function le(se,ne,te,xe){var Le=Kh(te);if(typeof Le!="function")throw Error(mt(150));if(te=Le.call(te),te==null)throw Error(mt(151));for(var Ge=Le=null,nt=ne,it=ne=0,dt=null,ct=te.next();nt!==null&&!ct.done;it++,ct=te.next()){nt.index>it?(dt=nt,nt=null):dt=nt.sibling;var Xe=D(se,nt,ct.value,xe);if(Xe===null){nt===null&&(nt=dt);break}t&&nt&&Xe.alternate===null&&e(se,nt),ne=c(Xe,ne,it),Ge===null?Le=Xe:Ge.sibling=Xe,Ge=Xe,nt=dt}if(ct.done)return n(se,nt),Ti&&tu(se,it),Le;if(nt===null){for(;!ct.done;it++,ct=te.next())ct=B(se,ct.value,xe),ct!==null&&(ne=c(ct,ne,it),Ge===null?Le=ct:Ge.sibling=ct,Ge=ct);return Ti&&tu(se,it),Le}for(nt=i(se,nt);!ct.done;it++,ct=te.next())ct=K(nt,se,it,ct.value,xe),ct!==null&&(t&&ct.alternate!==null&&nt.delete(ct.key===null?it:ct.key),ne=c(ct,ne,it),Ge===null?Le=ct:Ge.sibling=ct,Ge=ct);return t&&nt.forEach(function(Bt){return e(se,Bt)}),Ti&&tu(se,it),Le}function Ce(se,ne,te,xe){if(typeof te=="object"&&te!==null&&te.type===Tf&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case d0:e:{for(var Le=te.key,Ge=ne;Ge!==null;){if(Ge.key===Le){if(Le=te.type,Le===Tf){if(Ge.tag===7){n(se,Ge.sibling),ne=r(Ge,te.props.children),ne.return=se,se=ne;break e}}else if(Ge.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===Yl&&m3(Le)===Ge.type){n(se,Ge.sibling),ne=r(Ge,te.props),ne.ref=id(se,Ge,te),ne.return=se,se=ne;break e}n(se,Ge);break}else e(se,Ge);Ge=Ge.sibling}te.type===Tf?(ne=fu(te.props.children,se.mode,xe,te.key),ne.return=se,se=ne):(xe=tp(te.type,te.key,te.props,null,se.mode,xe),xe.ref=id(se,ne,te),xe.return=se,se=xe)}return p(se);case Ef:e:{for(Ge=te.key;ne!==null;){if(ne.key===Ge)if(ne.tag===4&&ne.stateNode.containerInfo===te.containerInfo&&ne.stateNode.implementation===te.implementation){n(se,ne.sibling),ne=r(ne,te.children||[]),ne.return=se,se=ne;break e}else{n(se,ne);break}else e(se,ne);ne=ne.sibling}ne=w1(te,se.mode,xe),ne.return=se,se=ne}return p(se);case Yl:return Ge=te._init,Ce(se,ne,Ge(te._payload),xe)}if(hd(te))return ee(se,ne,te,xe);if(Kh(te))return le(se,ne,te,xe);E0(se,te)}return typeof te=="string"&&te!==""||typeof te=="number"?(te=""+te,ne!==null&&ne.tag===6?(n(se,ne.sibling),ne=r(ne,te),ne.return=se,se=ne):(n(se,ne),ne=x1(te,se.mode,xe),ne.return=se,se=ne),p(se)):n(se,ne)}return Ce}var ch=t4(!0),n4=t4(!1),bA={},Ta=vc(bA),Qd=vc(bA),Xd=vc(bA);function au(t){if(t===bA)throw Error(mt(174));return t}function b2(t,e){switch(di(Xd,e),di(Qd,t),di(Ta,bA),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:v_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=v_(e,t)}vi(Ta),di(Ta,e)}function uh(){vi(Ta),vi(Qd),vi(Xd)}function i4(t){au(Xd.current);var e=au(Ta.current),n=v_(e,t.type);e!==n&&(di(Qd,t),di(Ta,n))}function E2(t){Qd.current===t&&(vi(Ta),vi(Qd))}var Ci=vc(0);function Fp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var p1=[];function T2(){for(var t=0;t<p1.length;t++)p1[t]._workInProgressVersionPrimary=null;p1.length=0}var X0=El.ReactCurrentDispatcher,m1=El.ReactCurrentBatchConfig,_u=0,Pi=null,cr=null,yr=null,Np=!1,Td=!1,Yd=0,SU=0;function Gr(){throw Error(mt(321))}function S2(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Qs(t[n],e[n]))return!1;return!0}function M2(t,e,n,i,r,c){if(_u=c,Pi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,X0.current=t===null||t.memoizedState===null?kU:PU,t=n(i,r),Td){c=0;do{if(Td=!1,Yd=0,25<=c)throw Error(mt(301));c+=1,yr=cr=null,e.updateQueue=null,X0.current=LU,t=n(i,r)}while(Td)}if(X0.current=Up,e=cr!==null&&cr.next!==null,_u=0,yr=cr=Pi=null,Np=!1,e)throw Error(mt(300));return t}function I2(){var t=Yd!==0;return Yd=0,t}function _a(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?Pi.memoizedState=yr=t:yr=yr.next=t,yr}function Es(){if(cr===null){var t=Pi.alternate;t=t!==null?t.memoizedState:null}else t=cr.next;var e=yr===null?Pi.memoizedState:yr.next;if(e!==null)yr=e,cr=t;else{if(t===null)throw Error(mt(310));cr=t,t={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},yr===null?Pi.memoizedState=yr=t:yr=yr.next=t}return yr}function Kd(t,e){return typeof e=="function"?e(t):e}function g1(t){var e=Es(),n=e.queue;if(n===null)throw Error(mt(311));n.lastRenderedReducer=t;var i=cr,r=i.baseQueue,c=n.pending;if(c!==null){if(r!==null){var p=r.next;r.next=c.next,c.next=p}i.baseQueue=r=c,n.pending=null}if(r!==null){c=r.next,i=i.baseState;var a=p=null,T=null,k=c;do{var z=k.lane;if((_u&z)===z)T!==null&&(T=T.next={lane:0,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null}),i=k.hasEagerState?k.eagerState:t(i,k.action);else{var B={lane:z,action:k.action,hasEagerState:k.hasEagerState,eagerState:k.eagerState,next:null};T===null?(a=T=B,p=i):T=T.next=B,Pi.lanes|=z,yu|=z}k=k.next}while(k!==null&&k!==c);T===null?p=i:T.next=a,Qs(i,e.memoizedState)||(Eo=!0),e.memoizedState=i,e.baseState=p,e.baseQueue=T,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do c=r.lane,Pi.lanes|=c,yu|=c,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function _1(t){var e=Es(),n=e.queue;if(n===null)throw Error(mt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,c=e.memoizedState;if(r!==null){n.pending=null;var p=r=r.next;do c=t(c,p.action),p=p.next;while(p!==r);Qs(c,e.memoizedState)||(Eo=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),n.lastRenderedState=c}return[c,i]}function r4(){}function o4(t,e){var n=Pi,i=Es(),r=e(),c=!Qs(i.memoizedState,r);if(c&&(i.memoizedState=r,Eo=!0),i=i.queue,C2(l4.bind(null,n,i,t),[t]),i.getSnapshot!==e||c||yr!==null&&yr.memoizedState.tag&1){if(n.flags|=2048,Jd(9,a4.bind(null,n,i,r,e),void 0,null),xr===null)throw Error(mt(349));_u&30||s4(n,e,r)}return r}function s4(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Pi.updateQueue,e===null?(e={lastEffect:null,stores:null},Pi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function a4(t,e,n,i){e.value=n,e.getSnapshot=i,c4(e)&&u4(t)}function l4(t,e,n){return n(function(){c4(e)&&u4(t)})}function c4(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Qs(t,n)}catch{return!0}}function u4(t){var e=vl(t,1);e!==null&&qs(e,t,1,-1)}function g3(t){var e=_a();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kd,lastRenderedState:t},e.queue=t,t=t.dispatch=CU.bind(null,Pi,t),[e.memoizedState,t]}function Jd(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=Pi.updateQueue,e===null?(e={lastEffect:null,stores:null},Pi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function f4(){return Es().memoizedState}function Y0(t,e,n,i){var r=_a();Pi.flags|=t,r.memoizedState=Jd(1|e,n,void 0,i===void 0?null:i)}function Tm(t,e,n,i){var r=Es();i=i===void 0?null:i;var c=void 0;if(cr!==null){var p=cr.memoizedState;if(c=p.destroy,i!==null&&S2(i,p.deps)){r.memoizedState=Jd(e,n,c,i);return}}Pi.flags|=t,r.memoizedState=Jd(1|e,n,c,i)}function _3(t,e){return Y0(8390656,8,t,e)}function C2(t,e){return Tm(2048,8,t,e)}function h4(t,e){return Tm(4,2,t,e)}function d4(t,e){return Tm(4,4,t,e)}function A4(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function p4(t,e,n){return n=n!=null?n.concat([t]):null,Tm(4,4,A4.bind(null,e,t),n)}function k2(){}function m4(t,e){var n=Es();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&S2(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function g4(t,e){var n=Es();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&S2(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function _4(t,e,n){return _u&21?(Qs(n,e)||(n=x9(),Pi.lanes|=n,yu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Eo=!0),t.memoizedState=n)}function MU(t,e){var n=Jn;Jn=n!==0&&4>n?n:4,t(!0);var i=m1.transition;m1.transition={};try{t(!1),e()}finally{Jn=n,m1.transition=i}}function y4(){return Es().memoizedState}function IU(t,e,n){var i=Ac(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},v4(t))x4(e,n);else if(n=Y9(t,e,n,i),n!==null){var r=fo();qs(n,t,i,r),w4(n,e,i)}}function CU(t,e,n){var i=Ac(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(v4(t))x4(e,r);else{var c=t.alternate;if(t.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var p=e.lastRenderedState,a=c(p,n);if(r.hasEagerState=!0,r.eagerState=a,Qs(a,p)){var T=e.interleaved;T===null?(r.next=r,x2(e)):(r.next=T.next,T.next=r),e.interleaved=r;return}}catch{}finally{}n=Y9(t,e,r,i),n!==null&&(r=fo(),qs(n,t,i,r),w4(n,e,i))}}function v4(t){var e=t.alternate;return t===Pi||e!==null&&e===Pi}function x4(t,e){Td=Np=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function w4(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,a2(t,n)}}var Up={readContext:bs,useCallback:Gr,useContext:Gr,useEffect:Gr,useImperativeHandle:Gr,useInsertionEffect:Gr,useLayoutEffect:Gr,useMemo:Gr,useReducer:Gr,useRef:Gr,useState:Gr,useDebugValue:Gr,useDeferredValue:Gr,useTransition:Gr,useMutableSource:Gr,useSyncExternalStore:Gr,useId:Gr,unstable_isNewReconciler:!1},kU={readContext:bs,useCallback:function(t,e){return _a().memoizedState=[t,e===void 0?null:e],t},useContext:bs,useEffect:_3,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Y0(4194308,4,A4.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Y0(4194308,4,t,e)},useInsertionEffect:function(t,e){return Y0(4,2,t,e)},useMemo:function(t,e){var n=_a();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=_a();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=IU.bind(null,Pi,t),[i.memoizedState,t]},useRef:function(t){var e=_a();return t={current:t},e.memoizedState=t},useState:g3,useDebugValue:k2,useDeferredValue:function(t){return _a().memoizedState=t},useTransition:function(){var t=g3(!1),e=t[0];return t=MU.bind(null,t[1]),_a().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=Pi,r=_a();if(Ti){if(n===void 0)throw Error(mt(407));n=n()}else{if(n=e(),xr===null)throw Error(mt(349));_u&30||s4(i,e,n)}r.memoizedState=n;var c={value:n,getSnapshot:e};return r.queue=c,_3(l4.bind(null,i,c,t),[t]),i.flags|=2048,Jd(9,a4.bind(null,i,c,n,e),void 0,null),n},useId:function(){var t=_a(),e=xr.identifierPrefix;if(Ti){var n=dl,i=hl;n=(i&~(1<<32-Zs(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=Yd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=SU++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},PU={readContext:bs,useCallback:m4,useContext:bs,useEffect:C2,useImperativeHandle:p4,useInsertionEffect:h4,useLayoutEffect:d4,useMemo:g4,useReducer:g1,useRef:f4,useState:function(){return g1(Kd)},useDebugValue:k2,useDeferredValue:function(t){var e=Es();return _4(e,cr.memoizedState,t)},useTransition:function(){var t=g1(Kd)[0],e=Es().memoizedState;return[t,e]},useMutableSource:r4,useSyncExternalStore:o4,useId:y4,unstable_isNewReconciler:!1},LU={readContext:bs,useCallback:m4,useContext:bs,useEffect:C2,useImperativeHandle:p4,useInsertionEffect:h4,useLayoutEffect:d4,useMemo:g4,useReducer:_1,useRef:f4,useState:function(){return _1(Kd)},useDebugValue:k2,useDeferredValue:function(t){var e=Es();return cr===null?e.memoizedState=t:_4(e,cr.memoizedState,t)},useTransition:function(){var t=_1(Kd)[0],e=Es().memoizedState;return[t,e]},useMutableSource:r4,useSyncExternalStore:o4,useId:y4,unstable_isNewReconciler:!1};function fh(t,e){try{var n="",i=e;do n+=sN(i),i=i.return;while(i);var r=n}catch(c){r=`
Error generating stack: `+c.message+`
`+c.stack}return{value:t,source:e,stack:r,digest:null}}function y1(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function G_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var RU=typeof WeakMap=="function"?WeakMap:Map;function b4(t,e,n){n=Al(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){jp||(jp=!0,J_=i),G_(t,e)},n}function E4(t,e,n){n=Al(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){G_(t,e)}}var c=t.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(n.callback=function(){G_(t,e),typeof i!="function"&&(dc===null?dc=new Set([this]):dc.add(this));var p=e.stack;this.componentDidCatch(e.value,{componentStack:p!==null?p:""})}),n}function y3(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new RU;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=ZU.bind(null,t,e,n),e.then(t,t))}function v3(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function x3(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Al(-1,1),e.tag=2,hc(n,e,1))),n.lanes|=1),t)}var DU=El.ReactCurrentOwner,Eo=!1;function lo(t,e,n,i){e.child=t===null?n4(e,null,n,i):ch(e,t.child,n,i)}function w3(t,e,n,i,r){n=n.render;var c=e.ref;return Hf(e,r),i=M2(t,e,n,i,c,r),n=I2(),t!==null&&!Eo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,xl(t,e,r)):(Ti&&n&&p2(e),e.flags|=1,lo(t,e,i,r),e.child)}function b3(t,e,n,i,r){if(t===null){var c=n.type;return typeof c=="function"&&!F2(c)&&c.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=c,T4(t,e,c,i,r)):(t=tp(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(c=t.child,!(t.lanes&r)){var p=c.memoizedProps;if(n=n.compare,n=n!==null?n:$d,n(p,i)&&t.ref===e.ref)return xl(t,e,r)}return e.flags|=1,t=pc(c,i),t.ref=e.ref,t.return=e,e.child=t}function T4(t,e,n,i,r){if(t!==null){var c=t.memoizedProps;if($d(c,i)&&t.ref===e.ref)if(Eo=!1,e.pendingProps=i=c,(t.lanes&r)!==0)t.flags&131072&&(Eo=!0);else return e.lanes=t.lanes,xl(t,e,r)}return H_(t,e,n,i,r)}function S4(t,e,n){var i=e.pendingProps,r=i.children,c=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},di(zf,Ho),Ho|=n;else{if(!(n&1073741824))return t=c!==null?c.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,di(zf,Ho),Ho|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=c!==null?c.baseLanes:n,di(zf,Ho),Ho|=i}else c!==null?(i=c.baseLanes|n,e.memoizedState=null):i=n,di(zf,Ho),Ho|=i;return lo(t,e,r,n),e.child}function M4(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function H_(t,e,n,i,r){var c=Mo(n)?mu:qr.current;return c=ah(e,c),Hf(e,r),n=M2(t,e,n,i,c,r),i=I2(),t!==null&&!Eo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,xl(t,e,r)):(Ti&&i&&p2(e),e.flags|=1,lo(t,e,n,r),e.child)}function E3(t,e,n,i,r){if(Mo(n)){var c=!0;Lp(e)}else c=!1;if(Hf(e,r),e.stateNode===null)K0(t,e),e4(e,n,i),j_(e,n,i,r),i=!0;else if(t===null){var p=e.stateNode,a=e.memoizedProps;p.props=a;var T=p.context,k=n.contextType;typeof k=="object"&&k!==null?k=bs(k):(k=Mo(n)?mu:qr.current,k=ah(e,k));var z=n.getDerivedStateFromProps,B=typeof z=="function"||typeof p.getSnapshotBeforeUpdate=="function";B||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(a!==i||T!==k)&&p3(e,p,i,k),Kl=!1;var D=e.memoizedState;p.state=D,Op(e,i,p,r),T=e.memoizedState,a!==i||D!==T||So.current||Kl?(typeof z=="function"&&(V_(e,n,z,i),T=e.memoizedState),(a=Kl||A3(e,n,a,i,D,T,k))?(B||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(e.flags|=4194308)):(typeof p.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=T),p.props=i,p.state=T,p.context=k,i=a):(typeof p.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{p=e.stateNode,K9(t,e),a=e.memoizedProps,k=e.type===e.elementType?a:Vs(e.type,a),p.props=k,B=e.pendingProps,D=p.context,T=n.contextType,typeof T=="object"&&T!==null?T=bs(T):(T=Mo(n)?mu:qr.current,T=ah(e,T));var K=n.getDerivedStateFromProps;(z=typeof K=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(a!==B||D!==T)&&p3(e,p,i,T),Kl=!1,D=e.memoizedState,p.state=D,Op(e,i,p,r);var ee=e.memoizedState;a!==B||D!==ee||So.current||Kl?(typeof K=="function"&&(V_(e,n,K,i),ee=e.memoizedState),(k=Kl||A3(e,n,k,i,D,ee,T)||!1)?(z||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(i,ee,T),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(i,ee,T)),typeof p.componentDidUpdate=="function"&&(e.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof p.componentDidUpdate!="function"||a===t.memoizedProps&&D===t.memoizedState||(e.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&D===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=ee),p.props=i,p.state=ee,p.context=T,i=k):(typeof p.componentDidUpdate!="function"||a===t.memoizedProps&&D===t.memoizedState||(e.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&D===t.memoizedState||(e.flags|=1024),i=!1)}return $_(t,e,n,i,c,r)}function $_(t,e,n,i,r,c){M4(t,e);var p=(e.flags&128)!==0;if(!i&&!p)return r&&c3(e,n,!1),xl(t,e,c);i=e.stateNode,DU.current=e;var a=p&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&p?(e.child=ch(e,t.child,null,c),e.child=ch(e,null,a,c)):lo(t,e,a,c),e.memoizedState=i.state,r&&c3(e,n,!0),e.child}function I4(t){var e=t.stateNode;e.pendingContext?l3(t,e.pendingContext,e.pendingContext!==e.context):e.context&&l3(t,e.context,!1),b2(t,e.containerInfo)}function T3(t,e,n,i,r){return lh(),g2(r),e.flags|=256,lo(t,e,n,i),e.child}var W_={dehydrated:null,treeContext:null,retryLane:0};function Z_(t){return{baseLanes:t,cachePool:null,transitions:null}}function C4(t,e,n){var i=e.pendingProps,r=Ci.current,c=!1,p=(e.flags&128)!==0,a;if((a=p)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(c=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),di(Ci,r&1),t===null)return N_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(p=i.children,t=i.fallback,c?(i=e.mode,c=e.child,p={mode:"hidden",children:p},!(i&1)&&c!==null?(c.childLanes=0,c.pendingProps=p):c=Im(p,i,0,null),t=fu(t,i,n,null),c.return=e,t.return=e,c.sibling=t,e.child=c,e.child.memoizedState=Z_(n),e.memoizedState=W_,t):P2(e,p));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return zU(t,e,p,i,a,r,n);if(c){c=i.fallback,p=e.mode,r=t.child,a=r.sibling;var T={mode:"hidden",children:i.children};return!(p&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=T,e.deletions=null):(i=pc(r,T),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?c=pc(a,c):(c=fu(c,p,n,null),c.flags|=2),c.return=e,i.return=e,i.sibling=c,e.child=i,i=c,c=e.child,p=t.child.memoizedState,p=p===null?Z_(n):{baseLanes:p.baseLanes|n,cachePool:null,transitions:p.transitions},c.memoizedState=p,c.childLanes=t.childLanes&~n,e.memoizedState=W_,i}return c=t.child,t=c.sibling,i=pc(c,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function P2(t,e){return e=Im({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function T0(t,e,n,i){return i!==null&&g2(i),ch(e,t.child,null,n),t=P2(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function zU(t,e,n,i,r,c,p){if(n)return e.flags&256?(e.flags&=-257,i=y1(Error(mt(422))),T0(t,e,p,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(c=i.fallback,r=e.mode,i=Im({mode:"visible",children:i.children},r,0,null),c=fu(c,r,p,null),c.flags|=2,i.return=e,c.return=e,i.sibling=c,e.child=i,e.mode&1&&ch(e,t.child,null,p),e.child.memoizedState=Z_(p),e.memoizedState=W_,c);if(!(e.mode&1))return T0(t,e,p,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,c=Error(mt(419)),i=y1(c,i,void 0),T0(t,e,p,i)}if(a=(p&t.childLanes)!==0,Eo||a){if(i=xr,i!==null){switch(p&-p){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|p)?0:r,r!==0&&r!==c.retryLane&&(c.retryLane=r,vl(t,r),qs(i,t,r,-1))}return O2(),i=y1(Error(mt(421))),T0(t,e,p,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=qU.bind(null,t),r._reactRetry=e,null):(t=c.treeContext,qo=fc(r.nextSibling),Yo=e,Ti=!0,Gs=null,t!==null&&(gs[_s++]=hl,gs[_s++]=dl,gs[_s++]=gu,hl=t.id,dl=t.overflow,gu=e),e=P2(e,i.children),e.flags|=4096,e)}function S3(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),U_(t.return,e,n)}function v1(t,e,n,i,r){var c=t.memoizedState;c===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=i,c.tail=n,c.tailMode=r)}function k4(t,e,n){var i=e.pendingProps,r=i.revealOrder,c=i.tail;if(lo(t,e,i.children,n),i=Ci.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&S3(t,n,e);else if(t.tag===19)S3(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(di(Ci,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Fp(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),v1(e,!1,r,n,c);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Fp(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}v1(e,!0,n,null,c);break;case"together":v1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function K0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),yu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(mt(153));if(e.child!==null){for(t=e.child,n=pc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=pc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function BU(t,e,n){switch(e.tag){case 3:I4(e),lh();break;case 5:i4(e);break;case 1:Mo(e.type)&&Lp(e);break;case 4:b2(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;di(zp,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(di(Ci,Ci.current&1),e.flags|=128,null):n&e.child.childLanes?C4(t,e,n):(di(Ci,Ci.current&1),t=xl(t,e,n),t!==null?t.sibling:null);di(Ci,Ci.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return k4(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),di(Ci,Ci.current),i)break;return null;case 22:case 23:return e.lanes=0,S4(t,e,n)}return xl(t,e,n)}var P4,q_,L4,R4;P4=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};q_=function(){};L4=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,au(Ta.current);var c=null;switch(n){case"input":r=m_(t,r),i=m_(t,i),c=[];break;case"select":r=Li({},r,{value:void 0}),i=Li({},i,{value:void 0}),c=[];break;case"textarea":r=y_(t,r),i=y_(t,i),c=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=kp)}x_(n,i);var p;n=null;for(k in r)if(!i.hasOwnProperty(k)&&r.hasOwnProperty(k)&&r[k]!=null)if(k==="style"){var a=r[k];for(p in a)a.hasOwnProperty(p)&&(n||(n={}),n[p]="")}else k!=="dangerouslySetInnerHTML"&&k!=="children"&&k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(Fd.hasOwnProperty(k)?c||(c=[]):(c=c||[]).push(k,null));for(k in i){var T=i[k];if(a=r!=null?r[k]:void 0,i.hasOwnProperty(k)&&T!==a&&(T!=null||a!=null))if(k==="style")if(a){for(p in a)!a.hasOwnProperty(p)||T&&T.hasOwnProperty(p)||(n||(n={}),n[p]="");for(p in T)T.hasOwnProperty(p)&&a[p]!==T[p]&&(n||(n={}),n[p]=T[p])}else n||(c||(c=[]),c.push(k,n)),n=T;else k==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,a=a?a.__html:void 0,T!=null&&a!==T&&(c=c||[]).push(k,T)):k==="children"?typeof T!="string"&&typeof T!="number"||(c=c||[]).push(k,""+T):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&(Fd.hasOwnProperty(k)?(T!=null&&k==="onScroll"&&yi("scroll",t),c||a===T||(c=[])):(c=c||[]).push(k,T))}n&&(c=c||[]).push("style",n);var k=c;(e.updateQueue=k)&&(e.flags|=4)}};R4=function(t,e,n,i){n!==i&&(e.flags|=4)};function rd(t,e){if(!Ti)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Hr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function OU(t,e,n){var i=e.pendingProps;switch(m2(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(e),null;case 1:return Mo(e.type)&&Pp(),Hr(e),null;case 3:return i=e.stateNode,uh(),vi(So),vi(qr),T2(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(b0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gs!==null&&(ny(Gs),Gs=null))),q_(t,e),Hr(e),null;case 5:E2(e);var r=au(Xd.current);if(n=e.type,t!==null&&e.stateNode!=null)L4(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(mt(166));return Hr(e),null}if(t=au(Ta.current),b0(e)){i=e.stateNode,n=e.type;var c=e.memoizedProps;switch(i[va]=e,i[qd]=c,t=(e.mode&1)!==0,n){case"dialog":yi("cancel",i),yi("close",i);break;case"iframe":case"object":case"embed":yi("load",i);break;case"video":case"audio":for(r=0;r<Ad.length;r++)yi(Ad[r],i);break;case"source":yi("error",i);break;case"img":case"image":case"link":yi("error",i),yi("load",i);break;case"details":yi("toggle",i);break;case"input":zb(i,c),yi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!c.multiple},yi("invalid",i);break;case"textarea":Ob(i,c),yi("invalid",i)}x_(n,c),r=null;for(var p in c)if(c.hasOwnProperty(p)){var a=c[p];p==="children"?typeof a=="string"?i.textContent!==a&&(c.suppressHydrationWarning!==!0&&w0(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(c.suppressHydrationWarning!==!0&&w0(i.textContent,a,t),r=["children",""+a]):Fd.hasOwnProperty(p)&&a!=null&&p==="onScroll"&&yi("scroll",i)}switch(n){case"input":A0(i),Bb(i,c,!0);break;case"textarea":A0(i),Fb(i);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(i.onclick=kp)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{p=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=s9(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=p.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=p.createElement(n,{is:i.is}):(t=p.createElement(n),n==="select"&&(p=t,i.multiple?p.multiple=!0:i.size&&(p.size=i.size))):t=p.createElementNS(t,n),t[va]=e,t[qd]=i,P4(t,e,!1,!1),e.stateNode=t;e:{switch(p=w_(n,i),n){case"dialog":yi("cancel",t),yi("close",t),r=i;break;case"iframe":case"object":case"embed":yi("load",t),r=i;break;case"video":case"audio":for(r=0;r<Ad.length;r++)yi(Ad[r],t);r=i;break;case"source":yi("error",t),r=i;break;case"img":case"image":case"link":yi("error",t),yi("load",t),r=i;break;case"details":yi("toggle",t),r=i;break;case"input":zb(t,i),r=m_(t,i),yi("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=Li({},i,{value:void 0}),yi("invalid",t);break;case"textarea":Ob(t,i),r=y_(t,i),yi("invalid",t);break;default:r=i}x_(n,r),a=r;for(c in a)if(a.hasOwnProperty(c)){var T=a[c];c==="style"?c9(t,T):c==="dangerouslySetInnerHTML"?(T=T?T.__html:void 0,T!=null&&a9(t,T)):c==="children"?typeof T=="string"?(n!=="textarea"||T!=="")&&Nd(t,T):typeof T=="number"&&Nd(t,""+T):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Fd.hasOwnProperty(c)?T!=null&&c==="onScroll"&&yi("scroll",t):T!=null&&t2(t,c,T,p))}switch(n){case"input":A0(t),Bb(t,i,!1);break;case"textarea":A0(t),Fb(t);break;case"option":i.value!=null&&t.setAttribute("value",""+gc(i.value));break;case"select":t.multiple=!!i.multiple,c=i.value,c!=null?Uf(t,!!i.multiple,c,!1):i.defaultValue!=null&&Uf(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=kp)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Hr(e),null;case 6:if(t&&e.stateNode!=null)R4(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(mt(166));if(n=au(Xd.current),au(Ta.current),b0(e)){if(i=e.stateNode,n=e.memoizedProps,i[va]=e,(c=i.nodeValue!==n)&&(t=Yo,t!==null))switch(t.tag){case 3:w0(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&w0(i.nodeValue,n,(t.mode&1)!==0)}c&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[va]=e,e.stateNode=i}return Hr(e),null;case 13:if(vi(Ci),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ti&&qo!==null&&e.mode&1&&!(e.flags&128))X9(),lh(),e.flags|=98560,c=!1;else if(c=b0(e),i!==null&&i.dehydrated!==null){if(t===null){if(!c)throw Error(mt(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(mt(317));c[va]=e}else lh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Hr(e),c=!1}else Gs!==null&&(ny(Gs),Gs=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Ci.current&1?ur===0&&(ur=3):O2())),e.updateQueue!==null&&(e.flags|=4),Hr(e),null);case 4:return uh(),q_(t,e),t===null&&Wd(e.stateNode.containerInfo),Hr(e),null;case 10:return v2(e.type._context),Hr(e),null;case 17:return Mo(e.type)&&Pp(),Hr(e),null;case 19:if(vi(Ci),c=e.memoizedState,c===null)return Hr(e),null;if(i=(e.flags&128)!==0,p=c.rendering,p===null)if(i)rd(c,!1);else{if(ur!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(p=Fp(t),p!==null){for(e.flags|=128,rd(c,!1),i=p.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)c=n,t=i,c.flags&=14680066,p=c.alternate,p===null?(c.childLanes=0,c.lanes=t,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=p.childLanes,c.lanes=p.lanes,c.child=p.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=p.memoizedProps,c.memoizedState=p.memoizedState,c.updateQueue=p.updateQueue,c.type=p.type,t=p.dependencies,c.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return di(Ci,Ci.current&1|2),e.child}t=t.sibling}c.tail!==null&&Qi()>hh&&(e.flags|=128,i=!0,rd(c,!1),e.lanes=4194304)}else{if(!i)if(t=Fp(p),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),rd(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!Ti)return Hr(e),null}else 2*Qi()-c.renderingStartTime>hh&&n!==1073741824&&(e.flags|=128,i=!0,rd(c,!1),e.lanes=4194304);c.isBackwards?(p.sibling=e.child,e.child=p):(n=c.last,n!==null?n.sibling=p:e.child=p,c.last=p)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=Qi(),e.sibling=null,n=Ci.current,di(Ci,i?n&1|2:n&1),e):(Hr(e),null);case 22:case 23:return B2(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Ho&1073741824&&(Hr(e),e.subtreeFlags&6&&(e.flags|=8192)):Hr(e),null;case 24:return null;case 25:return null}throw Error(mt(156,e.tag))}function FU(t,e){switch(m2(e),e.tag){case 1:return Mo(e.type)&&Pp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return uh(),vi(So),vi(qr),T2(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return E2(e),null;case 13:if(vi(Ci),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(mt(340));lh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return vi(Ci),null;case 4:return uh(),null;case 10:return v2(e.type._context),null;case 22:case 23:return B2(),null;case 24:return null;default:return null}}var S0=!1,Zr=!1,NU=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function Df(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){ji(t,e,i)}else n.current=null}function Q_(t,e,n){try{n()}catch(i){ji(t,e,i)}}var M3=!1;function UU(t,e){if(L_=Mp,t=O9(),A2(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,c=i.focusNode;i=i.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var p=0,a=-1,T=-1,k=0,z=0,B=t,D=null;t:for(;;){for(var K;B!==n||r!==0&&B.nodeType!==3||(a=p+r),B!==c||i!==0&&B.nodeType!==3||(T=p+i),B.nodeType===3&&(p+=B.nodeValue.length),(K=B.firstChild)!==null;)D=B,B=K;for(;;){if(B===t)break t;if(D===n&&++k===r&&(a=p),D===c&&++z===i&&(T=p),(K=B.nextSibling)!==null)break;B=D,D=B.parentNode}B=K}n=a===-1||T===-1?null:{start:a,end:T}}else n=null}n=n||{start:0,end:0}}else n=null;for(R_={focusedElem:t,selectionRange:n},Mp=!1,Zt=e;Zt!==null;)if(e=Zt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Zt=t;else for(;Zt!==null;){e=Zt;try{var ee=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(ee!==null){var le=ee.memoizedProps,Ce=ee.memoizedState,se=e.stateNode,ne=se.getSnapshotBeforeUpdate(e.elementType===e.type?le:Vs(e.type,le),Ce);se.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:var te=e.stateNode.containerInfo;te.nodeType===1?te.textContent="":te.nodeType===9&&te.documentElement&&te.removeChild(te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(mt(163))}}catch(xe){ji(e,e.return,xe)}if(t=e.sibling,t!==null){t.return=e.return,Zt=t;break}Zt=e.return}return ee=M3,M3=!1,ee}function Sd(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var c=r.destroy;r.destroy=void 0,c!==void 0&&Q_(e,n,c)}r=r.next}while(r!==i)}}function Sm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function X_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function D4(t){var e=t.alternate;e!==null&&(t.alternate=null,D4(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[va],delete e[qd],delete e[B_],delete e[wU],delete e[bU])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function z4(t){return t.tag===5||t.tag===3||t.tag===4}function I3(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||z4(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Y_(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=kp));else if(i!==4&&(t=t.child,t!==null))for(Y_(t,e,n),t=t.sibling;t!==null;)Y_(t,e,n),t=t.sibling}function K_(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(K_(t,e,n),t=t.sibling;t!==null;)K_(t,e,n),t=t.sibling}var kr=null,js=!1;function Xl(t,e,n){for(n=n.child;n!==null;)B4(t,e,n),n=n.sibling}function B4(t,e,n){if(Ea&&typeof Ea.onCommitFiberUnmount=="function")try{Ea.onCommitFiberUnmount(_m,n)}catch{}switch(n.tag){case 5:Zr||Df(n,e);case 6:var i=kr,r=js;kr=null,Xl(t,e,n),kr=i,js=r,kr!==null&&(js?(t=kr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):kr.removeChild(n.stateNode));break;case 18:kr!==null&&(js?(t=kr,n=n.stateNode,t.nodeType===8?d1(t.parentNode,n):t.nodeType===1&&d1(t,n),Gd(t)):d1(kr,n.stateNode));break;case 4:i=kr,r=js,kr=n.stateNode.containerInfo,js=!0,Xl(t,e,n),kr=i,js=r;break;case 0:case 11:case 14:case 15:if(!Zr&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var c=r,p=c.destroy;c=c.tag,p!==void 0&&(c&2||c&4)&&Q_(n,e,p),r=r.next}while(r!==i)}Xl(t,e,n);break;case 1:if(!Zr&&(Df(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){ji(n,e,a)}Xl(t,e,n);break;case 21:Xl(t,e,n);break;case 22:n.mode&1?(Zr=(i=Zr)||n.memoizedState!==null,Xl(t,e,n),Zr=i):Xl(t,e,n);break;default:Xl(t,e,n)}}function C3(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new NU),e.forEach(function(i){var r=QU.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Us(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var c=t,p=e,a=p;e:for(;a!==null;){switch(a.tag){case 5:kr=a.stateNode,js=!1;break e;case 3:kr=a.stateNode.containerInfo,js=!0;break e;case 4:kr=a.stateNode.containerInfo,js=!0;break e}a=a.return}if(kr===null)throw Error(mt(160));B4(c,p,r),kr=null,js=!1;var T=r.alternate;T!==null&&(T.return=null),r.return=null}catch(k){ji(r,e,k)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)O4(e,t),e=e.sibling}function O4(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Us(e,t),ga(t),i&4){try{Sd(3,t,t.return),Sm(3,t)}catch(le){ji(t,t.return,le)}try{Sd(5,t,t.return)}catch(le){ji(t,t.return,le)}}break;case 1:Us(e,t),ga(t),i&512&&n!==null&&Df(n,n.return);break;case 5:if(Us(e,t),ga(t),i&512&&n!==null&&Df(n,n.return),t.flags&32){var r=t.stateNode;try{Nd(r,"")}catch(le){ji(t,t.return,le)}}if(i&4&&(r=t.stateNode,r!=null)){var c=t.memoizedProps,p=n!==null?n.memoizedProps:c,a=t.type,T=t.updateQueue;if(t.updateQueue=null,T!==null)try{a==="input"&&c.type==="radio"&&c.name!=null&&r9(r,c),w_(a,p);var k=w_(a,c);for(p=0;p<T.length;p+=2){var z=T[p],B=T[p+1];z==="style"?c9(r,B):z==="dangerouslySetInnerHTML"?a9(r,B):z==="children"?Nd(r,B):t2(r,z,B,k)}switch(a){case"input":g_(r,c);break;case"textarea":o9(r,c);break;case"select":var D=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!c.multiple;var K=c.value;K!=null?Uf(r,!!c.multiple,K,!1):D!==!!c.multiple&&(c.defaultValue!=null?Uf(r,!!c.multiple,c.defaultValue,!0):Uf(r,!!c.multiple,c.multiple?[]:"",!1))}r[qd]=c}catch(le){ji(t,t.return,le)}}break;case 6:if(Us(e,t),ga(t),i&4){if(t.stateNode===null)throw Error(mt(162));r=t.stateNode,c=t.memoizedProps;try{r.nodeValue=c}catch(le){ji(t,t.return,le)}}break;case 3:if(Us(e,t),ga(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Gd(e.containerInfo)}catch(le){ji(t,t.return,le)}break;case 4:Us(e,t),ga(t);break;case 13:Us(e,t),ga(t),r=t.child,r.flags&8192&&(c=r.memoizedState!==null,r.stateNode.isHidden=c,!c||r.alternate!==null&&r.alternate.memoizedState!==null||(D2=Qi())),i&4&&C3(t);break;case 22:if(z=n!==null&&n.memoizedState!==null,t.mode&1?(Zr=(k=Zr)||z,Us(e,t),Zr=k):Us(e,t),ga(t),i&8192){if(k=t.memoizedState!==null,(t.stateNode.isHidden=k)&&!z&&t.mode&1)for(Zt=t,z=t.child;z!==null;){for(B=Zt=z;Zt!==null;){switch(D=Zt,K=D.child,D.tag){case 0:case 11:case 14:case 15:Sd(4,D,D.return);break;case 1:Df(D,D.return);var ee=D.stateNode;if(typeof ee.componentWillUnmount=="function"){i=D,n=D.return;try{e=i,ee.props=e.memoizedProps,ee.state=e.memoizedState,ee.componentWillUnmount()}catch(le){ji(i,n,le)}}break;case 5:Df(D,D.return);break;case 22:if(D.memoizedState!==null){P3(B);continue}}K!==null?(K.return=D,Zt=K):P3(B)}z=z.sibling}e:for(z=null,B=t;;){if(B.tag===5){if(z===null){z=B;try{r=B.stateNode,k?(c=r.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(a=B.stateNode,T=B.memoizedProps.style,p=T!=null&&T.hasOwnProperty("display")?T.display:null,a.style.display=l9("display",p))}catch(le){ji(t,t.return,le)}}}else if(B.tag===6){if(z===null)try{B.stateNode.nodeValue=k?"":B.memoizedProps}catch(le){ji(t,t.return,le)}}else if((B.tag!==22&&B.tag!==23||B.memoizedState===null||B===t)&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===t)break e;for(;B.sibling===null;){if(B.return===null||B.return===t)break e;z===B&&(z=null),B=B.return}z===B&&(z=null),B.sibling.return=B.return,B=B.sibling}}break;case 19:Us(e,t),ga(t),i&4&&C3(t);break;case 21:break;default:Us(e,t),ga(t)}}function ga(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(z4(n)){var i=n;break e}n=n.return}throw Error(mt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Nd(r,""),i.flags&=-33);var c=I3(t);K_(t,c,r);break;case 3:case 4:var p=i.stateNode.containerInfo,a=I3(t);Y_(t,a,p);break;default:throw Error(mt(161))}}catch(T){ji(t,t.return,T)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function VU(t,e,n){Zt=t,F4(t)}function F4(t,e,n){for(var i=(t.mode&1)!==0;Zt!==null;){var r=Zt,c=r.child;if(r.tag===22&&i){var p=r.memoizedState!==null||S0;if(!p){var a=r.alternate,T=a!==null&&a.memoizedState!==null||Zr;a=S0;var k=Zr;if(S0=p,(Zr=T)&&!k)for(Zt=r;Zt!==null;)p=Zt,T=p.child,p.tag===22&&p.memoizedState!==null?L3(r):T!==null?(T.return=p,Zt=T):L3(r);for(;c!==null;)Zt=c,F4(c),c=c.sibling;Zt=r,S0=a,Zr=k}k3(t)}else r.subtreeFlags&8772&&c!==null?(c.return=r,Zt=c):k3(t)}}function k3(t){for(;Zt!==null;){var e=Zt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Zr||Sm(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Zr)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Vs(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&d3(e,c,i);break;case 3:var p=e.updateQueue;if(p!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}d3(e,p,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var T=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":T.autoFocus&&n.focus();break;case"img":T.src&&(n.src=T.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var k=e.alternate;if(k!==null){var z=k.memoizedState;if(z!==null){var B=z.dehydrated;B!==null&&Gd(B)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(mt(163))}Zr||e.flags&512&&X_(e)}catch(D){ji(e,e.return,D)}}if(e===t){Zt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Zt=n;break}Zt=e.return}}function P3(t){for(;Zt!==null;){var e=Zt;if(e===t){Zt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Zt=n;break}Zt=e.return}}function L3(t){for(;Zt!==null;){var e=Zt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Sm(4,e)}catch(T){ji(e,n,T)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(T){ji(e,r,T)}}var c=e.return;try{X_(e)}catch(T){ji(e,c,T)}break;case 5:var p=e.return;try{X_(e)}catch(T){ji(e,p,T)}}}catch(T){ji(e,e.return,T)}if(e===t){Zt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Zt=a;break}Zt=e.return}}var jU=Math.ceil,Vp=El.ReactCurrentDispatcher,L2=El.ReactCurrentOwner,xs=El.ReactCurrentBatchConfig,Wn=0,xr=null,nr=null,Pr=0,Ho=0,zf=vc(0),ur=0,eA=null,yu=0,Mm=0,R2=0,Md=null,bo=null,D2=0,hh=1/0,ll=null,jp=!1,J_=null,dc=null,M0=!1,oc=null,Gp=0,Id=0,ey=null,J0=-1,ep=0;function fo(){return Wn&6?Qi():J0!==-1?J0:J0=Qi()}function Ac(t){return t.mode&1?Wn&2&&Pr!==0?Pr&-Pr:TU.transition!==null?(ep===0&&(ep=x9()),ep):(t=Jn,t!==0||(t=window.event,t=t===void 0?16:I9(t.type)),t):1}function qs(t,e,n,i){if(50<Id)throw Id=0,ey=null,Error(mt(185));vA(t,n,i),(!(Wn&2)||t!==xr)&&(t===xr&&(!(Wn&2)&&(Mm|=n),ur===4&&ec(t,Pr)),Io(t,i),n===1&&Wn===0&&!(e.mode&1)&&(hh=Qi()+500,bm&&xc()))}function Io(t,e){var n=t.callbackNode;TN(t,e);var i=Sp(t,t===xr?Pr:0);if(i===0)n!==null&&Vb(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&Vb(n),e===1)t.tag===0?EU(R3.bind(null,t)):Z9(R3.bind(null,t)),vU(function(){!(Wn&6)&&xc()}),n=null;else{switch(w9(i)){case 1:n=s2;break;case 4:n=y9;break;case 16:n=Tp;break;case 536870912:n=v9;break;default:n=Tp}n=W4(n,N4.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function N4(t,e){if(J0=-1,ep=0,Wn&6)throw Error(mt(327));var n=t.callbackNode;if($f()&&t.callbackNode!==n)return null;var i=Sp(t,t===xr?Pr:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Hp(t,i);else{e=i;var r=Wn;Wn|=2;var c=V4();(xr!==t||Pr!==e)&&(ll=null,hh=Qi()+500,uu(t,e));do try{$U();break}catch(a){U4(t,a)}while(1);y2(),Vp.current=c,Wn=r,nr!==null?e=0:(xr=null,Pr=0,e=ur)}if(e!==0){if(e===2&&(r=M_(t),r!==0&&(i=r,e=ty(t,r))),e===1)throw n=eA,uu(t,0),ec(t,i),Io(t,Qi()),n;if(e===6)ec(t,i);else{if(r=t.current.alternate,!(i&30)&&!GU(r)&&(e=Hp(t,i),e===2&&(c=M_(t),c!==0&&(i=c,e=ty(t,c))),e===1))throw n=eA,uu(t,0),ec(t,i),Io(t,Qi()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(mt(345));case 2:nu(t,bo,ll);break;case 3:if(ec(t,i),(i&130023424)===i&&(e=D2+500-Qi(),10<e)){if(Sp(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){fo(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=z_(nu.bind(null,t,bo,ll),e);break}nu(t,bo,ll);break;case 4:if(ec(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var p=31-Zs(i);c=1<<p,p=e[p],p>r&&(r=p),i&=~c}if(i=r,i=Qi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*jU(i/1960))-i,10<i){t.timeoutHandle=z_(nu.bind(null,t,bo,ll),i);break}nu(t,bo,ll);break;case 5:nu(t,bo,ll);break;default:throw Error(mt(329))}}}return Io(t,Qi()),t.callbackNode===n?N4.bind(null,t):null}function ty(t,e){var n=Md;return t.current.memoizedState.isDehydrated&&(uu(t,e).flags|=256),t=Hp(t,e),t!==2&&(e=bo,bo=n,e!==null&&ny(e)),t}function ny(t){bo===null?bo=t:bo.push.apply(bo,t)}function GU(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],c=r.getSnapshot;r=r.value;try{if(!Qs(c(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ec(t,e){for(e&=~R2,e&=~Mm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Zs(e),i=1<<n;t[n]=-1,e&=~i}}function R3(t){if(Wn&6)throw Error(mt(327));$f();var e=Sp(t,0);if(!(e&1))return Io(t,Qi()),null;var n=Hp(t,e);if(t.tag!==0&&n===2){var i=M_(t);i!==0&&(e=i,n=ty(t,i))}if(n===1)throw n=eA,uu(t,0),ec(t,e),Io(t,Qi()),n;if(n===6)throw Error(mt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,nu(t,bo,ll),Io(t,Qi()),null}function z2(t,e){var n=Wn;Wn|=1;try{return t(e)}finally{Wn=n,Wn===0&&(hh=Qi()+500,bm&&xc())}}function vu(t){oc!==null&&oc.tag===0&&!(Wn&6)&&$f();var e=Wn;Wn|=1;var n=xs.transition,i=Jn;try{if(xs.transition=null,Jn=1,t)return t()}finally{Jn=i,xs.transition=n,Wn=e,!(Wn&6)&&xc()}}function B2(){Ho=zf.current,vi(zf)}function uu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,yU(n)),nr!==null)for(n=nr.return;n!==null;){var i=n;switch(m2(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Pp();break;case 3:uh(),vi(So),vi(qr),T2();break;case 5:E2(i);break;case 4:uh();break;case 13:vi(Ci);break;case 19:vi(Ci);break;case 10:v2(i.type._context);break;case 22:case 23:B2()}n=n.return}if(xr=t,nr=t=pc(t.current,null),Pr=Ho=e,ur=0,eA=null,R2=Mm=yu=0,bo=Md=null,su!==null){for(e=0;e<su.length;e++)if(n=su[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,c=n.pending;if(c!==null){var p=c.next;c.next=r,i.next=p}n.pending=i}su=null}return t}function U4(t,e){do{var n=nr;try{if(y2(),X0.current=Up,Np){for(var i=Pi.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Np=!1}if(_u=0,yr=cr=Pi=null,Td=!1,Yd=0,L2.current=null,n===null||n.return===null){ur=1,eA=e,nr=null;break}e:{var c=t,p=n.return,a=n,T=e;if(e=Pr,a.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){var k=T,z=a,B=z.tag;if(!(z.mode&1)&&(B===0||B===11||B===15)){var D=z.alternate;D?(z.updateQueue=D.updateQueue,z.memoizedState=D.memoizedState,z.lanes=D.lanes):(z.updateQueue=null,z.memoizedState=null)}var K=v3(p);if(K!==null){K.flags&=-257,x3(K,p,a,c,e),K.mode&1&&y3(c,k,e),e=K,T=k;var ee=e.updateQueue;if(ee===null){var le=new Set;le.add(T),e.updateQueue=le}else ee.add(T);break e}else{if(!(e&1)){y3(c,k,e),O2();break e}T=Error(mt(426))}}else if(Ti&&a.mode&1){var Ce=v3(p);if(Ce!==null){!(Ce.flags&65536)&&(Ce.flags|=256),x3(Ce,p,a,c,e),g2(fh(T,a));break e}}c=T=fh(T,a),ur!==4&&(ur=2),Md===null?Md=[c]:Md.push(c),c=p;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var se=b4(c,T,e);h3(c,se);break e;case 1:a=T;var ne=c.type,te=c.stateNode;if(!(c.flags&128)&&(typeof ne.getDerivedStateFromError=="function"||te!==null&&typeof te.componentDidCatch=="function"&&(dc===null||!dc.has(te)))){c.flags|=65536,e&=-e,c.lanes|=e;var xe=E4(c,a,e);h3(c,xe);break e}}c=c.return}while(c!==null)}G4(n)}catch(Le){e=Le,nr===n&&n!==null&&(nr=n=n.return);continue}break}while(1)}function V4(){var t=Vp.current;return Vp.current=Up,t===null?Up:t}function O2(){(ur===0||ur===3||ur===2)&&(ur=4),xr===null||!(yu&268435455)&&!(Mm&268435455)||ec(xr,Pr)}function Hp(t,e){var n=Wn;Wn|=2;var i=V4();(xr!==t||Pr!==e)&&(ll=null,uu(t,e));do try{HU();break}catch(r){U4(t,r)}while(1);if(y2(),Wn=n,Vp.current=i,nr!==null)throw Error(mt(261));return xr=null,Pr=0,ur}function HU(){for(;nr!==null;)j4(nr)}function $U(){for(;nr!==null&&!mN();)j4(nr)}function j4(t){var e=$4(t.alternate,t,Ho);t.memoizedProps=t.pendingProps,e===null?G4(t):nr=e,L2.current=null}function G4(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=FU(n,e),n!==null){n.flags&=32767,nr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ur=6,nr=null;return}}else if(n=OU(n,e,Ho),n!==null){nr=n;return}if(e=e.sibling,e!==null){nr=e;return}nr=e=t}while(e!==null);ur===0&&(ur=5)}function nu(t,e,n){var i=Jn,r=xs.transition;try{xs.transition=null,Jn=1,WU(t,e,n,i)}finally{xs.transition=r,Jn=i}return null}function WU(t,e,n,i){do $f();while(oc!==null);if(Wn&6)throw Error(mt(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(mt(177));t.callbackNode=null,t.callbackPriority=0;var c=n.lanes|n.childLanes;if(SN(t,c),t===xr&&(nr=xr=null,Pr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||M0||(M0=!0,W4(Tp,function(){return $f(),null})),c=(n.flags&15990)!==0,n.subtreeFlags&15990||c){c=xs.transition,xs.transition=null;var p=Jn;Jn=1;var a=Wn;Wn|=4,L2.current=null,UU(t,n),O4(n,t),hU(R_),Mp=!!L_,R_=L_=null,t.current=n,VU(n),gN(),Wn=a,Jn=p,xs.transition=c}else t.current=n;if(M0&&(M0=!1,oc=t,Gp=r),c=t.pendingLanes,c===0&&(dc=null),vN(n.stateNode),Io(t,Qi()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(jp)throw jp=!1,t=J_,J_=null,t;return Gp&1&&t.tag!==0&&$f(),c=t.pendingLanes,c&1?t===ey?Id++:(Id=0,ey=t):Id=0,xc(),null}function $f(){if(oc!==null){var t=w9(Gp),e=xs.transition,n=Jn;try{if(xs.transition=null,Jn=16>t?16:t,oc===null)var i=!1;else{if(t=oc,oc=null,Gp=0,Wn&6)throw Error(mt(331));var r=Wn;for(Wn|=4,Zt=t.current;Zt!==null;){var c=Zt,p=c.child;if(Zt.flags&16){var a=c.deletions;if(a!==null){for(var T=0;T<a.length;T++){var k=a[T];for(Zt=k;Zt!==null;){var z=Zt;switch(z.tag){case 0:case 11:case 15:Sd(8,z,c)}var B=z.child;if(B!==null)B.return=z,Zt=B;else for(;Zt!==null;){z=Zt;var D=z.sibling,K=z.return;if(D4(z),z===k){Zt=null;break}if(D!==null){D.return=K,Zt=D;break}Zt=K}}}var ee=c.alternate;if(ee!==null){var le=ee.child;if(le!==null){ee.child=null;do{var Ce=le.sibling;le.sibling=null,le=Ce}while(le!==null)}}Zt=c}}if(c.subtreeFlags&2064&&p!==null)p.return=c,Zt=p;else e:for(;Zt!==null;){if(c=Zt,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Sd(9,c,c.return)}var se=c.sibling;if(se!==null){se.return=c.return,Zt=se;break e}Zt=c.return}}var ne=t.current;for(Zt=ne;Zt!==null;){p=Zt;var te=p.child;if(p.subtreeFlags&2064&&te!==null)te.return=p,Zt=te;else e:for(p=ne;Zt!==null;){if(a=Zt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Sm(9,a)}}catch(Le){ji(a,a.return,Le)}if(a===p){Zt=null;break e}var xe=a.sibling;if(xe!==null){xe.return=a.return,Zt=xe;break e}Zt=a.return}}if(Wn=r,xc(),Ea&&typeof Ea.onPostCommitFiberRoot=="function")try{Ea.onPostCommitFiberRoot(_m,t)}catch{}i=!0}return i}finally{Jn=n,xs.transition=e}}return!1}function D3(t,e,n){e=fh(n,e),e=b4(t,e,1),t=hc(t,e,1),e=fo(),t!==null&&(vA(t,1,e),Io(t,e))}function ji(t,e,n){if(t.tag===3)D3(t,t,n);else for(;e!==null;){if(e.tag===3){D3(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(dc===null||!dc.has(i))){t=fh(n,t),t=E4(e,t,1),e=hc(e,t,1),t=fo(),e!==null&&(vA(e,1,t),Io(e,t));break}}e=e.return}}function ZU(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=fo(),t.pingedLanes|=t.suspendedLanes&n,xr===t&&(Pr&n)===n&&(ur===4||ur===3&&(Pr&130023424)===Pr&&500>Qi()-D2?uu(t,0):R2|=n),Io(t,e)}function H4(t,e){e===0&&(t.mode&1?(e=g0,g0<<=1,!(g0&130023424)&&(g0=4194304)):e=1);var n=fo();t=vl(t,e),t!==null&&(vA(t,e,n),Io(t,n))}function qU(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),H4(t,n)}function QU(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(mt(314))}i!==null&&i.delete(e),H4(t,n)}var $4;$4=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||So.current)Eo=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Eo=!1,BU(t,e,n);Eo=!!(t.flags&131072)}else Eo=!1,Ti&&e.flags&1048576&&q9(e,Dp,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;K0(t,e),t=e.pendingProps;var r=ah(e,qr.current);Hf(e,n),r=M2(null,e,i,t,r,n);var c=I2();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Mo(i)?(c=!0,Lp(e)):c=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,w2(e),r.updater=Em,e.stateNode=r,r._reactInternals=e,j_(e,i,t,n),e=$_(null,e,i,!0,c,n)):(e.tag=0,Ti&&c&&p2(e),lo(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(K0(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=YU(i),t=Vs(i,t),r){case 0:e=H_(null,e,i,t,n);break e;case 1:e=E3(null,e,i,t,n);break e;case 11:e=w3(null,e,i,t,n);break e;case 14:e=b3(null,e,i,Vs(i.type,t),n);break e}throw Error(mt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Vs(i,r),H_(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Vs(i,r),E3(t,e,i,r,n);case 3:e:{if(I4(e),t===null)throw Error(mt(387));i=e.pendingProps,c=e.memoizedState,r=c.element,K9(t,e),Op(e,i,null,n);var p=e.memoizedState;if(i=p.element,c.isDehydrated)if(c={element:i,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){r=fh(Error(mt(423)),e),e=T3(t,e,i,n,r);break e}else if(i!==r){r=fh(Error(mt(424)),e),e=T3(t,e,i,n,r);break e}else for(qo=fc(e.stateNode.containerInfo.firstChild),Yo=e,Ti=!0,Gs=null,n=n4(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lh(),i===r){e=xl(t,e,n);break e}lo(t,e,i,n)}e=e.child}return e;case 5:return i4(e),t===null&&N_(e),i=e.type,r=e.pendingProps,c=t!==null?t.memoizedProps:null,p=r.children,D_(i,r)?p=null:c!==null&&D_(i,c)&&(e.flags|=32),M4(t,e),lo(t,e,p,n),e.child;case 6:return t===null&&N_(e),null;case 13:return C4(t,e,n);case 4:return b2(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=ch(e,null,i,n):lo(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Vs(i,r),w3(t,e,i,r,n);case 7:return lo(t,e,e.pendingProps,n),e.child;case 8:return lo(t,e,e.pendingProps.children,n),e.child;case 12:return lo(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,c=e.memoizedProps,p=r.value,di(zp,i._currentValue),i._currentValue=p,c!==null)if(Qs(c.value,p)){if(c.children===r.children&&!So.current){e=xl(t,e,n);break e}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var a=c.dependencies;if(a!==null){p=c.child;for(var T=a.firstContext;T!==null;){if(T.context===i){if(c.tag===1){T=Al(-1,n&-n),T.tag=2;var k=c.updateQueue;if(k!==null){k=k.shared;var z=k.pending;z===null?T.next=T:(T.next=z.next,z.next=T),k.pending=T}}c.lanes|=n,T=c.alternate,T!==null&&(T.lanes|=n),U_(c.return,n,e),a.lanes|=n;break}T=T.next}}else if(c.tag===10)p=c.type===e.type?null:c.child;else if(c.tag===18){if(p=c.return,p===null)throw Error(mt(341));p.lanes|=n,a=p.alternate,a!==null&&(a.lanes|=n),U_(p,n,e),p=c.sibling}else p=c.child;if(p!==null)p.return=c;else for(p=c;p!==null;){if(p===e){p=null;break}if(c=p.sibling,c!==null){c.return=p.return,p=c;break}p=p.return}c=p}lo(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Hf(e,n),r=bs(r),i=i(r),e.flags|=1,lo(t,e,i,n),e.child;case 14:return i=e.type,r=Vs(i,e.pendingProps),r=Vs(i.type,r),b3(t,e,i,r,n);case 15:return T4(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Vs(i,r),K0(t,e),e.tag=1,Mo(i)?(t=!0,Lp(e)):t=!1,Hf(e,n),e4(e,i,r),j_(e,i,r,n),$_(null,e,i,!0,t,n);case 19:return k4(t,e,n);case 22:return S4(t,e,n)}throw Error(mt(156,e.tag))};function W4(t,e){return _9(t,e)}function XU(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ys(t,e,n,i){return new XU(t,e,n,i)}function F2(t){return t=t.prototype,!(!t||!t.isReactComponent)}function YU(t){if(typeof t=="function")return F2(t)?1:0;if(t!=null){if(t=t.$$typeof,t===i2)return 11;if(t===r2)return 14}return 2}function pc(t,e){var n=t.alternate;return n===null?(n=ys(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function tp(t,e,n,i,r,c){var p=2;if(i=t,typeof t=="function")F2(t)&&(p=1);else if(typeof t=="string")p=5;else e:switch(t){case Tf:return fu(n.children,r,c,e);case n2:p=8,r|=8;break;case h_:return t=ys(12,n,e,r|2),t.elementType=h_,t.lanes=c,t;case d_:return t=ys(13,n,e,r),t.elementType=d_,t.lanes=c,t;case A_:return t=ys(19,n,e,r),t.elementType=A_,t.lanes=c,t;case t9:return Im(n,r,c,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case J6:p=10;break e;case e9:p=9;break e;case i2:p=11;break e;case r2:p=14;break e;case Yl:p=16,i=null;break e}throw Error(mt(130,t==null?t:typeof t,""))}return e=ys(p,n,e,r),e.elementType=t,e.type=i,e.lanes=c,e}function fu(t,e,n,i){return t=ys(7,t,i,e),t.lanes=n,t}function Im(t,e,n,i){return t=ys(22,t,i,e),t.elementType=t9,t.lanes=n,t.stateNode={isHidden:!1},t}function x1(t,e,n){return t=ys(6,t,null,e),t.lanes=n,t}function w1(t,e,n){return e=ys(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function KU(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=n1(0),this.expirationTimes=n1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=n1(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function N2(t,e,n,i,r,c,p,a,T){return t=new KU(t,e,n,a,T),e===1?(e=1,c===!0&&(e|=8)):e=0,c=ys(3,null,null,e),t.current=c,c.stateNode=t,c.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},w2(c),t}function JU(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ef,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function Z4(t){if(!t)return _c;t=t._reactInternals;e:{if(Tu(t)!==t||t.tag!==1)throw Error(mt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Mo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(mt(171))}if(t.tag===1){var n=t.type;if(Mo(n))return W9(t,n,e)}return e}function q4(t,e,n,i,r,c,p,a,T){return t=N2(n,i,!0,t,r,c,p,a,T),t.context=Z4(null),n=t.current,i=fo(),r=Ac(n),c=Al(i,r),c.callback=e??null,hc(n,c,r),t.current.lanes=r,vA(t,r,i),Io(t,i),t}function Cm(t,e,n,i){var r=e.current,c=fo(),p=Ac(r);return n=Z4(n),e.context===null?e.context=n:e.pendingContext=n,e=Al(c,p),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=hc(r,e,p),t!==null&&(qs(t,r,p,c),Q0(t,r,p)),p}function $p(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function z3(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function U2(t,e){z3(t,e),(t=t.alternate)&&z3(t,e)}function eV(){return null}var Q4=typeof reportError=="function"?reportError:function(t){console.error(t)};function V2(t){this._internalRoot=t}km.prototype.render=V2.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(mt(409));Cm(t,e,null,null)};km.prototype.unmount=V2.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;vu(function(){Cm(null,t,null,null)}),e[yl]=null}};function km(t){this._internalRoot=t}km.prototype.unstable_scheduleHydration=function(t){if(t){var e=T9();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jl.length&&e!==0&&e<Jl[n].priority;n++);Jl.splice(n,0,t),n===0&&M9(t)}};function j2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Pm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function B3(){}function tV(t,e,n,i,r){if(r){if(typeof i=="function"){var c=i;i=function(){var k=$p(p);c.call(k)}}var p=q4(e,i,t,0,null,!1,!1,"",B3);return t._reactRootContainer=p,t[yl]=p.current,Wd(t.nodeType===8?t.parentNode:t),vu(),p}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var k=$p(T);a.call(k)}}var T=N2(t,0,!1,null,null,!1,!1,"",B3);return t._reactRootContainer=T,t[yl]=T.current,Wd(t.nodeType===8?t.parentNode:t),vu(function(){Cm(e,T,n,i)}),T}function Lm(t,e,n,i,r){var c=n._reactRootContainer;if(c){var p=c;if(typeof r=="function"){var a=r;r=function(){var T=$p(p);a.call(T)}}Cm(e,p,t,r)}else p=tV(n,e,t,r,i);return $p(p)}b9=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=dd(e.pendingLanes);n!==0&&(a2(e,n|1),Io(e,Qi()),!(Wn&6)&&(hh=Qi()+500,xc()))}break;case 13:vu(function(){var i=vl(t,1);if(i!==null){var r=fo();qs(i,t,1,r)}}),U2(t,1)}};l2=function(t){if(t.tag===13){var e=vl(t,134217728);if(e!==null){var n=fo();qs(e,t,134217728,n)}U2(t,134217728)}};E9=function(t){if(t.tag===13){var e=Ac(t),n=vl(t,e);if(n!==null){var i=fo();qs(n,t,e,i)}U2(t,e)}};T9=function(){return Jn};S9=function(t,e){var n=Jn;try{return Jn=t,e()}finally{Jn=n}};E_=function(t,e,n){switch(e){case"input":if(g_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=wm(i);if(!r)throw Error(mt(90));i9(i),g_(i,r)}}}break;case"textarea":o9(t,n);break;case"select":e=n.value,e!=null&&Uf(t,!!n.multiple,e,!1)}};h9=z2;d9=vu;var nV={usingClientEntryPoint:!1,Events:[wA,Cf,wm,u9,f9,z2]},od={findFiberByHostInstance:ou,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iV={bundleType:od.bundleType,version:od.version,rendererPackageName:od.rendererPackageName,rendererConfig:od.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:El.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=m9(t),t===null?null:t.stateNode},findFiberByHostInstance:od.findFiberByHostInstance||eV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var I0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!I0.isDisabled&&I0.supportsFiber)try{_m=I0.inject(iV),Ea=I0}catch{}}es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nV;es.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!j2(e))throw Error(mt(200));return JU(t,e,null,n)};es.createRoot=function(t,e){if(!j2(t))throw Error(mt(299));var n=!1,i="",r=Q4;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=N2(t,1,!1,null,null,n,!1,i,r),t[yl]=e.current,Wd(t.nodeType===8?t.parentNode:t),new V2(e)};es.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(mt(188)):(t=Object.keys(t).join(","),Error(mt(268,t)));return t=m9(e),t=t===null?null:t.stateNode,t};es.flushSync=function(t){return vu(t)};es.hydrate=function(t,e,n){if(!Pm(e))throw Error(mt(200));return Lm(null,t,e,!0,n)};es.hydrateRoot=function(t,e,n){if(!j2(t))throw Error(mt(405));var i=n!=null&&n.hydratedSources||null,r=!1,c="",p=Q4;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),e=q4(e,null,t,1,n??null,r,!1,c,p),t[yl]=e.current,Wd(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new km(e)};es.render=function(t,e,n){if(!Pm(e))throw Error(mt(200));return Lm(null,t,e,!1,n)};es.unmountComponentAtNode=function(t){if(!Pm(t))throw Error(mt(40));return t._reactRootContainer?(vu(function(){Lm(null,null,t,!1,function(){t._reactRootContainer=null,t[yl]=null})}),!0):!1};es.unstable_batchedUpdates=z2;es.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Pm(n))throw Error(mt(200));if(t==null||t._reactInternals===void 0)throw Error(mt(38));return Lm(t,e,n,!1,i)};es.version="18.2.0-next-9e3b772b8-20220608";function X4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X4)}catch(t){console.error(t)}}X4(),q6.exports=es;var G2=q6.exports,Y4,O3=G2;Y4=O3.createRoot,O3.hydrateRoot;const b1=Math.PI/180,C0=new Float32Array(16),F3=new Float32Array(12);function N3(t,e,n){const i=e[0]*b1,r=e[1]*b1,c=e[2]*b1,p=Math.sin(c),a=Math.sin(i),T=Math.sin(r),k=Math.cos(c),z=Math.cos(i),B=Math.cos(r),D=n[0],K=n[1],ee=n[2];t[0]=D*B*z,t[1]=D*T*z,t[2]=D*-a,t[3]=K*(-T*k+B*a*p),t[4]=K*(B*k+T*a*p),t[5]=K*z*p,t[6]=ee*(T*p+B*a*k),t[7]=ee*(-B*p+T*a*k),t[8]=ee*z*k}function U3(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const rV={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:r,getScale:c,getTranslation:p,getTransformMatrix:a}=this.props,T=Array.isArray(a),k=T&&a.length===16,z=Array.isArray(c),B=Array.isArray(r),D=Array.isArray(p),K=k||!T&&!!a(i[0]);K?t.constant=k:t.constant=B&&z&&D;const ee=t.value;if(t.constant){let le;K?(C0.set(a),le=U3(C0)):(le=F3,N3(le,r,c),le.set(p,9)),t.value=new Float32Array(le)}else{let le=e*t.size;const{iterable:Ce,objectInfo:se}=Vy(i,e,n);for(const ne of Ce){se.index++;let te;if(K)C0.set(k?a:a(ne,se)),te=U3(C0);else{te=F3;const xe=B?r:r(ne,se),Le=z?c:c(ne,se);N3(te,xe,Le),te.set(D?p:p(ne,se),9)}ee[le++]=te[0],ee[le++]=te[1],ee[le++]=te[2],ee[le++]=te[3],ee[le++]=te[4],ee[le++]=te[5],ee[le++]=te[6],ee[le++]=te[7],ee[le++]=te[8],ee[le++]=te[9],ee[le++]=te[10],ee[le++]=te[11]}}}};function oV(t,e){return e===Un.CARTESIAN||e===Un.METER_OFFSETS||e===Un.DEFAULT&&!t.isGeospatial}const sV=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,aV=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function lV(t){let e=1/0,n=1/0,i=1/0,r=-1/0,c=-1/0,p=-1/0;const a=t.POSITION?t.POSITION.value:[],T=a&&a.length;for(let k=0;k<T;k+=3){const z=a[k],B=a[k+1],D=a[k+2];e=z<e?z:e,n=B<n?B:n,i=D<i?D:i,r=z>r?z:r,c=B>c?B:c,p=D>p?D:p}return[[e,n,i],[r,c,p]]}function V3(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),ii.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function j3(t,e){if(t.attributes)return V3(t.attributes,e),t instanceof U0?t:new U0(t);if(t.positions||t.POSITION)return V3(t,e),new U0({attributes:t});throw Error("Invalid mesh")}const cV=[0,0,0,255],uV={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:cV},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class Rm extends _h{constructor(...e){super(...e),ae(this,"state",void 0)}getShaders(){const e=!On(this.context.gl),n={};return _E(this.context.gl,hi.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:sV,fs:aV,modules:[i6,CL,r6],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:i}=this.props;if(!i)return null;if(n=(e=i.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:r}=j3(i,this.props._useMeshColors);r.POSITION=r.POSITION||r.positions,n=lV(r)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:rV}),this.setState({emptyTexture:new ws(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e;if(n.mesh!==i.mesh||r.extensionsChanged){var c;if(this.state.positionBounds=null,(c=this.state.model)===null||c===void 0||c.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const p=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(p.NORMAL||p.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==i.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:r,_instanced:c}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!c||oV(n,r),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new fp(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:j3(e,this.props._useMeshColors),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:r}=this.state;return n.setUniforms({sampler:i||r,hasTexture:!!i}),n}setTexture(e){const{emptyTexture:n,model:i}=this.state;i&&i.setUniforms({sampler:e||n,hasTexture:!!e})}}ae(Rm,"defaultProps",uV);ae(Rm,"layerName","SimpleMeshLayer");function np(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function fV(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function K4(t){let e,n,i;t.length!==2?(e=np,n=(a,T)=>np(t(a),T),i=(a,T)=>t(a)-T):(e=t===np||t===fV?t:hV,n=t,i=t);function r(a,T,k=0,z=a.length){if(k<z){if(e(T,T)!==0)return z;do{const B=k+z>>>1;n(a[B],T)<0?k=B+1:z=B}while(k<z)}return k}function c(a,T,k=0,z=a.length){if(k<z){if(e(T,T)!==0)return z;do{const B=k+z>>>1;n(a[B],T)<=0?k=B+1:z=B}while(k<z)}return k}function p(a,T,k=0,z=a.length){const B=r(a,T,k,z-1);return B>k&&i(a[B-1],T)>-i(a[B],T)?B-1:B}return{left:r,center:p,right:c}}function hV(){return 0}function dV(t){return t===null?NaN:+t}const AV=K4(np),pV=AV.right;K4(dV).center;const J4=pV;function mV(t,e){let n,i;if(e===void 0)for(const r of t)r!=null&&(n===void 0?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let c of t)(c=e(c,++r,t))!=null&&(n===void 0?c>=c&&(n=i=c):(n>c&&(n=c),i<c&&(i=c)))}return[n,i]}const gV=Math.sqrt(50),_V=Math.sqrt(10),yV=Math.sqrt(2);function Wp(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),c=i/Math.pow(10,r),p=c>=gV?10:c>=_V?5:c>=yV?2:1;let a,T,k;return r<0?(k=Math.pow(10,-r)/p,a=Math.round(t*k),T=Math.round(e*k),a/k<t&&++a,T/k>e&&--T,k=-k):(k=Math.pow(10,r)*p,a=Math.round(t/k),T=Math.round(e/k),a*k<t&&++a,T*k>e&&--T),T<a&&.5<=n&&n<2?Wp(t,e,n*2):[a,T,k]}function vV(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,c,p]=i?Wp(e,t,n):Wp(t,e,n);if(!(c>=r))return[];const a=c-r+1,T=new Array(a);if(i)if(p<0)for(let k=0;k<a;++k)T[k]=(c-k)/-p;else for(let k=0;k<a;++k)T[k]=(c-k)*p;else if(p<0)for(let k=0;k<a;++k)T[k]=(r+k)/-p;else for(let k=0;k<a;++k)T[k]=(r+k)*p;return T}function iy(t,e,n){return e=+e,t=+t,n=+n,Wp(t,e,n)[2]}function xV(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?iy(e,t,n):iy(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function ry(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,c=new Array(r);++i<r;)c[i]=t+i*n;return c}function H2(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function e5(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function EA(){}var tA=.7,Zp=1/tA,Wf="\\s*([+-]?\\d+)\\s*",nA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Sa="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wV=/^#([0-9a-f]{3,8})$/,bV=new RegExp("^rgb\\("+[Wf,Wf,Wf]+"\\)$"),EV=new RegExp("^rgb\\("+[Sa,Sa,Sa]+"\\)$"),TV=new RegExp("^rgba\\("+[Wf,Wf,Wf,nA]+"\\)$"),SV=new RegExp("^rgba\\("+[Sa,Sa,Sa,nA]+"\\)$"),MV=new RegExp("^hsl\\("+[nA,Sa,Sa]+"\\)$"),IV=new RegExp("^hsla\\("+[nA,Sa,Sa,nA]+"\\)$"),G3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};H2(EA,iA,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:H3,formatHex:H3,formatHsl:CV,formatRgb:$3,toString:$3});function H3(){return this.rgb().formatHex()}function CV(){return t5(this).formatHsl()}function $3(){return this.rgb().formatRgb()}function iA(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=wV.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?W3(e):n===3?new Qo(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?k0(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?k0(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=bV.exec(t))?new Qo(e[1],e[2],e[3],1):(e=EV.exec(t))?new Qo(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=TV.exec(t))?k0(e[1],e[2],e[3],e[4]):(e=SV.exec(t))?k0(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=MV.exec(t))?Q3(e[1],e[2]/100,e[3]/100,1):(e=IV.exec(t))?Q3(e[1],e[2]/100,e[3]/100,e[4]):G3.hasOwnProperty(t)?W3(G3[t]):t==="transparent"?new Qo(NaN,NaN,NaN,0):null}function W3(t){return new Qo(t>>16&255,t>>8&255,t&255,1)}function k0(t,e,n,i){return i<=0&&(t=e=n=NaN),new Qo(t,e,n,i)}function kV(t){return t instanceof EA||(t=iA(t)),t?(t=t.rgb(),new Qo(t.r,t.g,t.b,t.opacity)):new Qo}function qp(t,e,n,i){return arguments.length===1?kV(t):new Qo(t,e,n,i??1)}function Qo(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}H2(Qo,qp,e5(EA,{brighter:function(t){return t=t==null?Zp:Math.pow(Zp,t),new Qo(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?tA:Math.pow(tA,t),new Qo(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Z3,formatHex:Z3,formatRgb:q3,toString:q3}));function Z3(){return"#"+E1(this.r)+E1(this.g)+E1(this.b)}function q3(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function E1(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function Q3(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new xa(t,e,n,i)}function t5(t){if(t instanceof xa)return new xa(t.h,t.s,t.l,t.opacity);if(t instanceof EA||(t=iA(t)),!t)return new xa;if(t instanceof xa)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),c=Math.max(e,n,i),p=NaN,a=c-r,T=(c+r)/2;return a?(e===c?p=(n-i)/a+(n<i)*6:n===c?p=(i-e)/a+2:p=(e-n)/a+4,a/=T<.5?c+r:2-c-r,p*=60):a=T>0&&T<1?0:p,new xa(p,a,T,t.opacity)}function PV(t,e,n,i){return arguments.length===1?t5(t):new xa(t,e,n,i??1)}function xa(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}H2(xa,PV,e5(EA,{brighter:function(t){return t=t==null?Zp:Math.pow(Zp,t),new xa(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?tA:Math.pow(tA,t),new xa(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Qo(T1(t>=240?t-240:t+120,r,i),T1(t,r,i),T1(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function T1(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function LV(t,e,n,i,r){var c=t*t,p=c*t;return((1-3*t+3*c-p)*e+(4-6*c+3*p)*n+(1+3*t+3*c-3*p)*i+p*r)/6}function RV(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],c=t[i+1],p=i>0?t[i-1]:2*r-c,a=i<e-1?t[i+2]:2*c-r;return LV((n-i/e)*e,p,r,c,a)}}function $2(t){return function(){return t}}function DV(t,e){return function(n){return t+n*e}}function zV(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function BV(t){return(t=+t)==1?n5:function(e,n){return n-e?zV(e,n,t):$2(isNaN(e)?n:e)}}function n5(t,e){var n=e-t;return n?DV(t,n):$2(isNaN(t)?e:t)}const X3=function t(e){var n=BV(e);function i(r,c){var p=n((r=qp(r)).r,(c=qp(c)).r),a=n(r.g,c.g),T=n(r.b,c.b),k=n5(r.opacity,c.opacity);return function(z){return r.r=p(z),r.g=a(z),r.b=T(z),r.opacity=k(z),r+""}}return i.gamma=t,i}(1);function OV(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),c=new Array(n),p,a;for(p=0;p<n;++p)a=qp(e[p]),i[p]=a.r||0,r[p]=a.g||0,c[p]=a.b||0;return i=t(i),r=t(r),c=t(c),a.opacity=1,function(T){return a.r=i(T),a.g=r(T),a.b=c(T),a+""}}}var FV=OV(RV);function NV(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(c){for(r=0;r<n;++r)i[r]=t[r]*(1-c)+e[r]*c;return i}}function UV(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function VV(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),c=new Array(n),p;for(p=0;p<i;++p)r[p]=W2(t[p],e[p]);for(;p<n;++p)c[p]=e[p];return function(a){for(p=0;p<i;++p)c[p]=r[p](a);return c}}function jV(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Qp(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function GV(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=W2(t[r],e[r]):i[r]=e[r];return function(c){for(r in n)i[r]=n[r](c);return i}}var oy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,S1=new RegExp(oy.source,"g");function HV(t){return function(){return t}}function $V(t){return function(e){return t(e)+""}}function WV(t,e){var n=oy.lastIndex=S1.lastIndex=0,i,r,c,p=-1,a=[],T=[];for(t=t+"",e=e+"";(i=oy.exec(t))&&(r=S1.exec(e));)(c=r.index)>n&&(c=e.slice(n,c),a[p]?a[p]+=c:a[++p]=c),(i=i[0])===(r=r[0])?a[p]?a[p]+=r:a[++p]=r:(a[++p]=null,T.push({i:p,x:Qp(i,r)})),n=S1.lastIndex;return n<e.length&&(c=e.slice(n),a[p]?a[p]+=c:a[++p]=c),a.length<2?T[0]?$V(T[0].x):HV(e):(e=T.length,function(k){for(var z=0,B;z<e;++z)a[(B=T[z]).i]=B.x(k);return a.join("")})}function W2(t,e){var n=typeof e,i;return e==null||n==="boolean"?$2(e):(n==="number"?Qp:n==="string"?(i=iA(e))?(e=i,X3):WV:e instanceof iA?X3:e instanceof Date?jV:UV(e)?NV:Array.isArray(e)?VV:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?GV:Qp)(t,e)}function ZV(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Z2(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function i5(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function TA(){}var rA=.7,Xp=1/rA,Zf="\\s*([+-]?\\d+)\\s*",oA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ma="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qV=/^#([0-9a-f]{3,8})$/,QV=new RegExp(`^rgb\\(${Zf},${Zf},${Zf}\\)$`),XV=new RegExp(`^rgb\\(${Ma},${Ma},${Ma}\\)$`),YV=new RegExp(`^rgba\\(${Zf},${Zf},${Zf},${oA}\\)$`),KV=new RegExp(`^rgba\\(${Ma},${Ma},${Ma},${oA}\\)$`),JV=new RegExp(`^hsl\\(${oA},${Ma},${Ma}\\)$`),ej=new RegExp(`^hsla\\(${oA},${Ma},${Ma},${oA}\\)$`),Y3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Z2(TA,sA,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:K3,formatHex:K3,formatHex8:tj,formatHsl:nj,formatRgb:J3,toString:J3});function K3(){return this.rgb().formatHex()}function tj(){return this.rgb().formatHex8()}function nj(){return r5(this).formatHsl()}function J3(){return this.rgb().formatRgb()}function sA(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=qV.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?e8(e):n===3?new To(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?P0(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?P0(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=QV.exec(t))?new To(e[1],e[2],e[3],1):(e=XV.exec(t))?new To(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=YV.exec(t))?P0(e[1],e[2],e[3],e[4]):(e=KV.exec(t))?P0(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=JV.exec(t))?i8(e[1],e[2]/100,e[3]/100,1):(e=ej.exec(t))?i8(e[1],e[2]/100,e[3]/100,e[4]):Y3.hasOwnProperty(t)?e8(Y3[t]):t==="transparent"?new To(NaN,NaN,NaN,0):null}function e8(t){return new To(t>>16&255,t>>8&255,t&255,1)}function P0(t,e,n,i){return i<=0&&(t=e=n=NaN),new To(t,e,n,i)}function ij(t){return t instanceof TA||(t=sA(t)),t?(t=t.rgb(),new To(t.r,t.g,t.b,t.opacity)):new To}function sy(t,e,n,i){return arguments.length===1?ij(t):new To(t,e,n,i??1)}function To(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}Z2(To,sy,i5(TA,{brighter(t){return t=t==null?Xp:Math.pow(Xp,t),new To(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?rA:Math.pow(rA,t),new To(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new To(hu(this.r),hu(this.g),hu(this.b),Yp(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:t8,formatHex:t8,formatHex8:rj,formatRgb:n8,toString:n8}));function t8(){return`#${lu(this.r)}${lu(this.g)}${lu(this.b)}`}function rj(){return`#${lu(this.r)}${lu(this.g)}${lu(this.b)}${lu((isNaN(this.opacity)?1:this.opacity)*255)}`}function n8(){const t=Yp(this.opacity);return`${t===1?"rgb(":"rgba("}${hu(this.r)}, ${hu(this.g)}, ${hu(this.b)}${t===1?")":`, ${t})`}`}function Yp(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function hu(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function lu(t){return t=hu(t),(t<16?"0":"")+t.toString(16)}function i8(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Hs(t,e,n,i)}function r5(t){if(t instanceof Hs)return new Hs(t.h,t.s,t.l,t.opacity);if(t instanceof TA||(t=sA(t)),!t)return new Hs;if(t instanceof Hs)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),c=Math.max(e,n,i),p=NaN,a=c-r,T=(c+r)/2;return a?(e===c?p=(n-i)/a+(n<i)*6:n===c?p=(i-e)/a+2:p=(e-n)/a+4,a/=T<.5?c+r:2-c-r,p*=60):a=T>0&&T<1?0:p,new Hs(p,a,T,t.opacity)}function oj(t,e,n,i){return arguments.length===1?r5(t):new Hs(t,e,n,i??1)}function Hs(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}Z2(Hs,oj,i5(TA,{brighter(t){return t=t==null?Xp:Math.pow(Xp,t),new Hs(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?rA:Math.pow(rA,t),new Hs(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new To(M1(t>=240?t-240:t+120,r,i),M1(t,r,i),M1(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Hs(r8(this.h),L0(this.s),L0(this.l),Yp(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Yp(this.opacity);return`${t===1?"hsl(":"hsla("}${r8(this.h)}, ${L0(this.s)*100}%, ${L0(this.l)*100}%${t===1?")":`, ${t})`}`}}));function r8(t){return t=(t||0)%360,t<0?t+360:t}function L0(t){return Math.max(0,Math.min(1,t||0))}function M1(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function sj(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Kp(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function dh(t){return t=Kp(Math.abs(t)),t?t[1]:NaN}function aj(t,e){return function(n,i){for(var r=n.length,c=[],p=0,a=t[0],T=0;r>0&&a>0&&(T+a+1>i&&(a=Math.max(1,i-T)),c.push(n.substring(r-=a,r+a)),!((T+=a+1)>i));)a=t[p=(p+1)%t.length];return c.reverse().join(e)}}function lj(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var cj=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Jp(t){if(!(e=cj.exec(t)))throw new Error("invalid format: "+t);var e;return new q2({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Jp.prototype=q2.prototype;function q2(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}q2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function uj(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var o5;function fj(t,e){var n=Kp(t,e);if(!n)return t+"";var i=n[0],r=n[1],c=r-(o5=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,p=i.length;return c===p?i:c>p?i+new Array(c-p+1).join("0"):c>0?i.slice(0,c)+"."+i.slice(c):"0."+new Array(1-c).join("0")+Kp(t,Math.max(0,e+c-1))[0]}function o8(t,e){var n=Kp(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const s8={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:sj,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>o8(t*100,e),r:o8,s:fj,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function a8(t){return t}var l8=Array.prototype.map,c8=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function hj(t){var e=t.grouping===void 0||t.thousands===void 0?a8:aj(l8.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",c=t.numerals===void 0?a8:lj(l8.call(t.numerals,String)),p=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",T=t.nan===void 0?"NaN":t.nan+"";function k(B){B=Jp(B);var D=B.fill,K=B.align,ee=B.sign,le=B.symbol,Ce=B.zero,se=B.width,ne=B.comma,te=B.precision,xe=B.trim,Le=B.type;Le==="n"?(ne=!0,Le="g"):s8[Le]||(te===void 0&&(te=12),xe=!0,Le="g"),(Ce||D==="0"&&K==="=")&&(Ce=!0,D="0",K="=");var Ge=le==="$"?n:le==="#"&&/[boxX]/.test(Le)?"0"+Le.toLowerCase():"",nt=le==="$"?i:/[%p]/.test(Le)?p:"",it=s8[Le],dt=/[defgprs%]/.test(Le);te=te===void 0?6:/[gprs]/.test(Le)?Math.max(1,Math.min(21,te)):Math.max(0,Math.min(20,te));function ct(Xe){var Bt=Ge,Rt=nt,jt,_n,Mt;if(Le==="c")Rt=it(Xe)+Rt,Xe="";else{Xe=+Xe;var Sn=Xe<0||1/Xe<0;if(Xe=isNaN(Xe)?T:it(Math.abs(Xe),te),xe&&(Xe=uj(Xe)),Sn&&+Xe==0&&ee!=="+"&&(Sn=!1),Bt=(Sn?ee==="("?ee:a:ee==="-"||ee==="("?"":ee)+Bt,Rt=(Le==="s"?c8[8+o5/3]:"")+Rt+(Sn&&ee==="("?")":""),dt){for(jt=-1,_n=Xe.length;++jt<_n;)if(Mt=Xe.charCodeAt(jt),48>Mt||Mt>57){Rt=(Mt===46?r+Xe.slice(jt+1):Xe.slice(jt))+Rt,Xe=Xe.slice(0,jt);break}}}ne&&!Ce&&(Xe=e(Xe,1/0));var pt=Bt.length+Xe.length+Rt.length,It=pt<se?new Array(se-pt+1).join(D):"";switch(ne&&Ce&&(Xe=e(It+Xe,It.length?se-Rt.length:1/0),It=""),K){case"<":Xe=Bt+Xe+Rt+It;break;case"=":Xe=Bt+It+Xe+Rt;break;case"^":Xe=It.slice(0,pt=It.length>>1)+Bt+Xe+Rt+It.slice(pt);break;default:Xe=It+Bt+Xe+Rt;break}return c(Xe)}return ct.toString=function(){return B+""},ct}function z(B,D){var K=k((B=Jp(B),B.type="f",B)),ee=Math.max(-8,Math.min(8,Math.floor(dh(D)/3)))*3,le=Math.pow(10,-ee),Ce=c8[8+ee/3];return function(se){return K(le*se)+Ce}}return{format:k,formatPrefix:z}}var R0,s5,a5;dj({thousands:",",grouping:[3],currency:["$",""]});function dj(t){return R0=hj(t),s5=R0.format,a5=R0.formatPrefix,R0}function Aj(t){return Math.max(0,-dh(Math.abs(t)))}function pj(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(dh(e)/3)))*3-dh(Math.abs(t)))}function mj(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,dh(e)-dh(t))+1}const Q2=t=>()=>t;function gj(t,e){return function(n){return t+n*e}}function _j(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function yj(t){return(t=+t)==1?l5:function(e,n){return n-e?_j(e,n,t):Q2(isNaN(e)?n:e)}}function l5(t,e){var n=e-t;return n?gj(t,n):Q2(isNaN(t)?e:t)}const u8=function t(e){var n=yj(e);function i(r,c){var p=n((r=sy(r)).r,(c=sy(c)).r),a=n(r.g,c.g),T=n(r.b,c.b),k=l5(r.opacity,c.opacity);return function(z){return r.r=p(z),r.g=a(z),r.b=T(z),r.opacity=k(z),r+""}}return i.gamma=t,i}(1);function vj(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(c){for(r=0;r<n;++r)i[r]=t[r]*(1-c)+e[r]*c;return i}}function xj(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function wj(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),c=new Array(n),p;for(p=0;p<i;++p)r[p]=X2(t[p],e[p]);for(;p<n;++p)c[p]=e[p];return function(a){for(p=0;p<i;++p)c[p]=r[p](a);return c}}function bj(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function em(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Ej(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=X2(t[r],e[r]):i[r]=e[r];return function(c){for(r in n)i[r]=n[r](c);return i}}var ay=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,I1=new RegExp(ay.source,"g");function Tj(t){return function(){return t}}function Sj(t){return function(e){return t(e)+""}}function Mj(t,e){var n=ay.lastIndex=I1.lastIndex=0,i,r,c,p=-1,a=[],T=[];for(t=t+"",e=e+"";(i=ay.exec(t))&&(r=I1.exec(e));)(c=r.index)>n&&(c=e.slice(n,c),a[p]?a[p]+=c:a[++p]=c),(i=i[0])===(r=r[0])?a[p]?a[p]+=r:a[++p]=r:(a[++p]=null,T.push({i:p,x:em(i,r)})),n=I1.lastIndex;return n<e.length&&(c=e.slice(n),a[p]?a[p]+=c:a[++p]=c),a.length<2?T[0]?Sj(T[0].x):Tj(e):(e=T.length,function(k){for(var z=0,B;z<e;++z)a[(B=T[z]).i]=B.x(k);return a.join("")})}function X2(t,e){var n=typeof e,i;return e==null||n==="boolean"?Q2(e):(n==="number"?em:n==="string"?(i=sA(e))?(e=i,u8):Mj:e instanceof sA?u8:e instanceof Date?bj:xj(e)?vj:Array.isArray(e)?wj:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Ej:em)(t,e)}function Ij(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function c5(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Cj(t){return function(){return t}}function kj(t){return+t}var f8=[0,1];function Bf(t){return t}function ly(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Cj(isNaN(e)?NaN:.5)}function Pj(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function Lj(t,e,n){var i=t[0],r=t[1],c=e[0],p=e[1];return r<i?(i=ly(r,i),c=n(p,c)):(i=ly(i,r),c=n(c,p)),function(a){return c(i(a))}}function Rj(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),c=new Array(i),p=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++p<i;)r[p]=ly(t[p],t[p+1]),c[p]=n(e[p],e[p+1]);return function(a){var T=J4(t,a,1,i)-1;return c[T](r[T](a))}}function Dj(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function zj(){var t=f8,e=f8,n=X2,i,r,c,p=Bf,a,T,k;function z(){var D=Math.min(t.length,e.length);return p!==Bf&&(p=Pj(t[0],t[D-1])),a=D>2?Rj:Lj,T=k=null,B}function B(D){return D==null||isNaN(D=+D)?c:(T||(T=a(t.map(i),e,n)))(i(p(D)))}return B.invert=function(D){return p(r((k||(k=a(e,t.map(i),em)))(D)))},B.domain=function(D){return arguments.length?(t=Array.from(D,kj),z()):t.slice()},B.range=function(D){return arguments.length?(e=Array.from(D),z()):e.slice()},B.rangeRound=function(D){return e=Array.from(D),n=Ij,z()},B.clamp=function(D){return arguments.length?(p=D?!0:Bf,z()):p!==Bf},B.interpolate=function(D){return arguments.length?(n=D,z()):n},B.unknown=function(D){return arguments.length?(c=D,B):c},function(D,K){return i=D,r=K,z()}}function Bj(){return zj()(Bf,Bf)}function Oj(t,e,n,i){var r=xV(t,e,n),c;switch(i=Jp(i??",f"),i.type){case"s":{var p=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(c=pj(r,p))&&(i.precision=c),a5(i,p)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(c=mj(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=c-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(c=Aj(r))&&(i.precision=c-(i.type==="%")*2);break}}return s5(i)}function u5(t){var e=t.domain;return t.ticks=function(n){var i=e();return vV(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return Oj(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,c=i.length-1,p=i[r],a=i[c],T,k,z=10;for(a<p&&(k=p,p=a,a=k,k=r,r=c,c=k);z-- >0;){if(k=iy(p,a,n),k===T)return i[r]=p,i[c]=a,e(i);if(k>0)p=Math.floor(p/k)*k,a=Math.ceil(a/k)*k;else if(k<0)p=Math.ceil(p*k)/k,a=Math.floor(a*k)/k;else break;T=k}return t},t}function f5(){var t=Bj();return t.copy=function(){return Dj(t,f5())},c5.apply(t,arguments),u5(t)}function aA(){var t=0,e=1,n=1,i=[.5],r=[0,1],c;function p(T){return T!=null&&T<=T?r[J4(i,T,0,n)]:c}function a(){var T=-1;for(i=new Array(n);++T<n;)i[T]=((T+1)*e-(T-n)*t)/(n+1);return p}return p.domain=function(T){return arguments.length?([t,e]=T,t=+t,e=+e,a()):[t,e]},p.range=function(T){return arguments.length?(n=(r=Array.from(T)).length-1,a()):r.slice()},p.invertExtent=function(T){var k=r.indexOf(T);return k<0?[NaN,NaN]:k<1?[t,i[0]]:k>=n?[i[n-1],e]:[i[k-1],i[k]]},p.unknown=function(T){return arguments.length&&(c=T),p},p.thresholds=function(){return i.slice()},p.copy=function(){return aA().domain([t,e]).range(r).unknown(c)},c5.apply(u5(p),arguments)}function Fj(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}const Nj=t=>FV(t[t.length-1]);var Uj=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Fj);const Vj=Nj(Uj);function pd(t,e,n){this.k=t,this.x=e,this.y=n}pd.prototype={constructor:pd,scale:function(t){return t===1?this:new pd(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new pd(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};pd.prototype;var Jo=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},i;for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var r="";function c(q){return e.locateFile?e.locateFile(q,r):r+q}var p;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",p=function(U,W,ie){var f=new XMLHttpRequest;f.open("GET",U,!0),f.responseType="arraybuffer",f.onload=function(){if(f.status==200||f.status==0&&f.response){W(f.response);return}var ke=mi(U);if(ke){W(ke.buffer);return}ie()},f.onerror=ie,f.send(null)};var a=e.print||console.log.bind(console),T=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments;var k=0,z=function(q){k=q},B=function(){return k},D=8;function K(q,U,W,ie){switch(W=W||"i8",W.charAt(W.length-1)==="*"&&(W="i32"),W){case"i1":Bt[q>>0]=U;break;case"i8":Bt[q>>0]=U;break;case"i16":jt[q>>1]=U;break;case"i32":_n[q>>2]=U;break;case"i64":wr=[U>>>0,(Yi=U,+Si(Yi)>=1?Yi>0?(Gi(+hr(Yi/4294967296),4294967295)|0)>>>0:~~+Qr((Yi-+(~~Yi>>>0))/4294967296)>>>0:0)],_n[q>>2]=wr[0],_n[q+4>>2]=wr[1];break;case"float":Mt[q>>2]=U;break;case"double":Sn[q>>3]=U;break;default:Ji("invalid type for setValue: "+W)}}function ee(q,U,W){switch(U=U||"i8",U.charAt(U.length-1)==="*"&&(U="i32"),U){case"i1":return Bt[q>>0];case"i8":return Bt[q>>0];case"i16":return jt[q>>1];case"i32":return _n[q>>2];case"i64":return _n[q>>2];case"float":return Mt[q>>2];case"double":return Sn[q>>3];default:Ji("invalid type for getValue: "+U)}return null}var le=!1;function Ce(q,U){q||Ji("Assertion failed: "+U)}function se(q){var U=e["_"+q];return Ce(U,"Cannot call unknown function "+q+", make sure it is exported"),U}function ne(q,U,W,ie,f){var H={string:function(lt){var Tt=0;if(lt!=null&&lt!==0){var xt=(lt.length<<2)+1;Tt=Co(xt),it(lt,Tt,xt)}return Tt},array:function(lt){var Tt=Co(lt.length);return dt(lt,Tt),Tt}};function ke(lt){return U==="string"?Ge(lt):U==="boolean"?!!lt:lt}var Te=se(q),we=[],Me=0;if(ie)for(var Fe=0;Fe<ie.length;Fe++){var rt=H[W[Fe]];rt?(Me===0&&(Me=zi()),we[Fe]=rt(ie[Fe])):we[Fe]=ie[Fe]}var Ne=Te.apply(null,we);return Ne=ke(Ne),Me!==0&&ai(Me),Ne}function te(q,U,W,ie){W=W||[];var f=W.every(function(ke){return ke==="number"}),H=U!=="string";return H&&f&&!ie?se(q):function(){return ne(q,U,W,arguments)}}var xe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Le(q,U,W){for(var ie=U+W,f=U;q[f]&&!(f>=ie);)++f;if(f-U>16&&q.subarray&&xe)return xe.decode(q.subarray(U,f));for(var H="";U<f;){var ke=q[U++];if(!(ke&128)){H+=String.fromCharCode(ke);continue}var Te=q[U++]&63;if((ke&224)==192){H+=String.fromCharCode((ke&31)<<6|Te);continue}var we=q[U++]&63;if((ke&240)==224?ke=(ke&15)<<12|Te<<6|we:ke=(ke&7)<<18|Te<<12|we<<6|q[U++]&63,ke<65536)H+=String.fromCharCode(ke);else{var Me=ke-65536;H+=String.fromCharCode(55296|Me>>10,56320|Me&1023)}}return H}function Ge(q,U){return q?Le(Rt,q,U):""}function nt(q,U,W,ie){if(!(ie>0))return 0;for(var f=W,H=W+ie-1,ke=0;ke<q.length;++ke){var Te=q.charCodeAt(ke);if(Te>=55296&&Te<=57343){var we=q.charCodeAt(++ke);Te=65536+((Te&1023)<<10)|we&1023}if(Te<=127){if(W>=H)break;U[W++]=Te}else if(Te<=2047){if(W+1>=H)break;U[W++]=192|Te>>6,U[W++]=128|Te&63}else if(Te<=65535){if(W+2>=H)break;U[W++]=224|Te>>12,U[W++]=128|Te>>6&63,U[W++]=128|Te&63}else{if(W+3>=H)break;U[W++]=240|Te>>18,U[W++]=128|Te>>12&63,U[W++]=128|Te>>6&63,U[W++]=128|Te&63}}return U[W]=0,W-f}function it(q,U,W){return nt(q,Rt,U,W)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function dt(q,U){Bt.set(q,U)}function ct(q,U){return q%U>0&&(q+=U-q%U),q}var Xe,Bt,Rt,jt,_n,Mt,Sn;function pt(q){Xe=q,e.HEAP8=Bt=new Int8Array(q),e.HEAP16=jt=new Int16Array(q),e.HEAP32=_n=new Int32Array(q),e.HEAPU8=Rt=new Uint8Array(q),e.HEAPU16=new Uint16Array(q),e.HEAPU32=new Uint32Array(q),e.HEAPF32=Mt=new Float32Array(q),e.HEAPF64=Sn=new Float64Array(q)}var It=5267040,Jt=24128,kn=e.TOTAL_MEMORY||33554432;e.buffer?Xe=e.buffer:Xe=new ArrayBuffer(kn),kn=Xe.byteLength,pt(Xe),_n[Jt>>2]=It;function Mn(q){for(;q.length>0;){var U=q.shift();if(typeof U=="function"){U();continue}var W=U.func;typeof W=="number"?U.arg===void 0?e.dynCall_v(W):e.dynCall_vi(W,U.arg):W(U.arg===void 0?null:U.arg)}}var ri=[],oi=[],Ri=[],Ai=[];function Nn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Xi(e.preRun.shift());Mn(ri)}function Di(){Mn(oi)}function yn(){Mn(Ri)}function qn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)pi(e.postRun.shift());Mn(Ai)}function Xi(q){ri.unshift(q)}function pi(q){Ai.unshift(q)}var Si=Math.abs,Qr=Math.ceil,hr=Math.floor,Gi=Math.min,xi=0,Dr=null;function bn(q){xi++,e.monitorRunDependencies&&e.monitorRunDependencies(xi)}function ir(q){if(xi--,e.monitorRunDependencies&&e.monitorRunDependencies(xi),xi==0&&Dr){var U=Dr;Dr=null,U()}}e.preloadedImages={},e.preloadedAudios={};var Vn=null,zr="data:application/octet-stream;base64,";function ns(q){return String.prototype.startsWith?q.startsWith(zr):q.indexOf(zr)===0}var Yi,wr;Vn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var is=24144;function Br(q){return q}function et(q){var U=/\b__Z[\w\d_]+/g;return q.replace(U,function(W){var ie=W;return W===ie?W:ie+" ["+W+"]"})}function gt(){var q=new Error;if(!q.stack){try{throw new Error(0)}catch(U){q=U}if(!q.stack)return"(no stack trace available)"}return q.stack.toString()}function po(){var q=gt();return e.extraStackTrace&&(q+=`
`+e.extraStackTrace()),et(q)}function Ki(q,U,W,ie){Ji("Assertion failed: "+Ge(q)+", at: "+[U?Ge(U):"unknown filename",W,ie?Ge(ie):"unknown function"])}function vn(){return Bt.length}function dr(q,U,W){Rt.set(Rt.subarray(U,U+W),q)}function rr(q){return e.___errno_location&&(_n[e.___errno_location()>>2]=q),q}function or(q){Ji("OOM")}function Xr(q){try{var U=new ArrayBuffer(q);return U.byteLength!=q?void 0:(new Int8Array(U).set(Bt),wi(U),pt(U),1)}catch{}}function _t(q){var U=vn(),W=16777216,ie=2147483648-W;if(q>ie)return!1;for(var f=16777216,H=Math.max(U,f);H<q;)H<=536870912?H=ct(2*H,W):H=Math.min(ct((3*H+2147483648)/4,W),ie);var ke=Xr(H);return!!ke}var ln=typeof atob=="function"?atob:function(q){var U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",W="",ie,f,H,ke,Te,we,Me,Fe=0;q=q.replace(/[^A-Za-z0-9\+\/\=]/g,"");do ke=U.indexOf(q.charAt(Fe++)),Te=U.indexOf(q.charAt(Fe++)),we=U.indexOf(q.charAt(Fe++)),Me=U.indexOf(q.charAt(Fe++)),ie=ke<<2|Te>>4,f=(Te&15)<<4|we>>2,H=(we&3)<<6|Me,W=W+String.fromCharCode(ie),we!==64&&(W=W+String.fromCharCode(f)),Me!==64&&(W=W+String.fromCharCode(H));while(Fe<q.length);return W};function an(q){try{for(var U=ln(q),W=new Uint8Array(U.length),ie=0;ie<U.length;++ie)W[ie]=U.charCodeAt(ie);return W}catch{throw new Error("Converting base64 string to bytes failed.")}}function mi(q){if(ns(q))return an(q.slice(zr.length))}var Yr={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},rn={a:Ji,b:z,c:B,d:Ki,e:rr,f:vn,g:dr,h:_t,i:or,j:Br,k:et,l:Xr,m:gt,n:po,o:is,p:Jt},ft=function(q,U,W){"almost asm";var ie=new q.Int8Array(W),f=new q.Int32Array(W);new q.Uint8Array(W),new q.Float32Array(W);var H=new q.Float64Array(W),ke=U.o|0,Te=U.p|0,we=q.Math.floor,Me=q.Math.abs,Fe=q.Math.sqrt,rt=q.Math.pow,Ne=q.Math.cos,lt=q.Math.sin,Tt=q.Math.tan,xt=q.Math.acos,$t=q.Math.asin,Ft=q.Math.atan,en=q.Math.atan2,Gt=q.Math.ceil,Wt=q.Math.imul,dn=q.Math.min,wn=q.Math.max,Ln=q.Math.clz32,Ot=U.b,me=U.c,Qt=U.d,Bi=U.e,Rn=U.f,Ss=U.g,Ms=U.h,Xs=U.i,Ae=24160;function rs(d){return ie=new Int8Array(d),f=new Int32Array(d),H=new Float64Array(d),W=d,!0}function Kr(d){d=d|0;var h=0;return h=Ae,Ae=Ae+d|0,Ae=Ae+15&-16,h|0}function Ys(){return Ae|0}function Ks(d){d=d|0,Ae=d}function Js(d,h){d=d|0,Ae=d}function ka(d,h){d=d|0,h=h|0;var m=0,_=0,v=0;return(d|0)<0?(h=2,h|0):(d|0)>13780509?(h=ua(15,h)|0,h|0):(m=((d|0)<0)<<31>>31,v=J(d|0,m|0,3,0)|0,_=me()|0,m=M(d|0,m|0,1,0)|0,m=J(v|0,_|0,m|0,me()|0)|0,m=M(m|0,me()|0,1,0)|0,d=me()|0,f[h>>2]=m,f[h+4>>2]=d,h=0,h|0)}function Pa(d,h,m,_){return d=d|0,h=h|0,m=m|0,_=_|0,go(d,h,m,_,0)|0}function go(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0;if(O=Ae,Ae=Ae+16|0,I=O,!(ue(d,h,m,_,v)|0))return _=0,Ae=O,_|0;do if((m|0)>=0){if((m|0)>13780509){if(E=ua(15,I)|0,E|0)break;P=I,I=f[P>>2]|0,P=f[P+4>>2]|0}else E=((m|0)<0)<<31>>31,G=J(m|0,E|0,3,0)|0,P=me()|0,E=M(m|0,E|0,1,0)|0,E=J(G|0,P|0,E|0,me()|0)|0,E=M(E|0,me()|0,1,0)|0,P=me()|0,f[I>>2]=E,f[I+4>>2]=P,I=E;if(je(_|0,0,I<<3|0)|0,v|0){je(v|0,0,I<<2|0)|0,E=pe(d,h,m,_,v,I,P,0)|0;break}E=w(I,4)|0,E?(G=pe(d,h,m,_,E,I,P,0)|0,y(E),E=G):E=13}else E=2;while(0);return G=E,Ae=O,G|0}function ue(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0;if(ze=Ae,Ae=Ae+16|0,Re=ze,be=ze+8|0,ve=Re,f[ve>>2]=d,f[ve+4>>2]=h,(m|0)<0)return be=2,Ae=ze,be|0;if(E=_,f[E>>2]=d,f[E+4>>2]=h,E=(v|0)!=0,E&&(f[v>>2]=0),Gn(d,h)|0)return be=9,Ae=ze,be|0;f[be>>2]=0;e:do if((m|0)>=1)if(E)for(X=1,G=0,de=0,ve=1,E=d;;){if(!(G|de)){if(E=Ie(E,h,4,be,Re)|0,E|0)break e;if(h=Re,E=f[h>>2]|0,h=f[h+4>>2]|0,Gn(E,h)|0){E=9;break e}}if(E=Ie(E,h,f[22384+(de<<2)>>2]|0,be,Re)|0,E|0)break e;if(h=Re,E=f[h>>2]|0,h=f[h+4>>2]|0,d=_+(X<<3)|0,f[d>>2]=E,f[d+4>>2]=h,f[v+(X<<2)>>2]=ve,d=G+1|0,I=(d|0)==(ve|0),P=de+1|0,O=(P|0)==6,Gn(E,h)|0){E=9;break e}if(ve=ve+(O&I&1)|0,(ve|0)>(m|0)){E=0;break}else X=X+1|0,G=I?0:d,de=I?O?0:P:de}else for(X=1,G=0,de=0,ve=1,E=d;;){if(!(G|de)){if(E=Ie(E,h,4,be,Re)|0,E|0)break e;if(h=Re,E=f[h>>2]|0,h=f[h+4>>2]|0,Gn(E,h)|0){E=9;break e}}if(E=Ie(E,h,f[22384+(de<<2)>>2]|0,be,Re)|0,E|0)break e;if(h=Re,E=f[h>>2]|0,h=f[h+4>>2]|0,d=_+(X<<3)|0,f[d>>2]=E,f[d+4>>2]=h,d=G+1|0,I=(d|0)==(ve|0),P=de+1|0,O=(P|0)==6,Gn(E,h)|0){E=9;break e}if(ve=ve+(O&I&1)|0,(ve|0)>(m|0)){E=0;break}else X=X+1|0,G=I?0:d,de=I?O?0:P:de}else E=0;while(0);return be=E,Ae=ze,be|0}function pe(d,h,m,_,v,E,I,P){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0,E=E|0,I=I|0,P=P|0;var O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0;if(ze=Ae,Ae=Ae+16|0,Re=ze+8|0,be=ze,O=ye(d|0,h|0,E|0,I|0)|0,X=me()|0,de=_+(O<<3)|0,Je=de,Ye=f[Je>>2]|0,Je=f[Je+4>>2]|0,G=(Ye|0)==(d|0)&(Je|0)==(h|0),!((Ye|0)==0&(Je|0)==0|G))do O=M(O|0,X|0,1,0)|0,O=ce(O|0,me()|0,E|0,I|0)|0,X=me()|0,de=_+(O<<3)|0,Ye=de,Je=f[Ye>>2]|0,Ye=f[Ye+4>>2]|0,G=(Je|0)==(d|0)&(Ye|0)==(h|0);while(!((Je|0)==0&(Ye|0)==0|G));if(O=v+(O<<2)|0,G&&(f[O>>2]|0)<=(P|0)||(Ye=de,f[Ye>>2]=d,f[Ye+4>>2]=h,f[O>>2]=P,(P|0)>=(m|0)))return Ye=0,Ae=ze,Ye|0;switch(G=P+1|0,f[Re>>2]=0,O=Ie(d,h,2,Re,be)|0,O|0){case 9:{ve=9;break}case 0:{O=be,O=pe(f[O>>2]|0,f[O+4>>2]|0,m,_,v,E,I,G)|0,O||(ve=9);break}}e:do if((ve|0)==9){switch(f[Re>>2]=0,O=Ie(d,h,3,Re,be)|0,O|0){case 9:break;case 0:{if(O=be,O=pe(f[O>>2]|0,f[O+4>>2]|0,m,_,v,E,I,G)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,h,1,Re,be)|0,O|0){case 9:break;case 0:{if(O=be,O=pe(f[O>>2]|0,f[O+4>>2]|0,m,_,v,E,I,G)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,h,5,Re,be)|0,O|0){case 9:break;case 0:{if(O=be,O=pe(f[O>>2]|0,f[O+4>>2]|0,m,_,v,E,I,G)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,h,4,Re,be)|0,O|0){case 9:break;case 0:{if(O=be,O=pe(f[O>>2]|0,f[O+4>>2]|0,m,_,v,E,I,G)|0,O|0)break e;break}default:break e}switch(f[Re>>2]=0,O=Ie(d,h,6,Re,be)|0,O|0){case 9:break;case 0:{if(O=be,O=pe(f[O>>2]|0,f[O+4>>2]|0,m,_,v,E,I,G)|0,O|0)break e;break}default:break e}return Ye=0,Ae=ze,Ye|0}while(0);return Ye=O,Ae=ze,Ye|0}function Ie(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0;if(m>>>0>6)return v=1,v|0;if(de=(f[_>>2]|0)%6|0,f[_>>2]=de,(de|0)>0){E=0;do m=Cs(m)|0,E=E+1|0;while((E|0)<(f[_>>2]|0))}if(de=oe(d|0,h|0,45)|0,me()|0,X=de&127,X>>>0>121)return v=5,v|0;O=Mi(d,h)|0,E=oe(d|0,h|0,52)|0,me()|0,E=E&15;e:do if(!E)G=8;else{for(;;){if(I=(15-E|0)*3|0,P=oe(d|0,h|0,I|0)|0,me()|0,P=P&7,(P|0)==7){h=5;break}if(be=(Ar(E)|0)==0,E=E+-1|0,ve=ge(7,0,I|0)|0,h=h&~(me()|0),Re=ge(f[(be?432:16)+(P*28|0)+(m<<2)>>2]|0,0,I|0)|0,I=me()|0,m=f[(be?640:224)+(P*28|0)+(m<<2)>>2]|0,d=Re|d&~ve,h=I|h,!m){m=0;break e}if(!E){G=8;break e}}return h|0}while(0);(G|0)==8&&(be=f[848+(X*28|0)+(m<<2)>>2]|0,Re=ge(be|0,0,45)|0,d=Re|d,h=me()|0|h&-1040385,m=f[4272+(X*28|0)+(m<<2)>>2]|0,(be&127|0)==127&&(be=ge(f[848+(X*28|0)+20>>2]|0,0,45)|0,h=me()|0|h&-1040385,m=f[4272+(X*28|0)+20>>2]|0,d=_o(be|d,h)|0,h=me()|0,f[_>>2]=(f[_>>2]|0)+1)),P=oe(d|0,h|0,45)|0,me()|0,P=P&127;e:do if(In(P)|0){t:do if((Mi(d,h)|0)==1){if((X|0)!=(P|0))if(Iu(P,f[7696+(X*28|0)>>2]|0)|0){d=zl(d,h)|0,I=1,h=me()|0;break}else Qt(23313,22416,436,22424);switch(O|0){case 3:{d=_o(d,h)|0,h=me()|0,f[_>>2]=(f[_>>2]|0)+1,I=0;break t}case 5:{d=zl(d,h)|0,h=me()|0,f[_>>2]=(f[_>>2]|0)+5,I=0;break t}case 0:return be=9,be|0;default:return be=1,be|0}}else I=0;while(0);if((m|0)>0){E=0;do d=kc(d,h)|0,h=me()|0,E=E+1|0;while((E|0)!=(m|0))}if((X|0)!=(P|0)){if(!(Tl(P)|0)){if((I|0)!=0|(Mi(d,h)|0)!=5)break;f[_>>2]=(f[_>>2]|0)+1;break}switch(de&127){case 8:case 118:break e}(Mi(d,h)|0)!=3&&(f[_>>2]=(f[_>>2]|0)+1)}}else if((m|0)>0){E=0;do d=_o(d,h)|0,h=me()|0,E=E+1|0;while((E|0)!=(m|0))}while(0);return f[_>>2]=((f[_>>2]|0)+m|0)%6|0,be=v,f[be>>2]=d,f[be+4>>2]=h,be=0,be|0}function qe(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0;for(P=Ae,Ae=Ae+16|0,E=P,I=P+8|0,v=(Gn(d,h)|0)==0,v=v?1:2;;){if(f[I>>2]=0,G=(Ie(d,h,v,I,E)|0)==0,O=E,G&((f[O>>2]|0)==(m|0)?(f[O+4>>2]|0)==(_|0):0)){d=4;break}if(v=v+1|0,v>>>0>=7){v=7,d=4;break}}return(d|0)==4?(Ae=P,v|0):0}function ht(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0;if(be=Ae,Ae=Ae+16|0,ve=be,Re=be+8|0,de=ve,f[de>>2]=d,f[de+4>>2]=h,!m)return Re=_,f[Re>>2]=d,f[Re+4>>2]=h,Re=0,Ae=be,Re|0;f[Re>>2]=0;e:do if(Gn(d,h)|0)d=9;else{if(E=(m|0)>0,E){v=0,de=d;do{if(d=Ie(de,h,4,Re,ve)|0,d|0)break e;if(h=ve,de=f[h>>2]|0,h=f[h+4>>2]|0,v=v+1|0,Gn(de,h)|0){d=9;break e}}while((v|0)<(m|0));if(X=_,f[X>>2]=de,f[X+4>>2]=h,X=m+-1|0,E){G=0,d=1;do{if(v=22384+(G<<2)|0,(G|0)==5)for(I=f[v>>2]|0,E=0,v=d;;){if(d=ve,d=Ie(f[d>>2]|0,f[d+4>>2]|0,I,Re,ve)|0,d|0)break e;if((E|0)!=(X|0))if(O=ve,P=f[O>>2]|0,O=f[O+4>>2]|0,d=_+(v<<3)|0,f[d>>2]=P,f[d+4>>2]=O,!(Gn(P,O)|0))d=v+1|0;else{d=9;break e}else d=v;if(E=E+1|0,(E|0)>=(m|0))break;v=d}else for(I=ve,O=f[v>>2]|0,P=0,v=d,E=f[I>>2]|0,I=f[I+4>>2]|0;;){if(d=Ie(E,I,O,Re,ve)|0,d|0)break e;if(I=ve,E=f[I>>2]|0,I=f[I+4>>2]|0,d=_+(v<<3)|0,f[d>>2]=E,f[d+4>>2]=I,d=v+1|0,Gn(E,I)|0){d=9;break e}if(P=P+1|0,(P|0)>=(m|0))break;v=d}G=G+1|0}while(G>>>0<6);d=ve,I=de,v=f[d>>2]|0,E=h,d=f[d+4>>2]|0}else I=de,v=de,E=h,d=h}else I=_,f[I>>2]=d,f[I+4>>2]=h,I=d,v=d,E=h,d=h;d=(I|0)==(v|0)&(E|0)==(d|0)?0:9}while(0);return Re=d,Ae=be,Re|0}function zt(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0;if(P=Ae,Ae=Ae+48|0,v=P+16|0,E=P+8|0,I=P,m|0)return I=15,Ae=P,I|0;if(G=d,O=f[G+4>>2]|0,m=E,f[m>>2]=f[G>>2],f[m+4>>2]=O,Do(E,v),h=Cu(v,h,I)|0,!h){if(m=f[E>>2]|0,E=f[d+8>>2]|0,(E|0)>0){v=f[d+12>>2]|0,h=0;do m=(f[v+(h<<3)>>2]|0)+m|0,h=h+1|0;while((h|0)<(E|0))}h=I,v=f[h>>2]|0,h=f[h+4>>2]|0,E=((m|0)<0)<<31>>31,(h|0)<(E|0)|(h|0)==(E|0)&v>>>0<m>>>0?(h=I,f[h>>2]=m,f[h+4>>2]=E,h=E):m=v,O=M(m|0,h|0,12,0)|0,G=me()|0,h=I,f[h>>2]=O,f[h+4>>2]=G,h=_,f[h>>2]=O,f[h+4>>2]=G,h=0}return G=h,Ae=P,G|0}function An(d,h,m,_,v,E,I){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0,E=E|0,I=I|0;var P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0,Be=0,bt=0,yt=0,ot=0,ut=0,cn=0,on=0,Kt=0,tn=0,sn=0,fn=0,zn=0,un=0,$n=0,ci=0,fs=0;if(zn=Ae,Ae=Ae+64|0,Kt=zn+48|0,tn=zn+32|0,sn=zn+24|0,bt=zn+8|0,yt=zn,O=f[d>>2]|0,(O|0)<=0)return fn=0,Ae=zn,fn|0;for(ot=d+4|0,ut=Kt+8|0,cn=tn+8|0,on=bt+8|0,P=0,$e=0;;){G=f[ot>>2]|0,He=G+($e<<4)|0,f[Kt>>2]=f[He>>2],f[Kt+4>>2]=f[He+4>>2],f[Kt+8>>2]=f[He+8>>2],f[Kt+12>>2]=f[He+12>>2],($e|0)==(O+-1|0)?(f[tn>>2]=f[G>>2],f[tn+4>>2]=f[G+4>>2],f[tn+8>>2]=f[G+8>>2],f[tn+12>>2]=f[G+12>>2]):(He=G+($e+1<<4)|0,f[tn>>2]=f[He>>2],f[tn+4>>2]=f[He+4>>2],f[tn+8>>2]=f[He+8>>2],f[tn+12>>2]=f[He+12>>2]),O=Da(Kt,tn,_,sn)|0;e:do if(O)G=0,P=O;else if(G=sn,O=f[G>>2]|0,G=f[G+4>>2]|0,(G|0)>0|(G|0)==0&O>>>0>0){Ye=0,He=0;t:for(;;){if(fs=+H[Kt>>3],Je=L(O|0,G|0,Ye|0,He|0)|0,ci=+(Je>>>0)+4294967296*+(me()|0),un=+(O>>>0)+4294967296*+(G|0),$n=+(Ye>>>0)+4294967296*+(He|0),H[bt>>3]=fs*ci/un+ +H[tn>>3]*$n/un,H[on>>3]=+H[ut>>3]*ci/un+ +H[cn>>3]*$n/un,O=Za(bt,_,yt)|0,O|0){P=O;break}Je=yt,ze=f[Je>>2]|0,Je=f[Je+4>>2]|0,ve=ye(ze|0,Je|0,h|0,m|0)|0,X=me()|0,O=I+(ve<<3)|0,de=O,G=f[de>>2]|0,de=f[de+4>>2]|0;n:do if((G|0)==0&(de|0)==0)Be=O,fn=16;else for(Re=0,be=0;;){if((Re|0)>(m|0)|(Re|0)==(m|0)&be>>>0>h>>>0){P=1;break t}if((G|0)==(ze|0)&(de|0)==(Je|0))break n;if(O=M(ve|0,X|0,1,0)|0,ve=ce(O|0,me()|0,h|0,m|0)|0,X=me()|0,be=M(be|0,Re|0,1,0)|0,Re=me()|0,O=I+(ve<<3)|0,de=O,G=f[de>>2]|0,de=f[de+4>>2]|0,(G|0)==0&(de|0)==0){Be=O,fn=16;break}}while(0);if((fn|0)==16&&(fn=0,!((ze|0)==0&(Je|0)==0))&&(be=Be,f[be>>2]=ze,f[be+4>>2]=Je,be=E+(f[v>>2]<<3)|0,f[be>>2]=ze,f[be+4>>2]=Je,be=v,be=M(f[be>>2]|0,f[be+4>>2]|0,1,0)|0,ze=me()|0,Je=v,f[Je>>2]=be,f[Je+4>>2]=ze),Ye=M(Ye|0,He|0,1,0)|0,He=me()|0,G=sn,O=f[G>>2]|0,G=f[G+4>>2]|0,!((G|0)>(He|0)|(G|0)==(He|0)&O>>>0>Ye>>>0)){G=1;break e}}G=0}else G=1;while(0);if($e=$e+1|0,!G){fn=21;break}if(O=f[d>>2]|0,($e|0)>=(O|0)){P=0,fn=21;break}}return(fn|0)==21?(Ae=zn,P|0):0}function ei(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0,Be=0,bt=0,yt=0,ot=0,ut=0,cn=0,on=0,Kt=0,tn=0,sn=0,fn=0,zn=0,un=0,$n=0,ci=0;if(ci=Ae,Ae=Ae+112|0,fn=ci+80|0,O=ci+72|0,zn=ci,un=ci+56|0,m|0)return $n=15,Ae=ci,$n|0;if(G=d+8|0,$n=A((f[G>>2]<<5)+32|0)|0,!$n)return $n=13,Ae=ci,$n|0;if(qu(d,$n),tn=d,sn=f[tn+4>>2]|0,m=O,f[m>>2]=f[tn>>2],f[m+4>>2]=sn,Do(O,fn),m=Cu(fn,h,zn)|0,m)tn=0,sn=0;else{if(m=f[O>>2]|0,E=f[G>>2]|0,(E|0)>0){I=f[d+12>>2]|0,v=0;do m=(f[I+(v<<3)>>2]|0)+m|0,v=v+1|0;while((v|0)!=(E|0));v=m}else v=m;m=zn,E=f[m>>2]|0,m=f[m+4>>2]|0,I=((v|0)<0)<<31>>31,(m|0)<(I|0)|(m|0)==(I|0)&E>>>0<v>>>0?(m=zn,f[m>>2]=v,f[m+4>>2]=I,m=I):v=E,tn=M(v|0,m|0,12,0)|0,sn=me()|0,m=zn,f[m>>2]=tn,f[m+4>>2]=sn,m=0}if(m|0)return y($n),$n=m,Ae=ci,$n|0;if(v=w(tn,8)|0,!v)return y($n),$n=13,Ae=ci,$n|0;if(P=w(tn,8)|0,!P)return y($n),y(v),$n=13,Ae=ci,$n|0;on=fn,f[on>>2]=0,f[on+4>>2]=0,on=d,Kt=f[on+4>>2]|0,m=O,f[m>>2]=f[on>>2],f[m+4>>2]=Kt,m=An(O,tn,sn,h,fn,v,P)|0;e:do if(m)y(v),y(P),y($n);else{t:do if((f[G>>2]|0)>0){for(I=d+12|0,E=0;m=An((f[I>>2]|0)+(E<<3)|0,tn,sn,h,fn,v,P)|0,E=E+1|0,!(m|0);)if((E|0)>=(f[G>>2]|0))break t;y(v),y(P),y($n);break e}while(0);(sn|0)>0|(sn|0)==0&tn>>>0>0&&je(P|0,0,tn<<3|0)|0,Kt=fn,on=f[Kt+4>>2]|0;t:do if((on|0)>0|(on|0)==0&(f[Kt>>2]|0)>>>0>0){ot=v,ut=P,cn=v,on=P,Kt=v,m=v,Be=v,bt=P,yt=P,v=P;n:for(;;){for(Je=0,Ye=0,He=0,$e=0,E=0,I=0;;){P=zn,O=P+56|0;do f[P>>2]=0,P=P+4|0;while((P|0)<(O|0));if(h=ot+(Je<<3)|0,G=f[h>>2]|0,h=f[h+4>>2]|0,ue(G,h,1,zn,0)|0){P=zn,O=P+56|0;do f[P>>2]=0,P=P+4|0;while((P|0)<(O|0));P=w(7,4)|0,P|0&&(pe(G,h,1,zn,P,7,0,0)|0,y(P))}for(ze=0;;){be=zn+(ze<<3)|0,Re=f[be>>2]|0,be=f[be+4>>2]|0;i:do if((Re|0)==0&(be|0)==0)P=E,O=I;else{if(X=ye(Re|0,be|0,tn|0,sn|0)|0,G=me()|0,P=_+(X<<3)|0,h=P,O=f[h>>2]|0,h=f[h+4>>2]|0,!((O|0)==0&(h|0)==0)){de=0,ve=0;do{if((de|0)>(sn|0)|(de|0)==(sn|0)&ve>>>0>tn>>>0)break n;if((O|0)==(Re|0)&(h|0)==(be|0)){P=E,O=I;break i}P=M(X|0,G|0,1,0)|0,X=ce(P|0,me()|0,tn|0,sn|0)|0,G=me()|0,ve=M(ve|0,de|0,1,0)|0,de=me()|0,P=_+(X<<3)|0,h=P,O=f[h>>2]|0,h=f[h+4>>2]|0}while(!((O|0)==0&(h|0)==0))}(Re|0)==0&(be|0)==0?(P=E,O=I):(Lo(Re,be,un)|0,ha(d,$n,un)|0&&(ve=M(E|0,I|0,1,0)|0,I=me()|0,de=P,f[de>>2]=Re,f[de+4>>2]=be,E=ut+(E<<3)|0,f[E>>2]=Re,f[E+4>>2]=be,E=ve),P=E,O=I)}while(0);if(ze=ze+1|0,ze>>>0>=7)break;E=P,I=O}if(Je=M(Je|0,Ye|0,1,0)|0,Ye=me()|0,He=M(He|0,$e|0,1,0)|0,$e=me()|0,I=fn,E=f[I>>2]|0,I=f[I+4>>2]|0,($e|0)<(I|0)|($e|0)==(I|0)&He>>>0<E>>>0)E=P,I=O;else break}if((I|0)>0|(I|0)==0&E>>>0>0){E=0,I=0;do $e=ot+(E<<3)|0,f[$e>>2]=0,f[$e+4>>2]=0,E=M(E|0,I|0,1,0)|0,I=me()|0,$e=fn,He=f[$e+4>>2]|0;while((I|0)<(He|0)|((I|0)==(He|0)?E>>>0<(f[$e>>2]|0)>>>0:0))}if($e=fn,f[$e>>2]=P,f[$e+4>>2]=O,(O|0)>0|(O|0)==0&P>>>0>0)ze=v,Je=yt,Ye=Kt,He=bt,$e=ut,v=Be,yt=m,bt=cn,Be=ze,m=Je,Kt=on,on=Ye,cn=He,ut=ot,ot=$e;else break t}y(cn),y(on),y($n),m=1;break e}else m=P;while(0);y($n),y(v),y(m),m=0}while(0);return $n=m,Ae=ci,$n|0}function pn(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0;if(X=Ae,Ae=Ae+176|0,O=X,(h|0)<1)return zo(m,0,0),G=0,Ae=X,G|0;for(P=d,P=oe(f[P>>2]|0,f[P+4>>2]|0,52)|0,me()|0,zo(m,(h|0)>6?h:6,P&15),P=0;_=d+(P<<3)|0,_=sa(f[_>>2]|0,f[_+4>>2]|0,O)|0,!(_|0);){if(_=f[O>>2]|0,(_|0)>0){I=0;do E=O+8+(I<<4)|0,I=I+1|0,_=O+8+(((I|0)%(_|0)|0)<<4)|0,v=bi(m,_,E)|0,v?Bo(m,v)|0:li(m,E,_)|0,_=f[O>>2]|0;while((I|0)<(_|0))}if(P=P+1|0,(P|0)>=(h|0)){_=0,G=13;break}}return(G|0)==13?(Ae=X,_|0):(no(m),G=_,Ae=X,G|0)}function gi(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0;if(E=Ae,Ae=Ae+32|0,_=E,v=E+16|0,d=pn(d,h,v)|0,d|0)return m=d,Ae=E,m|0;if(f[m>>2]=0,f[m+4>>2]=0,f[m+8>>2]=0,d=jc(v)|0,d|0)do{h=St(m)|0;do Ol(h,d)|0,I=d+16|0,f[_>>2]=f[I>>2],f[_+4>>2]=f[I+4>>2],f[_+8>>2]=f[I+8>>2],f[_+12>>2]=f[I+12>>2],Bo(v,d)|0,d=Gc(v,_)|0;while(d|0);d=jc(v)|0}while(d|0);return no(v),d=Dc(m)|0,d?(Wu(m),I=d,Ae=E,I|0):(I=0,Ae=E,I|0)}function In(d){return d=d|0,d>>>0>121?(d=0,d|0):(d=f[7696+(d*28|0)+16>>2]|0,d|0)}function Tl(d){return d=d|0,(d|0)==4|(d|0)==117|0}function Sl(d){return d=d|0,f[11120+((f[d>>2]|0)*216|0)+((f[d+4>>2]|0)*72|0)+((f[d+8>>2]|0)*24|0)+(f[d+12>>2]<<3)>>2]|0}function Ml(d){return d=d|0,f[11120+((f[d>>2]|0)*216|0)+((f[d+4>>2]|0)*72|0)+((f[d+8>>2]|0)*24|0)+(f[d+12>>2]<<3)+4>>2]|0}function Mu(d,h){d=d|0,h=h|0,d=7696+(d*28|0)|0,f[h>>2]=f[d>>2],f[h+4>>2]=f[d+4>>2],f[h+8>>2]=f[d+8>>2],f[h+12>>2]=f[d+12>>2]}function Eh(d,h){d=d|0,h=h|0;var m=0,_=0;if(h>>>0>20)return h=-1,h|0;do if((f[11120+(h*216|0)>>2]|0)!=(d|0))if((f[11120+(h*216|0)+8>>2]|0)!=(d|0))if((f[11120+(h*216|0)+16>>2]|0)!=(d|0))if((f[11120+(h*216|0)+24>>2]|0)!=(d|0))if((f[11120+(h*216|0)+32>>2]|0)!=(d|0))if((f[11120+(h*216|0)+40>>2]|0)!=(d|0))if((f[11120+(h*216|0)+48>>2]|0)!=(d|0))if((f[11120+(h*216|0)+56>>2]|0)!=(d|0))if((f[11120+(h*216|0)+64>>2]|0)!=(d|0))if((f[11120+(h*216|0)+72>>2]|0)!=(d|0))if((f[11120+(h*216|0)+80>>2]|0)!=(d|0))if((f[11120+(h*216|0)+88>>2]|0)!=(d|0))if((f[11120+(h*216|0)+96>>2]|0)!=(d|0))if((f[11120+(h*216|0)+104>>2]|0)!=(d|0))if((f[11120+(h*216|0)+112>>2]|0)!=(d|0))if((f[11120+(h*216|0)+120>>2]|0)!=(d|0))if((f[11120+(h*216|0)+128>>2]|0)!=(d|0))if((f[11120+(h*216|0)+136>>2]|0)==(d|0))d=2,m=1,_=2;else{if((f[11120+(h*216|0)+144>>2]|0)==(d|0)){d=0,m=2,_=0;break}if((f[11120+(h*216|0)+152>>2]|0)==(d|0)){d=0,m=2,_=1;break}if((f[11120+(h*216|0)+160>>2]|0)==(d|0)){d=0,m=2,_=2;break}if((f[11120+(h*216|0)+168>>2]|0)==(d|0)){d=1,m=2,_=0;break}if((f[11120+(h*216|0)+176>>2]|0)==(d|0)){d=1,m=2,_=1;break}if((f[11120+(h*216|0)+184>>2]|0)==(d|0)){d=1,m=2,_=2;break}if((f[11120+(h*216|0)+192>>2]|0)==(d|0)){d=2,m=2,_=0;break}if((f[11120+(h*216|0)+200>>2]|0)==(d|0)){d=2,m=2,_=1;break}if((f[11120+(h*216|0)+208>>2]|0)==(d|0)){d=2,m=2,_=2;break}else d=-1;return d|0}else d=2,m=1,_=1;else d=2,m=1,_=0;else d=1,m=1,_=2;else d=1,m=1,_=1;else d=1,m=1,_=0;else d=0,m=1,_=2;else d=0,m=1,_=1;else d=0,m=1,_=0;else d=2,m=0,_=2;else d=2,m=0,_=1;else d=2,m=0,_=0;else d=1,m=0,_=2;else d=1,m=0,_=1;else d=1,m=0,_=0;else d=0,m=0,_=2;else d=0,m=0,_=1;else d=0,m=0,_=0;while(0);return h=f[11120+(h*216|0)+(m*72|0)+(d*24|0)+(_<<3)+4>>2]|0,h|0}function Iu(d,h){return d=d|0,h=h|0,(f[7696+(d*28|0)+20>>2]|0)==(h|0)?(h=1,h|0):(h=(f[7696+(d*28|0)+24>>2]|0)==(h|0),h|0)}function La(d,h){return d=d|0,h=h|0,f[848+(d*28|0)+(h<<2)>>2]|0}function Ra(d,h){return d=d|0,h=h|0,(f[848+(d*28|0)>>2]|0)==(h|0)?(h=0,h|0):(f[848+(d*28|0)+4>>2]|0)==(h|0)?(h=1,h|0):(f[848+(d*28|0)+8>>2]|0)==(h|0)?(h=2,h|0):(f[848+(d*28|0)+12>>2]|0)==(h|0)?(h=3,h|0):(f[848+(d*28|0)+16>>2]|0)==(h|0)?(h=4,h|0):(f[848+(d*28|0)+20>>2]|0)==(h|0)?(h=5,h|0):((f[848+(d*28|0)+24>>2]|0)==(h|0)?6:7)|0}function wc(){return 122}function bc(d){d=d|0;var h=0,m=0,_=0;h=0;do ge(h|0,0,45)|0,_=me()|0|134225919,m=d+(h<<3)|0,f[m>>2]=-1,f[m+4>>2]=_,h=h+1|0;while((h|0)!=122);return 0}function Dn(d){return d=d|0,+H[d+16>>3]<+H[d+24>>3]|0}function Ec(d,h){d=d|0,h=h|0;var m=0,_=0,v=0;return m=+H[h>>3],!(m>=+H[d+8>>3])||!(m<=+H[d>>3])?(h=0,h|0):(_=+H[d+16>>3],m=+H[d+24>>3],v=+H[h+8>>3],h=v>=m,d=v<=_&1,_<m?h&&(d=1):h||(d=0),h=(d|0)!=0,h|0)}function Cu(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0;be=Ae,Ae=Ae+288|0,X=be+264|0,de=be+96|0,G=be,P=G,O=P+96|0;do f[P>>2]=0,P=P+4|0;while((P|0)<(O|0));return h=Bl(h,G)|0,h|0?(Re=h,Ae=be,Re|0):(O=G,G=f[O>>2]|0,O=f[O+4>>2]|0,Lo(G,O,X)|0,sa(G,O,de)|0,I=+Qa(X,de+8|0),H[X>>3]=+H[d>>3],O=X+8|0,H[O>>3]=+H[d+16>>3],H[de>>3]=+H[d+8>>3],G=de+8|0,H[G>>3]=+H[d+24>>3],v=+Qa(X,de),Je=+H[O>>3]-+H[G>>3],E=+Me(+Je),ze=+H[X>>3]-+H[de>>3],_=+Me(+ze),!(Je==0|ze==0)&&(Je=+De(+E,+_),Je=+Gt(+(v*v/+Ve(+(Je/+Ve(+E,+_)),3)/(I*(I*2.59807621135)*.8))),H[ke>>3]=Je,ve=~~Je>>>0,Re=+Me(Je)>=1?Je>0?~~+dn(+we(Je/4294967296),4294967295)>>>0:~~+Gt((Je-+(~~Je>>>0))/4294967296)>>>0:0,(f[ke+4>>2]&2146435072|0)!=2146435072)?(de=(ve|0)==0&(Re|0)==0,h=m,f[h>>2]=de?1:ve,f[h+4>>2]=de?0:Re,h=0):h=1,Re=h,Ae=be,Re|0)}function Da(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0,X=0;G=Ae,Ae=Ae+288|0,I=G+264|0,P=G+96|0,O=G,v=O,E=v+96|0;do f[v>>2]=0,v=v+4|0;while((v|0)<(E|0));return m=Bl(m,O)|0,m|0?(_=m,Ae=G,_|0):(m=O,v=f[m>>2]|0,m=f[m+4>>2]|0,Lo(v,m,I)|0,sa(v,m,P)|0,X=+Qa(I,P+8|0),X=+Gt(+(+Qa(d,h)/(X*2))),H[ke>>3]=X,m=~~X>>>0,v=+Me(X)>=1?X>0?~~+dn(+we(X/4294967296),4294967295)>>>0:~~+Gt((X-+(~~X>>>0))/4294967296)>>>0:0,(f[ke+4>>2]&2146435072|0)==2146435072?(_=1,Ae=G,_|0):(O=(m|0)==0&(v|0)==0,f[_>>2]=O?1:m,f[_+4>>2]=O?0:v,_=0,Ae=G,_|0))}function za(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0,f[d>>2]=h,f[d+4>>2]=m,f[d+8>>2]=_}function ku(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0;de=h+8|0,f[de>>2]=0,O=+H[d>>3],I=+Me(+O),G=+H[d+8>>3],P=+Me(+G)/.8660254037844386,I=I+P*.5,m=~~I,d=~~P,I=I-+(m|0),P=P-+(d|0);do if(I<.5)if(I<.3333333333333333)if(f[h>>2]=m,P<(I+1)*.5){f[h+4>>2]=d;break}else{d=d+1|0,f[h+4>>2]=d;break}else if(ve=1-I,d=(!(P<ve)&1)+d|0,f[h+4>>2]=d,ve<=P&P<I*2){m=m+1|0,f[h>>2]=m;break}else{f[h>>2]=m;break}else{if(!(I<.6666666666666666))if(m=m+1|0,f[h>>2]=m,P<I*.5){f[h+4>>2]=d;break}else{d=d+1|0,f[h+4>>2]=d;break}if(P<1-I){if(f[h+4>>2]=d,I*2+-1<P){f[h>>2]=m;break}}else d=d+1|0,f[h+4>>2]=d;m=m+1|0,f[h>>2]=m}while(0);do if(O<0)if(d&1){X=(d+1|0)/2|0,X=L(m|0,((m|0)<0)<<31>>31|0,X|0,((X|0)<0)<<31>>31|0)|0,m=~~(+(m|0)-((+(X>>>0)+4294967296*+(me()|0))*2+1)),f[h>>2]=m;break}else{X=(d|0)/2|0,X=L(m|0,((m|0)<0)<<31>>31|0,X|0,((X|0)<0)<<31>>31|0)|0,m=~~(+(m|0)-(+(X>>>0)+4294967296*+(me()|0))*2),f[h>>2]=m;break}while(0);X=h+4|0,G<0&&(m=m-((d<<1|1|0)/2|0)|0,f[h>>2]=m,d=0-d|0,f[X>>2]=d),_=d-m|0,(m|0)<0?(v=0-m|0,f[X>>2]=_,f[de>>2]=v,f[h>>2]=0,d=_,m=0):v=0,(d|0)<0&&(m=m-d|0,f[h>>2]=m,v=v-d|0,f[de>>2]=v,f[X>>2]=0,d=0),E=m-v|0,_=d-v|0,(v|0)<0&&(f[h>>2]=E,f[X>>2]=_,f[de>>2]=0,d=_,m=E,v=0),_=(d|0)<(m|0)?d:m,_=(v|0)<(_|0)?v:_,!((_|0)<=0)&&(f[h>>2]=m-_,f[X>>2]=d-_,f[de>>2]=v-_)}function Zn(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0;h=f[d>>2]|0,I=d+4|0,m=f[I>>2]|0,(h|0)<0&&(m=m-h|0,f[I>>2]=m,E=d+8|0,f[E>>2]=(f[E>>2]|0)-h,f[d>>2]=0,h=0),(m|0)<0?(h=h-m|0,f[d>>2]=h,E=d+8|0,v=(f[E>>2]|0)-m|0,f[E>>2]=v,f[I>>2]=0,m=0):(v=d+8|0,E=v,v=f[v>>2]|0),(v|0)<0&&(h=h-v|0,f[d>>2]=h,m=m-v|0,f[I>>2]=m,f[E>>2]=0,v=0),_=(m|0)<(h|0)?m:h,_=(v|0)<(_|0)?v:_,!((_|0)<=0)&&(f[d>>2]=h-_,f[I>>2]=m-_,f[E>>2]=v-_)}function Po(d,h){d=d|0,h=h|0;var m=0,_=0;_=f[d+8>>2]|0,m=+((f[d+4>>2]|0)-_|0),H[h>>3]=+((f[d>>2]|0)-_|0)-m*.5,H[h+8>>3]=m*.8660254037844386}function Oi(d,h,m){d=d|0,h=h|0,m=m|0,f[m>>2]=(f[h>>2]|0)+(f[d>>2]|0),f[m+4>>2]=(f[h+4>>2]|0)+(f[d+4>>2]|0),f[m+8>>2]=(f[h+8>>2]|0)+(f[d+8>>2]|0)}function ea(d,h,m){d=d|0,h=h|0,m=m|0,f[m>>2]=(f[d>>2]|0)-(f[h>>2]|0),f[m+4>>2]=(f[d+4>>2]|0)-(f[h+4>>2]|0),f[m+8>>2]=(f[d+8>>2]|0)-(f[h+8>>2]|0)}function Il(d,h){d=d|0,h=h|0;var m=0,_=0;m=Wt(f[d>>2]|0,h)|0,f[d>>2]=m,m=d+4|0,_=Wt(f[m>>2]|0,h)|0,f[m>>2]=_,d=d+8|0,h=Wt(f[d>>2]|0,h)|0,f[d>>2]=h}function ta(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;I=f[d>>2]|0,P=(I|0)<0,_=(f[d+4>>2]|0)-(P?I:0)|0,E=(_|0)<0,v=(E?0-_|0:0)+((f[d+8>>2]|0)-(P?I:0))|0,m=(v|0)<0,d=m?0:v,h=(E?0:_)-(m?v:0)|0,v=(P?0:I)-(E?_:0)-(m?v:0)|0,m=(h|0)<(v|0)?h:v,m=(d|0)<(m|0)?d:m,_=(m|0)>0,d=d-(_?m:0)|0,h=h-(_?m:0)|0;e:do switch(v-(_?m:0)|0){case 0:switch(h|0){case 0:return P=d|0?(d|0)==1?1:7:0,P|0;case 1:return P=d|0?(d|0)==1?3:7:2,P|0;default:break e}case 1:switch(h|0){case 0:return P=d|0?(d|0)==1?5:7:4,P|0;case 1:{if(!d)d=6;else break e;return d|0}default:break e}}while(0);return P=7,P|0}function Cl(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;I=d+8|0,v=f[I>>2]|0,E=(f[d>>2]|0)-v|0,P=d+4|0,v=(f[P>>2]|0)-v|0;do if(E>>>0>715827881|v>>>0>715827881){if(m=(E|0)>0,m){if((2147483647-E|0)<(E|0)||(2147483647-(E<<1)|0)<(E|0))return P=1,P|0}else if((-2147483648-E|0)>(E|0)||(-2147483648-(E<<1)|0)>(E|0))return P=1,P|0;if(h=E*3|0,(v|0)>0){if((2147483647-v|0)<(v|0))return P=1,P|0}else if((-2147483648-v|0)>(v|0))return P=1,P|0;if(_=v<<1,(E|0)>-1){if((h|-2147483648|0)>=(v|0))return P=1,P|0}else if((h^-2147483648|0)<(v|0))return P=1,P|0;if(m){if((2147483647-E|0)<(_|0))h=1;else{m=_;break}return h|0}else{if((-2147483648-E|0)>(_|0))h=1;else{m=_;break}return h|0}}else m=v<<1,h=E*3|0;while(0);_=s(+(h-v|0)/7)|0,f[d>>2]=_,v=s(+(m+E|0)/7)|0,f[P>>2]=v,f[I>>2]=0,m=(v|0)<(_|0),h=m?_:v,m=m?v:_;do if((m|0)<0){if((h|0)>0){if((h|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-h|0)>=(m|0)))break;Qt(23313,22444,355,22455)}if((m|0)==-2147483648|(-2147483648-h|0)>(m|0)&&Qt(23313,22444,355,22455),(h|0)>-1){if((h|-2147483648|0)<(m|0))break;Qt(23313,22444,355,22455)}else{if((h^-2147483648|0)>=(m|0))break;Qt(23313,22444,355,22455)}}while(0);return h=v-_|0,(_|0)<0?(m=0-_|0,f[P>>2]=h,f[I>>2]=m,f[d>>2]=0,_=0):(h=v,m=0),(h|0)<0&&(_=_-h|0,f[d>>2]=_,m=m-h|0,f[I>>2]=m,f[P>>2]=0,h=0),E=_-m|0,v=h-m|0,(m|0)<0?(f[d>>2]=E,f[P>>2]=v,f[I>>2]=0,h=v,v=E,m=0):v=_,_=(h|0)<(v|0)?h:v,_=(m|0)<(_|0)?m:_,(_|0)<=0?(P=0,P|0):(f[d>>2]=v-_,f[P>>2]=h-_,f[I>>2]=m-_,P=0,P|0)}function Tc(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;I=d+8|0,v=f[I>>2]|0,E=(f[d>>2]|0)-v|0,P=d+4|0,v=(f[P>>2]|0)-v|0;do if(E>>>0>715827881|v>>>0>715827881){if(m=(E|0)>0,m){if((2147483647-E|0)<(E|0))return P=1,P|0}else if((-2147483648-E|0)>(E|0))return P=1,P|0;if(h=E<<1,(v|0)>0){if((2147483647-v|0)<(v|0)||(2147483647-(v<<1)|0)<(v|0))return P=1,P|0}else if((-2147483648-v|0)>(v|0)||(-2147483648-(v<<1)|0)>(v|0))return P=1,P|0;if(_=v*3|0,m){if((2147483647-h|0)<(v|0))return P=1,P|0}else if((-2147483648-h|0)>(v|0))return P=1,P|0;if((v|0)>-1){if((_|-2147483648|0)<(E|0)){m=_;break}else h=1;return h|0}else{if((_^-2147483648|0)<(E|0))h=1;else{m=_;break}return h|0}}else m=v*3|0,h=E<<1;while(0);_=s(+(h+v|0)/7)|0,f[d>>2]=_,v=s(+(m-E|0)/7)|0,f[P>>2]=v,f[I>>2]=0,m=(v|0)<(_|0),h=m?_:v,m=m?v:_;do if((m|0)<0){if((h|0)>0){if((h|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-h|0)>=(m|0)))break;Qt(23313,22444,404,22469)}if((m|0)==-2147483648|(-2147483648-h|0)>(m|0)&&Qt(23313,22444,404,22469),(h|0)>-1){if((h|-2147483648|0)<(m|0))break;Qt(23313,22444,404,22469)}else{if((h^-2147483648|0)>=(m|0))break;Qt(23313,22444,404,22469)}}while(0);return h=v-_|0,(_|0)<0?(m=0-_|0,f[P>>2]=h,f[I>>2]=m,f[d>>2]=0,_=0):(h=v,m=0),(h|0)<0&&(_=_-h|0,f[d>>2]=_,m=m-h|0,f[I>>2]=m,f[P>>2]=0,h=0),E=_-m|0,v=h-m|0,(m|0)<0?(f[d>>2]=E,f[P>>2]=v,f[I>>2]=0,h=v,v=E,m=0):v=_,_=(h|0)<(v|0)?h:v,_=(m|0)<(_|0)?m:_,(_|0)<=0?(P=0,P|0):(f[d>>2]=v-_,f[P>>2]=h-_,f[I>>2]=m-_,P=0,P|0)}function Sc(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;I=d+8|0,m=f[I>>2]|0,h=(f[d>>2]|0)-m|0,P=d+4|0,m=(f[P>>2]|0)-m|0,_=s(+((h*3|0)-m|0)/7)|0,f[d>>2]=_,h=s(+((m<<1)+h|0)/7)|0,f[P>>2]=h,f[I>>2]=0,m=h-_|0,(_|0)<0?(E=0-_|0,f[P>>2]=m,f[I>>2]=E,f[d>>2]=0,h=m,_=0,m=E):m=0,(h|0)<0&&(_=_-h|0,f[d>>2]=_,m=m-h|0,f[I>>2]=m,f[P>>2]=0,h=0),E=_-m|0,v=h-m|0,(m|0)<0?(f[d>>2]=E,f[P>>2]=v,f[I>>2]=0,h=v,v=E,m=0):v=_,_=(h|0)<(v|0)?h:v,_=(m|0)<(_|0)?m:_,!((_|0)<=0)&&(f[d>>2]=v-_,f[P>>2]=h-_,f[I>>2]=m-_)}function Ba(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;I=d+8|0,m=f[I>>2]|0,h=(f[d>>2]|0)-m|0,P=d+4|0,m=(f[P>>2]|0)-m|0,_=s(+((h<<1)+m|0)/7)|0,f[d>>2]=_,h=s(+((m*3|0)-h|0)/7)|0,f[P>>2]=h,f[I>>2]=0,m=h-_|0,(_|0)<0?(E=0-_|0,f[P>>2]=m,f[I>>2]=E,f[d>>2]=0,h=m,_=0,m=E):m=0,(h|0)<0&&(_=_-h|0,f[d>>2]=_,m=m-h|0,f[I>>2]=m,f[P>>2]=0,h=0),E=_-m|0,v=h-m|0,(m|0)<0?(f[d>>2]=E,f[P>>2]=v,f[I>>2]=0,h=v,v=E,m=0):v=_,_=(h|0)<(v|0)?h:v,_=(m|0)<(_|0)?m:_,!((_|0)<=0)&&(f[d>>2]=v-_,f[P>>2]=h-_,f[I>>2]=m-_)}function Oa(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;h=f[d>>2]|0,I=d+4|0,m=f[I>>2]|0,P=d+8|0,_=f[P>>2]|0,v=m+(h*3|0)|0,f[d>>2]=v,m=_+(m*3|0)|0,f[I>>2]=m,h=(_*3|0)+h|0,f[P>>2]=h,_=m-v|0,(v|0)<0?(h=h-v|0,f[I>>2]=_,f[P>>2]=h,f[d>>2]=0,m=_,_=0):_=v,(m|0)<0&&(_=_-m|0,f[d>>2]=_,h=h-m|0,f[P>>2]=h,f[I>>2]=0,m=0),E=_-h|0,v=m-h|0,(h|0)<0?(f[d>>2]=E,f[I>>2]=v,f[P>>2]=0,_=E,h=0):v=m,m=(v|0)<(_|0)?v:_,m=(h|0)<(m|0)?h:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[I>>2]=v-m,f[P>>2]=h-m)}function os(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;v=f[d>>2]|0,I=d+4|0,h=f[I>>2]|0,P=d+8|0,m=f[P>>2]|0,_=(h*3|0)+v|0,v=m+(v*3|0)|0,f[d>>2]=v,f[I>>2]=_,h=(m*3|0)+h|0,f[P>>2]=h,m=_-v|0,(v|0)<0?(h=h-v|0,f[I>>2]=m,f[P>>2]=h,f[d>>2]=0,v=0):m=_,(m|0)<0&&(v=v-m|0,f[d>>2]=v,h=h-m|0,f[P>>2]=h,f[I>>2]=0,m=0),E=v-h|0,_=m-h|0,(h|0)<0?(f[d>>2]=E,f[I>>2]=_,f[P>>2]=0,v=E,h=0):_=m,m=(_|0)<(v|0)?_:v,m=(h|0)<(m|0)?h:m,!((m|0)<=0)&&(f[d>>2]=v-m,f[I>>2]=_-m,f[P>>2]=h-m)}function Is(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0;(h+-1|0)>>>0>=6||(v=(f[15440+(h*12|0)>>2]|0)+(f[d>>2]|0)|0,f[d>>2]=v,P=d+4|0,_=(f[15440+(h*12|0)+4>>2]|0)+(f[P>>2]|0)|0,f[P>>2]=_,I=d+8|0,h=(f[15440+(h*12|0)+8>>2]|0)+(f[I>>2]|0)|0,f[I>>2]=h,m=_-v|0,(v|0)<0?(h=h-v|0,f[P>>2]=m,f[I>>2]=h,f[d>>2]=0,_=0):(m=_,_=v),(m|0)<0&&(_=_-m|0,f[d>>2]=_,h=h-m|0,f[I>>2]=h,f[P>>2]=0,m=0),E=_-h|0,v=m-h|0,(h|0)<0?(f[d>>2]=E,f[P>>2]=v,f[I>>2]=0,_=E,h=0):v=m,m=(v|0)<(_|0)?v:_,m=(h|0)<(m|0)?h:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[P>>2]=v-m,f[I>>2]=h-m))}function Pu(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;v=f[d>>2]|0,I=d+4|0,h=f[I>>2]|0,P=d+8|0,m=f[P>>2]|0,_=h+v|0,v=m+v|0,f[d>>2]=v,f[I>>2]=_,h=m+h|0,f[P>>2]=h,m=_-v|0,(v|0)<0?(h=h-v|0,f[I>>2]=m,f[P>>2]=h,f[d>>2]=0,_=0):(m=_,_=v),(m|0)<0&&(_=_-m|0,f[d>>2]=_,h=h-m|0,f[P>>2]=h,f[I>>2]=0,m=0),E=_-h|0,v=m-h|0,(h|0)<0?(f[d>>2]=E,f[I>>2]=v,f[P>>2]=0,_=E,h=0):v=m,m=(v|0)<(_|0)?v:_,m=(h|0)<(m|0)?h:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[I>>2]=v-m,f[P>>2]=h-m)}function kl(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;h=f[d>>2]|0,I=d+4|0,_=f[I>>2]|0,P=d+8|0,m=f[P>>2]|0,v=_+h|0,f[d>>2]=v,_=m+_|0,f[I>>2]=_,h=m+h|0,f[P>>2]=h,m=_-v|0,(v|0)<0?(h=h-v|0,f[I>>2]=m,f[P>>2]=h,f[d>>2]=0,_=0):(m=_,_=v),(m|0)<0&&(_=_-m|0,f[d>>2]=_,h=h-m|0,f[P>>2]=h,f[I>>2]=0,m=0),E=_-h|0,v=m-h|0,(h|0)<0?(f[d>>2]=E,f[I>>2]=v,f[P>>2]=0,_=E,h=0):v=m,m=(v|0)<(_|0)?v:_,m=(h|0)<(m|0)?h:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[I>>2]=v-m,f[P>>2]=h-m)}function Cs(d){switch(d=d|0,d|0){case 1:{d=5;break}case 5:{d=4;break}case 4:{d=6;break}case 6:{d=2;break}case 2:{d=3;break}case 3:{d=1;break}}return d|0}function ss(d){switch(d=d|0,d|0){case 1:{d=3;break}case 3:{d=2;break}case 2:{d=6;break}case 6:{d=4;break}case 4:{d=5;break}case 5:{d=1;break}}return d|0}function Lu(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;h=f[d>>2]|0,I=d+4|0,m=f[I>>2]|0,P=d+8|0,_=f[P>>2]|0,v=m+(h<<1)|0,f[d>>2]=v,m=_+(m<<1)|0,f[I>>2]=m,h=(_<<1)+h|0,f[P>>2]=h,_=m-v|0,(v|0)<0?(h=h-v|0,f[I>>2]=_,f[P>>2]=h,f[d>>2]=0,m=_,_=0):_=v,(m|0)<0&&(_=_-m|0,f[d>>2]=_,h=h-m|0,f[P>>2]=h,f[I>>2]=0,m=0),E=_-h|0,v=m-h|0,(h|0)<0?(f[d>>2]=E,f[I>>2]=v,f[P>>2]=0,_=E,h=0):v=m,m=(v|0)<(_|0)?v:_,m=(h|0)<(m|0)?h:m,!((m|0)<=0)&&(f[d>>2]=_-m,f[I>>2]=v-m,f[P>>2]=h-m)}function Ru(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;v=f[d>>2]|0,I=d+4|0,h=f[I>>2]|0,P=d+8|0,m=f[P>>2]|0,_=(h<<1)+v|0,v=m+(v<<1)|0,f[d>>2]=v,f[I>>2]=_,h=(m<<1)+h|0,f[P>>2]=h,m=_-v|0,(v|0)<0?(h=h-v|0,f[I>>2]=m,f[P>>2]=h,f[d>>2]=0,v=0):m=_,(m|0)<0&&(v=v-m|0,f[d>>2]=v,h=h-m|0,f[P>>2]=h,f[I>>2]=0,m=0),E=v-h|0,_=m-h|0,(h|0)<0?(f[d>>2]=E,f[I>>2]=_,f[P>>2]=0,v=E,h=0):_=m,m=(_|0)<(v|0)?_:v,m=(h|0)<(m|0)?h:m,!((m|0)<=0)&&(f[d>>2]=v-m,f[I>>2]=_-m,f[P>>2]=h-m)}function Fa(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0;return I=(f[d>>2]|0)-(f[h>>2]|0)|0,P=(I|0)<0,_=(f[d+4>>2]|0)-(f[h+4>>2]|0)-(P?I:0)|0,E=(_|0)<0,v=(P?0-I|0:0)+(f[d+8>>2]|0)-(f[h+8>>2]|0)+(E?0-_|0:0)|0,d=(v|0)<0,h=d?0:v,m=(E?0:_)-(d?v:0)|0,v=(P?0:I)-(E?_:0)-(d?v:0)|0,d=(m|0)<(v|0)?m:v,d=(h|0)<(d|0)?h:d,_=(d|0)>0,h=h-(_?d:0)|0,m=m-(_?d:0)|0,d=v-(_?d:0)|0,d=(d|0)>-1?d:0-d|0,m=(m|0)>-1?m:0-m|0,h=(h|0)>-1?h:0-h|0,h=(m|0)>(h|0)?m:h,((d|0)>(h|0)?d:h)|0}function Pl(d,h){d=d|0,h=h|0;var m=0;m=f[d+8>>2]|0,f[h>>2]=(f[d>>2]|0)-m,f[h+4>>2]=(f[d+4>>2]|0)-m}function Mc(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0;_=f[d>>2]|0,f[h>>2]=_,v=f[d+4>>2]|0,I=h+4|0,f[I>>2]=v,P=h+8|0,f[P>>2]=0,m=(v|0)<(_|0),d=m?_:v,m=m?v:_;do if((m|0)<0){if((d|0)>0){if((d|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-d|0)>=(m|0)))break;return d=1,d|0}if((m|0)==-2147483648|(-2147483648-d|0)>(m|0))return h=1,h|0;if((d|0)>-1){if((d|-2147483648|0)<(m|0))break;return d=1,d|0}else{if((d^-2147483648|0)<(m|0))d=1;else break;return d|0}}while(0);return d=v-_|0,(_|0)<0?(m=0-_|0,f[I>>2]=d,f[P>>2]=m,f[h>>2]=0,_=0):(d=v,m=0),(d|0)<0&&(_=_-d|0,f[h>>2]=_,m=m-d|0,f[P>>2]=m,f[I>>2]=0,d=0),E=_-m|0,v=d-m|0,(m|0)<0?(f[h>>2]=E,f[I>>2]=v,f[P>>2]=0,d=v,v=E,m=0):v=_,_=(d|0)<(v|0)?d:v,_=(m|0)<(_|0)?m:_,(_|0)<=0?(h=0,h|0):(f[h>>2]=v-_,f[I>>2]=d-_,f[P>>2]=m-_,h=0,h|0)}function Ll(d){d=d|0;var h=0,m=0,_=0,v=0;h=d+8|0,v=f[h>>2]|0,m=v-(f[d>>2]|0)|0,f[d>>2]=m,_=d+4|0,d=(f[_>>2]|0)-v|0,f[_>>2]=d,f[h>>2]=0-(d+m)}function na(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;m=f[d>>2]|0,h=0-m|0,f[d>>2]=h,I=d+8|0,f[I>>2]=0,P=d+4|0,_=f[P>>2]|0,v=_+m|0,(m|0)>0?(f[P>>2]=v,f[I>>2]=m,f[d>>2]=0,h=0,_=v):m=0,(_|0)<0?(E=h-_|0,f[d>>2]=E,m=m-_|0,f[I>>2]=m,f[P>>2]=0,v=E-m|0,h=0-m|0,(m|0)<0?(f[d>>2]=v,f[P>>2]=h,f[I>>2]=0,_=h,m=0):(_=0,v=E)):v=h,h=(_|0)<(v|0)?_:v,h=(m|0)<(h|0)?m:h,!((h|0)<=0)&&(f[d>>2]=v-h,f[P>>2]=_-h,f[I>>2]=m-h)}function Du(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0;if(de=Ae,Ae=Ae+64|0,X=de,P=de+56|0,!(!0&(h&2013265920|0)==134217728&(!0&(_&2013265920|0)==134217728)))return v=5,Ae=de,v|0;if((d|0)==(m|0)&(h|0)==(_|0))return f[v>>2]=0,v=0,Ae=de,v|0;if(I=oe(d|0,h|0,52)|0,me()|0,I=I&15,G=oe(m|0,_|0,52)|0,me()|0,(I|0)!=(G&15|0))return v=12,Ae=de,v|0;if(E=I+-1|0,I>>>0>1){Ga(d,h,E,X)|0,Ga(m,_,E,P)|0,G=X,O=f[G>>2]|0,G=f[G+4>>2]|0;e:do if((O|0)==(f[P>>2]|0)&&(G|0)==(f[P+4>>2]|0)){I=(I^15)*3|0,E=oe(d|0,h|0,I|0)|0,me()|0,E=E&7,I=oe(m|0,_|0,I|0)|0,me()|0,I=I&7;do if((E|0)==0|(I|0)==0)f[v>>2]=1,E=0;else if((E|0)==7)E=5;else{if((E|0)==1|(I|0)==1&&Gn(O,G)|0){E=5;break}if((f[15536+(E<<2)>>2]|0)!=(I|0)&&(f[15568+(E<<2)>>2]|0)!=(I|0))break e;f[v>>2]=1,E=0}while(0);return v=E,Ae=de,v|0}while(0)}E=X,I=E+56|0;do f[E>>2]=0,E=E+4|0;while((E|0)<(I|0));return Pa(d,h,1,X)|0,h=X,!((f[h>>2]|0)==(m|0)&&(f[h+4>>2]|0)==(_|0))&&(h=X+8|0,!((f[h>>2]|0)==(m|0)&&(f[h+4>>2]|0)==(_|0)))&&(h=X+16|0,!((f[h>>2]|0)==(m|0)&&(f[h+4>>2]|0)==(_|0)))&&(h=X+24|0,!((f[h>>2]|0)==(m|0)&&(f[h+4>>2]|0)==(_|0)))&&(h=X+32|0,!((f[h>>2]|0)==(m|0)&&(f[h+4>>2]|0)==(_|0)))&&(h=X+40|0,!((f[h>>2]|0)==(m|0)&&(f[h+4>>2]|0)==(_|0)))?(E=X+48|0,E=((f[E>>2]|0)==(m|0)?(f[E+4>>2]|0)==(_|0):0)&1):E=1,f[v>>2]=E,v=0,Ae=de,v|0}function zu(d,h,m,_,v){return d=d|0,h=h|0,m=m|0,_=_|0,v=v|0,m=qe(d,h,m,_)|0,(m|0)==7?(v=11,v|0):(_=ge(m|0,0,56)|0,h=h&-2130706433|(me()|0)|268435456,f[v>>2]=d|_,f[v+4>>2]=h,v=0,v|0)}function Rl(d,h,m){return d=d|0,h=h|0,m=m|0,!0&(h&2013265920|0)==268435456?(f[m>>2]=d,f[m+4>>2]=h&-2130706433|134217728,m=0,m|0):(m=6,m|0)}function ks(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0;return v=Ae,Ae=Ae+16|0,_=v,f[_>>2]=0,!0&(h&2013265920|0)==268435456?(E=oe(d|0,h|0,56)|0,me()|0,_=Ie(d,h&-2130706433|134217728,E&7,_,m)|0,Ae=v,_|0):(_=6,Ae=v,_|0)}function Bu(d,h){d=d|0,h=h|0;var m=0;switch(m=oe(d|0,h|0,56)|0,me()|0,m&7){case 0:case 7:return m=0,m|0}return m=h&-2130706433|134217728,!(!0&(h&2013265920|0)==268435456)||!0&(h&117440512|0)==16777216&(Gn(d,m)|0)!=0?(m=0,m|0):(m=Ps(d,m)|0,m|0)}function ia(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0;return v=Ae,Ae=Ae+16|0,_=v,!0&(h&2013265920|0)==268435456?(E=h&-2130706433|134217728,I=m,f[I>>2]=d,f[I+4>>2]=E,f[_>>2]=0,h=oe(d|0,h|0,56)|0,me()|0,_=Ie(d,E,h&7,_,m+8|0)|0,Ae=v,_|0):(_=6,Ae=v,_|0)}function Yn(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0;return v=(Gn(d,h)|0)==0,h=h&-2130706433,_=m,f[_>>2]=v?d:0,f[_+4>>2]=v?h|285212672:0,_=m+8|0,f[_>>2]=d,f[_+4>>2]=h|301989888,_=m+16|0,f[_>>2]=d,f[_+4>>2]=h|318767104,_=m+24|0,f[_>>2]=d,f[_+4>>2]=h|335544320,_=m+32|0,f[_>>2]=d,f[_+4>>2]=h|352321536,m=m+40|0,f[m>>2]=d,f[m+4>>2]=h|369098752,0}function Na(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0;return I=Ae,Ae=Ae+16|0,v=I,E=h&-2130706433|134217728,!0&(h&2013265920|0)==268435456?(_=oe(d|0,h|0,56)|0,me()|0,_=Ut(d,E,_&7)|0,(_|0)==-1?(f[m>>2]=0,E=6,Ae=I,E|0):(eo(d,E,v)|0&&Qt(23313,22484,282,22499),h=oe(d|0,h|0,52)|0,me()|0,h=h&15,Gn(d,E)|0?as(v,h,_,2,m):Ic(v,h,_,2,m),E=0,Ae=I,E|0)):(E=6,Ae=I,E|0)}function En(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0;_=Ae,Ae=Ae+16|0,v=_,Bn(d,h,m,v),ku(v,m+4|0),Ae=_}function Bn(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0;if(P=Ae,Ae=Ae+16|0,O=P,Qn(d,m,O),E=+xt(+(1-+H[O>>3]*.5)),E<1e-16){f[_>>2]=0,f[_+4>>2]=0,f[_+8>>2]=0,f[_+12>>2]=0,Ae=P;return}if(O=f[m>>2]|0,v=+H[15920+(O*24|0)>>3],v=+Hi(v-+Hi(+Hu(15600+(O<<4)|0,d))),Ar(h)|0?I=+Hi(v+-.3334731722518321):I=v,v=+Tt(+E)/.381966011250105,(h|0)>0){d=0;do v=v*2.6457513110645907,d=d+1|0;while((d|0)!=(h|0))}E=+Ne(+I)*v,H[_>>3]=E,I=+lt(+I)*v,H[_+8>>3]=I,Ae=P}function Qn(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0;if(E=Ae,Ae=Ae+32|0,v=E,Ja(d,v),f[h>>2]=0,H[m>>3]=5,_=+Hn(16400,v),_<+H[m>>3]&&(f[h>>2]=0,H[m>>3]=_),_=+Hn(16424,v),_<+H[m>>3]&&(f[h>>2]=1,H[m>>3]=_),_=+Hn(16448,v),_<+H[m>>3]&&(f[h>>2]=2,H[m>>3]=_),_=+Hn(16472,v),_<+H[m>>3]&&(f[h>>2]=3,H[m>>3]=_),_=+Hn(16496,v),_<+H[m>>3]&&(f[h>>2]=4,H[m>>3]=_),_=+Hn(16520,v),_<+H[m>>3]&&(f[h>>2]=5,H[m>>3]=_),_=+Hn(16544,v),_<+H[m>>3]&&(f[h>>2]=6,H[m>>3]=_),_=+Hn(16568,v),_<+H[m>>3]&&(f[h>>2]=7,H[m>>3]=_),_=+Hn(16592,v),_<+H[m>>3]&&(f[h>>2]=8,H[m>>3]=_),_=+Hn(16616,v),_<+H[m>>3]&&(f[h>>2]=9,H[m>>3]=_),_=+Hn(16640,v),_<+H[m>>3]&&(f[h>>2]=10,H[m>>3]=_),_=+Hn(16664,v),_<+H[m>>3]&&(f[h>>2]=11,H[m>>3]=_),_=+Hn(16688,v),_<+H[m>>3]&&(f[h>>2]=12,H[m>>3]=_),_=+Hn(16712,v),_<+H[m>>3]&&(f[h>>2]=13,H[m>>3]=_),_=+Hn(16736,v),_<+H[m>>3]&&(f[h>>2]=14,H[m>>3]=_),_=+Hn(16760,v),_<+H[m>>3]&&(f[h>>2]=15,H[m>>3]=_),_=+Hn(16784,v),_<+H[m>>3]&&(f[h>>2]=16,H[m>>3]=_),_=+Hn(16808,v),_<+H[m>>3]&&(f[h>>2]=17,H[m>>3]=_),_=+Hn(16832,v),_<+H[m>>3]&&(f[h>>2]=18,H[m>>3]=_),_=+Hn(16856,v),!(_<+H[m>>3])){Ae=E;return}f[h>>2]=19,H[m>>3]=_,Ae=E}function jn(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0;if(E=+Yu(d),E<1e-16){h=15600+(h<<4)|0,f[v>>2]=f[h>>2],f[v+4>>2]=f[h+4>>2],f[v+8>>2]=f[h+8>>2],f[v+12>>2]=f[h+12>>2];return}if(I=+en(+ +H[d+8>>3],+ +H[d>>3]),(m|0)>0){d=0;do E=E/2.6457513110645907,d=d+1|0;while((d|0)!=(m|0))}_?(E=E/3,m=(Ar(m)|0)==0,E=+Ft(+((m?E:E/2.6457513110645907)*.381966011250105))):(E=+Ft(+(E*.381966011250105)),Ar(m)|0&&(I=+Hi(I+.3334731722518321))),Ro(15600+(h<<4)|0,+Hi(+H[15920+(h*24|0)>>3]-I),E,v)}function Ua(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0;_=Ae,Ae=Ae+16|0,v=_,Po(d+4|0,v),jn(v,f[d>>2]|0,h,0,m),Ae=_}function as(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0,Be=0,bt=0,yt=0,ot=0,ut=0,cn=0,on=0,Kt=0,tn=0,sn=0,fn=0,zn=0,un=0;if(fn=Ae,Ae=Ae+272|0,E=fn+256|0,He=fn+240|0,Kt=fn,tn=fn+224|0,sn=fn+208|0,$e=fn+176|0,Be=fn+160|0,bt=fn+192|0,yt=fn+144|0,ot=fn+128|0,ut=fn+112|0,cn=fn+96|0,on=fn+80|0,f[E>>2]=h,f[He>>2]=f[d>>2],f[He+4>>2]=f[d+4>>2],f[He+8>>2]=f[d+8>>2],f[He+12>>2]=f[d+12>>2],Ou(He,E,Kt),f[v>>2]=0,He=_+m+((_|0)==5&1)|0,(He|0)<=(m|0)){Ae=fn;return}O=f[E>>2]|0,G=tn+4|0,X=$e+4|0,de=m+5|0,ve=16880+(O<<2)|0,Re=16960+(O<<2)|0,be=ot+8|0,ze=ut+8|0,Je=cn+8|0,Ye=sn+4|0,P=m;e:for(;;){I=Kt+(((P|0)%5|0)<<4)|0,f[sn>>2]=f[I>>2],f[sn+4>>2]=f[I+4>>2],f[sn+8>>2]=f[I+8>>2],f[sn+12>>2]=f[I+12>>2];do;while((ra(sn,O,0,1)|0)==2);if((P|0)>(m|0)&(Ar(h)|0)!=0){if(f[$e>>2]=f[sn>>2],f[$e+4>>2]=f[sn+4>>2],f[$e+8>>2]=f[sn+8>>2],f[$e+12>>2]=f[sn+12>>2],Po(G,Be),_=f[$e>>2]|0,E=f[17040+(_*80|0)+(f[tn>>2]<<2)>>2]|0,f[$e>>2]=f[18640+(_*80|0)+(E*20|0)>>2],I=f[18640+(_*80|0)+(E*20|0)+16>>2]|0,(I|0)>0){d=0;do Pu(X),d=d+1|0;while((d|0)<(I|0))}switch(I=18640+(_*80|0)+(E*20|0)+4|0,f[bt>>2]=f[I>>2],f[bt+4>>2]=f[I+4>>2],f[bt+8>>2]=f[I+8>>2],Il(bt,(f[ve>>2]|0)*3|0),Oi(X,bt,X),Zn(X),Po(X,yt),zn=+(f[Re>>2]|0),H[ot>>3]=zn*3,H[be>>3]=0,un=zn*-1.5,H[ut>>3]=un,H[ze>>3]=zn*2.598076211353316,H[cn>>3]=un,H[Je>>3]=zn*-2.598076211353316,f[17040+((f[$e>>2]|0)*80|0)+(f[sn>>2]<<2)>>2]|0){case 1:{d=ut,_=ot;break}case 3:{d=cn,_=ut;break}case 2:{d=ot,_=cn;break}default:{d=12;break e}}Uc(Be,yt,_,d,on),jn(on,f[$e>>2]|0,O,1,v+8+(f[v>>2]<<4)|0),f[v>>2]=(f[v>>2]|0)+1}if((P|0)<(de|0)&&(Po(Ye,$e),jn($e,f[sn>>2]|0,O,1,v+8+(f[v>>2]<<4)|0),f[v>>2]=(f[v>>2]|0)+1),f[tn>>2]=f[sn>>2],f[tn+4>>2]=f[sn+4>>2],f[tn+8>>2]=f[sn+8>>2],f[tn+12>>2]=f[sn+12>>2],P=P+1|0,(P|0)>=(He|0)){d=3;break}}if((d|0)==3){Ae=fn;return}else(d|0)==12&&Qt(22522,22569,571,22579)}function Ou(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0;O=Ae,Ae=Ae+128|0,_=O+64|0,v=O,E=_,I=20240,P=E+60|0;do f[E>>2]=f[I>>2],E=E+4|0,I=I+4|0;while((E|0)<(P|0));E=v,I=20304,P=E+60|0;do f[E>>2]=f[I>>2],E=E+4|0,I=I+4|0;while((E|0)<(P|0));P=(Ar(f[h>>2]|0)|0)==0,_=P?_:v,v=d+4|0,Lu(v),Ru(v),Ar(f[h>>2]|0)|0&&(os(v),f[h>>2]=(f[h>>2]|0)+1),f[m>>2]=f[d>>2],h=m+4|0,Oi(v,_,h),Zn(h),f[m+16>>2]=f[d>>2],h=m+20|0,Oi(v,_+12|0,h),Zn(h),f[m+32>>2]=f[d>>2],h=m+36|0,Oi(v,_+24|0,h),Zn(h),f[m+48>>2]=f[d>>2],h=m+52|0,Oi(v,_+36|0,h),Zn(h),f[m+64>>2]=f[d>>2],m=m+68|0,Oi(v,_+48|0,m),Zn(m),Ae=O}function ra(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0;if(be=Ae,Ae=Ae+32|0,ve=be+12|0,P=be,Re=d+4|0,de=f[16960+(h<<2)>>2]|0,X=(_|0)!=0,de=X?de*3|0:de,v=f[Re>>2]|0,G=d+8|0,I=f[G>>2]|0,X){if(E=d+12|0,_=f[E>>2]|0,v=I+v+_|0,(v|0)==(de|0))return Re=1,Ae=be,Re|0;O=E}else O=d+12|0,_=f[O>>2]|0,v=I+v+_|0;if((v|0)<=(de|0))return Re=0,Ae=be,Re|0;do if((_|0)>0){if(_=f[d>>2]|0,(I|0)>0){E=18640+(_*80|0)+60|0,_=d;break}_=18640+(_*80|0)+40|0,m?(za(ve,de,0,0),ea(Re,ve,P),kl(P),Oi(P,ve,Re),E=_,_=d):(E=_,_=d)}else E=18640+((f[d>>2]|0)*80|0)+20|0,_=d;while(0);if(f[_>>2]=f[E>>2],v=E+16|0,(f[v>>2]|0)>0){_=0;do Pu(Re),_=_+1|0;while((_|0)<(f[v>>2]|0))}return d=E+4|0,f[ve>>2]=f[d>>2],f[ve+4>>2]=f[d+4>>2],f[ve+8>>2]=f[d+8>>2],h=f[16880+(h<<2)>>2]|0,Il(ve,X?h*3|0:h),Oi(Re,ve,Re),Zn(Re),X?_=((f[G>>2]|0)+(f[Re>>2]|0)+(f[O>>2]|0)|0)==(de|0)?1:2:_=2,Re=_,Ae=be,Re|0}function Fu(d,h){d=d|0,h=h|0;var m=0;do m=ra(d,h,0,1)|0;while((m|0)==2);return m|0}function Ic(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0,Be=0,bt=0,yt=0,ot=0,ut=0,cn=0,on=0,Kt=0;if(cn=Ae,Ae=Ae+240|0,E=cn+224|0,bt=cn+208|0,yt=cn,ot=cn+192|0,ut=cn+176|0,Je=cn+160|0,Ye=cn+144|0,He=cn+128|0,$e=cn+112|0,Be=cn+96|0,f[E>>2]=h,f[bt>>2]=f[d>>2],f[bt+4>>2]=f[d+4>>2],f[bt+8>>2]=f[d+8>>2],f[bt+12>>2]=f[d+12>>2],Va(bt,E,yt),f[v>>2]=0,ze=_+m+((_|0)==6&1)|0,(ze|0)<=(m|0)){Ae=cn;return}O=f[E>>2]|0,G=m+6|0,X=16960+(O<<2)|0,de=Ye+8|0,ve=He+8|0,Re=$e+8|0,be=ot+4|0,I=0,P=m,_=-1;e:for(;;){if(E=(P|0)%6|0,d=yt+(E<<4)|0,f[ot>>2]=f[d>>2],f[ot+4>>2]=f[d+4>>2],f[ot+8>>2]=f[d+8>>2],f[ot+12>>2]=f[d+12>>2],d=I,I=ra(ot,O,0,1)|0,(P|0)>(m|0)&(Ar(h)|0)!=0&&(d|0)!=1&&(f[ot>>2]|0)!=(_|0)){switch(Po(yt+(((E+5|0)%6|0)<<4)+4|0,ut),Po(yt+(E<<4)+4|0,Je),on=+(f[X>>2]|0),H[Ye>>3]=on*3,H[de>>3]=0,Kt=on*-1.5,H[He>>3]=Kt,H[ve>>3]=on*2.598076211353316,H[$e>>3]=Kt,H[Re>>3]=on*-2.598076211353316,E=f[bt>>2]|0,f[17040+(E*80|0)+(((_|0)==(E|0)?f[ot>>2]|0:_)<<2)>>2]|0){case 1:{d=He,_=Ye;break}case 3:{d=$e,_=He;break}case 2:{d=Ye,_=$e;break}default:{d=8;break e}}Uc(ut,Je,_,d,Be),!(Ku(ut,Be)|0)&&!(Ku(Je,Be)|0)&&(jn(Be,f[bt>>2]|0,O,1,v+8+(f[v>>2]<<4)|0),f[v>>2]=(f[v>>2]|0)+1)}if((P|0)<(G|0)&&(Po(be,ut),jn(ut,f[ot>>2]|0,O,1,v+8+(f[v>>2]<<4)|0),f[v>>2]=(f[v>>2]|0)+1),P=P+1|0,(P|0)>=(ze|0)){d=3;break}else _=f[ot>>2]|0}if((d|0)==3){Ae=cn;return}else(d|0)==8&&Qt(22606,22569,736,22651)}function Va(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0;O=Ae,Ae=Ae+160|0,_=O+80|0,v=O,E=_,I=20368,P=E+72|0;do f[E>>2]=f[I>>2],E=E+4|0,I=I+4|0;while((E|0)<(P|0));E=v,I=20448,P=E+72|0;do f[E>>2]=f[I>>2],E=E+4|0,I=I+4|0;while((E|0)<(P|0));P=(Ar(f[h>>2]|0)|0)==0,_=P?_:v,v=d+4|0,Lu(v),Ru(v),Ar(f[h>>2]|0)|0&&(os(v),f[h>>2]=(f[h>>2]|0)+1),f[m>>2]=f[d>>2],h=m+4|0,Oi(v,_,h),Zn(h),f[m+16>>2]=f[d>>2],h=m+20|0,Oi(v,_+12|0,h),Zn(h),f[m+32>>2]=f[d>>2],h=m+36|0,Oi(v,_+24|0,h),Zn(h),f[m+48>>2]=f[d>>2],h=m+52|0,Oi(v,_+36|0,h),Zn(h),f[m+64>>2]=f[d>>2],h=m+68|0,Oi(v,_+48|0,h),Zn(h),f[m+80>>2]=f[d>>2],m=m+84|0,Oi(v,_+60|0,m),Zn(m),Ae=O}function ja(d,h){return d=d|0,h=h|0,h=oe(d|0,h|0,52)|0,me()|0,h&15|0}function oa(d,h){return d=d|0,h=h|0,h=oe(d|0,h|0,45)|0,me()|0,h&127|0}function Ps(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0;if(!(!0&(h&-16777216|0)==134217728)||(I=oe(d|0,h|0,45)|0,me()|0,I=I&127,I>>>0>121))return h=0,h|0;m=oe(d|0,h|0,52)|0,me()|0,m=m&15;do if(m|0){for(v=1,_=0;;){if(E=oe(d|0,h|0,(15-v|0)*3|0)|0,me()|0,E=E&7,(E|0)!=0&(_^1))if((E|0)==1&(In(I)|0)!=0){P=0,_=13;break}else _=1;if((E|0)==7){P=0,_=13;break}if(v>>>0<m>>>0)v=v+1|0;else{_=9;break}}if((_|0)==9){if((m|0)==15)P=1;else break;return P|0}else if((_|0)==13)return P|0}while(0);for(;;){if(P=oe(d|0,h|0,(14-m|0)*3|0)|0,me()|0,!((P&7|0)==7&!0)){P=0,_=13;break}if(m>>>0<14)m=m+1|0;else{P=1,_=13;break}}return(_|0)==13?P|0:0}function Ga(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0;if(E=oe(d|0,h|0,52)|0,me()|0,E=E&15,m>>>0>15)return _=4,_|0;if((E|0)<(m|0))return _=12,_|0;if((E|0)==(m|0))return f[_>>2]=d,f[_+4>>2]=h,_=0,_|0;if(v=ge(m|0,0,52)|0,v=v|d,d=me()|0|h&-15728641,(E|0)>(m|0))do h=ge(7,0,(14-m|0)*3|0)|0,m=m+1|0,v=h|v,d=me()|0|d;while((m|0)<(E|0));return f[_>>2]=v,f[_+4>>2]=d,_=0,_|0}function Ha(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0;if(E=oe(d|0,h|0,52)|0,me()|0,E=E&15,!((m|0)<16&(E|0)<=(m|0)))return _=4,_|0;v=m-E|0,m=oe(d|0,h|0,45)|0,me()|0;e:do if(!(In(m&127)|0))m=xo(7,0,v,((v|0)<0)<<31>>31)|0,v=me()|0;else{t:do if(E|0){for(m=1;I=ge(7,0,(15-m|0)*3|0)|0,!!((I&d|0)==0&((me()|0)&h|0)==0);)if(m>>>0<E>>>0)m=m+1|0;else break t;m=xo(7,0,v,((v|0)<0)<<31>>31)|0,v=me()|0;break e}while(0);m=xo(7,0,v,((v|0)<0)<<31>>31)|0,m=J(m|0,me()|0,5,0)|0,m=M(m|0,me()|0,-5,-1)|0,m=$(m|0,me()|0,6,0)|0,m=M(m|0,me()|0,1,0)|0,v=me()|0}while(0);return I=_,f[I>>2]=m,f[I+4>>2]=v,I=0,I|0}function Gn(d,h){d=d|0,h=h|0;var m=0,_=0,v=0;if(v=oe(d|0,h|0,45)|0,me()|0,!(In(v&127)|0))return v=0,v|0;v=oe(d|0,h|0,52)|0,me()|0,v=v&15;e:do if(!v)m=0;else for(_=1;;){if(m=oe(d|0,h|0,(15-_|0)*3|0)|0,me()|0,m=m&7,m|0)break e;if(_>>>0<v>>>0)_=_+1|0;else{m=0;break}}while(0);return v=(m|0)==0&1,v|0}function Dl(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0;if(I=Ae,Ae=Ae+16|0,E=I,la(E,d,h,m),h=E,d=f[h>>2]|0,h=f[h+4>>2]|0,(d|0)==0&(h|0)==0)return Ae=I,0;v=0,m=0;do P=_+(v<<3)|0,f[P>>2]=d,f[P+4>>2]=h,v=M(v|0,m|0,1,0)|0,m=me()|0,ca(E),P=E,d=f[P>>2]|0,h=f[P+4>>2]|0;while(!((d|0)==0&(h|0)==0));return Ae=I,0}function Jr(d,h,m,_){return d=d|0,h=h|0,m=m|0,_=_|0,(_|0)<(m|0)?(m=h,_=d,Ot(m|0),_|0):(m=ge(-1,-1,((_-m|0)*3|0)+3|0)|0,_=ge(~m|0,~(me()|0)|0,(15-_|0)*3|0)|0,m=~(me()|0)&h,_=~_&d,Ot(m|0),_|0)}function Nu(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0;return v=oe(d|0,h|0,52)|0,me()|0,v=v&15,(m|0)<16&(v|0)<=(m|0)?((v|0)<(m|0)&&(v=ge(-1,-1,((m+-1-v|0)*3|0)+3|0)|0,v=ge(~v|0,~(me()|0)|0,(15-m|0)*3|0)|0,h=~(me()|0)&h,d=~v&d),v=ge(m|0,0,52)|0,m=h&-15728641|(me()|0),f[_>>2]=d|v,f[_+4>>2]=m,_=0,_|0):(_=4,_|0)}function Cc(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0,Be=0,bt=0,yt=0,ot=0,ut=0;if((m|0)==0&(_|0)==0)return ot=0,ot|0;if(v=d,E=f[v>>2]|0,v=f[v+4>>2]|0,!0&(v&15728640|0)==0){if(!((_|0)>0|(_|0)==0&m>>>0>0)||(ot=h,f[ot>>2]=E,f[ot+4>>2]=v,(m|0)==1&(_|0)==0))return ot=0,ot|0;v=1;do bt=d+(v<<3)|0,yt=f[bt+4>>2]|0,ot=h+(v<<3)|0,f[ot>>2]=f[bt>>2],f[ot+4>>2]=yt,v=v+1|0;while(0<(_|0)|(_|0)==0&v>>>0<m>>>0);return v=0,v|0}if(Be=m<<3,yt=A(Be)|0,!yt)return ot=13,ot|0;if(Ze(yt|0,d|0,Be|0)|0,bt=w(m,8)|0,!bt)return y(yt),ot=13,ot|0;e:do if(m|0){t:for(;;){v=yt,Ye=f[v>>2]|0,v=f[v+4>>2]|0,He=oe(Ye|0,v|0,52)|0,me()|0,He=He&15,$e=He+-1|0,Je=(m|0)>0;n:do if((He|0)!=0&Je){if(Re=((m|0)<0)<<31>>31,be=ge($e|0,0,52)|0,ze=me()|0,$e>>>0>15){if(!((Ye|0)==0&(v|0)==0)){ot=17;break t}for(E=0;;){if(E=E+1|0,(E|0)>=(m|0))break n;if(_=yt+(E<<3)|0,ze=f[_>>2]|0,_=f[_+4>>2]|0,!((ze|0)==0&(_|0)==0)){v=_,ot=17;break t}}}for(E=0,d=Ye,_=v;;){if(!((d|0)==0&(_|0)==0)){if(!(!0&(_&117440512|0)==0)){ot=22;break t}if(P=oe(d|0,_|0,52)|0,me()|0,P=P&15,(P|0)<($e|0)){v=12,ot=28;break t}if((P|0)!=($e|0)&&(d=d|be,_=_&-15728641|ze,P>>>0>=He>>>0)){I=$e;do ve=ge(7,0,(14-I|0)*3|0)|0,I=I+1|0,d=ve|d,_=me()|0|_;while(I>>>0<P>>>0)}if(I=ye(d|0,_|0,m|0,Re|0)|0,me()|0,G=bt+(I<<3)|0,P=G,O=f[P>>2]|0,P=f[P+4>>2]|0,(O|0)==0&(P|0)==0)I=G;else for(ve=0;;){if((ve|0)>(m|0)){ot=32;break t}if((O|0)==(d|0)&(P&-117440513|0)==(_|0)){X=oe(O|0,P|0,56)|0,me()|0,X=X&7,de=X+1|0,ut=oe(O|0,P|0,45)|0,me()|0;i:do if(!(In(ut&127)|0))P=7;else{if(O=oe(O|0,P|0,52)|0,me()|0,O=O&15,!O){P=6;break}for(P=1;;){if(ut=ge(7,0,(15-P|0)*3|0)|0,!((ut&d|0)==0&((me()|0)&_|0)==0)){P=7;break i}if(P>>>0<O>>>0)P=P+1|0;else{P=6;break}}}while(0);if((X+2|0)>>>0>P>>>0){ot=42;break t}ut=ge(de|0,0,56)|0,_=me()|0|_&-117440513,de=G,f[de>>2]=0,f[de+4>>2]=0,d=ut|d}else I=(I+1|0)%(m|0)|0;if(G=bt+(I<<3)|0,P=G,O=f[P>>2]|0,P=f[P+4>>2]|0,(O|0)==0&(P|0)==0){I=G;break}else ve=ve+1|0}ut=I,f[ut>>2]=d,f[ut+4>>2]=_}if(E=E+1|0,(E|0)>=(m|0))break n;_=yt+(E<<3)|0,d=f[_>>2]|0,_=f[_+4>>2]|0}}while(0);if((m+5|0)>>>0<11){ot=85;break}if(ze=w((m|0)/6|0,8)|0,!ze){ot=49;break}n:do if(Je){ve=0,de=0;do{if(P=bt+(ve<<3)|0,_=P,E=f[_>>2]|0,_=f[_+4>>2]|0,!((E|0)==0&(_|0)==0)){O=oe(E|0,_|0,56)|0,me()|0,O=O&7,d=O+1|0,G=_&-117440513,ut=oe(E|0,_|0,45)|0,me()|0;i:do if(In(ut&127)|0){if(X=oe(E|0,_|0,52)|0,me()|0,X=X&15,X|0)for(I=1;;){if(ut=ge(7,0,(15-I|0)*3|0)|0,!((E&ut|0)==0&(G&(me()|0)|0)==0))break i;if(I>>>0<X>>>0)I=I+1|0;else break}_=ge(d|0,0,56)|0,E=_|E,_=me()|0|G,d=P,f[d>>2]=E,f[d+4>>2]=_,d=O+2|0}while(0);(d|0)==7&&(ut=ze+(de<<3)|0,f[ut>>2]=E,f[ut+4>>2]=_&-117440513,de=de+1|0)}ve=ve+1|0}while((ve|0)!=(m|0));if(Je){if(ve=((m|0)<0)<<31>>31,Re=ge($e|0,0,52)|0,be=me()|0,$e>>>0>15){if(!((Ye|0)==0&(v|0)==0)){v=4,ot=84;break t}for(v=0;;){if(v=v+1|0,(v|0)>=(m|0)){E=0,v=de;break n}if(ut=yt+(v<<3)|0,!((f[ut>>2]|0)==0&(f[ut+4>>2]|0)==0)){v=4,ot=84;break t}}}for(X=0,E=0,G=Ye;;){do if(!((G|0)==0&(v|0)==0)){if(P=oe(G|0,v|0,52)|0,me()|0,P=P&15,(P|0)<($e|0)){v=12,ot=84;break t}do if((P|0)==($e|0))_=G,P=v;else{if(_=G|Re,d=v&-15728641|be,P>>>0<He>>>0){P=d;break}I=$e;do ut=ge(7,0,(14-I|0)*3|0)|0,I=I+1|0,_=ut|_,d=me()|0|d;while(I>>>0<P>>>0);P=d}while(0);for(I=ye(_|0,P|0,m|0,ve|0)|0,me()|0,d=0;;){if((d|0)>(m|0)){ot=77;break t}if(ut=bt+(I<<3)|0,O=f[ut+4>>2]|0,(O&-117440513|0)==(P|0)&&(f[ut>>2]|0)==(_|0)){ot=79;break}if(I=(I+1|0)%(m|0)|0,ut=bt+(I<<3)|0,(f[ut>>2]|0)==(_|0)&&(f[ut+4>>2]|0)==(P|0))break;d=d+1|0}if((ot|0)==79&&(ot=0,!0&(O&117440512|0)==100663296))break;ut=h+(E<<3)|0,f[ut>>2]=G,f[ut+4>>2]=v,E=E+1|0}while(0);if(v=X+1|0,(v|0)>=(m|0)){v=de;break n}ut=yt+(v<<3)|0,X=v,G=f[ut>>2]|0,v=f[ut+4>>2]|0}}else E=0,v=de}else E=0,v=0;while(0);if(je(bt|0,0,Be|0)|0,Ze(yt|0,ze|0,v<<3|0)|0,y(ze),v)h=h+(E<<3)|0,m=v;else break e}if((ot|0)==17)!0&(v&117440512|0)==0?(v=4,ot=28):ot=22;else if((ot|0)==32)Qt(23313,22674,362,22684);else{if((ot|0)==42)return y(yt),y(bt),ut=10,ut|0;if((ot|0)==49)return y(yt),y(bt),ut=13,ut|0;if((ot|0)==77)Qt(23313,22674,462,22684);else{if((ot|0)==84)return y(ze),y(yt),y(bt),ut=v,ut|0;if((ot|0)==85){Ze(h|0,yt|0,m<<3|0)|0;break}}}if((ot|0)==22)return y(yt),y(bt),ut=5,ut|0;if((ot|0)==28)return y(yt),y(bt),ut=v,ut|0}while(0);return y(yt),y(bt),ut=0,ut|0}function Uu(d,h,m,_,v,E,I){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0,E=E|0,I=I|0;var P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0;if(ze=Ae,Ae=Ae+16|0,be=ze,!((m|0)>0|(m|0)==0&h>>>0>0))return be=0,Ae=ze,be|0;if((I|0)>=16)return be=12,Ae=ze,be|0;ve=0,Re=0,de=0,P=0;e:for(;;){if(G=d+(ve<<3)|0,O=f[G>>2]|0,G=f[G+4>>2]|0,X=oe(O|0,G|0,52)|0,me()|0,(X&15|0)>(I|0)){P=12,O=11;break}if(la(be,O,G,I),X=be,G=f[X>>2]|0,X=f[X+4>>2]|0,(G|0)==0&(X|0)==0)O=de;else{O=de;do{if(!((P|0)<(E|0)|(P|0)==(E|0)&O>>>0<v>>>0)){O=10;break e}de=_+(O<<3)|0,f[de>>2]=G,f[de+4>>2]=X,O=M(O|0,P|0,1,0)|0,P=me()|0,ca(be),de=be,G=f[de>>2]|0,X=f[de+4>>2]|0}while(!((G|0)==0&(X|0)==0))}if(ve=M(ve|0,Re|0,1,0)|0,Re=me()|0,(Re|0)<(m|0)|(Re|0)==(m|0)&ve>>>0<h>>>0)de=O;else{P=0,O=11;break}}return(O|0)==10?(be=14,Ae=ze,be|0):(O|0)==11?(Ae=ze,P|0):0}function Ls(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0;ve=Ae,Ae=Ae+16|0,de=ve;e:do if((m|0)>0|(m|0)==0&h>>>0>0){for(G=0,I=0,E=0,X=0;;){if(O=d+(G<<3)|0,P=f[O>>2]|0,O=f[O+4>>2]|0,!((P|0)==0&(O|0)==0)&&(O=(Ha(P,O,_,de)|0)==0,P=de,I=M(f[P>>2]|0,f[P+4>>2]|0,I|0,E|0)|0,E=me()|0,!O)){E=12;break}if(G=M(G|0,X|0,1,0)|0,X=me()|0,!((X|0)<(m|0)|(X|0)==(m|0)&G>>>0<h>>>0))break e}return Ae=ve,E|0}else I=0,E=0;while(0);return f[v>>2]=I,f[v+4>>2]=E,v=0,Ae=ve,v|0}function $a(d,h){return d=d|0,h=h|0,h=oe(d|0,h|0,52)|0,me()|0,h&1|0}function Mi(d,h){d=d|0,h=h|0;var m=0,_=0,v=0;if(v=oe(d|0,h|0,52)|0,me()|0,v=v&15,!v)return v=0,v|0;for(_=1;;){if(m=oe(d|0,h|0,(15-_|0)*3|0)|0,me()|0,m=m&7,m|0){_=5;break}if(_>>>0<v>>>0)_=_+1|0;else{m=0,_=5;break}}return(_|0)==5?m|0:0}function kc(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0,O=0;if(O=oe(d|0,h|0,52)|0,me()|0,O=O&15,!O)return P=h,O=d,Ot(P|0),O|0;for(P=1,m=0;;){E=(15-P|0)*3|0,_=ge(7,0,E|0)|0,v=me()|0,I=oe(d|0,h|0,E|0)|0,me()|0,E=ge(Cs(I&7)|0,0,E|0)|0,I=me()|0,d=E|d&~_,h=I|h&~v;e:do if(!m)if((E&_|0)==0&(I&v|0)==0)m=0;else if(_=oe(d|0,h|0,52)|0,me()|0,_=_&15,!_)m=1;else{m=1;t:for(;;){switch(I=oe(d|0,h|0,(15-m|0)*3|0)|0,me()|0,I&7){case 1:break t;case 0:break;default:{m=1;break e}}if(m>>>0<_>>>0)m=m+1|0;else{m=1;break e}}for(m=1;;)if(I=(15-m|0)*3|0,v=oe(d|0,h|0,I|0)|0,me()|0,E=ge(7,0,I|0)|0,h=h&~(me()|0),I=ge(Cs(v&7)|0,0,I|0)|0,d=d&~E|I,h=h|(me()|0),m>>>0<_>>>0)m=m+1|0;else{m=1;break}}while(0);if(P>>>0<O>>>0)P=P+1|0;else break}return Ot(h|0),d|0}function _o(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0;if(_=oe(d|0,h|0,52)|0,me()|0,_=_&15,!_)return m=h,_=d,Ot(m|0),_|0;for(m=1;E=(15-m|0)*3|0,I=oe(d|0,h|0,E|0)|0,me()|0,v=ge(7,0,E|0)|0,h=h&~(me()|0),E=ge(Cs(I&7)|0,0,E|0)|0,d=E|d&~v,h=me()|0|h,m>>>0<_>>>0;)m=m+1|0;return Ot(h|0),d|0}function Vu(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0,O=0;if(O=oe(d|0,h|0,52)|0,me()|0,O=O&15,!O)return P=h,O=d,Ot(P|0),O|0;for(P=1,m=0;;){E=(15-P|0)*3|0,_=ge(7,0,E|0)|0,v=me()|0,I=oe(d|0,h|0,E|0)|0,me()|0,E=ge(ss(I&7)|0,0,E|0)|0,I=me()|0,d=E|d&~_,h=I|h&~v;e:do if(!m)if((E&_|0)==0&(I&v|0)==0)m=0;else if(_=oe(d|0,h|0,52)|0,me()|0,_=_&15,!_)m=1;else{m=1;t:for(;;){switch(I=oe(d|0,h|0,(15-m|0)*3|0)|0,me()|0,I&7){case 1:break t;case 0:break;default:{m=1;break e}}if(m>>>0<_>>>0)m=m+1|0;else{m=1;break e}}for(m=1;;)if(v=(15-m|0)*3|0,E=ge(7,0,v|0)|0,I=h&~(me()|0),h=oe(d|0,h|0,v|0)|0,me()|0,h=ge(ss(h&7)|0,0,v|0)|0,d=d&~E|h,h=I|(me()|0),m>>>0<_>>>0)m=m+1|0;else{m=1;break}}while(0);if(P>>>0<O>>>0)P=P+1|0;else break}return Ot(h|0),d|0}function zl(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0;if(_=oe(d|0,h|0,52)|0,me()|0,_=_&15,!_)return m=h,_=d,Ot(m|0),_|0;for(m=1;I=(15-m|0)*3|0,E=ge(7,0,I|0)|0,v=h&~(me()|0),h=oe(d|0,h|0,I|0)|0,me()|0,h=ge(ss(h&7)|0,0,I|0)|0,d=h|d&~E,h=me()|0|v,m>>>0<_>>>0;)m=m+1|0;return Ot(h|0),d|0}function Wa(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0;if(O=Ae,Ae=Ae+64|0,P=O+40|0,_=O+24|0,v=O+12|0,E=O,ge(h|0,0,52)|0,m=me()|0|134225919,!h)return(f[d+4>>2]|0)>2||(f[d+8>>2]|0)>2||(f[d+12>>2]|0)>2?(I=0,P=0,Ot(I|0),Ae=O,P|0):(ge(Sl(d)|0,0,45)|0,I=me()|0|m,P=-1,Ot(I|0),Ae=O,P|0);if(f[P>>2]=f[d>>2],f[P+4>>2]=f[d+4>>2],f[P+8>>2]=f[d+8>>2],f[P+12>>2]=f[d+12>>2],I=P+4|0,(h|0)>0)for(d=-1;f[_>>2]=f[I>>2],f[_+4>>2]=f[I+4>>2],f[_+8>>2]=f[I+8>>2],h&1?(Sc(I),f[v>>2]=f[I>>2],f[v+4>>2]=f[I+4>>2],f[v+8>>2]=f[I+8>>2],Oa(v)):(Ba(I),f[v>>2]=f[I>>2],f[v+4>>2]=f[I+4>>2],f[v+8>>2]=f[I+8>>2],os(v)),ea(_,v,E),Zn(E),X=(15-h|0)*3|0,G=ge(7,0,X|0)|0,m=m&~(me()|0),X=ge(ta(E)|0,0,X|0)|0,d=X|d&~G,m=me()|0|m,(h|0)>1;)h=h+-1|0;else d=-1;e:do if((f[I>>2]|0)<=2&&(f[P+8>>2]|0)<=2&&(f[P+12>>2]|0)<=2){if(_=Sl(P)|0,h=ge(_|0,0,45)|0,h=h|d,d=me()|0|m&-1040385,E=Ml(P)|0,!(In(_)|0)){if((E|0)<=0)break;for(v=0;;){if(_=oe(h|0,d|0,52)|0,me()|0,_=_&15,_)for(m=1;X=(15-m|0)*3|0,P=oe(h|0,d|0,X|0)|0,me()|0,G=ge(7,0,X|0)|0,d=d&~(me()|0),X=ge(Cs(P&7)|0,0,X|0)|0,h=h&~G|X,d=d|(me()|0),m>>>0<_>>>0;)m=m+1|0;if(v=v+1|0,(v|0)==(E|0))break e}}v=oe(h|0,d|0,52)|0,me()|0,v=v&15;t:do if(v){m=1;n:for(;;){switch(X=oe(h|0,d|0,(15-m|0)*3|0)|0,me()|0,X&7){case 1:break n;case 0:break;default:break t}if(m>>>0<v>>>0)m=m+1|0;else break t}if(Iu(_,f[P>>2]|0)|0)for(m=1;P=(15-m|0)*3|0,G=ge(7,0,P|0)|0,X=d&~(me()|0),d=oe(h|0,d|0,P|0)|0,me()|0,d=ge(ss(d&7)|0,0,P|0)|0,h=h&~G|d,d=X|(me()|0),m>>>0<v>>>0;)m=m+1|0;else for(m=1;X=(15-m|0)*3|0,P=oe(h|0,d|0,X|0)|0,me()|0,G=ge(7,0,X|0)|0,d=d&~(me()|0),X=ge(Cs(P&7)|0,0,X|0)|0,h=h&~G|X,d=d|(me()|0),m>>>0<v>>>0;)m=m+1|0}while(0);if((E|0)>0){m=0;do h=kc(h,d)|0,d=me()|0,m=m+1|0;while((m|0)!=(E|0))}}else h=0,d=0;while(0);return G=d,X=h,Ot(G|0),Ae=O,X|0}function Ar(d){return d=d|0,(d|0)%2|0|0}function Za(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0;return v=Ae,Ae=Ae+16|0,_=v,h>>>0>15?(_=4,Ae=v,_|0):(f[d+4>>2]&2146435072|0)==2146435072||(f[d+8+4>>2]&2146435072|0)==2146435072?(_=3,Ae=v,_|0):(En(d,h,_),h=Wa(_,h)|0,_=me()|0,f[m>>2]=h,f[m+4>>2]=_,(h|0)==0&(_|0)==0&&Qt(23313,22674,786,22697),_=0,Ae=v,_|0)}function Rs(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0;if(v=m+4|0,E=oe(d|0,h|0,52)|0,me()|0,E=E&15,I=oe(d|0,h|0,45)|0,me()|0,_=(E|0)==0,In(I&127)|0){if(_)return I=1,I|0;_=1}else{if(_)return I=0,I|0;!(f[v>>2]|0)&&!(f[m+8>>2]|0)?_=(f[m+12>>2]|0)!=0&1:_=1}for(m=1;m&1?Oa(v):os(v),I=oe(d|0,h|0,(15-m|0)*3|0)|0,me()|0,Is(v,I&7),m>>>0<E>>>0;)m=m+1|0;return _|0}function eo(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0;if(X=Ae,Ae=Ae+16|0,O=X,G=oe(d|0,h|0,45)|0,me()|0,G=G&127,G>>>0>121)return f[m>>2]=0,f[m+4>>2]=0,f[m+8>>2]=0,f[m+12>>2]=0,G=5,Ae=X,G|0;e:do if(In(G)|0&&(E=oe(d|0,h|0,52)|0,me()|0,E=E&15,(E|0)!=0)){_=1;t:for(;;){switch(P=oe(d|0,h|0,(15-_|0)*3|0)|0,me()|0,P&7){case 5:break t;case 0:break;default:{_=h;break e}}if(_>>>0<E>>>0)_=_+1|0;else{_=h;break e}}for(v=1,_=h;h=(15-v|0)*3|0,I=ge(7,0,h|0)|0,P=_&~(me()|0),_=oe(d|0,_|0,h|0)|0,me()|0,_=ge(ss(_&7)|0,0,h|0)|0,d=d&~I|_,_=P|(me()|0),v>>>0<E>>>0;)v=v+1|0}else _=h;while(0);if(P=7696+(G*28|0)|0,f[m>>2]=f[P>>2],f[m+4>>2]=f[P+4>>2],f[m+8>>2]=f[P+8>>2],f[m+12>>2]=f[P+12>>2],!(Rs(d,_,m)|0))return G=0,Ae=X,G|0;if(I=m+4|0,f[O>>2]=f[I>>2],f[O+4>>2]=f[I+4>>2],f[O+8>>2]=f[I+8>>2],E=oe(d|0,_|0,52)|0,me()|0,P=E&15,E&1?(os(I),E=P+1|0):E=P,!(In(G)|0))_=0;else{e:do if(!P)_=0;else for(h=1;;){if(v=oe(d|0,_|0,(15-h|0)*3|0)|0,me()|0,v=v&7,v|0){_=v;break e}if(h>>>0<P>>>0)h=h+1|0;else{_=0;break}}while(0);_=(_|0)==4&1}if(!(ra(m,E,_,0)|0))(E|0)!=(P|0)&&(f[I>>2]=f[O>>2],f[I+4>>2]=f[O+4>>2],f[I+8>>2]=f[O+8>>2]);else{if(In(G)|0)do;while(ra(m,E,0,0)|0);(E|0)!=(P|0)&&Ba(I)}return G=0,Ae=X,G|0}function Lo(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0;return E=Ae,Ae=Ae+16|0,_=E,v=eo(d,h,_)|0,v|0?(Ae=E,v|0):(v=oe(d|0,h|0,52)|0,me()|0,Ua(_,v&15,m),v=0,Ae=E,v|0)}function sa(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0;if(I=Ae,Ae=Ae+16|0,E=I,_=eo(d,h,E)|0,_|0)return E=_,Ae=I,E|0;_=oe(d|0,h|0,45)|0,me()|0,_=(In(_&127)|0)==0,v=oe(d|0,h|0,52)|0,me()|0,v=v&15;e:do if(!_){if(v|0)for(_=1;;){if(P=ge(7,0,(15-_|0)*3|0)|0,!((P&d|0)==0&((me()|0)&h|0)==0))break e;if(_>>>0<v>>>0)_=_+1|0;else break}return as(E,v,0,5,m),P=0,Ae=I,P|0}while(0);return Ic(E,v,0,6,m),P=0,Ae=I,P|0}function qa(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0;if(v=oe(d|0,h|0,45)|0,me()|0,!(In(v&127)|0))return v=2,f[m>>2]=v,0;if(v=oe(d|0,h|0,52)|0,me()|0,v=v&15,!v)return v=5,f[m>>2]=v,0;for(_=1;;){if(E=ge(7,0,(15-_|0)*3|0)|0,!((E&d|0)==0&((me()|0)&h|0)==0)){_=2,d=6;break}if(_>>>0<v>>>0)_=_+1|0;else{_=5,d=6;break}}return(d|0)==6&&(f[m>>2]=_),0}function Pc(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0;de=Ae,Ae=Ae+128|0,G=de+112|0,E=de+96|0,X=de,v=oe(d|0,h|0,52)|0,me()|0,P=v&15,f[G>>2]=P,I=oe(d|0,h|0,45)|0,me()|0,I=I&127;e:do if(In(I)|0){if(P|0)for(_=1;;){if(O=ge(7,0,(15-_|0)*3|0)|0,!((O&d|0)==0&((me()|0)&h|0)==0)){v=0;break e}if(_>>>0<P>>>0)_=_+1|0;else break}if(v&1)v=1;else return O=ge(P+1|0,0,52)|0,X=me()|0|h&-15728641,G=ge(7,0,(14-P|0)*3|0)|0,X=Pc((O|d)&~G,X&~(me()|0),m)|0,Ae=de,X|0}else v=0;while(0);if(_=eo(d,h,E)|0,!_){v?(Ou(E,G,X),O=5):(Va(E,G,X),O=6);e:do if(In(I)|0)if(!P)d=5;else for(_=1;;){if(I=ge(7,0,(15-_|0)*3|0)|0,!((I&d|0)==0&((me()|0)&h|0)==0)){d=2;break e}if(_>>>0<P>>>0)_=_+1|0;else{d=5;break}}else d=2;while(0);je(m|0,-1,d<<2|0)|0;e:do if(v)for(E=0;;){if(I=X+(E<<4)|0,Fu(I,f[G>>2]|0)|0,I=f[I>>2]|0,P=f[m>>2]|0,(P|0)==-1|(P|0)==(I|0))_=m;else{v=0;do{if(v=v+1|0,v>>>0>=d>>>0){_=1;break e}_=m+(v<<2)|0,P=f[_>>2]|0}while(!((P|0)==-1|(P|0)==(I|0)))}if(f[_>>2]=I,E=E+1|0,E>>>0>=O>>>0){_=0;break}}else for(E=0;;){if(I=X+(E<<4)|0,ra(I,f[G>>2]|0,0,1)|0,I=f[I>>2]|0,P=f[m>>2]|0,(P|0)==-1|(P|0)==(I|0))_=m;else{v=0;do{if(v=v+1|0,v>>>0>=d>>>0){_=1;break e}_=m+(v<<2)|0,P=f[_>>2]|0}while(!((P|0)==-1|(P|0)==(I|0)))}if(f[_>>2]=I,E=E+1|0,E>>>0>=O>>>0){_=0;break}}while(0)}return X=_,Ae=de,X|0}function ju(){return 12}function Bl(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0,O=0;if(d>>>0>15)return P=4,P|0;if(ge(d|0,0,52)|0,P=me()|0|134225919,!d){m=0,_=0;do In(_)|0&&(ge(_|0,0,45)|0,I=P|(me()|0),d=h+(m<<3)|0,f[d>>2]=-1,f[d+4>>2]=I,m=m+1|0),_=_+1|0;while((_|0)!=122);return m=0,m|0}m=0,I=0;do{if(In(I)|0){for(ge(I|0,0,45)|0,_=1,v=-1,E=P|(me()|0);O=ge(7,0,(15-_|0)*3|0)|0,v=v&~O,E=E&~(me()|0),(_|0)!=(d|0);)_=_+1|0;O=h+(m<<3)|0,f[O>>2]=v,f[O+4>>2]=E,m=m+1|0}I=I+1|0}while((I|0)!=122);return m=0,m|0}function aa(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0;if(He=Ae,Ae=Ae+16|0,Je=He,Ye=oe(d|0,h|0,52)|0,me()|0,Ye=Ye&15,m>>>0>15)return Ye=4,Ae=He,Ye|0;if((Ye|0)<(m|0))return Ye=12,Ae=He,Ye|0;if((Ye|0)!=(m|0))if(E=ge(m|0,0,52)|0,E=E|d,P=me()|0|h&-15728641,(Ye|0)>(m|0)){O=m;do ze=ge(7,0,(14-O|0)*3|0)|0,O=O+1|0,E=ze|E,P=me()|0|P;while((O|0)<(Ye|0));ze=E}else ze=E;else ze=d,P=h;be=oe(ze|0,P|0,45)|0,me()|0;e:do if(In(be&127)|0){if(O=oe(ze|0,P|0,52)|0,me()|0,O=O&15,O|0)for(E=1;;){if(be=ge(7,0,(15-E|0)*3|0)|0,!((be&ze|0)==0&((me()|0)&P|0)==0)){G=33;break e}if(E>>>0<O>>>0)E=E+1|0;else break}if(be=_,f[be>>2]=0,f[be+4>>2]=0,(Ye|0)>(m|0)){for(be=h&-15728641,Re=Ye;;){if(ve=Re,Re=Re+-1|0,Re>>>0>15|(Ye|0)<(Re|0)){G=19;break}if((Ye|0)!=(Re|0))if(E=ge(Re|0,0,52)|0,E=E|d,O=me()|0|be,(Ye|0)<(ve|0))de=E;else{G=Re;do de=ge(7,0,(14-G|0)*3|0)|0,G=G+1|0,E=de|E,O=me()|0|O;while((G|0)<(Ye|0));de=E}else de=d,O=h;if(X=oe(de|0,O|0,45)|0,me()|0,!(In(X&127)|0))E=0;else{X=oe(de|0,O|0,52)|0,me()|0,X=X&15;t:do if(!X)E=0;else for(G=1;;){if(E=oe(de|0,O|0,(15-G|0)*3|0)|0,me()|0,E=E&7,E|0)break t;if(G>>>0<X>>>0)G=G+1|0;else{E=0;break}}while(0);E=(E|0)==0&1}if(O=oe(d|0,h|0,(15-ve|0)*3|0)|0,me()|0,O=O&7,(O|0)==7){v=5,G=42;break}if(E=(E|0)!=0,(O|0)==1&E){v=5,G=42;break}if(de=O+(((O|0)!=0&E)<<31>>31)|0,de|0&&(G=Ye-ve|0,G=xo(7,0,G,((G|0)<0)<<31>>31)|0,X=me()|0,E?(E=J(G|0,X|0,5,0)|0,E=M(E|0,me()|0,-5,-1)|0,E=$(E|0,me()|0,6,0)|0,E=M(E|0,me()|0,1,0)|0,O=me()|0):(E=G,O=X),ve=de+-1|0,ve=J(G|0,X|0,ve|0,((ve|0)<0)<<31>>31|0)|0,ve=M(E|0,O|0,ve|0,me()|0)|0,de=me()|0,X=_,X=M(ve|0,de|0,f[X>>2]|0,f[X+4>>2]|0)|0,de=me()|0,ve=_,f[ve>>2]=X,f[ve+4>>2]=de),(Re|0)<=(m|0)){G=37;break}}if((G|0)==19)Qt(23313,22674,1099,22710);else if((G|0)==37){I=_,v=f[I+4>>2]|0,I=f[I>>2]|0;break}else if((G|0)==42)return Ae=He,v|0}else v=0,I=0}else G=33;while(0);e:do if((G|0)==33)if(be=_,f[be>>2]=0,f[be+4>>2]=0,(Ye|0)>(m|0)){for(E=Ye;;){if(v=oe(d|0,h|0,(15-E|0)*3|0)|0,me()|0,v=v&7,(v|0)==7){v=5;break}if(I=Ye-E|0,I=xo(7,0,I,((I|0)<0)<<31>>31)|0,v=J(I|0,me()|0,v|0,0)|0,I=me()|0,be=_,I=M(f[be>>2]|0,f[be+4>>2]|0,v|0,I|0)|0,v=me()|0,be=_,f[be>>2]=I,f[be+4>>2]=v,E=E+-1|0,(E|0)<=(m|0))break e}return Ae=He,v|0}else v=0,I=0;while(0);return Ha(ze,P,Ye,Je)|0&&Qt(23313,22674,1063,22725),Ye=Je,Je=f[Ye+4>>2]|0,((v|0)>-1|(v|0)==-1&I>>>0>4294967295)&((Je|0)>(v|0)|((Je|0)==(v|0)?(f[Ye>>2]|0)>>>0>I>>>0:0))?(Ye=0,Ae=He,Ye|0):(Qt(23313,22674,1139,22710),0)}function Gu(d,h,m,_,v,E){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0,E=E|0;var I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0;if(de=Ae,Ae=Ae+16|0,I=de,v>>>0>15)return E=4,Ae=de,E|0;if(P=oe(m|0,_|0,52)|0,me()|0,P=P&15,(P|0)>(v|0))return E=12,Ae=de,E|0;if(Ha(m,_,v,I)|0&&Qt(23313,22674,1063,22725),X=I,G=f[X+4>>2]|0,!(((h|0)>-1|(h|0)==-1&d>>>0>4294967295)&((G|0)>(h|0)|((G|0)==(h|0)?(f[X>>2]|0)>>>0>d>>>0:0))))return E=2,Ae=de,E|0;X=v-P|0,v=ge(v|0,0,52)|0,O=me()|0|_&-15728641,G=E,f[G>>2]=v|m,f[G+4>>2]=O,G=oe(m|0,_|0,45)|0,me()|0;e:do if(In(G&127)|0){if(P|0)for(I=1;;){if(G=ge(7,0,(15-I|0)*3|0)|0,!((G&m|0)==0&((me()|0)&_|0)==0))break e;if(I>>>0<P>>>0)I=I+1|0;else break}if((X|0)<1)return E=0,Ae=de,E|0;for(G=P^15,_=-1,O=1,I=1;;){P=X-O|0,P=xo(7,0,P,((P|0)<0)<<31>>31)|0,m=me()|0;do if(I)if(I=J(P|0,m|0,5,0)|0,I=M(I|0,me()|0,-5,-1)|0,I=$(I|0,me()|0,6,0)|0,v=me()|0,(h|0)>(v|0)|(h|0)==(v|0)&d>>>0>I>>>0){h=M(d|0,h|0,-1,-1)|0,h=L(h|0,me()|0,I|0,v|0)|0,I=me()|0,ve=E,be=f[ve>>2]|0,ve=f[ve+4>>2]|0,ze=(G+_|0)*3|0,Re=ge(7,0,ze|0)|0,ve=ve&~(me()|0),_=$(h|0,I|0,P|0,m|0)|0,d=me()|0,v=M(_|0,d|0,2,0)|0,ze=ge(v|0,me()|0,ze|0)|0,ve=me()|0|ve,v=E,f[v>>2]=ze|be&~Re,f[v+4>>2]=ve,d=J(_|0,d|0,P|0,m|0)|0,d=L(h|0,I|0,d|0,me()|0)|0,I=0,h=me()|0;break}else{ze=E,Re=f[ze>>2]|0,ze=f[ze+4>>2]|0,be=ge(7,0,(G+_|0)*3|0)|0,ze=ze&~(me()|0),I=E,f[I>>2]=Re&~be,f[I+4>>2]=ze,I=1;break}else Re=E,v=f[Re>>2]|0,Re=f[Re+4>>2]|0,_=(G+_|0)*3|0,ve=ge(7,0,_|0)|0,Re=Re&~(me()|0),ze=$(d|0,h|0,P|0,m|0)|0,I=me()|0,_=ge(ze|0,I|0,_|0)|0,Re=me()|0|Re,be=E,f[be>>2]=_|v&~ve,f[be+4>>2]=Re,I=J(ze|0,I|0,P|0,m|0)|0,d=L(d|0,h|0,I|0,me()|0)|0,I=0,h=me()|0;while(0);if((X|0)>(O|0))_=~O,O=O+1|0;else{h=0;break}}return Ae=de,h|0}while(0);if((X|0)<1)return ze=0,Ae=de,ze|0;for(v=P^15,I=1;;)if(be=X-I|0,be=xo(7,0,be,((be|0)<0)<<31>>31)|0,ze=me()|0,O=E,m=f[O>>2]|0,O=f[O+4>>2]|0,P=(v-I|0)*3|0,_=ge(7,0,P|0)|0,O=O&~(me()|0),ve=$(d|0,h|0,be|0,ze|0)|0,Re=me()|0,P=ge(ve|0,Re|0,P|0)|0,O=me()|0|O,G=E,f[G>>2]=P|m&~_,f[G+4>>2]=O,ze=J(ve|0,Re|0,be|0,ze|0)|0,d=L(d|0,h|0,ze|0,me()|0)|0,h=me()|0,(X|0)<=(I|0)){h=0;break}else I=I+1|0;return Ae=de,h|0}function la(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0;v=oe(h|0,m|0,52)|0,me()|0,v=v&15,(h|0)==0&(m|0)==0|((_|0)>15|(v|0)>(_|0))?(_=-1,v=-1,h=0,m=0):(E=Jr(h,m,v+1|0,_)|0,m=(me()|0)&-15728641,h=ge(_|0,0,52)|0,h=E|h,m=m|(me()|0),E=(Gn(h,m)|0)==0,_=E?-1:_),E=d,f[E>>2]=h,f[E+4>>2]=m,f[d+8>>2]=v,f[d+12>>2]=_}function ca(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0,O=0,G=0;if(m=d,h=f[m>>2]|0,m=f[m+4>>2]|0,!((h|0)==0&(m|0)==0)&&(_=oe(h|0,m|0,52)|0,me()|0,_=_&15,P=ge(1,0,(_^15)*3|0)|0,h=M(P|0,me()|0,h|0,m|0)|0,m=me()|0,P=d,f[P>>2]=h,f[P+4>>2]=m,P=d+8|0,I=f[P>>2]|0,!((_|0)<(I|0)))){for(O=d+12|0,E=_;;){if((E|0)==(I|0)){_=5;break}if(G=(E|0)==(f[O>>2]|0),v=(15-E|0)*3|0,_=oe(h|0,m|0,v|0)|0,me()|0,_=_&7,G&((_|0)==1&!0)){_=7;break}if(!((_|0)==7&!0)){_=10;break}if(G=ge(1,0,v|0)|0,h=M(h|0,m|0,G|0,me()|0)|0,m=me()|0,G=d,f[G>>2]=h,f[G+4>>2]=m,(E|0)>(I|0))E=E+-1|0;else{_=10;break}}if((_|0)==5){G=d,f[G>>2]=0,f[G+4>>2]=0,f[P>>2]=-1,f[O>>2]=-1;return}else if((_|0)==7){I=ge(1,0,v|0)|0,I=M(h|0,m|0,I|0,me()|0)|0,P=me()|0,G=d,f[G>>2]=I,f[G+4>>2]=P,f[O>>2]=E+-1;return}else if((_|0)==10)return}}function Hi(d){d=+d;var h=0;return h=d<0?d+6.283185307179586:d,+(d>=6.283185307179586?h+-6.283185307179586:h)}function yo(d,h){return d=d|0,h=h|0,+Me(+(+H[d>>3]-+H[h>>3]))<17453292519943298e-27?(h=+Me(+(+H[d+8>>3]-+H[h+8>>3]))<17453292519943298e-27,h|0):(h=0,h|0)}function Tr(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0;return v=+H[h>>3],_=+H[d>>3],E=+lt(+((v-_)*.5)),m=+lt(+((+H[h+8>>3]-+H[d+8>>3])*.5)),m=E*E+m*(+Ne(+v)*+Ne(+_)*m),+(+en(+ +Fe(+m),+ +Fe(+(1-m)))*2)}function Qa(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0;return v=+H[h>>3],_=+H[d>>3],E=+lt(+((v-_)*.5)),m=+lt(+((+H[h+8>>3]-+H[d+8>>3])*.5)),m=E*E+m*(+Ne(+v)*+Ne(+_)*m),+(+en(+ +Fe(+m),+ +Fe(+(1-m)))*2*6371.007180918475)}function ls(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0;return v=+H[h>>3],_=+H[d>>3],E=+lt(+((v-_)*.5)),m=+lt(+((+H[h+8>>3]-+H[d+8>>3])*.5)),m=E*E+m*(+Ne(+v)*+Ne(+_)*m),+(+en(+ +Fe(+m),+ +Fe(+(1-m)))*2*6371.007180918475*1e3)}function Hu(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0;return E=+H[h>>3],_=+Ne(+E),v=+H[h+8>>3]-+H[d+8>>3],I=_*+lt(+v),m=+H[d>>3],+ +en(+I,+(+lt(+E)*+Ne(+m)-+Ne(+v)*(_*+lt(+m))))}function Ro(d,h,m,_){d=d|0,h=+h,m=+m,_=_|0;var v=0,E=0,I=0,P=0;if(m<1e-16){f[_>>2]=f[d>>2],f[_+4>>2]=f[d+4>>2],f[_+8>>2]=f[d+8>>2],f[_+12>>2]=f[d+12>>2];return}E=h<0?h+6.283185307179586:h,E=h>=6.283185307179586?E+-6.283185307179586:E;do if(E<1e-16)h=+H[d>>3]+m,H[_>>3]=h,v=_;else{if(v=+Me(+(E+-3.141592653589793))<1e-16,h=+H[d>>3],v){h=h-m,H[_>>3]=h,v=_;break}if(I=+Ne(+m),m=+lt(+m),h=I*+lt(+h)+ +Ne(+E)*(m*+Ne(+h)),h=h>1?1:h,h=+$t(+(h<-1?-1:h)),H[_>>3]=h,+Me(+(h+-1.5707963267948966))<1e-16){H[_>>3]=1.5707963267948966,H[_+8>>3]=0;return}if(+Me(+(h+1.5707963267948966))<1e-16){H[_>>3]=-1.5707963267948966,H[_+8>>3]=0;return}if(P=+Ne(+h),E=m*+lt(+E)/P,m=+H[d>>3],h=(I-+lt(+h)*+lt(+m))/+Ne(+m)/P,I=E>1?1:E,h=h>1?1:h,h=+H[d+8>>3]+ +en(+(I<-1?-1:I),+(h<-1?-1:h)),h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);H[_+8>>3]=h;return}while(0);if(+Me(+(h+-1.5707963267948966))<1e-16){H[v>>3]=1.5707963267948966,H[_+8>>3]=0;return}if(+Me(+(h+1.5707963267948966))<1e-16){H[v>>3]=-1.5707963267948966,H[_+8>>3]=0;return}if(h=+H[d+8>>3],h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);H[_+8>>3]=h}function Xa(d,h){return d=d|0,h=h|0,d>>>0>15?(h=4,h|0):(H[h>>3]=+H[20528+(d<<3)>>3],h=0,h|0)}function Lc(d,h){return d=d|0,h=h|0,d>>>0>15?(h=4,h|0):(H[h>>3]=+H[20656+(d<<3)>>3],h=0,h|0)}function Th(d,h){return d=d|0,h=h|0,d>>>0>15?(h=4,h|0):(H[h>>3]=+H[20784+(d<<3)>>3],h=0,h|0)}function Sh(d,h){return d=d|0,h=h|0,d>>>0>15?(h=4,h|0):(H[h>>3]=+H[20912+(d<<3)>>3],h=0,h|0)}function ua(d,h){d=d|0,h=h|0;var m=0;return d>>>0>15?(h=4,h|0):(m=xo(7,0,d,((d|0)<0)<<31>>31)|0,m=J(m|0,me()|0,120,0)|0,d=me()|0,f[h>>2]=m|2,f[h+4>>2]=d,h=0,h|0)}function fa(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0;return ve=+H[h>>3],X=+H[d>>3],O=+lt(+((ve-X)*.5)),E=+H[h+8>>3],G=+H[d+8>>3],I=+lt(+((E-G)*.5)),P=+Ne(+X),de=+Ne(+ve),I=O*O+I*(de*P*I),I=+en(+ +Fe(+I),+ +Fe(+(1-I)))*2,O=+H[m>>3],ve=+lt(+((O-ve)*.5)),_=+H[m+8>>3],E=+lt(+((_-E)*.5)),v=+Ne(+O),E=ve*ve+E*(de*v*E),E=+en(+ +Fe(+E),+ +Fe(+(1-E)))*2,O=+lt(+((X-O)*.5)),_=+lt(+((G-_)*.5)),_=O*O+_*(P*v*_),_=+en(+ +Fe(+_),+ +Fe(+(1-_)))*2,v=(I+E+_)*.5,+(+Ft(+ +Fe(+(+Tt(+(v*.5))*+Tt(+((v-I)*.5))*+Tt(+((v-E)*.5))*+Tt(+((v-_)*.5)))))*4)}function to(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0;if(P=Ae,Ae=Ae+192|0,E=P+168|0,I=P,v=Lo(d,h,E)|0,v|0)return m=v,Ae=P,m|0;if(sa(d,h,I)|0&&Qt(23313,22742,386,22751),h=f[I>>2]|0,(h|0)>0){if(_=+fa(I+8|0,I+8+(((h|0)!=1&1)<<4)|0,E)+0,(h|0)!=1){d=1;do v=d,d=d+1|0,_=_+ +fa(I+8+(v<<4)|0,I+8+(((d|0)%(h|0)|0)<<4)|0,E);while((d|0)<(h|0))}}else _=0;return H[m>>3]=_,m=0,Ae=P,m|0}function Pt(d,h,m){return d=d|0,h=h|0,m=m|0,d=to(d,h,m)|0,d|0||(H[m>>3]=+H[m>>3]*6371.007180918475*6371.007180918475),d|0}function $u(d,h,m){return d=d|0,h=h|0,m=m|0,d=to(d,h,m)|0,d|0||(H[m>>3]=+H[m>>3]*6371.007180918475*6371.007180918475*1e3*1e3),d|0}function Ds(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0;if(P=Ae,Ae=Ae+176|0,I=P,d=Na(d,h,I)|0,d|0)return I=d,Ae=P,I|0;if(H[m>>3]=0,d=f[I>>2]|0,(d|0)<=1)return I=0,Ae=P,I|0;h=d+-1|0,d=0,_=+H[I+8>>3],v=+H[I+16>>3],E=0;do d=d+1|0,G=_,_=+H[I+8+(d<<4)>>3],X=+lt(+((_-G)*.5)),O=v,v=+H[I+8+(d<<4)+8>>3],O=+lt(+((v-O)*.5)),O=X*X+O*(+Ne(+_)*+Ne(+G)*O),E=E+ +en(+ +Fe(+O),+ +Fe(+(1-O)))*2;while((d|0)<(h|0));return H[m>>3]=E,I=0,Ae=P,I|0}function cs(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0;if(P=Ae,Ae=Ae+176|0,I=P,d=Na(d,h,I)|0,d|0)return I=d,E=+H[m>>3],E=E*6371.007180918475,H[m>>3]=E,Ae=P,I|0;if(H[m>>3]=0,d=f[I>>2]|0,(d|0)<=1)return I=0,E=0,E=E*6371.007180918475,H[m>>3]=E,Ae=P,I|0;h=d+-1|0,d=0,_=+H[I+8>>3],v=+H[I+16>>3],E=0;do d=d+1|0,G=_,_=+H[I+8+(d<<4)>>3],X=+lt(+((_-G)*.5)),O=v,v=+H[I+8+(d<<4)+8>>3],O=+lt(+((v-O)*.5)),O=X*X+O*(+Ne(+G)*+Ne(+_)*O),E=E+ +en(+ +Fe(+O),+ +Fe(+(1-O)))*2;while((d|0)!=(h|0));return H[m>>3]=E,I=0,X=E,X=X*6371.007180918475,H[m>>3]=X,Ae=P,I|0}function Rc(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0;if(P=Ae,Ae=Ae+176|0,I=P,d=Na(d,h,I)|0,d|0)return I=d,E=+H[m>>3],E=E*6371.007180918475,E=E*1e3,H[m>>3]=E,Ae=P,I|0;if(H[m>>3]=0,d=f[I>>2]|0,(d|0)<=1)return I=0,E=0,E=E*6371.007180918475,E=E*1e3,H[m>>3]=E,Ae=P,I|0;h=d+-1|0,d=0,_=+H[I+8>>3],v=+H[I+16>>3],E=0;do d=d+1|0,G=_,_=+H[I+8+(d<<4)>>3],X=+lt(+((_-G)*.5)),O=v,v=+H[I+8+(d<<4)+8>>3],O=+lt(+((v-O)*.5)),O=X*X+O*(+Ne(+G)*+Ne(+_)*O),E=E+ +en(+ +Fe(+O),+ +Fe(+(1-O)))*2;while((d|0)!=(h|0));return H[m>>3]=E,I=0,X=E,X=X*6371.007180918475,X=X*1e3,H[m>>3]=X,Ae=P,I|0}function St(d){d=d|0;var h=0,m=0,_=0;return h=w(1,12)|0,h||Qt(22832,22787,49,22845),m=d+4|0,_=f[m>>2]|0,_|0?(_=_+8|0,f[_>>2]=h,f[m>>2]=h,h|0):(f[d>>2]|0&&Qt(22862,22787,61,22885),_=d,f[_>>2]=h,f[m>>2]=h,h|0)}function Ol(d,h){d=d|0,h=h|0;var m=0,_=0;return _=A(24)|0,_||Qt(22899,22787,78,22913),f[_>>2]=f[h>>2],f[_+4>>2]=f[h+4>>2],f[_+8>>2]=f[h+8>>2],f[_+12>>2]=f[h+12>>2],f[_+16>>2]=0,h=d+4|0,m=f[h>>2]|0,m|0?(f[m+16>>2]=_,f[h>>2]=_,_|0):(f[d>>2]|0&&Qt(22928,22787,82,22913),f[d>>2]=_,f[h>>2]=_,_|0)}function Wu(d){d=d|0;var h=0,m=0,_=0,v=0;if(d)for(_=1;;){if(h=f[d>>2]|0,h|0)do{if(m=f[h>>2]|0,m|0)do v=m,m=f[m+16>>2]|0,y(v);while(m|0);v=h,h=f[h+8>>2]|0,y(v)}while(h|0);if(h=d,d=f[d+8>>2]|0,_||y(h),d)_=0;else break}}function Dc(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0,Be=0,bt=0,yt=0,ot=0,ut=0,cn=0,on=0,Kt=0,tn=0,sn=0,fn=0,zn=0,un=0;if(v=d+8|0,f[v>>2]|0)return un=1,un|0;if(_=f[d>>2]|0,!_)return un=0,un|0;h=_,m=0;do m=m+1|0,h=f[h+8>>2]|0;while(h|0);if(m>>>0<2)return un=0,un|0;fn=A(m<<2)|0,fn||Qt(22948,22787,317,22967),sn=A(m<<5)|0,sn||Qt(22989,22787,321,22967),f[d>>2]=0,yt=d+4|0,f[yt>>2]=0,f[v>>2]=0,m=0,tn=0,bt=0,de=0;e:for(;;){if(X=f[_>>2]|0,X){E=0,I=X;do{if(O=+H[I+8>>3],h=I,I=f[I+16>>2]|0,G=(I|0)==0,v=G?X:I,P=+H[v+8>>3],+Me(+(O-P))>3.141592653589793){un=14;break}E=E+(P-O)*(+H[h>>3]+ +H[v>>3])}while(!G);if((un|0)==14){un=0,E=0,h=X;do Be=+H[h+8>>3],Kt=h+16|0,on=f[Kt>>2]|0,on=on|0?on:X,$e=+H[on+8>>3],E=E+(+H[h>>3]+ +H[on>>3])*(($e<0?$e+6.283185307179586:$e)-(Be<0?Be+6.283185307179586:Be)),h=f[(h|0?Kt:_)>>2]|0;while(h|0)}E>0?(f[fn+(tn<<2)>>2]=_,tn=tn+1|0,v=bt,h=de):un=19}else un=19;if((un|0)==19){un=0;do if(m){if(h=m+8|0,f[h>>2]|0){un=21;break e}if(m=w(1,12)|0,!m){un=23;break e}f[h>>2]=m,v=m+4|0,I=m,h=de}else if(de){v=yt,I=de+8|0,h=_,m=d;break}else if(f[d>>2]|0){un=27;break e}else{v=yt,I=d,h=_,m=d;break}while(0);if(f[I>>2]=_,f[v>>2]=_,I=sn+(bt<<5)|0,G=f[_>>2]|0,G){for(X=sn+(bt<<5)+8|0,H[X>>3]=17976931348623157e292,de=sn+(bt<<5)+24|0,H[de>>3]=17976931348623157e292,H[I>>3]=-17976931348623157e292,ve=sn+(bt<<5)+16|0,H[ve>>3]=-17976931348623157e292,Ye=17976931348623157e292,He=-17976931348623157e292,v=0,Re=G,O=17976931348623157e292,ze=17976931348623157e292,Je=-17976931348623157e292,P=-17976931348623157e292;E=+H[Re>>3],Be=+H[Re+8>>3],Re=f[Re+16>>2]|0,be=(Re|0)==0,$e=+H[(be?G:Re)+8>>3],E<O&&(H[X>>3]=E,O=E),Be<ze&&(H[de>>3]=Be,ze=Be),E>Je?H[I>>3]=E:E=Je,Be>P&&(H[ve>>3]=Be,P=Be),Ye=Be>0&Be<Ye?Be:Ye,He=Be<0&Be>He?Be:He,v=v|+Me(+(Be-$e))>3.141592653589793,!be;)Je=E;v&&(H[ve>>3]=He,H[de>>3]=Ye)}else f[I>>2]=0,f[I+4>>2]=0,f[I+8>>2]=0,f[I+12>>2]=0,f[I+16>>2]=0,f[I+20>>2]=0,f[I+24>>2]=0,f[I+28>>2]=0;v=bt+1|0}if(Kt=_+8|0,_=f[Kt>>2]|0,f[Kt>>2]=0,_)bt=v,de=h;else{un=45;break}}if((un|0)==21)Qt(22765,22787,35,22799);else if((un|0)==23)Qt(22819,22787,37,22799);else if((un|0)==27)Qt(22862,22787,61,22885);else if((un|0)==45){e:do if((tn|0)>0){for(Kt=(v|0)==0,cn=v<<2,on=(d|0)==0,ut=0,h=0;;){if(ot=f[fn+(ut<<2)>>2]|0,Kt)un=73;else{if(bt=A(cn)|0,!bt){un=50;break}if(yt=A(cn)|0,!yt){un=52;break}t:do if(on)m=0;else{for(v=0,m=0,I=d;_=sn+(v<<5)|0,Fl(f[I>>2]|0,_,f[ot>>2]|0)|0?(f[bt+(m<<2)>>2]=I,f[yt+(m<<2)>>2]=_,be=m+1|0):be=m,I=f[I+8>>2]|0,I;)v=v+1|0,m=be;if((be|0)>0)if(_=f[bt>>2]|0,(be|0)==1)m=_;else for(ve=0,Re=-1,m=_,de=_;;){for(G=f[de>>2]|0,_=0,I=0;v=f[f[bt+(I<<2)>>2]>>2]|0,(v|0)==(G|0)?X=_:X=_+((Fl(v,f[yt+(I<<2)>>2]|0,f[G>>2]|0)|0)&1)|0,I=I+1|0,(I|0)!=(be|0);)_=X;if(v=(X|0)>(Re|0),m=v?de:m,_=ve+1|0,(_|0)==(be|0))break t;ve=_,Re=v?X:Re,de=f[bt+(_<<2)>>2]|0}else m=0}while(0);if(y(bt),y(yt),m){if(v=m+4|0,_=f[v>>2]|0,_)m=_+8|0;else if(f[m>>2]|0){un=70;break}f[m>>2]=ot,f[v>>2]=ot}else un=73}if((un|0)==73){if(un=0,h=f[ot>>2]|0,h|0)do yt=h,h=f[h+16>>2]|0,y(yt);while(h|0);y(ot),h=1}if(ut=ut+1|0,(ut|0)>=(tn|0)){zn=h;break e}}(un|0)==50?Qt(23004,22787,249,23023):(un|0)==52?Qt(23042,22787,252,23023):(un|0)==70&&Qt(22862,22787,61,22885)}else zn=0;while(0);return y(fn),y(sn),un=zn,un|0}return 0}function Fl(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0;if(!(Ec(h,m)|0)||(h=Dn(h)|0,_=+H[m>>3],v=+H[m+8>>3],v=h&v<0?v+6.283185307179586:v,d=f[d>>2]|0,!d))return d=0,d|0;if(h){h=0,G=v,m=d;e:for(;;){for(;I=+H[m>>3],v=+H[m+8>>3],m=m+16|0,X=f[m>>2]|0,X=X|0?X:d,E=+H[X>>3],P=+H[X+8>>3],I>E?(O=I,I=P):(O=E,E=I,I=v,v=P),_=_==E|_==O?_+2220446049250313e-31:_,!!(_<E|_>O);)if(m=f[m>>2]|0,!m){m=22;break e}if(P=I<0?I+6.283185307179586:I,I=v<0?v+6.283185307179586:v,G=P==G|I==G?G+-2220446049250313e-31:G,O=P+(I-P)*((_-E)/(O-E)),(O<0?O+6.283185307179586:O)>G&&(h=h^1),m=f[m>>2]|0,!m){m=22;break}}if((m|0)==22)return h|0}else{h=0,G=v,m=d;e:for(;;){for(;I=+H[m>>3],v=+H[m+8>>3],m=m+16|0,X=f[m>>2]|0,X=X|0?X:d,E=+H[X>>3],P=+H[X+8>>3],I>E?(O=I,I=P):(O=E,E=I,I=v,v=P),_=_==E|_==O?_+2220446049250313e-31:_,!!(_<E|_>O);)if(m=f[m>>2]|0,!m){m=22;break e}if(G=I==G|v==G?G+-2220446049250313e-31:G,I+(v-I)*((_-E)/(O-E))>G&&(h=h^1),m=f[m>>2]|0,!m){m=22;break}}if((m|0)==22)return h|0}return 0}function vo(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0;if(He=Ae,Ae=Ae+32|0,Ye=He+16|0,Je=He,E=oe(d|0,h|0,52)|0,me()|0,E=E&15,Re=oe(m|0,_|0,52)|0,me()|0,(E|0)!=(Re&15|0))return Ye=12,Ae=He,Ye|0;if(G=oe(d|0,h|0,45)|0,me()|0,G=G&127,X=oe(m|0,_|0,45)|0,me()|0,X=X&127,G>>>0>121|X>>>0>121)return Ye=5,Ae=He,Ye|0;if(Re=(G|0)!=(X|0),Re){if(P=Ra(G,X)|0,(P|0)==7)return Ye=1,Ae=He,Ye|0;O=Ra(X,G)|0,(O|0)==7?Qt(23066,23090,161,23100):(be=P,I=O)}else be=0,I=0;de=In(G)|0,ve=In(X)|0,f[Ye>>2]=0,f[Ye+4>>2]=0,f[Ye+8>>2]=0,f[Ye+12>>2]=0;do if(be){if(X=f[4272+(G*28|0)+(be<<2)>>2]|0,P=(X|0)>0,ve)if(P){G=0,O=m,P=_;do O=Vu(O,P)|0,P=me()|0,I=ss(I)|0,(I|0)==1&&(I=ss(1)|0),G=G+1|0;while((G|0)!=(X|0));X=I,G=O,O=P}else X=I,G=m,O=_;else if(P){G=0,O=m,P=_;do O=zl(O,P)|0,P=me()|0,I=ss(I)|0,G=G+1|0;while((G|0)!=(X|0));X=I,G=O,O=P}else X=I,G=m,O=_;if(Rs(G,O,Ye)|0,Re||Qt(23115,23090,191,23100),P=(de|0)!=0,I=(ve|0)!=0,P&I&&Qt(23142,23090,192,23100),P){if(I=Mi(d,h)|0,(I|0)==7){E=5;break}if(ie[21872+(I*7|0)+be>>0]|0){E=1;break}O=f[21040+(I*28|0)+(be<<2)>>2]|0,G=O}else if(I){if(I=Mi(G,O)|0,(I|0)==7){E=5;break}if(ie[21872+(I*7|0)+X>>0]|0){E=1;break}G=0,O=f[21040+(X*28|0)+(I<<2)>>2]|0}else G=0,O=0;if((G|O|0)<0)E=5;else{if((O|0)>0){P=Ye+4|0,I=0;do kl(P),I=I+1|0;while((I|0)!=(O|0))}if(f[Je>>2]=0,f[Je+4>>2]=0,f[Je+8>>2]=0,Is(Je,be),E|0)for(;Ar(E)|0?Oa(Je):os(Je),(E|0)>1;)E=E+-1|0;if((G|0)>0){E=0;do kl(Je),E=E+1|0;while((E|0)!=(G|0))}ze=Ye+4|0,Oi(ze,Je,ze),Zn(ze),ze=51}}else if(Rs(m,_,Ye)|0,(de|0)!=0&(ve|0)!=0)if((X|0)!=(G|0)&&Qt(23173,23090,261,23100),I=Mi(d,h)|0,E=Mi(m,_)|0,(I|0)==7|(E|0)==7)E=5;else if(ie[21872+(I*7|0)+E>>0]|0)E=1;else if(I=f[21040+(I*28|0)+(E<<2)>>2]|0,(I|0)>0){P=Ye+4|0,E=0;do kl(P),E=E+1|0;while((E|0)!=(I|0));ze=51}else ze=51;else ze=51;while(0);return(ze|0)==51&&(E=Ye+4|0,f[v>>2]=f[E>>2],f[v+4>>2]=f[E+4>>2],f[v+8>>2]=f[E+8>>2],E=0),Ye=E,Ae=He,Ye|0}function zc(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0;if(ze=Ae,Ae=Ae+48|0,G=ze+36|0,I=ze+24|0,P=ze+12|0,O=ze,v=oe(d|0,h|0,52)|0,me()|0,v=v&15,ve=oe(d|0,h|0,45)|0,me()|0,ve=ve&127,ve>>>0>121)return _=5,Ae=ze,_|0;if(X=In(ve)|0,ge(v|0,0,52)|0,Je=me()|0|134225919,E=_,f[E>>2]=-1,f[E+4>>2]=Je,!v)return v=ta(m)|0,(v|0)==7||(v=La(ve,v)|0,(v|0)==127)?(Je=1,Ae=ze,Je|0):(Re=ge(v|0,0,45)|0,be=me()|0,ve=_,be=f[ve+4>>2]&-1040385|be,Je=_,f[Je>>2]=f[ve>>2]|Re,f[Je+4>>2]=be,Je=0,Ae=ze,Je|0);for(f[G>>2]=f[m>>2],f[G+4>>2]=f[m+4>>2],f[G+8>>2]=f[m+8>>2],m=v;;){if(E=m,m=m+-1|0,f[I>>2]=f[G>>2],f[I+4>>2]=f[G+4>>2],f[I+8>>2]=f[G+8>>2],Ar(E)|0){if(v=Cl(G)|0,v|0){m=13;break}f[P>>2]=f[G>>2],f[P+4>>2]=f[G+4>>2],f[P+8>>2]=f[G+8>>2],Oa(P)}else{if(v=Tc(G)|0,v|0){m=13;break}f[P>>2]=f[G>>2],f[P+4>>2]=f[G+4>>2],f[P+8>>2]=f[G+8>>2],os(P)}if(ea(I,P,O),Zn(O),v=_,He=f[v>>2]|0,v=f[v+4>>2]|0,$e=(15-E|0)*3|0,Ye=ge(7,0,$e|0)|0,v=v&~(me()|0),$e=ge(ta(O)|0,0,$e|0)|0,v=me()|0|v,Je=_,f[Je>>2]=$e|He&~Ye,f[Je+4>>2]=v,(E|0)<=1){m=14;break}}e:do if((m|0)!=13&&(m|0)==14)if((f[G>>2]|0)<=1&&(f[G+4>>2]|0)<=1&&(f[G+8>>2]|0)<=1){m=ta(G)|0,v=La(ve,m)|0,(v|0)==127?O=0:O=In(v)|0;t:do if(m){if(X){if(v=Mi(d,h)|0,(v|0)==7){v=5;break e}if(E=f[21248+(v*28|0)+(m<<2)>>2]|0,(E|0)>0){v=m,m=0;do v=Cs(v)|0,m=m+1|0;while((m|0)!=(E|0))}else v=m;if((v|0)==1){v=9;break e}m=La(ve,v)|0,(m|0)==127&&Qt(23200,23090,411,23230),In(m)|0?Qt(23245,23090,412,23230):(be=m,Re=E,de=v)}else be=v,Re=0,de=m;if(P=f[4272+(ve*28|0)+(de<<2)>>2]|0,(P|0)<=-1&&Qt(23276,23090,419,23230),!O){if((Re|0)<0){v=5;break e}if(Re|0){E=_,v=0,m=f[E>>2]|0,E=f[E+4>>2]|0;do m=_o(m,E)|0,E=me()|0,$e=_,f[$e>>2]=m,f[$e+4>>2]=E,v=v+1|0;while((v|0)<(Re|0))}if((P|0)<=0){v=be,m=58;break}for(E=_,v=0,m=f[E>>2]|0,E=f[E+4>>2]|0;;)if(m=_o(m,E)|0,E=me()|0,$e=_,f[$e>>2]=m,f[$e+4>>2]=E,v=v+1|0,(v|0)==(P|0)){v=be,m=58;break t}}if(I=Ra(be,ve)|0,(I|0)==7&&Qt(23066,23090,428,23230),v=_,m=f[v>>2]|0,v=f[v+4>>2]|0,(P|0)>0){E=0;do m=_o(m,v)|0,v=me()|0,$e=_,f[$e>>2]=m,f[$e+4>>2]=v,E=E+1|0;while((E|0)!=(P|0))}if(v=Mi(m,v)|0,(v|0)==7&&Qt(23313,23090,440,23230),m=Tl(be)|0,m=f[(m?21664:21456)+(I*28|0)+(v<<2)>>2]|0,(m|0)<0&&Qt(23313,23090,454,23230),!m)v=be,m=58;else{I=_,v=0,E=f[I>>2]|0,I=f[I+4>>2]|0;do E=kc(E,I)|0,I=me()|0,$e=_,f[$e>>2]=E,f[$e+4>>2]=I,v=v+1|0;while((v|0)<(m|0));v=be,m=58}}else if((X|0)!=0&(O|0)!=0){if(m=Mi(d,h)|0,E=_,E=Mi(f[E>>2]|0,f[E+4>>2]|0)|0,(m|0)==7|(E|0)==7){v=5;break e}if(E=f[21248+(m*28|0)+(E<<2)>>2]|0,(E|0)<0){v=5;break e}if(!E)m=59;else{P=_,m=0,I=f[P>>2]|0,P=f[P+4>>2]|0;do I=_o(I,P)|0,P=me()|0,$e=_,f[$e>>2]=I,f[$e+4>>2]=P,m=m+1|0;while((m|0)<(E|0));m=58}}else m=58;while(0);if((m|0)==58&&O&&(m=59),(m|0)==59&&($e=_,(Mi(f[$e>>2]|0,f[$e+4>>2]|0)|0)==1)){v=9;break}$e=_,Ye=f[$e>>2]|0,$e=f[$e+4>>2]&-1040385,He=ge(v|0,0,45)|0,$e=$e|(me()|0),v=_,f[v>>2]=Ye|He,f[v+4>>2]=$e,v=0}else v=1;while(0);return $e=v,Ae=ze,$e|0}function Mh(d,h,m,_,v,E){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0,E=E|0;var I=0,P=0;return P=Ae,Ae=Ae+16|0,I=P,v?d=15:(d=vo(d,h,m,_,I)|0,d||(Pl(I,E),d=0)),Ae=P,d|0}function Zu(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0;return I=Ae,Ae=Ae+16|0,E=I,_?m=15:(m=Mc(m,E)|0,m||(m=zc(d,h,E,v)|0)),Ae=I,m|0}function Bc(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0;return O=Ae,Ae=Ae+32|0,I=O+12|0,P=O,E=vo(d,h,d,h,I)|0,E|0?(P=E,Ae=O,P|0):(d=vo(d,h,m,_,P)|0,d|0?(P=d,Ae=O,P|0):(I=Fa(I,P)|0,P=v,f[P>>2]=I,f[P+4>>2]=((I|0)<0)<<31>>31,P=0,Ae=O,P|0))}function Oc(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0;return O=Ae,Ae=Ae+32|0,I=O+12|0,P=O,E=vo(d,h,d,h,I)|0,!E&&(E=vo(d,h,m,_,P)|0,!E)?(_=Fa(I,P)|0,_=M(_|0,((_|0)<0)<<31>>31|0,1,0)|0,I=me()|0,P=v,f[P>>2]=_,f[P+4>>2]=I,P=0,Ae=O,P|0):(P=E,Ae=O,P|0)}function Fc(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0,Be=0,bt=0,yt=0,ot=0,ut=0;if(ot=Ae,Ae=Ae+48|0,I=ot+24|0,P=ot+12|0,yt=ot,E=vo(d,h,d,h,I)|0,!E&&(E=vo(d,h,m,_,P)|0,!E)){Be=Fa(I,P)|0,bt=((Be|0)<0)<<31>>31,f[I>>2]=0,f[I+4>>2]=0,f[I+8>>2]=0,f[P>>2]=0,f[P+4>>2]=0,f[P+8>>2]=0,vo(d,h,d,h,I)|0&&Qt(23313,23090,691,23299),vo(d,h,m,_,P)|0&&Qt(23313,23090,696,23299),Ll(I),Ll(P),Be?(de=f[I>>2]|0,be=+(Be|0),Ye=I+4|0,ve=f[Ye>>2]|0,He=I+8|0,Re=f[He>>2]|0,$e=I,_=de,E=ve,m=Re,ze=+((f[P>>2]|0)-de|0)/be,Je=+((f[P+4>>2]|0)-ve|0)/be,be=+((f[P+8>>2]|0)-Re|0)/be):(E=I+4|0,m=I+8|0,Ye=E,He=m,$e=I,_=f[I>>2]|0,E=f[E>>2]|0,m=f[m>>2]|0,ze=0,Je=0,be=0),f[yt>>2]=_,Re=yt+4|0,f[Re>>2]=E,ve=yt+8|0,f[ve>>2]=m;e:do if((Be|0)<0)E=0;else for(X=0,de=0,E=_;;){G=+(de>>>0)+4294967296*+(X|0),ut=ze*G+ +(E|0),O=Je*G+ +(f[Ye>>2]|0),G=be*G+ +(f[He>>2]|0),m=~~+Ee(+ut),I=~~+Ee(+O),E=~~+Ee(+G),ut=+Me(+(+(m|0)-ut)),O=+Me(+(+(I|0)-O)),G=+Me(+(+(E|0)-G));do if(ut>O&ut>G)m=0-(I+E)|0,_=I;else if(P=0-m|0,O>G){_=P-E|0;break}else{_=I,E=P-I|0;break}while(0);if(f[yt>>2]=m,f[Re>>2]=_,f[ve>>2]=E,na(yt),E=zc(d,h,yt,v+(de<<3)|0)|0,E|0)break e;if(!((X|0)<(bt|0)|(X|0)==(bt|0)&de>>>0<Be>>>0)){E=0;break e}E=M(de|0,X|0,1,0)|0,P=me()|0,X=P,de=E,E=f[$e>>2]|0}while(0);return yt=E,Ae=ot,yt|0}return yt=E,Ae=ot,yt|0}function xo(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0;if((m|0)==0&(_|0)==0)return v=0,E=1,Ot(v|0),E|0;E=d,v=h,d=1,h=0;do I=(m&1|0)==0&!0,d=J((I?1:E)|0,(I?0:v)|0,d|0,h|0)|0,h=me()|0,m=_e(m|0,_|0,1)|0,_=me()|0,E=J(E|0,v|0,E|0,v|0)|0,v=me()|0;while(!((m|0)==0&(_|0)==0));return Ot(h|0),d|0}function sr(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0;if(!(Ec(h,m)|0)||(h=Dn(h)|0,_=+H[m>>3],v=+H[m+8>>3],v=h&v<0?v+6.283185307179586:v,ve=f[d>>2]|0,(ve|0)<=0))return ve=0,ve|0;if(de=f[d+4>>2]|0,h){h=0,X=v,m=-1,d=0;e:for(;;){for(G=d;I=+H[de+(G<<4)>>3],v=+H[de+(G<<4)+8>>3],d=(m+2|0)%(ve|0)|0,E=+H[de+(d<<4)>>3],P=+H[de+(d<<4)+8>>3],I>E?(O=I,I=P):(O=E,E=I,I=v,v=P),_=_==E|_==O?_+2220446049250313e-31:_,!!(_<E|_>O);)if(m=G+1|0,(m|0)>=(ve|0)){m=22;break e}else d=G,G=m,m=d;if(P=I<0?I+6.283185307179586:I,I=v<0?v+6.283185307179586:v,X=P==X|I==X?X+-2220446049250313e-31:X,O=P+(I-P)*((_-E)/(O-E)),(O<0?O+6.283185307179586:O)>X&&(h=h^1),d=G+1|0,(d|0)>=(ve|0)){m=22;break}else m=G}if((m|0)==22)return h|0}else{h=0,X=v,m=-1,d=0;e:for(;;){for(G=d;I=+H[de+(G<<4)>>3],v=+H[de+(G<<4)+8>>3],d=(m+2|0)%(ve|0)|0,E=+H[de+(d<<4)>>3],P=+H[de+(d<<4)+8>>3],I>E?(O=I,I=P):(O=E,E=I,I=v,v=P),_=_==E|_==O?_+2220446049250313e-31:_,!!(_<E|_>O);)if(m=G+1|0,(m|0)>=(ve|0)){m=22;break e}else d=G,G=m,m=d;if(X=I==X|v==X?X+-2220446049250313e-31:X,I+(v-I)*((_-E)/(O-E))>X&&(h=h^1),d=G+1|0,(d|0)>=(ve|0)){m=22;break}else m=G}if((m|0)==22)return h|0}return 0}function Do(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0;if(be=f[d>>2]|0,!be){f[h>>2]=0,f[h+4>>2]=0,f[h+8>>2]=0,f[h+12>>2]=0,f[h+16>>2]=0,f[h+20>>2]=0,f[h+24>>2]=0,f[h+28>>2]=0;return}if(ze=h+8|0,H[ze>>3]=17976931348623157e292,Je=h+24|0,H[Je>>3]=17976931348623157e292,H[h>>3]=-17976931348623157e292,Ye=h+16|0,H[Ye>>3]=-17976931348623157e292,!((be|0)<=0)){for(ve=f[d+4>>2]|0,G=17976931348623157e292,X=-17976931348623157e292,de=0,d=-1,E=17976931348623157e292,I=17976931348623157e292,O=-17976931348623157e292,_=-17976931348623157e292,Re=0;m=+H[ve+(Re<<4)>>3],P=+H[ve+(Re<<4)+8>>3],d=d+2|0,v=+H[ve+(((d|0)==(be|0)?0:d)<<4)+8>>3],m<E&&(H[ze>>3]=m,E=m),P<I&&(H[Je>>3]=P,I=P),m>O?H[h>>3]=m:m=O,P>_&&(H[Ye>>3]=P,_=P),G=P>0&P<G?P:G,X=P<0&P>X?P:X,de=de|+Me(+(P-v))>3.141592653589793,d=Re+1|0,(d|0)!=(be|0);)He=Re,O=m,Re=d,d=He;de&&(H[Ye>>3]=X,H[Je>>3]=G)}}function qu(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0,Be=0,bt=0,yt=0,ot=0;if(be=f[d>>2]|0,be){if(ze=h+8|0,H[ze>>3]=17976931348623157e292,Je=h+24|0,H[Je>>3]=17976931348623157e292,H[h>>3]=-17976931348623157e292,Ye=h+16|0,H[Ye>>3]=-17976931348623157e292,(be|0)>0){for(v=f[d+4>>2]|0,ve=17976931348623157e292,Re=-17976931348623157e292,_=0,m=-1,O=17976931348623157e292,G=17976931348623157e292,de=-17976931348623157e292,I=-17976931348623157e292,He=0;E=+H[v+(He<<4)>>3],X=+H[v+(He<<4)+8>>3],yt=m+2|0,P=+H[v+(((yt|0)==(be|0)?0:yt)<<4)+8>>3],E<O&&(H[ze>>3]=E,O=E),X<G&&(H[Je>>3]=X,G=X),E>de?H[h>>3]=E:E=de,X>I&&(H[Ye>>3]=X,I=X),ve=X>0&X<ve?X:ve,Re=X<0&X>Re?X:Re,_=_|+Me(+(X-P))>3.141592653589793,m=He+1|0,(m|0)!=(be|0);)yt=He,de=E,He=m,m=yt;_&&(H[Ye>>3]=Re,H[Je>>3]=ve)}}else f[h>>2]=0,f[h+4>>2]=0,f[h+8>>2]=0,f[h+12>>2]=0,f[h+16>>2]=0,f[h+20>>2]=0,f[h+24>>2]=0,f[h+28>>2]=0;if(yt=d+8|0,m=f[yt>>2]|0,!((m|0)<=0)){bt=d+12|0,Be=0;do if(v=f[bt>>2]|0,_=Be,Be=Be+1|0,Je=h+(Be<<5)|0,Ye=f[v+(_<<3)>>2]|0,Ye){if(He=h+(Be<<5)+8|0,H[He>>3]=17976931348623157e292,d=h+(Be<<5)+24|0,H[d>>3]=17976931348623157e292,H[Je>>3]=-17976931348623157e292,$e=h+(Be<<5)+16|0,H[$e>>3]=-17976931348623157e292,(Ye|0)>0){for(be=f[v+(_<<3)+4>>2]|0,ve=17976931348623157e292,Re=-17976931348623157e292,v=0,_=-1,ze=0,O=17976931348623157e292,G=17976931348623157e292,X=-17976931348623157e292,I=-17976931348623157e292;E=+H[be+(ze<<4)>>3],de=+H[be+(ze<<4)+8>>3],_=_+2|0,P=+H[be+(((_|0)==(Ye|0)?0:_)<<4)+8>>3],E<O&&(H[He>>3]=E,O=E),de<G&&(H[d>>3]=de,G=de),E>X?H[Je>>3]=E:E=X,de>I&&(H[$e>>3]=de,I=de),ve=de>0&de<ve?de:ve,Re=de<0&de>Re?de:Re,v=v|+Me(+(de-P))>3.141592653589793,_=ze+1|0,(_|0)!=(Ye|0);)ot=ze,ze=_,X=E,_=ot;v&&(H[$e>>3]=Re,H[d>>3]=ve)}}else f[Je>>2]=0,f[Je+4>>2]=0,f[Je+8>>2]=0,f[Je+12>>2]=0,f[Je+16>>2]=0,f[Je+20>>2]=0,f[Je+24>>2]=0,f[Je+28>>2]=0,m=f[yt>>2]|0;while((Be|0)<(m|0))}}function ha(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0;if(!(sr(d,h,m)|0))return v=0,v|0;if(v=d+8|0,(f[v>>2]|0)<=0)return v=1,v|0;for(_=d+12|0,d=0;;){if(E=d,d=d+1|0,sr((f[_>>2]|0)+(E<<3)|0,h+(d<<5)|0,m)|0){d=0,_=6;break}if((d|0)>=(f[v>>2]|0)){d=1,_=6;break}}return(_|0)==6?d|0:0}function Nc(){return 8}function Ya(){return 16}function Qu(){return 168}function Fr(){return 8}function Kn(){return 16}function Ka(){return 12}function Nl(){return 8}function Xu(d){return d=d|0,+(+((f[d>>2]|0)>>>0)+4294967296*+(f[d+4>>2]|0))}function Yu(d){d=d|0;var h=0,m=0;return m=+H[d>>3],h=+H[d+8>>3],+ +Fe(+(m*m+h*h))}function Uc(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0;G=+H[d>>3],O=+H[h>>3]-G,P=+H[d+8>>3],I=+H[h+8>>3]-P,de=+H[m>>3],E=+H[_>>3]-de,ve=+H[m+8>>3],X=+H[_+8>>3]-ve,E=(E*(P-ve)-(G-de)*X)/(O*X-I*E),H[v>>3]=G+O*E,H[v+8>>3]=P+I*E}function Ku(d,h){return d=d|0,h=h|0,+Me(+(+H[d>>3]-+H[h>>3]))<11920928955078125e-23?(h=+Me(+(+H[d+8>>3]-+H[h+8>>3]))<11920928955078125e-23,h|0):(h=0,h|0)}function Hn(d,h){d=d|0,h=h|0;var m=0,_=0,v=0;return v=+H[d>>3]-+H[h>>3],_=+H[d+8>>3]-+H[h+8>>3],m=+H[d+16>>3]-+H[h+16>>3],+(v*v+_*_+m*m)}function Ja(d,h){d=d|0,h=h|0;var m=0,_=0,v=0;m=+H[d>>3],_=+Ne(+m),m=+lt(+m),H[h+16>>3]=m,m=+H[d+8>>3],v=_*+Ne(+m),H[h>>3]=v,m=_*+lt(+m),H[h+8>>3]=m}function Ut(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0;if(E=Ae,Ae=Ae+16|0,v=E,_=Gn(d,h)|0,(m+-1|0)>>>0>5||(_=(_|0)!=0,(m|0)==1&_))return v=-1,Ae=E,v|0;do if(qt(d,h,v)|0)_=-1;else if(_){_=((f[21936+(m<<2)>>2]|0)+5-(f[v>>2]|0)|0)%5|0;break}else{_=((f[21968+(m<<2)>>2]|0)+6-(f[v>>2]|0)|0)%6|0;break}while(0);return v=_,Ae=E,v|0}function qt(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0,G=0;if(G=Ae,Ae=Ae+32|0,I=G+16|0,P=G,_=eo(d,h,I)|0,_|0)return m=_,Ae=G,m|0;E=oa(d,h)|0,O=Mi(d,h)|0,Mu(E,P),_=Eh(E,f[I>>2]|0)|0;e:do if(In(E)|0){do switch(E|0){case 4:{d=0;break}case 14:{d=1;break}case 24:{d=2;break}case 38:{d=3;break}case 49:{d=4;break}case 58:{d=5;break}case 63:{d=6;break}case 72:{d=7;break}case 83:{d=8;break}case 97:{d=9;break}case 107:{d=10;break}case 117:{d=11;break}default:{_=1;break e}}while(0);if(v=f[22e3+(d*24|0)+8>>2]|0,h=f[22e3+(d*24|0)+16>>2]|0,d=f[I>>2]|0,(d|0)!=(f[P>>2]|0)&&(P=Tl(E)|0,d=f[I>>2]|0,P|(d|0)==(h|0)&&(_=(_+1|0)%6|0)),(O|0)==3&(d|0)==(h|0)){_=(_+5|0)%6|0,v=22;break}(O|0)==5&(d|0)==(v|0)&&(_=(_+1|0)%6|0),v=22}else v=22;while(0);return(v|0)==22&&(f[m>>2]=_,_=0),m=_,Ae=G,m|0}function $i(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0;if($e=Ae,Ae=Ae+32|0,He=$e+24|0,Je=$e+20|0,be=$e+8|0,Re=$e+16|0,ve=$e,O=(Gn(d,h)|0)==0,O=O?6:5,X=oe(d|0,h|0,52)|0,me()|0,X=X&15,O>>>0<=m>>>0)return _=2,Ae=$e,_|0;de=(X|0)==0,!de&&(ze=ge(7,0,(X^15)*3|0)|0,(ze&d|0)==0&((me()|0)&h|0)==0)?v=m:E=4;e:do if((E|0)==4){if(v=(Gn(d,h)|0)!=0,((v?4:5)|0)<(m|0)||qt(d,h,He)|0||(E=(f[He>>2]|0)+m|0,v?v=22288+(((E|0)%5|0)<<2)|0:v=22320+(((E|0)%6|0)<<2)|0,ze=f[v>>2]|0,(ze|0)==7))return _=1,Ae=$e,_|0;f[Je>>2]=0,v=Ie(d,h,ze,Je,be)|0;do if(!v){if(P=be,G=f[P>>2]|0,P=f[P+4>>2]|0,I=P>>>0<h>>>0|(P|0)==(h|0)&G>>>0<d>>>0,E=I?G:d,I=I?P:h,!de&&(de=ge(7,0,(X^15)*3|0)|0,(G&de|0)==0&(P&(me()|0)|0)==0))v=m;else{if(P=(m+-1+O|0)%(O|0)|0,v=Gn(d,h)|0,(P|0)<0&&Qt(23313,23315,245,23324),O=(v|0)!=0,((O?4:5)|0)<(P|0)&&Qt(23313,23315,245,23324),qt(d,h,He)|0&&Qt(23313,23315,245,23324),v=(f[He>>2]|0)+P|0,O?v=22288+(((v|0)%5|0)<<2)|0:v=22320+(((v|0)%6|0)<<2)|0,P=f[v>>2]|0,(P|0)==7&&Qt(23313,23315,245,23324),f[Re>>2]=0,v=Ie(d,h,P,Re,ve)|0,v|0)break;G=ve,O=f[G>>2]|0,G=f[G+4>>2]|0;do if(G>>>0<I>>>0|(G|0)==(I|0)&O>>>0<E>>>0){if(Gn(O,G)|0?E=qe(O,G,d,h)|0:E=f[22384+((((f[Re>>2]|0)+(f[22352+(P<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,v=Gn(O,G)|0,(E+-1|0)>>>0>5){v=-1,E=O,I=G;break}if(v=(v|0)!=0,(E|0)==1&v){v=-1,E=O,I=G;break}do if(qt(O,G,He)|0)v=-1;else if(v){v=((f[21936+(E<<2)>>2]|0)+5-(f[He>>2]|0)|0)%5|0;break}else{v=((f[21968+(E<<2)>>2]|0)+6-(f[He>>2]|0)|0)%6|0;break}while(0);E=O,I=G}else v=m;while(0);P=be,G=f[P>>2]|0,P=f[P+4>>2]|0}if((E|0)==(G|0)&(I|0)==(P|0)){if(O=(Gn(G,P)|0)!=0,O?d=qe(G,P,d,h)|0:d=f[22384+((((f[Je>>2]|0)+(f[22352+(ze<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,v=Gn(G,P)|0,(d+-1|0)>>>0<=5&&(Ye=(v|0)!=0,!((d|0)==1&Ye)))do if(qt(G,P,He)|0)v=-1;else if(Ye){v=((f[21936+(d<<2)>>2]|0)+5-(f[He>>2]|0)|0)%5|0;break}else{v=((f[21968+(d<<2)>>2]|0)+6-(f[He>>2]|0)|0)%6|0;break}while(0);else v=-1;v=v+1|0,v=(v|0)==6|O&(v|0)==5?0:v}h=I,d=E;break e}while(0);return _=v,Ae=$e,_|0}while(0);return Ye=ge(v|0,0,56)|0,He=me()|0|h&-2130706433|536870912,f[_>>2]=Ye|d,f[_+4>>2]=He,_=0,Ae=$e,_|0}function Vc(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0;return E=(Gn(d,h)|0)==0,_=$i(d,h,0,m)|0,v=(_|0)==0,E?!v||(_=$i(d,h,1,m+8|0)|0,_|0)||(_=$i(d,h,2,m+16|0)|0,_|0)||(_=$i(d,h,3,m+24|0)|0,_|0)||(_=$i(d,h,4,m+32|0)|0,_)?(E=_,E|0):$i(d,h,5,m+40|0)|0:!v||(_=$i(d,h,1,m+8|0)|0,_|0)||(_=$i(d,h,2,m+16|0)|0,_|0)||(_=$i(d,h,3,m+24|0)|0,_|0)||(_=$i(d,h,4,m+32|0)|0,_|0)?(E=_,E|0):(E=m+40|0,f[E>>2]=0,f[E+4>>2]=0,E=0,E|0)}function us(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0,P=0,O=0;return O=Ae,Ae=Ae+192|0,v=O,E=O+168|0,I=oe(d|0,h|0,56)|0,me()|0,I=I&7,P=h&-2130706433|134217728,_=eo(d,P,E)|0,_|0?(P=_,Ae=O,P|0):(h=oe(d|0,h|0,52)|0,me()|0,h=h&15,Gn(d,P)|0?as(E,h,I,1,v):Ic(E,h,I,1,v),P=v+8|0,f[m>>2]=f[P>>2],f[m+4>>2]=f[P+4>>2],f[m+8>>2]=f[P+8>>2],f[m+12>>2]=f[P+12>>2],P=0,Ae=O,P|0)}function Wi(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0;return v=Ae,Ae=Ae+16|0,m=v,!(!0&(h&2013265920|0)==536870912)||(_=h&-2130706433|134217728,!(Ps(d,_)|0))?(_=0,Ae=v,_|0):(E=oe(d|0,h|0,56)|0,me()|0,E=($i(d,_,E&7,m)|0)==0,_=m,_=E&((f[_>>2]|0)==(d|0)?(f[_+4>>2]|0)==(h|0):0)&1,Ae=v,_|0)}function zo(d,h,m){d=d|0,h=h|0,m=m|0;var _=0;(h|0)>0?(_=w(h,4)|0,f[d>>2]=_,_||Qt(23337,23360,40,23374)):f[d>>2]=0,f[d+4>>2]=h,f[d+8>>2]=0,f[d+12>>2]=m}function no(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0;v=d+4|0,E=d+12|0,I=d+8|0;e:for(;;){for(m=f[v>>2]|0,h=0;;){if((h|0)>=(m|0))break e;if(_=f[d>>2]|0,P=f[_+(h<<2)>>2]|0,!P)h=h+1|0;else break}h=_+(~~(+Me(+(+rt(10,+ +(15-(f[E>>2]|0)|0))*(+H[P>>3]+ +H[P+8>>3])))%+(m|0))>>>0<<2)|0,m=f[h>>2]|0;t:do if(m|0){if(_=P+32|0,(m|0)==(P|0))f[h>>2]=f[_>>2];else{if(m=m+32|0,h=f[m>>2]|0,!h)break;for(;(h|0)!=(P|0);)if(m=h+32|0,h=f[m>>2]|0,!h)break t;f[m>>2]=f[_>>2]}y(P),f[I>>2]=(f[I>>2]|0)+-1}while(0)}y(f[d>>2]|0)}function jc(d){d=d|0;var h=0,m=0,_=0;for(_=f[d+4>>2]|0,m=0;;){if((m|0)>=(_|0)){h=0,m=4;break}if(h=f[(f[d>>2]|0)+(m<<2)>>2]|0,!h)m=m+1|0;else{m=4;break}}return(m|0)==4?h|0:0}function Bo(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0;if(m=~~(+Me(+(+rt(10,+ +(15-(f[d+12>>2]|0)|0))*(+H[h>>3]+ +H[h+8>>3])))%+(f[d+4>>2]|0))>>>0,m=(f[d>>2]|0)+(m<<2)|0,_=f[m>>2]|0,!_)return E=1,E|0;E=h+32|0;do if((_|0)!=(h|0)){if(m=f[_+32>>2]|0,!m)return E=1,E|0;for(v=m;;){if((v|0)==(h|0)){v=8;break}if(m=f[v+32>>2]|0,m)_=v,v=m;else{m=1,v=10;break}}if((v|0)==8){f[_+32>>2]=f[E>>2];break}else if((v|0)==10)return m|0}else f[m>>2]=f[E>>2];while(0);return y(h),E=d+8|0,f[E>>2]=(f[E>>2]|0)+-1,E=0,E|0}function li(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0;E=A(40)|0,E||Qt(23390,23360,98,23403),f[E>>2]=f[h>>2],f[E+4>>2]=f[h+4>>2],f[E+8>>2]=f[h+8>>2],f[E+12>>2]=f[h+12>>2],v=E+16|0,f[v>>2]=f[m>>2],f[v+4>>2]=f[m+4>>2],f[v+8>>2]=f[m+8>>2],f[v+12>>2]=f[m+12>>2],f[E+32>>2]=0,v=~~(+Me(+(+rt(10,+ +(15-(f[d+12>>2]|0)|0))*(+H[h>>3]+ +H[h+8>>3])))%+(f[d+4>>2]|0))>>>0,v=(f[d>>2]|0)+(v<<2)|0,_=f[v>>2]|0;do if(!_)f[v>>2]=E;else{for(;!(yo(_,h)|0&&yo(_+16|0,m)|0);)if(v=f[_+32>>2]|0,_=v|0?v:_,!(f[_+32>>2]|0)){I=10;break}if((I|0)==10){f[_+32>>2]=E;break}return y(E),I=_,I|0}while(0);return I=d+8|0,f[I>>2]=(f[I>>2]|0)+1,I=E,I|0}function bi(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0;if(v=~~(+Me(+(+rt(10,+ +(15-(f[d+12>>2]|0)|0))*(+H[h>>3]+ +H[h+8>>3])))%+(f[d+4>>2]|0))>>>0,v=f[(f[d>>2]|0)+(v<<2)>>2]|0,!v)return m=0,m|0;if(!m){for(d=v;;){if(yo(d,h)|0){_=10;break}if(d=f[d+32>>2]|0,!d){d=0,_=10;break}}if((_|0)==10)return d|0}for(d=v;;){if(yo(d,h)|0&&yo(d+16|0,m)|0){_=10;break}if(d=f[d+32>>2]|0,!d){d=0,_=10;break}}return(_|0)==10?d|0:0}function Gc(d,h){d=d|0,h=h|0;var m=0;if(m=~~(+Me(+(+rt(10,+ +(15-(f[d+12>>2]|0)|0))*(+H[h>>3]+ +H[h+8>>3])))%+(f[d+4>>2]|0))>>>0,d=f[(f[d>>2]|0)+(m<<2)>>2]|0,!d)return m=0,m|0;for(;;){if(yo(d,h)|0){h=5;break}if(d=f[d+32>>2]|0,!d){d=0,h=5;break}}return(h|0)==5?d|0:0}function zs(){return 23424}function x(d){return d=+d,+ +tt(+d)}function s(d){return d=+d,~~+x(d)|0}function A(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0,ze=0,Je=0,Ye=0,He=0,$e=0,Be=0,bt=0;bt=Ae,Ae=Ae+16|0,ve=bt;do if(d>>>0<245){if(G=d>>>0<11?16:d+11&-8,d=G>>>3,de=f[5857]|0,m=de>>>d,m&3|0)return h=(m&1^1)+d|0,d=23468+(h<<1<<2)|0,m=d+8|0,_=f[m>>2]|0,v=_+8|0,E=f[v>>2]|0,(E|0)==(d|0)?f[5857]=de&~(1<<h):(f[E+12>>2]=d,f[m>>2]=E),Be=h<<3,f[_+4>>2]=Be|3,Be=_+Be+4|0,f[Be>>2]=f[Be>>2]|1,Be=v,Ae=bt,Be|0;if(X=f[5859]|0,G>>>0>X>>>0){if(m|0)return h=2<<d,h=m<<d&(h|0-h),h=(h&0-h)+-1|0,P=h>>>12&16,h=h>>>P,m=h>>>5&8,h=h>>>m,E=h>>>2&4,h=h>>>E,d=h>>>1&2,h=h>>>d,_=h>>>1&1,_=(m|P|E|d|_)+(h>>>_)|0,h=23468+(_<<1<<2)|0,d=h+8|0,E=f[d>>2]|0,P=E+8|0,m=f[P>>2]|0,(m|0)==(h|0)?(d=de&~(1<<_),f[5857]=d):(f[m+12>>2]=h,f[d>>2]=m,d=de),Be=_<<3,I=Be-G|0,f[E+4>>2]=G|3,v=E+G|0,f[v+4>>2]=I|1,f[E+Be>>2]=I,X|0&&(_=f[5862]|0,h=X>>>3,m=23468+(h<<1<<2)|0,h=1<<h,d&h?(d=m+8|0,h=f[d>>2]|0):(f[5857]=d|h,h=m,d=m+8|0),f[d>>2]=_,f[h+12>>2]=_,f[_+8>>2]=h,f[_+12>>2]=m),f[5859]=I,f[5862]=v,Be=P,Ae=bt,Be|0;if(E=f[5858]|0,E){for(m=(E&0-E)+-1|0,v=m>>>12&16,m=m>>>v,_=m>>>5&8,m=m>>>_,I=m>>>2&4,m=m>>>I,P=m>>>1&2,m=m>>>P,O=m>>>1&1,O=f[23732+((_|v|I|P|O)+(m>>>O)<<2)>>2]|0,m=O,P=O,O=(f[O+4>>2]&-8)-G|0;d=f[m+16>>2]|0,!(!d&&(d=f[m+20>>2]|0,!d));)I=(f[d+4>>2]&-8)-G|0,v=I>>>0<O>>>0,m=d,P=v?d:P,O=v?I:O;if(I=P+G|0,I>>>0>P>>>0){v=f[P+24>>2]|0,h=f[P+12>>2]|0;do if((h|0)==(P|0)){if(d=P+20|0,h=f[d>>2]|0,!h&&(d=P+16|0,h=f[d>>2]|0,!h)){m=0;break}for(;;)if(_=h+20|0,m=f[_>>2]|0,m)h=m,d=_;else if(_=h+16|0,m=f[_>>2]|0,m)h=m,d=_;else break;f[d>>2]=0,m=h}else m=f[P+8>>2]|0,f[m+12>>2]=h,f[h+8>>2]=m,m=h;while(0);do if(v|0){if(h=f[P+28>>2]|0,d=23732+(h<<2)|0,(P|0)==(f[d>>2]|0)){if(f[d>>2]=m,!m){f[5858]=E&~(1<<h);break}}else if(Be=v+16|0,f[((f[Be>>2]|0)==(P|0)?Be:v+20|0)>>2]=m,!m)break;f[m+24>>2]=v,h=f[P+16>>2]|0,h|0&&(f[m+16>>2]=h,f[h+24>>2]=m),h=f[P+20>>2]|0,h|0&&(f[m+20>>2]=h,f[h+24>>2]=m)}while(0);return O>>>0<16?(Be=O+G|0,f[P+4>>2]=Be|3,Be=P+Be+4|0,f[Be>>2]=f[Be>>2]|1):(f[P+4>>2]=G|3,f[I+4>>2]=O|1,f[I+O>>2]=O,X|0&&(_=f[5862]|0,h=X>>>3,m=23468+(h<<1<<2)|0,h=1<<h,h&de?(d=m+8|0,h=f[d>>2]|0):(f[5857]=h|de,h=m,d=m+8|0),f[d>>2]=_,f[h+12>>2]=_,f[_+8>>2]=h,f[_+12>>2]=m),f[5859]=O,f[5862]=I),Be=P+8|0,Ae=bt,Be|0}else de=G}else de=G}else de=G}else if(d>>>0<=4294967231)if(d=d+11|0,G=d&-8,_=f[5858]|0,_){v=0-G|0,d=d>>>8,d?G>>>0>16777215?O=31:(de=(d+1048320|0)>>>16&8,ze=d<<de,P=(ze+520192|0)>>>16&4,ze=ze<<P,O=(ze+245760|0)>>>16&2,O=14-(P|de|O)+(ze<<O>>>15)|0,O=G>>>(O+7|0)&1|O<<1):O=0,m=f[23732+(O<<2)>>2]|0;e:do if(!m)m=0,d=0,ze=61;else for(d=0,P=G<<((O|0)==31?0:25-(O>>>1)|0),E=0;;){if(I=(f[m+4>>2]&-8)-G|0,I>>>0<v>>>0)if(I)d=m,v=I;else{d=m,v=0,ze=65;break e}if(ze=f[m+20>>2]|0,m=f[m+16+(P>>>31<<2)>>2]|0,E=(ze|0)==0|(ze|0)==(m|0)?E:ze,m)P=P<<1;else{m=E,ze=61;break}}while(0);if((ze|0)==61){if((m|0)==0&(d|0)==0){if(d=2<<O,d=(d|0-d)&_,!d){de=G;break}de=(d&0-d)+-1|0,I=de>>>12&16,de=de>>>I,E=de>>>5&8,de=de>>>E,P=de>>>2&4,de=de>>>P,O=de>>>1&2,de=de>>>O,m=de>>>1&1,d=0,m=f[23732+((E|I|P|O|m)+(de>>>m)<<2)>>2]|0}m?ze=65:(P=d,I=v)}if((ze|0)==65)for(E=m;;)if(de=(f[E+4>>2]&-8)-G|0,m=de>>>0<v>>>0,v=m?de:v,d=m?E:d,m=f[E+16>>2]|0,m||(m=f[E+20>>2]|0),m)E=m;else{P=d,I=v;break}if(P|0&&I>>>0<((f[5859]|0)-G|0)>>>0&&(X=P+G|0,X>>>0>P>>>0)){E=f[P+24>>2]|0,h=f[P+12>>2]|0;do if((h|0)==(P|0)){if(d=P+20|0,h=f[d>>2]|0,!h&&(d=P+16|0,h=f[d>>2]|0,!h)){h=0;break}for(;;)if(v=h+20|0,m=f[v>>2]|0,m)h=m,d=v;else if(v=h+16|0,m=f[v>>2]|0,m)h=m,d=v;else break;f[d>>2]=0}else Be=f[P+8>>2]|0,f[Be+12>>2]=h,f[h+8>>2]=Be;while(0);do if(E){if(d=f[P+28>>2]|0,m=23732+(d<<2)|0,(P|0)==(f[m>>2]|0)){if(f[m>>2]=h,!h){_=_&~(1<<d),f[5858]=_;break}}else if(Be=E+16|0,f[((f[Be>>2]|0)==(P|0)?Be:E+20|0)>>2]=h,!h)break;f[h+24>>2]=E,d=f[P+16>>2]|0,d|0&&(f[h+16>>2]=d,f[d+24>>2]=h),d=f[P+20>>2]|0,d&&(f[h+20>>2]=d,f[d+24>>2]=h)}while(0);e:do if(I>>>0<16)Be=I+G|0,f[P+4>>2]=Be|3,Be=P+Be+4|0,f[Be>>2]=f[Be>>2]|1;else{if(f[P+4>>2]=G|3,f[X+4>>2]=I|1,f[X+I>>2]=I,h=I>>>3,I>>>0<256){m=23468+(h<<1<<2)|0,d=f[5857]|0,h=1<<h,d&h?(d=m+8|0,h=f[d>>2]|0):(f[5857]=d|h,h=m,d=m+8|0),f[d>>2]=X,f[h+12>>2]=X,f[X+8>>2]=h,f[X+12>>2]=m;break}if(h=I>>>8,h?I>>>0>16777215?m=31:($e=(h+1048320|0)>>>16&8,Be=h<<$e,He=(Be+520192|0)>>>16&4,Be=Be<<He,m=(Be+245760|0)>>>16&2,m=14-(He|$e|m)+(Be<<m>>>15)|0,m=I>>>(m+7|0)&1|m<<1):m=0,h=23732+(m<<2)|0,f[X+28>>2]=m,d=X+16|0,f[d+4>>2]=0,f[d>>2]=0,d=1<<m,!(_&d)){f[5858]=_|d,f[h>>2]=X,f[X+24>>2]=h,f[X+12>>2]=X,f[X+8>>2]=X;break}h=f[h>>2]|0;t:do if((f[h+4>>2]&-8|0)!=(I|0)){for(_=I<<((m|0)==31?0:25-(m>>>1)|0);m=h+16+(_>>>31<<2)|0,d=f[m>>2]|0,!!d;)if((f[d+4>>2]&-8|0)==(I|0)){h=d;break t}else _=_<<1,h=d;f[m>>2]=X,f[X+24>>2]=h,f[X+12>>2]=X,f[X+8>>2]=X;break e}while(0);$e=h+8|0,Be=f[$e>>2]|0,f[Be+12>>2]=X,f[$e>>2]=X,f[X+8>>2]=Be,f[X+12>>2]=h,f[X+24>>2]=0}while(0);return Be=P+8|0,Ae=bt,Be|0}else de=G}else de=G;else de=-1;while(0);if(m=f[5859]|0,m>>>0>=de>>>0)return h=m-de|0,d=f[5862]|0,h>>>0>15?(Be=d+de|0,f[5862]=Be,f[5859]=h,f[Be+4>>2]=h|1,f[d+m>>2]=h,f[d+4>>2]=de|3):(f[5859]=0,f[5862]=0,f[d+4>>2]=m|3,Be=d+m+4|0,f[Be>>2]=f[Be>>2]|1),Be=d+8|0,Ae=bt,Be|0;if(I=f[5860]|0,I>>>0>de>>>0)return He=I-de|0,f[5860]=He,Be=f[5863]|0,$e=Be+de|0,f[5863]=$e,f[$e+4>>2]=He|1,f[Be+4>>2]=de|3,Be=Be+8|0,Ae=bt,Be|0;if(f[5975]|0?d=f[5977]|0:(f[5977]=4096,f[5976]=4096,f[5978]=-1,f[5979]=-1,f[5980]=0,f[5968]=0,f[5975]=ve&-16^1431655768,d=4096),P=de+48|0,O=de+47|0,E=d+O|0,v=0-d|0,G=E&v,G>>>0<=de>>>0||(d=f[5967]|0,d|0&&(X=f[5965]|0,ve=X+G|0,ve>>>0<=X>>>0|ve>>>0>d>>>0)))return Be=0,Ae=bt,Be|0;e:do if(f[5968]&4)h=0,ze=143;else{m=f[5863]|0;t:do if(m){for(_=23876;ve=f[_>>2]|0,!(ve>>>0<=m>>>0&&(ve+(f[_+4>>2]|0)|0)>>>0>m>>>0);)if(d=f[_+8>>2]|0,d)_=d;else{ze=128;break t}if(h=E-I&v,h>>>0<2147483647)if(d=Ke(h|0)|0,(d|0)==((f[_>>2]|0)+(f[_+4>>2]|0)|0)){if((d|0)!=-1){I=h,E=d,ze=145;break e}}else _=d,ze=136;else h=0}else ze=128;while(0);do if((ze|0)==128)if(m=Ke(0)|0,(m|0)!=-1&&(h=m,Re=f[5976]|0,be=Re+-1|0,h=(be&h|0?(be+h&0-Re)-h|0:0)+G|0,Re=f[5965]|0,be=h+Re|0,h>>>0>de>>>0&h>>>0<2147483647)){if(ve=f[5967]|0,ve|0&&be>>>0<=Re>>>0|be>>>0>ve>>>0){h=0;break}if(d=Ke(h|0)|0,(d|0)==(m|0)){I=h,E=m,ze=145;break e}else _=d,ze=136}else h=0;while(0);do if((ze|0)==136){if(m=0-h|0,!(P>>>0>h>>>0&(h>>>0<2147483647&(_|0)!=-1)))if((_|0)==-1){h=0;break}else{I=h,E=_,ze=145;break e}if(d=f[5977]|0,d=O-h+d&0-d,d>>>0>=2147483647){I=h,E=_,ze=145;break e}if((Ke(d|0)|0)==-1){Ke(m|0)|0,h=0;break}else{I=d+h|0,E=_,ze=145;break e}}while(0);f[5968]=f[5968]|4,ze=143}while(0);if((ze|0)==143&&G>>>0<2147483647&&(He=Ke(G|0)|0,be=Ke(0)|0,Je=be-He|0,Ye=Je>>>0>(de+40|0)>>>0,!((He|0)==-1|Ye^1|He>>>0<be>>>0&((He|0)!=-1&(be|0)!=-1)^1))&&(I=Ye?Je:h,E=He,ze=145),(ze|0)==145){h=(f[5965]|0)+I|0,f[5965]=h,h>>>0>(f[5966]|0)>>>0&&(f[5966]=h),O=f[5863]|0;e:do if(O){for(h=23876;;){if(d=f[h>>2]|0,m=f[h+4>>2]|0,(E|0)==(d+m|0)){ze=154;break}if(_=f[h+8>>2]|0,_)h=_;else break}if((ze|0)==154&&($e=h+4|0,(f[h+12>>2]&8|0)==0)&&E>>>0>O>>>0&d>>>0<=O>>>0){f[$e>>2]=m+I,Be=(f[5860]|0)+I|0,He=O+8|0,He=He&7|0?0-He&7:0,$e=O+He|0,He=Be-He|0,f[5863]=$e,f[5860]=He,f[$e+4>>2]=He|1,f[O+Be+4>>2]=40,f[5864]=f[5979];break}for(E>>>0<(f[5861]|0)>>>0&&(f[5861]=E),m=E+I|0,h=23876;;){if((f[h>>2]|0)==(m|0)){ze=162;break}if(d=f[h+8>>2]|0,d)h=d;else break}if((ze|0)==162&&!(f[h+12>>2]&8|0)){f[h>>2]=E,X=h+4|0,f[X>>2]=(f[X>>2]|0)+I,X=E+8|0,X=E+(X&7|0?0-X&7:0)|0,h=m+8|0,h=m+(h&7|0?0-h&7:0)|0,G=X+de|0,P=h-X-de|0,f[X+4>>2]=de|3;t:do if((O|0)==(h|0))Be=(f[5860]|0)+P|0,f[5860]=Be,f[5863]=G,f[G+4>>2]=Be|1;else{if((f[5862]|0)==(h|0)){Be=(f[5859]|0)+P|0,f[5859]=Be,f[5862]=G,f[G+4>>2]=Be|1,f[G+Be>>2]=Be;break}if(d=f[h+4>>2]|0,(d&3|0)==1){I=d&-8,_=d>>>3;n:do if(d>>>0<256)if(d=f[h+8>>2]|0,m=f[h+12>>2]|0,(m|0)==(d|0)){f[5857]=f[5857]&~(1<<_);break}else{f[d+12>>2]=m,f[m+8>>2]=d;break}else{E=f[h+24>>2]|0,d=f[h+12>>2]|0;do if((d|0)==(h|0)){if(m=h+16|0,_=m+4|0,d=f[_>>2]|0,d)m=_;else if(d=f[m>>2]|0,!d){d=0;break}for(;;)if(v=d+20|0,_=f[v>>2]|0,_)d=_,m=v;else if(v=d+16|0,_=f[v>>2]|0,_)d=_,m=v;else break;f[m>>2]=0}else Be=f[h+8>>2]|0,f[Be+12>>2]=d,f[d+8>>2]=Be;while(0);if(!E)break;m=f[h+28>>2]|0,_=23732+(m<<2)|0;do if((f[_>>2]|0)!=(h|0)){if(Be=E+16|0,f[((f[Be>>2]|0)==(h|0)?Be:E+20|0)>>2]=d,!d)break n}else{if(f[_>>2]=d,d|0)break;f[5858]=f[5858]&~(1<<m);break n}while(0);if(f[d+24>>2]=E,m=h+16|0,_=f[m>>2]|0,_|0&&(f[d+16>>2]=_,f[_+24>>2]=d),m=f[m+4>>2]|0,!m)break;f[d+20>>2]=m,f[m+24>>2]=d}while(0);h=h+I|0,v=I+P|0}else v=P;if(h=h+4|0,f[h>>2]=f[h>>2]&-2,f[G+4>>2]=v|1,f[G+v>>2]=v,h=v>>>3,v>>>0<256){m=23468+(h<<1<<2)|0,d=f[5857]|0,h=1<<h,d&h?(d=m+8|0,h=f[d>>2]|0):(f[5857]=d|h,h=m,d=m+8|0),f[d>>2]=G,f[h+12>>2]=G,f[G+8>>2]=h,f[G+12>>2]=m;break}h=v>>>8;do if(!h)_=0;else{if(v>>>0>16777215){_=31;break}$e=(h+1048320|0)>>>16&8,Be=h<<$e,He=(Be+520192|0)>>>16&4,Be=Be<<He,_=(Be+245760|0)>>>16&2,_=14-(He|$e|_)+(Be<<_>>>15)|0,_=v>>>(_+7|0)&1|_<<1}while(0);if(h=23732+(_<<2)|0,f[G+28>>2]=_,d=G+16|0,f[d+4>>2]=0,f[d>>2]=0,d=f[5858]|0,m=1<<_,!(d&m)){f[5858]=d|m,f[h>>2]=G,f[G+24>>2]=h,f[G+12>>2]=G,f[G+8>>2]=G;break}h=f[h>>2]|0;n:do if((f[h+4>>2]&-8|0)!=(v|0)){for(_=v<<((_|0)==31?0:25-(_>>>1)|0);m=h+16+(_>>>31<<2)|0,d=f[m>>2]|0,!!d;)if((f[d+4>>2]&-8|0)==(v|0)){h=d;break n}else _=_<<1,h=d;f[m>>2]=G,f[G+24>>2]=h,f[G+12>>2]=G,f[G+8>>2]=G;break t}while(0);$e=h+8|0,Be=f[$e>>2]|0,f[Be+12>>2]=G,f[$e>>2]=G,f[G+8>>2]=Be,f[G+12>>2]=h,f[G+24>>2]=0}while(0);return Be=X+8|0,Ae=bt,Be|0}for(h=23876;d=f[h>>2]|0,!(d>>>0<=O>>>0&&(Be=d+(f[h+4>>2]|0)|0,Be>>>0>O>>>0));)h=f[h+8>>2]|0;v=Be+-47|0,d=v+8|0,d=v+(d&7|0?0-d&7:0)|0,v=O+16|0,d=d>>>0<v>>>0?O:d,h=d+8|0,m=I+-40|0,He=E+8|0,He=He&7|0?0-He&7:0,$e=E+He|0,He=m-He|0,f[5863]=$e,f[5860]=He,f[$e+4>>2]=He|1,f[E+m+4>>2]=40,f[5864]=f[5979],m=d+4|0,f[m>>2]=27,f[h>>2]=f[5969],f[h+4>>2]=f[5970],f[h+8>>2]=f[5971],f[h+12>>2]=f[5972],f[5969]=E,f[5970]=I,f[5972]=0,f[5971]=h,h=d+24|0;do $e=h,h=h+4|0,f[h>>2]=7;while(($e+8|0)>>>0<Be>>>0);if((d|0)!=(O|0)){if(E=d-O|0,f[m>>2]=f[m>>2]&-2,f[O+4>>2]=E|1,f[d>>2]=E,h=E>>>3,E>>>0<256){m=23468+(h<<1<<2)|0,d=f[5857]|0,h=1<<h,d&h?(d=m+8|0,h=f[d>>2]|0):(f[5857]=d|h,h=m,d=m+8|0),f[d>>2]=O,f[h+12>>2]=O,f[O+8>>2]=h,f[O+12>>2]=m;break}if(h=E>>>8,h?E>>>0>16777215?_=31:($e=(h+1048320|0)>>>16&8,Be=h<<$e,He=(Be+520192|0)>>>16&4,Be=Be<<He,_=(Be+245760|0)>>>16&2,_=14-(He|$e|_)+(Be<<_>>>15)|0,_=E>>>(_+7|0)&1|_<<1):_=0,m=23732+(_<<2)|0,f[O+28>>2]=_,f[O+20>>2]=0,f[v>>2]=0,h=f[5858]|0,d=1<<_,!(h&d)){f[5858]=h|d,f[m>>2]=O,f[O+24>>2]=m,f[O+12>>2]=O,f[O+8>>2]=O;break}h=f[m>>2]|0;t:do if((f[h+4>>2]&-8|0)!=(E|0)){for(_=E<<((_|0)==31?0:25-(_>>>1)|0);m=h+16+(_>>>31<<2)|0,d=f[m>>2]|0,!!d;)if((f[d+4>>2]&-8|0)==(E|0)){h=d;break t}else _=_<<1,h=d;f[m>>2]=O,f[O+24>>2]=h,f[O+12>>2]=O,f[O+8>>2]=O;break e}while(0);$e=h+8|0,Be=f[$e>>2]|0,f[Be+12>>2]=O,f[$e>>2]=O,f[O+8>>2]=Be,f[O+12>>2]=h,f[O+24>>2]=0}}else Be=f[5861]|0,(Be|0)==0|E>>>0<Be>>>0&&(f[5861]=E),f[5969]=E,f[5970]=I,f[5972]=0,f[5866]=f[5975],f[5865]=-1,f[5870]=23468,f[5869]=23468,f[5872]=23476,f[5871]=23476,f[5874]=23484,f[5873]=23484,f[5876]=23492,f[5875]=23492,f[5878]=23500,f[5877]=23500,f[5880]=23508,f[5879]=23508,f[5882]=23516,f[5881]=23516,f[5884]=23524,f[5883]=23524,f[5886]=23532,f[5885]=23532,f[5888]=23540,f[5887]=23540,f[5890]=23548,f[5889]=23548,f[5892]=23556,f[5891]=23556,f[5894]=23564,f[5893]=23564,f[5896]=23572,f[5895]=23572,f[5898]=23580,f[5897]=23580,f[5900]=23588,f[5899]=23588,f[5902]=23596,f[5901]=23596,f[5904]=23604,f[5903]=23604,f[5906]=23612,f[5905]=23612,f[5908]=23620,f[5907]=23620,f[5910]=23628,f[5909]=23628,f[5912]=23636,f[5911]=23636,f[5914]=23644,f[5913]=23644,f[5916]=23652,f[5915]=23652,f[5918]=23660,f[5917]=23660,f[5920]=23668,f[5919]=23668,f[5922]=23676,f[5921]=23676,f[5924]=23684,f[5923]=23684,f[5926]=23692,f[5925]=23692,f[5928]=23700,f[5927]=23700,f[5930]=23708,f[5929]=23708,f[5932]=23716,f[5931]=23716,Be=I+-40|0,He=E+8|0,He=He&7|0?0-He&7:0,$e=E+He|0,He=Be-He|0,f[5863]=$e,f[5860]=He,f[$e+4>>2]=He|1,f[E+Be+4>>2]=40,f[5864]=f[5979];while(0);if(h=f[5860]|0,h>>>0>de>>>0)return He=h-de|0,f[5860]=He,Be=f[5863]|0,$e=Be+de|0,f[5863]=$e,f[$e+4>>2]=He|1,f[Be+4>>2]=de|3,Be=Be+8|0,Ae=bt,Be|0}return Be=zs()|0,f[Be>>2]=12,Be=0,Ae=bt,Be|0}function y(d){d=d|0;var h=0,m=0,_=0,v=0,E=0,I=0,P=0,O=0;if(d){m=d+-8|0,v=f[5861]|0,d=f[d+-4>>2]|0,h=d&-8,O=m+h|0;do if(d&1)P=m,I=m;else{if(_=f[m>>2]|0,!(d&3)||(I=m+(0-_)|0,E=_+h|0,I>>>0<v>>>0))return;if((f[5862]|0)==(I|0)){if(d=O+4|0,h=f[d>>2]|0,(h&3|0)!=3){P=I,h=E;break}f[5859]=E,f[d>>2]=h&-2,f[I+4>>2]=E|1,f[I+E>>2]=E;return}if(m=_>>>3,_>>>0<256)if(d=f[I+8>>2]|0,h=f[I+12>>2]|0,(h|0)==(d|0)){f[5857]=f[5857]&~(1<<m),P=I,h=E;break}else{f[d+12>>2]=h,f[h+8>>2]=d,P=I,h=E;break}v=f[I+24>>2]|0,d=f[I+12>>2]|0;do if((d|0)==(I|0)){if(h=I+16|0,m=h+4|0,d=f[m>>2]|0,d)h=m;else if(d=f[h>>2]|0,!d){d=0;break}for(;;)if(_=d+20|0,m=f[_>>2]|0,m)d=m,h=_;else if(_=d+16|0,m=f[_>>2]|0,m)d=m,h=_;else break;f[h>>2]=0}else P=f[I+8>>2]|0,f[P+12>>2]=d,f[d+8>>2]=P;while(0);if(v){if(h=f[I+28>>2]|0,m=23732+(h<<2)|0,(f[m>>2]|0)==(I|0)){if(f[m>>2]=d,!d){f[5858]=f[5858]&~(1<<h),P=I,h=E;break}}else if(P=v+16|0,f[((f[P>>2]|0)==(I|0)?P:v+20|0)>>2]=d,!d){P=I,h=E;break}f[d+24>>2]=v,h=I+16|0,m=f[h>>2]|0,m|0&&(f[d+16>>2]=m,f[m+24>>2]=d),h=f[h+4>>2]|0,h?(f[d+20>>2]=h,f[h+24>>2]=d,P=I,h=E):(P=I,h=E)}else P=I,h=E}while(0);if(!(I>>>0>=O>>>0)&&(d=O+4|0,_=f[d>>2]|0,!!(_&1))){if(_&2)f[d>>2]=_&-2,f[P+4>>2]=h|1,f[I+h>>2]=h,v=h;else{if((f[5863]|0)==(O|0)){if(O=(f[5860]|0)+h|0,f[5860]=O,f[5863]=P,f[P+4>>2]=O|1,(P|0)!=(f[5862]|0))return;f[5862]=0,f[5859]=0;return}if((f[5862]|0)==(O|0)){O=(f[5859]|0)+h|0,f[5859]=O,f[5862]=I,f[P+4>>2]=O|1,f[I+O>>2]=O;return}v=(_&-8)+h|0,m=_>>>3;do if(_>>>0<256)if(h=f[O+8>>2]|0,d=f[O+12>>2]|0,(d|0)==(h|0)){f[5857]=f[5857]&~(1<<m);break}else{f[h+12>>2]=d,f[d+8>>2]=h;break}else{E=f[O+24>>2]|0,d=f[O+12>>2]|0;do if((d|0)==(O|0)){if(h=O+16|0,m=h+4|0,d=f[m>>2]|0,d)h=m;else if(d=f[h>>2]|0,!d){m=0;break}for(;;)if(_=d+20|0,m=f[_>>2]|0,m)d=m,h=_;else if(_=d+16|0,m=f[_>>2]|0,m)d=m,h=_;else break;f[h>>2]=0,m=d}else m=f[O+8>>2]|0,f[m+12>>2]=d,f[d+8>>2]=m,m=d;while(0);if(E|0){if(d=f[O+28>>2]|0,h=23732+(d<<2)|0,(f[h>>2]|0)==(O|0)){if(f[h>>2]=m,!m){f[5858]=f[5858]&~(1<<d);break}}else if(_=E+16|0,f[((f[_>>2]|0)==(O|0)?_:E+20|0)>>2]=m,!m)break;f[m+24>>2]=E,d=O+16|0,h=f[d>>2]|0,h|0&&(f[m+16>>2]=h,f[h+24>>2]=m),d=f[d+4>>2]|0,d|0&&(f[m+20>>2]=d,f[d+24>>2]=m)}}while(0);if(f[P+4>>2]=v|1,f[I+v>>2]=v,(P|0)==(f[5862]|0)){f[5859]=v;return}}if(d=v>>>3,v>>>0<256){m=23468+(d<<1<<2)|0,h=f[5857]|0,d=1<<d,h&d?(h=m+8|0,d=f[h>>2]|0):(f[5857]=h|d,d=m,h=m+8|0),f[h>>2]=P,f[d+12>>2]=P,f[P+8>>2]=d,f[P+12>>2]=m;return}d=v>>>8,d?v>>>0>16777215?_=31:(I=(d+1048320|0)>>>16&8,O=d<<I,E=(O+520192|0)>>>16&4,O=O<<E,_=(O+245760|0)>>>16&2,_=14-(E|I|_)+(O<<_>>>15)|0,_=v>>>(_+7|0)&1|_<<1):_=0,d=23732+(_<<2)|0,f[P+28>>2]=_,f[P+20>>2]=0,f[P+16>>2]=0,h=f[5858]|0,m=1<<_;e:do if(!(h&m))f[5858]=h|m,f[d>>2]=P,f[P+24>>2]=d,f[P+12>>2]=P,f[P+8>>2]=P;else{d=f[d>>2]|0;t:do if((f[d+4>>2]&-8|0)!=(v|0)){for(_=v<<((_|0)==31?0:25-(_>>>1)|0);m=d+16+(_>>>31<<2)|0,h=f[m>>2]|0,!!h;)if((f[h+4>>2]&-8|0)==(v|0)){d=h;break t}else _=_<<1,d=h;f[m>>2]=P,f[P+24>>2]=d,f[P+12>>2]=P,f[P+8>>2]=P;break e}while(0);I=d+8|0,O=f[I>>2]|0,f[O+12>>2]=P,f[I>>2]=P,f[P+8>>2]=O,f[P+12>>2]=d,f[P+24>>2]=0}while(0);if(O=(f[5865]|0)+-1|0,f[5865]=O,!(O|0)){for(d=23884;d=f[d>>2]|0,d;)d=d+8|0;f[5865]=-1}}}}function w(d,h){d=d|0,h=h|0;var m=0;return d?(m=Wt(h,d)|0,(h|d)>>>0>65535&&(m=((m>>>0)/(d>>>0)|0|0)==(h|0)?m:-1)):m=0,d=A(m)|0,!d||!(f[d+-4>>2]&3)||je(d|0,0,m|0)|0,d|0}function M(d,h,m,_){return d=d|0,h=h|0,m=m|0,_=_|0,m=d+m>>>0,Ot(h+_+(m>>>0<d>>>0|0)>>>0|0),m|0|0}function L(d,h,m,_){return d=d|0,h=h|0,m=m|0,_=_|0,_=h-_-(m>>>0>d>>>0|0)>>>0,Ot(_|0),d-m>>>0|0|0}function N(d){return d=d|0,(d?31-(Ln(d^d-1)|0)|0:32)|0}function V(d,h,m,_,v){d=d|0,h=h|0,m=m|0,_=_|0,v=v|0;var E=0,I=0,P=0,O=0,G=0,X=0,de=0,ve=0,Re=0,be=0;if(X=d,O=h,G=O,I=m,ve=_,P=ve,!G)return E=(v|0)!=0,P?E?(f[v>>2]=d|0,f[v+4>>2]=h&0,ve=0,v=0,Ot(ve|0),v|0):(ve=0,v=0,Ot(ve|0),v|0):(E&&(f[v>>2]=(X>>>0)%(I>>>0),f[v+4>>2]=0),ve=0,v=(X>>>0)/(I>>>0)>>>0,Ot(ve|0),v|0);E=(P|0)==0;do if(I){if(!E){if(E=(Ln(P|0)|0)-(Ln(G|0)|0)|0,E>>>0<=31){de=E+1|0,P=31-E|0,h=E-31>>31,I=de,d=X>>>(de>>>0)&h|G<<P,h=G>>>(de>>>0)&h,E=0,P=X<<P;break}return v?(f[v>>2]=d|0,f[v+4>>2]=O|h&0,ve=0,v=0,Ot(ve|0),v|0):(ve=0,v=0,Ot(ve|0),v|0)}if(E=I-1|0,E&I|0){P=(Ln(I|0)|0)+33-(Ln(G|0)|0)|0,be=64-P|0,de=32-P|0,O=de>>31,Re=P-32|0,h=Re>>31,I=P,d=de-1>>31&G>>>(Re>>>0)|(G<<de|X>>>(P>>>0))&h,h=h&G>>>(P>>>0),E=X<<be&O,P=(G<<be|X>>>(Re>>>0))&O|X<<de&P-33>>31;break}return v|0&&(f[v>>2]=E&X,f[v+4>>2]=0),(I|0)==1?(Re=O|h&0,be=d|0|0,Ot(Re|0),be|0):(be=N(I|0)|0,Re=G>>>(be>>>0)|0,be=G<<32-be|X>>>(be>>>0)|0,Ot(Re|0),be|0)}else{if(E)return v|0&&(f[v>>2]=(G>>>0)%(I>>>0),f[v+4>>2]=0),Re=0,be=(G>>>0)/(I>>>0)>>>0,Ot(Re|0),be|0;if(!X)return v|0&&(f[v>>2]=0,f[v+4>>2]=(G>>>0)%(P>>>0)),Re=0,be=(G>>>0)/(P>>>0)>>>0,Ot(Re|0),be|0;if(E=P-1|0,!(E&P))return v|0&&(f[v>>2]=d|0,f[v+4>>2]=E&G|h&0),Re=0,be=G>>>((N(P|0)|0)>>>0),Ot(Re|0),be|0;if(E=(Ln(P|0)|0)-(Ln(G|0)|0)|0,E>>>0<=30){h=E+1|0,P=31-E|0,I=h,d=G<<P|X>>>(h>>>0),h=G>>>(h>>>0),E=0,P=X<<P;break}return v?(f[v>>2]=d|0,f[v+4>>2]=O|h&0,Re=0,be=0,Ot(Re|0),be|0):(Re=0,be=0,Ot(Re|0),be|0)}while(0);if(!I)G=P,O=0,P=0;else{de=m|0|0,X=ve|_&0,G=M(de|0,X|0,-1,-1)|0,m=me()|0,O=P,P=0;do _=O,O=E>>>31|O<<1,E=P|E<<1,_=d<<1|_>>>31|0,ve=d>>>31|h<<1|0,L(G|0,m|0,_|0,ve|0)|0,be=me()|0,Re=be>>31|((be|0)<0?-1:0)<<1,P=Re&1,d=L(_|0,ve|0,Re&de|0,(((be|0)<0?-1:0)>>31|((be|0)<0?-1:0)<<1)&X|0)|0,h=me()|0,I=I-1|0;while(I|0);G=O,O=0}return I=0,v|0&&(f[v>>2]=d,f[v+4>>2]=h),Re=(E|0)>>>31|(G|I)<<1|(I<<1|E>>>31)&0|O,be=(E<<1|0)&-2|P,Ot(Re|0),be|0}function $(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0;return G=h>>31|((h|0)<0?-1:0)<<1,O=((h|0)<0?-1:0)>>31|((h|0)<0?-1:0)<<1,E=_>>31|((_|0)<0?-1:0)<<1,v=((_|0)<0?-1:0)>>31|((_|0)<0?-1:0)<<1,P=L(G^d|0,O^h|0,G|0,O|0)|0,I=me()|0,d=E^G,h=v^O,L((V(P,I,L(E^m|0,v^_|0,E|0,v|0)|0,me()|0,0)|0)^d|0,(me()|0)^h|0,d|0,h|0)|0}function Q(d,h){d=d|0,h=h|0;var m=0,_=0,v=0,E=0;return E=d&65535,v=h&65535,m=Wt(v,E)|0,_=d>>>16,d=(m>>>16)+(Wt(v,_)|0)|0,v=h>>>16,h=Wt(v,E)|0,Ot((d>>>16)+(Wt(v,_)|0)+(((d&65535)+h|0)>>>16)|0),d+h<<16|m&65535|0|0}function J(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0;return v=d,E=m,m=Q(v,E)|0,d=me()|0,Ot((Wt(h,E)|0)+(Wt(_,v)|0)+d|d&0|0),m|0|0|0}function ce(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0,I=0,P=0,O=0,G=0;return v=Ae,Ae=Ae+16|0,P=v|0,I=h>>31|((h|0)<0?-1:0)<<1,E=((h|0)<0?-1:0)>>31|((h|0)<0?-1:0)<<1,G=_>>31|((_|0)<0?-1:0)<<1,O=((_|0)<0?-1:0)>>31|((_|0)<0?-1:0)<<1,d=L(I^d|0,E^h|0,I|0,E|0)|0,h=me()|0,V(d,h,L(G^m|0,O^_|0,G|0,O|0)|0,me()|0,P)|0,_=L(f[P>>2]^I|0,f[P+4>>2]^E|0,I|0,E|0)|0,m=me()|0,Ae=v,Ot(m|0),_|0}function ye(d,h,m,_){d=d|0,h=h|0,m=m|0,_=_|0;var v=0,E=0;return E=Ae,Ae=Ae+16|0,v=E|0,V(d,h,m,_,v)|0,Ae=E,Ot(f[v+4>>2]|0),f[v>>2]|0|0}function _e(d,h,m){return d=d|0,h=h|0,m=m|0,(m|0)<32?(Ot(h>>m|0),d>>>m|(h&(1<<m)-1)<<32-m):(Ot(((h|0)<0?-1:0)|0),h>>m-32|0)}function oe(d,h,m){return d=d|0,h=h|0,m=m|0,(m|0)<32?(Ot(h>>>m|0),d>>>m|(h&(1<<m)-1)<<32-m):(Ot(0),h>>>m-32|0)}function ge(d,h,m){return d=d|0,h=h|0,m=m|0,(m|0)<32?(Ot(h<<m|(d&(1<<m)-1<<32-m)>>>32-m|0),d<<m):(Ot(d<<m-32|0),0)}function De(d,h){return d=+d,h=+h,d!=d?+h:h!=h?+d:+wn(+d,+h)}function Ve(d,h){return d=+d,h=+h,d!=d?+h:h!=h?+d:+dn(+d,+h)}function Ee(d){return d=+d,d>=0?+we(d+.5):+Gt(d-.5)}function Ze(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0;if((m|0)>=8192)return Ss(d|0,h|0,m|0)|0,d|0;if(E=d|0,v=d+m|0,(d&3)==(h&3)){for(;d&3;){if(!m)return E|0;ie[d>>0]=ie[h>>0]|0,d=d+1|0,h=h+1|0,m=m-1|0}for(m=v&-4|0,_=m-64|0;(d|0)<=(_|0);)f[d>>2]=f[h>>2],f[d+4>>2]=f[h+4>>2],f[d+8>>2]=f[h+8>>2],f[d+12>>2]=f[h+12>>2],f[d+16>>2]=f[h+16>>2],f[d+20>>2]=f[h+20>>2],f[d+24>>2]=f[h+24>>2],f[d+28>>2]=f[h+28>>2],f[d+32>>2]=f[h+32>>2],f[d+36>>2]=f[h+36>>2],f[d+40>>2]=f[h+40>>2],f[d+44>>2]=f[h+44>>2],f[d+48>>2]=f[h+48>>2],f[d+52>>2]=f[h+52>>2],f[d+56>>2]=f[h+56>>2],f[d+60>>2]=f[h+60>>2],d=d+64|0,h=h+64|0;for(;(d|0)<(m|0);)f[d>>2]=f[h>>2],d=d+4|0,h=h+4|0}else for(m=v-4|0;(d|0)<(m|0);)ie[d>>0]=ie[h>>0]|0,ie[d+1>>0]=ie[h+1>>0]|0,ie[d+2>>0]=ie[h+2>>0]|0,ie[d+3>>0]=ie[h+3>>0]|0,d=d+4|0,h=h+4|0;for(;(d|0)<(v|0);)ie[d>>0]=ie[h>>0]|0,d=d+1|0,h=h+1|0;return E|0}function je(d,h,m){d=d|0,h=h|0,m=m|0;var _=0,v=0,E=0,I=0;if(E=d+m|0,h=h&255,(m|0)>=67){for(;d&3;)ie[d>>0]=h,d=d+1|0;for(_=E&-4|0,I=h|h<<8|h<<16|h<<24,v=_-64|0;(d|0)<=(v|0);)f[d>>2]=I,f[d+4>>2]=I,f[d+8>>2]=I,f[d+12>>2]=I,f[d+16>>2]=I,f[d+20>>2]=I,f[d+24>>2]=I,f[d+28>>2]=I,f[d+32>>2]=I,f[d+36>>2]=I,f[d+40>>2]=I,f[d+44>>2]=I,f[d+48>>2]=I,f[d+52>>2]=I,f[d+56>>2]=I,f[d+60>>2]=I,d=d+64|0;for(;(d|0)<(_|0);)f[d>>2]=I,d=d+4|0}for(;(d|0)<(E|0);)ie[d>>0]=h,d=d+1|0;return E-m|0}function tt(d){return d=+d,d>=0?+we(d+.5):+Gt(d-.5)}function Ke(d){d=d|0;var h=0,m=0,_=0;return _=Rn()|0,m=f[Te>>2]|0,h=m+d|0,(d|0)>0&(h|0)<(m|0)|(h|0)<0?(Xs(h|0)|0,Bi(12),-1):(h|0)>(_|0)&&!(Ms(h|0)|0)?(Bi(12),-1):(f[Te>>2]=h,m|0)}return{___divdi3:$,___muldi3:J,___remdi3:ce,___uremdi3:ye,_areNeighborCells:Du,_bitshift64Ashr:_e,_bitshift64Lshr:oe,_bitshift64Shl:ge,_calloc:w,_cellAreaKm2:Pt,_cellAreaM2:$u,_cellAreaRads2:to,_cellToBoundary:sa,_cellToCenterChild:Nu,_cellToChildPos:aa,_cellToChildren:Dl,_cellToChildrenSize:Ha,_cellToLatLng:Lo,_cellToLocalIj:Mh,_cellToParent:Ga,_cellToVertex:$i,_cellToVertexes:Vc,_cellsToDirectedEdge:zu,_cellsToLinkedMultiPolygon:gi,_childPosToCell:Gu,_compactCells:Cc,_destroyLinkedMultiPolygon:Wu,_directedEdgeToBoundary:Na,_directedEdgeToCells:ia,_edgeLengthKm:cs,_edgeLengthM:Rc,_edgeLengthRads:Ds,_emscripten_replace_memory:rs,_free:y,_getBaseCellNumber:oa,_getDirectedEdgeDestination:ks,_getDirectedEdgeOrigin:Rl,_getHexagonAreaAvgKm2:Xa,_getHexagonAreaAvgM2:Lc,_getHexagonEdgeLengthAvgKm:Th,_getHexagonEdgeLengthAvgM:Sh,_getIcosahedronFaces:Pc,_getNumCells:ua,_getPentagons:Bl,_getRes0Cells:bc,_getResolution:ja,_greatCircleDistanceKm:Qa,_greatCircleDistanceM:ls,_greatCircleDistanceRads:Tr,_gridDisk:Pa,_gridDiskDistances:go,_gridDistance:Bc,_gridPathCells:Fc,_gridPathCellsSize:Oc,_gridRingUnsafe:ht,_i64Add:M,_i64Subtract:L,_isPentagon:Gn,_isResClassIII:$a,_isValidCell:Ps,_isValidDirectedEdge:Bu,_isValidVertex:Wi,_latLngToCell:Za,_llvm_maxnum_f64:De,_llvm_minnum_f64:Ve,_llvm_round_f64:Ee,_localIjToCell:Zu,_malloc:A,_maxFaceCount:qa,_maxGridDiskSize:ka,_maxPolygonToCellsSize:zt,_memcpy:Ze,_memset:je,_originToDirectedEdges:Yn,_pentagonCount:ju,_polygonToCells:ei,_readInt64AsDoubleFromPointer:Xu,_res0CellCount:wc,_round:tt,_sbrk:Ke,_sizeOfCellBoundary:Qu,_sizeOfCoordIJ:Nl,_sizeOfGeoLoop:Fr,_sizeOfGeoPolygon:Kn,_sizeOfH3Index:Nc,_sizeOfLatLng:Ya,_sizeOfLinkedGeoPolygon:Ka,_uncompactCells:Uu,_uncompactCellsSize:Ls,_vertexToLatLng:us,establishStackSpace:Js,stackAlloc:Kr,stackRestore:Ks,stackSave:Ys}}(Yr,rn,Xe);e.___divdi3=ft.___divdi3,e.___muldi3=ft.___muldi3,e.___remdi3=ft.___remdi3,e.___uremdi3=ft.___uremdi3,e._areNeighborCells=ft._areNeighborCells,e._bitshift64Ashr=ft._bitshift64Ashr,e._bitshift64Lshr=ft._bitshift64Lshr,e._bitshift64Shl=ft._bitshift64Shl,e._calloc=ft._calloc,e._cellAreaKm2=ft._cellAreaKm2,e._cellAreaM2=ft._cellAreaM2,e._cellAreaRads2=ft._cellAreaRads2,e._cellToBoundary=ft._cellToBoundary,e._cellToCenterChild=ft._cellToCenterChild,e._cellToChildPos=ft._cellToChildPos,e._cellToChildren=ft._cellToChildren,e._cellToChildrenSize=ft._cellToChildrenSize,e._cellToLatLng=ft._cellToLatLng,e._cellToLocalIj=ft._cellToLocalIj,e._cellToParent=ft._cellToParent,e._cellToVertex=ft._cellToVertex,e._cellToVertexes=ft._cellToVertexes,e._cellsToDirectedEdge=ft._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=ft._cellsToLinkedMultiPolygon,e._childPosToCell=ft._childPosToCell,e._compactCells=ft._compactCells,e._destroyLinkedMultiPolygon=ft._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=ft._directedEdgeToBoundary,e._directedEdgeToCells=ft._directedEdgeToCells,e._edgeLengthKm=ft._edgeLengthKm,e._edgeLengthM=ft._edgeLengthM,e._edgeLengthRads=ft._edgeLengthRads;var wi=e._emscripten_replace_memory=ft._emscripten_replace_memory;e._free=ft._free,e._getBaseCellNumber=ft._getBaseCellNumber,e._getDirectedEdgeDestination=ft._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=ft._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=ft._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=ft._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=ft._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=ft._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=ft._getIcosahedronFaces,e._getNumCells=ft._getNumCells,e._getPentagons=ft._getPentagons,e._getRes0Cells=ft._getRes0Cells,e._getResolution=ft._getResolution,e._greatCircleDistanceKm=ft._greatCircleDistanceKm,e._greatCircleDistanceM=ft._greatCircleDistanceM,e._greatCircleDistanceRads=ft._greatCircleDistanceRads,e._gridDisk=ft._gridDisk,e._gridDiskDistances=ft._gridDiskDistances,e._gridDistance=ft._gridDistance,e._gridPathCells=ft._gridPathCells,e._gridPathCellsSize=ft._gridPathCellsSize,e._gridRingUnsafe=ft._gridRingUnsafe,e._i64Add=ft._i64Add,e._i64Subtract=ft._i64Subtract,e._isPentagon=ft._isPentagon,e._isResClassIII=ft._isResClassIII,e._isValidCell=ft._isValidCell,e._isValidDirectedEdge=ft._isValidDirectedEdge,e._isValidVertex=ft._isValidVertex,e._latLngToCell=ft._latLngToCell,e._llvm_maxnum_f64=ft._llvm_maxnum_f64,e._llvm_minnum_f64=ft._llvm_minnum_f64,e._llvm_round_f64=ft._llvm_round_f64,e._localIjToCell=ft._localIjToCell,e._malloc=ft._malloc,e._maxFaceCount=ft._maxFaceCount,e._maxGridDiskSize=ft._maxGridDiskSize,e._maxPolygonToCellsSize=ft._maxPolygonToCellsSize,e._memcpy=ft._memcpy,e._memset=ft._memset,e._originToDirectedEdges=ft._originToDirectedEdges,e._pentagonCount=ft._pentagonCount,e._polygonToCells=ft._polygonToCells,e._readInt64AsDoubleFromPointer=ft._readInt64AsDoubleFromPointer,e._res0CellCount=ft._res0CellCount,e._round=ft._round,e._sbrk=ft._sbrk,e._sizeOfCellBoundary=ft._sizeOfCellBoundary,e._sizeOfCoordIJ=ft._sizeOfCoordIJ,e._sizeOfGeoLoop=ft._sizeOfGeoLoop,e._sizeOfGeoPolygon=ft._sizeOfGeoPolygon,e._sizeOfH3Index=ft._sizeOfH3Index,e._sizeOfLatLng=ft._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=ft._sizeOfLinkedGeoPolygon,e._uncompactCells=ft._uncompactCells,e._uncompactCellsSize=ft._uncompactCellsSize,e._vertexToLatLng=ft._vertexToLatLng,e.establishStackSpace=ft.establishStackSpace;var Co=e.stackAlloc=ft.stackAlloc,ai=e.stackRestore=ft.stackRestore,zi=e.stackSave=ft.stackSave;if(e.asm=ft,e.cwrap=te,e.setValue=K,e.getValue=ee,Vn){ns(Vn)||(Vn=c(Vn));{bn();var Pn=function(q){q.byteLength&&(q=new Uint8Array(q)),Rt.set(q,D),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,ir()},ko=function(){p(Vn,Pn,function(){throw"could not load memory initializer "+Vn})},br=mi(Vn);if(br)Pn(br.buffer);else if(e.memoryInitializerRequest){var Er=function(){var q=e.memoryInitializerRequest,U=q.response;if(q.status!==200&&q.status!==0){var W=mi(e.memoryInitializerRequestURL);if(W)U=W.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+q.status+", retrying "+Vn),ko();return}}Pn(U)};e.memoryInitializerRequest.response?setTimeout(Er,0):e.memoryInitializerRequest.addEventListener("load",Er)}else ko()}}var Or;Dr=function q(){Or||mo(),Or||(Dr=q)};function mo(q){if(xi>0||(Nn(),xi>0))return;function U(){Or||(Or=!0,!le&&(Di(),yn(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),qn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),U()},1)):U()}e.run=mo;function Ji(q){throw e.onAbort&&e.onAbort(q),q+="",a(q),T(q),le=!0,"abort("+q+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Ji,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return mo(),t}(typeof Jo=="object"?Jo:{}),Tn="number",hn=Tn,sd=Tn,mn=Tn,gn=Tn,$r=Tn,Xt=Tn,jj=[["sizeOfH3Index",Tn],["sizeOfLatLng",Tn],["sizeOfCellBoundary",Tn],["sizeOfGeoLoop",Tn],["sizeOfGeoPolygon",Tn],["sizeOfLinkedGeoPolygon",Tn],["sizeOfCoordIJ",Tn],["readInt64AsDoubleFromPointer",Tn],["isValidCell",sd,[mn,gn]],["latLngToCell",hn,[Tn,Tn,$r,Xt]],["cellToLatLng",hn,[mn,gn,Xt]],["cellToBoundary",hn,[mn,gn,Xt]],["maxGridDiskSize",hn,[Tn,Xt]],["gridDisk",hn,[mn,gn,Tn,Xt]],["gridDiskDistances",hn,[mn,gn,Tn,Xt,Xt]],["gridRingUnsafe",hn,[mn,gn,Tn,Xt]],["maxPolygonToCellsSize",hn,[Xt,$r,Tn,Xt]],["polygonToCells",hn,[Xt,$r,Tn,Xt]],["cellsToLinkedMultiPolygon",hn,[Xt,Tn,Xt]],["destroyLinkedMultiPolygon",null,[Xt]],["compactCells",hn,[Xt,Xt,Tn,Tn]],["uncompactCells",hn,[Xt,Tn,Tn,Xt,Tn,$r]],["uncompactCellsSize",hn,[Xt,Tn,Tn,$r,Xt]],["isPentagon",sd,[mn,gn]],["isResClassIII",sd,[mn,gn]],["getBaseCellNumber",Tn,[mn,gn]],["getResolution",Tn,[mn,gn]],["maxFaceCount",hn,[mn,gn,Xt]],["getIcosahedronFaces",hn,[mn,gn,Xt]],["cellToParent",hn,[mn,gn,$r,Xt]],["cellToChildren",hn,[mn,gn,$r,Xt]],["cellToCenterChild",hn,[mn,gn,$r,Xt]],["cellToChildrenSize",hn,[mn,gn,$r,Xt]],["cellToChildPos",hn,[mn,gn,$r,Xt]],["childPosToCell",hn,[Tn,Tn,mn,gn,$r,Xt]],["areNeighborCells",hn,[mn,gn,mn,gn,Xt]],["cellsToDirectedEdge",hn,[mn,gn,mn,gn,Xt]],["getDirectedEdgeOrigin",hn,[mn,gn,Xt]],["getDirectedEdgeDestination",hn,[mn,gn,Xt]],["isValidDirectedEdge",sd,[mn,gn]],["directedEdgeToCells",hn,[mn,gn,Xt]],["originToDirectedEdges",hn,[mn,gn,Xt]],["directedEdgeToBoundary",hn,[mn,gn,Xt]],["gridDistance",hn,[mn,gn,mn,gn,Xt]],["gridPathCells",hn,[mn,gn,mn,gn,Xt]],["gridPathCellsSize",hn,[mn,gn,mn,gn,Xt]],["cellToLocalIj",hn,[mn,gn,mn,gn,Tn,Xt]],["localIjToCell",hn,[mn,gn,Xt,Tn,Xt]],["getHexagonAreaAvgM2",hn,[$r,Xt]],["getHexagonAreaAvgKm2",hn,[$r,Xt]],["getHexagonEdgeLengthAvgM",hn,[$r,Xt]],["getHexagonEdgeLengthAvgKm",hn,[$r,Xt]],["greatCircleDistanceM",Tn,[Xt,Xt]],["greatCircleDistanceKm",Tn,[Xt,Xt]],["greatCircleDistanceRads",Tn,[Xt,Xt]],["cellAreaM2",hn,[mn,gn,Xt]],["cellAreaKm2",hn,[mn,gn,Xt]],["cellAreaRads2",hn,[mn,gn,Xt]],["edgeLengthM",hn,[mn,gn,Xt]],["edgeLengthKm",hn,[mn,gn,Xt]],["edgeLengthRads",hn,[mn,gn,Xt]],["getNumCells",hn,[$r,Xt]],["getRes0Cells",hn,[Xt]],["res0CellCount",Tn],["getPentagons",hn,[Tn,Xt]],["pentagonCount",Tn],["cellToVertex",hn,[mn,gn,Tn,Xt]],["cellToVertexes",hn,[mn,gn,Xt]],["vertexToLatLng",hn,[mn,gn,Xt]],["isValidVertex",sd,[mn,gn]]],Gj=0,Hj=1,$j=2,Wj=3,h5=4,Zj=5,qj=6,Qj=7,Xj=8,Yj=9,Kj=10,Jj=11,eG=12,tG=13,nG=14,iG=15,Rr={};Rr[Gj]="Success";Rr[Hj]="The operation failed but a more specific error is not available";Rr[$j]="Argument was outside of acceptable range";Rr[Wj]="Latitude or longitude arguments were outside of acceptable range";Rr[h5]="Resolution argument was outside of acceptable range";Rr[Zj]="Cell argument was not valid";Rr[qj]="Directed edge argument was not valid";Rr[Qj]="Undirected edge argument was not valid";Rr[Xj]="Vertex argument was not valid";Rr[Yj]="Pentagon distortion was encountered";Rr[Kj]="Duplicate input";Rr[Jj]="Cell arguments were not neighbors";Rr[eG]="Cell arguments had incompatible resolutions";Rr[tG]="Memory allocation failed";Rr[nG]="Bounds of provided memory were insufficient";Rr[iG]="Mode or flags argument was not valid";var d5=1e3,rG=1001,oG=1002,Dm={};Dm[d5]="Unknown unit";Dm[rG]="Array length out of bounds";Dm[oG]="Got unexpected null value for H3 index";var sG="Unknown error";function A5(t,e,n){var i=n&&"value"in n,r=new Error((t[e]||sG)+" (code: "+e+(i?", value: "+n.value:"")+")");return r.code=e,r}function p5(t,e){var n=arguments.length===2?{value:e}:{};return A5(Rr,t,n)}function aG(t,e){var n=arguments.length===2?{value:e}:{};return A5(Dm,t,n)}function tm(t){if(t!==0)throw p5(t)}var Ts={};jj.forEach(function(e){Ts[e[0]]=Jo.cwrap.apply(Jo,e)});var h8=16,Ah=8;Ts.sizeOfH3Index();var lG=Ts.sizeOfLatLng(),cG=Ts.sizeOfCellBoundary();Ts.sizeOfGeoPolygon();Ts.sizeOfGeoLoop();Ts.sizeOfLinkedGeoPolygon();Ts.sizeOfCoordIJ();var Cd={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function uG(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw p5(h5,t);return t}var fG=/[^0-9a-fA-F]/;function m5(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||fG.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),h8),n=parseInt(t.substring(t.length-8),h8);return[n,e]}function hG(t,e){return e===void 0&&(e=0),Jo.getValue(t+Ah*e,"double")}function nm(t){return mG(Jo.getValue(t,"double"))}function g5(t){return[nm(t),nm(t+Ah)]}function dG(t){return[nm(t+Ah),nm(t)]}function AG(t,e,n){for(var i=Jo.getValue(t,"i32"),r=t+Ah,c=[],p=e?dG:g5,a=0;a<i*2;a+=2)c.push(p(r+Ah*a));return n&&c.push(c[0]),c}function _5(t){var e=Jo._malloc(lG),n=m5(t),i=n[0],r=n[1];try{return tm(Ts.cellToLatLng(i,r,e)),g5(e)}finally{Jo._free(e)}}function pG(t,e){var n=Jo._malloc(cG),i=m5(t),r=i[0],c=i[1];try{return tm(Ts.cellToBoundary(r,c,n)),AG(n,e,e)}finally{Jo._free(n)}}function C1(t,e){uG(t);var n=Jo._malloc(Ah);try{switch(e){case Cd.m:tm(Ts.getHexagonEdgeLengthAvgM(t,n));break;case Cd.km:tm(Ts.getHexagonEdgeLengthAvgKm(t,n));break;default:throw aG(d5,e)}return hG(n)}finally{Jo._free(n)}}function mG(t){return t*180/Math.PI}function d8(t,e,n=1){const i=n,[r,c]=_5(t);return e.map(a=>{let T=Jf(c,a[0],i),k=Jf(r,a[1],i);return[T,k]})}function gG(t,[e,n]){let i=pG(t).map(p=>[p[1],p[0]]),r=d8(t,i,n),c=d8(t,i,e);return[r,c]}class Y2 extends _A{initializeState(){super.initializeState(),this.setState({hextiles:this.props.data})}renderLayers(){const{hextiles:e}=this.state;if(!e)return;let n=[],i=aA().domain([0,1]).range(ry(0,e.length))(this.props.resolution);console.log(e.length);let r=e[i];return Object.keys(r).forEach(c=>{let p=r[c],a=gG(c,[this.props.getValue?1-this.props.getValue({properties:p}):this.props.thicknessRange[0],this.props.thicknessRange[1]]);this.props.raised?n.push({polygon:a.map(T=>T.map(([k,z])=>[k,z,this.props.getElevation({properties:p})])),properties:p}):n.push({polygon:a,properties:p})}),[new mm({id:`${this.props.id}SolidHexTileLayer`,data:n,getPolygon:c=>c.polygon,filled:this.props.filled,wireframe:this.props.wireframe,extruded:this.props.extruded,pickable:this.props.pickable,getFillColor:this.props.getFillColor,getElevation:this.props.getElevation,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,opacity:this.props.opacity,updateTriggers:this.props.updateTriggers})]}}Y2.layerName="SolidHexTileLayer";Y2.defaultProps={..._A.defaultProps,...mm.defaultProps,thicknessRange:[.7,.9],resolution:0,resRange:[5,5],getValue:void 0};const _G=[[],[[0,0]],[[0,.33],[0,-.33]],[[-.33,-.33],[.33,-.33],[0,.29]],[[-.33,-.33],[.33,-.33],[-.33,.33],[.33,.33]],[[-.33,-.67],[.33,-.67],[-.33,0],[.33,0],[0,.58]],[[-.33,-.67],[.33,-.67],[-.33,0],[.33,0],[-.33,.67],[.33,.67]],[[0,0],[-.67,0],[.67,0],[-.33,.58],[.33,.58],[-.33,-.58],[.33,-.58]]],yG=aA().domain([0,1]).range(_G);class K2 extends _A{initializeState(){super.initializeState(),this.setState({hextiles:this.props.data})}renderLayers(){const{hextiles:e}=this.state;if(!e)return;let n=[],i=aA().domain([0,1]).range(ry(0,e.length))(this.props.resolution),r=aA().domain([0,1]).range(ry(this.props.resRange[0],this.props.resRange[1]+1))(this.props.resolution),c=e[i];const p=C1(r,Cd.km)/250*1.75;let a=C1(r,Cd.km)/C1(5,Cd.km);return Object.keys(c).forEach(T=>{let k=c[T];const[z,B]=_5(T);for(let[D,K]of yG(this.props.getValue({properties:k}))){let[ee,le]=this.props.offset;this.props.raised?n.push({position:[B+D*p+ee*p,z+K*p+le*p,this.props.getElevation({properties:k})],properties:k}):n.push({position:[B+D*p+ee*p,z+K*p+le*p],properties:k})}}),[new Rm({id:`${this.props.id}IconHexTileLayer`,data:n,getPosition:T=>T.position,mesh:this.props.mesh,texture:this.props.texture,sizeScale:this.props.sizeScale*a,wireframe:this.props.wireframe,material:this.props.material,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,textureParameters:this.props.textureParameters,autoHighlight:this.props.autoHighlight,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,highlightColor:this.props.highlightColor,loaders:this.props.loaders,modelMatrix:this.props.modelMatrix,opacity:this.props.opacity,pickable:this.props.pickable,visible:this.props.visible,wrapLongitude:this.props.wrapLongitude,updateTriggers:this.props.updateTriggers})]}}K2.layerName="IconHexTileLayer";K2.defaultProps={..._A.defaultProps,...Rm.defaultProps,thicknessRange:[.7,.9],resolution:0,resRange:[5,5],getValue:t=>t,offset:[0,0]};const im=[{"87298d866ffffff":{confidence:80.2,power:123.96000000000002,Elevation:1366,personnel:0},"8728364b0ffffff":{confidence:75,power:66.95,Elevation:725,personnel:0},"8728364b2ffffff":{confidence:72.2,power:82.28999999999999,Elevation:702,personnel:0},"8728364b6ffffff":{confidence:27,power:79.75,Elevation:725,personnel:0},"87298d862ffffff":{confidence:73.35714285714286,power:218.9678571428571,Elevation:1431,personnel:0},"87298d864ffffff":{confidence:85.41509433962264,power:106.8924528301887,Elevation:1300,personnel:0},"87298d871ffffff":{confidence:91.02857142857142,power:125.69428571428574,Elevation:1431,personnel:0},"87298d873ffffff":{confidence:82.94117647058823,power:74.44117647058822,Elevation:1550,personnel:0},"87298d870ffffff":{confidence:72,power:84.45217391304348,Elevation:1419,personnel:0},"87298d860ffffff":{confidence:76.53125,power:213.01562500000003,Elevation:1300,personnel:0},"87298d846ffffff":{confidence:70.42857142857143,power:45.10000000000001,Elevation:1530,personnel:0},"87298d9abffffff":{confidence:94.9,power:611.9399999999998,Elevation:1504,personnel:0},"87298d9aaffffff":{confidence:92.75925925925925,power:454.3611111111112,Elevation:1504,personnel:0},"87298d98dffffff":{confidence:66.57142857142857,power:274.10714285714283,Elevation:1479,personnel:.860161037286291},"87298d9a8ffffff":{confidence:96.72881355932203,power:563.0932203389831,Elevation:1504,personnel:0},"87298d813ffffff":{confidence:62.5,power:20.875,Elevation:1654,personnel:0},"87298d81effffff":{confidence:93,power:66.46249999999999,Elevation:1882,personnel:0},"87298d9acffffff":{confidence:87.71428571428571,power:574.6892857142858,Elevation:1594,personnel:0},"87298d81affffff":{confidence:57.333333333333336,power:92.75,Elevation:1882,personnel:0},"87298d92affffff":{confidence:74.25,power:65.76818181818183,Elevation:1261,personnel:0},"87298d92bffffff":{confidence:65.75,power:52.324999999999996,Elevation:1069,personnel:0},"87298d901ffffff":{confidence:94.17073170731707,power:134.44390243902438,Elevation:1261,personnel:.7678378139439905},"87298d903ffffff":{confidence:74.34782608695652,power:145.54782608695652,Elevation:1388,personnel:0},"87298d928ffffff":{confidence:78.5945945945946,power:55.96486486486486,Elevation:1156,personnel:0},"87298d92effffff":{confidence:75.45454545454545,power:66.91818181818181,Elevation:1354,personnel:0},"87298d91effffff":{confidence:80.97727272727273,power:235.66363636363633,Elevation:1376,personnel:.004055144158407464},"87298d91affffff":{confidence:56.9375,power:121.00625,Elevation:1317,personnel:.941002271395834},"87298d8e4ffffff":{confidence:66.68571428571428,power:68.35142857142858,Elevation:1811,personnel:0},"87298d803ffffff":{confidence:87.25,power:32.95,Elevation:1625,personnel:0},"87298d80affffff":{confidence:85.55172413793103,power:202.42758620689656,Elevation:1811,personnel:0},"87298d913ffffff":{confidence:89.125,power:297.3375,Elevation:1376,personnel:0},"87298d81dffffff":{confidence:72.6,power:56.56,Elevation:1625,personnel:0},"87298d8e0ffffff":{confidence:68.55,power:61.05500000000001,Elevation:1882,personnel:0},"87298d959ffffff":{confidence:74.5,power:79.43333333333334,Elevation:1366,personnel:.5845462257019302},"87298d981ffffff":{confidence:83.5,power:335.3888888888889,Elevation:1781,personnel:0},"87298d9adffffff":{confidence:75.82142857142857,power:81.08571428571429,Elevation:1376,personnel:0},"87298d91dffffff":{confidence:67.5,power:175.4,Elevation:1254,personnel:0},"87298d91cffffff":{confidence:89.16,power:267.856,Elevation:1254,personnel:0},"87298d865ffffff":{confidence:62.8,power:50.54,Elevation:1005,personnel:.4966034986165482},"87298d875ffffff":{confidence:79.70370370370371,power:115.06666666666666,Elevation:1431,personnel:0},"87298d911ffffff":{confidence:82.8,power:202.75999999999993,Elevation:1485,personnel:0},"87298d902ffffff":{confidence:81.5,power:144.24000000000004,Elevation:1388,personnel:0},"87298d918ffffff":{confidence:50,power:61.599999999999994,Elevation:1254,personnel:0},"87298d98cffffff":{confidence:85.06976744186046,power:438.9930232558139,Elevation:1479,personnel:.5672354768631239},"87298d90effffff":{confidence:86.5,power:149.175,Elevation:1106,personnel:0},"87298d9a9ffffff":{confidence:82.83333333333333,power:238.38333333333333,Elevation:1317,personnel:0},"87298d900ffffff":{confidence:84.6774193548387,power:166.53548387096774,Elevation:1388,personnel:.7755127010728279},"87298d98effffff":{confidence:92.55263157894737,power:357.7526315789472,Elevation:1666,personnel:.16636374579324753},"87298d988ffffff":{confidence:81.44,power:159.76,Elevation:1479,personnel:0},"87298d98affffff":{confidence:89.83333333333333,power:160.16851851851848,Elevation:1684,personnel:0},"87298d905ffffff":{confidence:72.66666666666667,power:56.32222222222222,Elevation:1354,personnel:0},"87298d999ffffff":{confidence:83.15,power:158.99,Elevation:1779,personnel:0},"87298d99dffffff":{confidence:74.10526315789474,power:103.69473684210527,Elevation:1817,personnel:0},"87298d998ffffff":{confidence:26.9,power:96.22,Elevation:1779,personnel:0},"87298d98bffffff":{confidence:53.42857142857143,power:39.83571428571429,Elevation:1555,personnel:0},"87298d836ffffff":{confidence:84,power:78.475,Elevation:1359,personnel:0},"87298d929ffffff":{confidence:58.666666666666664,power:99.90000000000002,Elevation:949,personnel:.45573485868103825},"87298d90cffffff":{confidence:42.5,power:179.9,Elevation:1261,personnel:0},"87298d834ffffff":{confidence:94,power:534.6,Elevation:1317,personnel:0},"87298d9a0ffffff":{confidence:86,power:430.59999999999997,Elevation:1953,personnel:0},"87298d9a2ffffff":{confidence:0,power:116.7,Elevation:2207,personnel:0},"87298d801ffffff":{confidence:70,power:38.1,Elevation:1491,personnel:0},"87298d81cffffff":{confidence:99,power:101.6,Elevation:1625,personnel:0},"87298d8adffffff":{confidence:86.25,power:67.8125,Elevation:1882,personnel:0},"87298d818ffffff":{confidence:65.0909090909091,power:57.81818181818182,Elevation:1794,personnel:.7125732007896374},"87298d874ffffff":{confidence:83.3,power:102.72,Elevation:1323,personnel:0},"87298d856ffffff":{confidence:44.22222222222222,power:31.488888888888894,Elevation:1741,personnel:0},"87298d809ffffff":{confidence:83,power:37.9,Elevation:1741,personnel:.44805592600101607},"87298d8a9ffffff":{confidence:47.65,power:43.925,Elevation:2062,personnel:0},"87298d812ffffff":{confidence:84.0909090909091,power:64.03636363636366,Elevation:1734,personnel:0},"87298d8a1ffffff":{confidence:84.81818181818181,power:81.66363636363636,Elevation:1734,personnel:0},"87298d8a5ffffff":{confidence:53.73684210526316,power:85.44736842105263,Elevation:1734,personnel:0},"87298d80effffff":{confidence:67.3076923076923,power:29.461538461538467,Elevation:1694,personnel:0},"87298d819ffffff":{confidence:68.57142857142857,power:114.0857142857143,Elevation:1794,personnel:0},"87298d800ffffff":{confidence:60,power:16.5,Elevation:1457,personnel:0},"87298d9aeffffff":{confidence:86.78787878787878,power:353.9030303030302,Elevation:1594,personnel:0},"87298d985ffffff":{confidence:86.13333333333334,power:445.2200000000001,Elevation:1781,personnel:0},"87298d906ffffff":{confidence:63,power:83.7,Elevation:1466,personnel:.48938611652176434},"87298d983ffffff":{confidence:86.83333333333333,power:155.9333333333333,Elevation:1817,personnel:0},"87298d81bffffff":{confidence:64,power:152.16666666666666,Elevation:1794,personnel:0},"87298d8e5ffffff":{confidence:74.52631578947368,power:95.7552631578947,Elevation:1802,personnel:0},"87298d8e3ffffff":{confidence:55,power:16.7,Elevation:1981,personnel:0},"87298d852ffffff":{confidence:100,power:119.45,Elevation:1802,personnel:0},"87298d8e1ffffff":{confidence:63.57142857142857,power:45.742857142857154,Elevation:1802,personnel:0},"87298d915ffffff":{confidence:38,power:59.96666666666667,Elevation:1485,personnel:0},"87298d808ffffff":{confidence:58,power:21,Elevation:1628,personnel:0},"87298d80bffffff":{confidence:62.25,power:33.45,Elevation:1741,personnel:0},"87298d816ffffff":{confidence:60.75,power:50.48333333333334,Elevation:1555,personnel:0},"87298d980ffffff":{confidence:100,power:514.2,Elevation:2007,personnel:.002830426682370324},"87298d989ffffff":{confidence:57.18181818181818,power:47.58181818181819,Elevation:1555,personnel:0},"8728364b1ffffff":{confidence:90.66666666666667,power:183.03333333333333,Elevation:636,personnel:.09274340534219172},"87298d94dffffff":{confidence:80.71428571428571,power:40.885714285714286,Elevation:814,personnel:.4540783303488197},"8728364b3ffffff":{confidence:70.77777777777777,power:93.01111111111112,Elevation:702,personnel:0},"87298d94bffffff":{confidence:76.66666666666667,power:59.166666666666664,Elevation:898,personnel:0},"87298d863ffffff":{confidence:44.333333333333336,power:29.53333333333333,Elevation:1389,personnel:0}},{"88298d866dfffff":{confidence:78.625,power:95.675,Elevation:1366,personnel:0},"8828364b05fffff":{confidence:87,power:36.849999999999994,Elevation:725,personnel:0},"8828364b23fffff":{confidence:75.6,power:130.04000000000002,Elevation:702,personnel:0},"8828364b63fffff":{confidence:27,power:79.75,Elevation:725,personnel:0},"88298d8667fffff":{confidence:58.38461538461539,power:86.60769230769233,Elevation:1366,personnel:0},"88298d8663fffff":{confidence:100,power:202.84285714285716,Elevation:1300,personnel:0},"88298d8621fffff":{confidence:5,power:15.199999999999998,Elevation:1431,personnel:0},"88298d864bfffff":{confidence:89.6,power:52.8,Elevation:1300,personnel:0},"88298d871dfffff":{confidence:97.85714285714286,power:78,Elevation:1431,personnel:0},"88298d8739fffff":{confidence:73.4,power:37.00000000000001,Elevation:1419,personnel:0},"88298d8701fffff":{confidence:100,power:29.45,Elevation:1419,personnel:0},"88298d8719fffff":{confidence:98.9090909090909,power:213.5636363636364,Elevation:1431,personnel:0},"88298d8641fffff":{confidence:100,power:84.92857142857143,Elevation:1300,personnel:0},"88298d866bfffff":{confidence:86.15384615384616,power:77.83846153846153,Elevation:1300,personnel:0},"8828364b2bfffff":{confidence:63.5,power:49.49999999999999,Elevation:702,personnel:0},"88298d8605fffff":{confidence:47.8,power:166.46,Elevation:1389,personnel:0},"88298d8717fffff":{confidence:73.8,power:48.36,Elevation:1431,personnel:0},"88298d8469fffff":{confidence:45,power:31.600000000000005,Elevation:1530,personnel:0},"88298d8643fffff":{confidence:88.2,power:83.25,Elevation:1300,personnel:0},"88298d8607fffff":{confidence:78.8,power:528.24,Elevation:1389,personnel:0},"88298d860dfffff":{confidence:81.85714285714286,power:278.75714285714287,Elevation:1300,personnel:0},"88298d9ab3fffff":{confidence:87.25,power:292.4,Elevation:1479,personnel:0},"88298d9abdfffff":{confidence:100,power:1098.5500000000002,Elevation:1504,personnel:0},"88298d9aabfffff":{confidence:74.28571428571429,power:214.24285714285716,Elevation:1504,personnel:0},"88298d9ab1fffff":{confidence:100,power:166,Elevation:1504,personnel:0},"88298d98dbfffff":{confidence:74.8,power:493.28000000000003,Elevation:1479,personnel:0},"88298d9a8dfffff":{confidence:95,power:245.84,Elevation:1504,personnel:0},"88298d9a81fffff":{confidence:100,power:358.9312499999999,Elevation:1504,personnel:0},"88298d98d9fffff":{confidence:57.75,power:44.35,Elevation:1479,personnel:0},"88298d8133fffff":{confidence:83,power:27.55,Elevation:1654,personnel:0},"88298d81a9fffff":{confidence:72.5,power:35.75,Elevation:1882,personnel:0},"88298d9ac5fffff":{confidence:97.66666666666667,power:73.53333333333332,Elevation:1594,personnel:0},"88298d9ac7fffff":{confidence:84.9090909090909,power:306.4181818181818,Elevation:1594,personnel:0},"88298d81a3fffff":{confidence:60,power:144.66666666666666,Elevation:1794,personnel:0},"88298d9285fffff":{confidence:79.47058823529412,power:70.31764705882354,Elevation:1156,personnel:0},"88298d92bdfffff":{confidence:75.5,power:80.65,Elevation:1069,personnel:0},"88298d9019fffff":{confidence:88.53846153846153,power:113.33846153846154,Elevation:1261,personnel:0},"88298d9023fffff":{confidence:95.75,power:254.15,Elevation:1388,personnel:0},"88298d92abfffff":{confidence:30.666666666666668,power:49.46666666666667,Elevation:1156,personnel:0},"88298d9039fffff":{confidence:56,power:48.25454545454545,Elevation:1388,personnel:0},"88298d903bfffff":{confidence:100,power:125.65,Elevation:1261,personnel:0},"88298d92e7fffff":{confidence:80.36363636363636,power:59.790909090909096,Elevation:1354,personnel:0},"88298d9287fffff":{confidence:99.5,power:49.833333333333336,Elevation:1156,personnel:0},"88298d9015fffff":{confidence:98.85714285714286,power:100.32857142857144,Elevation:1261,personnel:0},"88298d9011fffff":{confidence:95,power:122.27272727272727,Elevation:1261,personnel:.7678378139439905},"88298d9053fffff":{confidence:88.66666666666667,power:68.31666666666666,Elevation:1354,personnel:0},"88298d92adfffff":{confidence:69.57142857142857,power:35.1,Elevation:1354,personnel:0},"88298d91e5fffff":{confidence:100,power:102.25,Elevation:1376,personnel:0},"88298d91a9fffff":{confidence:98,power:284.675,Elevation:1376,personnel:0},"88298d8e4dfffff":{confidence:53.166666666666664,power:54.83333333333332,Elevation:1811,personnel:0},"88298d8037fffff":{confidence:83,power:20.1,Elevation:1625,personnel:0},"88298d80a5fffff":{confidence:77.71428571428571,power:336.75714285714287,Elevation:1811,personnel:0},"88298d91edfffff":{confidence:87,power:210.10000000000002,Elevation:1376,personnel:0},"88298d9133fffff":{confidence:100,power:501.925,Elevation:1376,personnel:0},"88298d913bfffff":{confidence:78.25,power:92.75,Elevation:1376,personnel:0},"88298d81d3fffff":{confidence:100,power:136.14999999999998,Elevation:1811,personnel:0},"88298d8e45fffff":{confidence:79,power:65.075,Elevation:1811,personnel:0},"88298d8e01fffff":{confidence:70.5,power:33.35,Elevation:1882,personnel:0},"88298d9593fffff":{confidence:96,power:112.80000000000001,Elevation:1300,personnel:0},"88298d9591fffff":{confidence:34.5,power:63.55,Elevation:1366,personnel:.5845462257019302},"88298d864dfffff":{confidence:55.142857142857146,power:21.514285714285712,Elevation:1300,personnel:0},"88298d8647fffff":{confidence:88.1,power:179.34,Elevation:1300,personnel:0},"88298d8649fffff":{confidence:90,power:164.32222222222222,Elevation:1300,personnel:0},"88298d9815fffff":{confidence:78.36363636363636,power:134.91818181818178,Elevation:1781,personnel:0},"88298d91adfffff":{confidence:49,power:45.785714285714285,Elevation:1376,personnel:0},"88298d9a8bfffff":{confidence:100,power:820.5333333333333,Elevation:1504,personnel:0},"88298d91e7fffff":{confidence:92.75,power:606.7249999999999,Elevation:1376,personnel:0},"88298d91d9fffff":{confidence:79,power:145.63333333333335,Elevation:1254,personnel:0},"88298d91e1fffff":{confidence:83.33333333333333,power:428.3111111111111,Elevation:1376,personnel:.004055144158407464},"88298d91cdfffff":{confidence:96.0909090909091,power:145.3818181818182,Elevation:1388,personnel:0},"88298d91e9fffff":{confidence:66.23076923076923,power:101.56153846153846,Elevation:1376,personnel:0},"88298d91ebfffff":{confidence:79.6,power:47.17999999999999,Elevation:1376,personnel:0},"88298d8651fffff":{confidence:75,power:63.349999999999994,Elevation:1005,personnel:.4966034986165482},"88298d8609fffff":{confidence:97.4,power:142.42000000000002,Elevation:1300,personnel:0},"88298d8601fffff":{confidence:79.5,power:76.55,Elevation:1300,personnel:0},"88298d8655fffff":{confidence:64.2,power:43.8,Elevation:1300,personnel:0},"88298d865dfffff":{confidence:54.666666666666664,power:42,Elevation:1300,personnel:0},"88298d860bfffff":{confidence:92,power:102.5,Elevation:1300,personnel:0},"88298d8759fffff":{confidence:60,power:64.95,Elevation:1366,personnel:0},"88298d959bfffff":{confidence:93,power:61.95,Elevation:1151,personnel:0},"88298d9113fffff":{confidence:68,power:78.02222222222223,Elevation:1485,personnel:0},"88298d9027fffff":{confidence:96,power:116.67999999999999,Elevation:1388,personnel:0},"88298d918dfffff":{confidence:50,power:61.599999999999994,Elevation:1254,personnel:0},"88298d91a5fffff":{confidence:41,power:119.4,Elevation:1317,personnel:0},"88298d9ab9fffff":{confidence:99.5,power:831.7,Elevation:1504,personnel:0},"88298d9a95fffff":{confidence:94.5,power:466.7,Elevation:1504,personnel:0},"88298d98c9fffff":{confidence:91,power:731.4,Elevation:1504,personnel:0},"88298d98cbfffff":{confidence:100,power:1011.1,Elevation:1479,personnel:0},"88298d90edfffff":{confidence:100,power:162.95,Elevation:1261,personnel:0},"88298d9813fffff":{confidence:96,power:518.4266666666666,Elevation:1666,personnel:0},"88298d9ab7fffff":{confidence:100,power:815.1,Elevation:1479,personnel:0},"88298d901dfffff":{confidence:97.25,power:315.34999999999997,Elevation:1261,personnel:0},"88298d91c3fffff":{confidence:80.75,power:199.39999999999998,Elevation:1254,personnel:0},"88298d9ad5fffff":{confidence:94.14285714285714,power:74.47142857142858,Elevation:1594,personnel:0},"88298d9aa9fffff":{confidence:97.91666666666667,power:145.90833333333333,Elevation:1504,personnel:0},"88298d9abbfffff":{confidence:100,power:396.05,Elevation:1504,personnel:0},"88298d981bfffff":{confidence:100,power:299.3416666666667,Elevation:1781,personnel:0},"88298d9ab5fffff":{confidence:100,power:1277.2,Elevation:1504,personnel:0},"88298d9117fffff":{confidence:96.83333333333333,power:493.11666666666656,Elevation:1376,personnel:0},"88298d9a89fffff":{confidence:98.66666666666667,power:450.6777777777777,Elevation:1594,personnel:0},"88298d9a87fffff":{confidence:100,power:4754.5,Elevation:1504,personnel:0},"88298d9003fffff":{confidence:84.5,power:46.2625,Elevation:1388,personnel:0},"88298d9aa5fffff":{confidence:95.3076923076923,power:566.5999999999999,Elevation:1781,personnel:0},"88298d9aa7fffff":{confidence:92.66666666666667,power:150.06666666666663,Elevation:1781,personnel:0},"88298d98c1fffff":{confidence:63.42857142857143,power:118.71428571428571,Elevation:1479,personnel:.5672354768631239},"88298d98e9fffff":{confidence:79.91666666666667,power:379.8,Elevation:1666,personnel:0},"88298d98d5fffff":{confidence:62.285714285714285,power:59.5,Elevation:1479,personnel:0},"88298d98c7fffff":{confidence:86.5,power:137.71666666666667,Elevation:1666,personnel:0},"88298d98e3fffff":{confidence:99.2,power:218.05,Elevation:1666,personnel:0},"88298d9881fffff":{confidence:48.666666666666664,power:39.6,Elevation:1479,personnel:0},"88298d9885fffff":{confidence:96.66666666666667,power:211.3,Elevation:1666,personnel:0},"88298d98adfffff":{confidence:100,power:209.3625,Elevation:1684,personnel:0},"88298d98a1fffff":{confidence:99.27272727272727,power:286.3181818181818,Elevation:1684,personnel:0},"88298d92a5fffff":{confidence:97.375,power:110.26249999999999,Elevation:1261,personnel:0},"88298d98cdfffff":{confidence:100,power:561.8000000000001,Elevation:1666,personnel:0},"88298d9889fffff":{confidence:79.2,power:44.22,Elevation:1479,personnel:0},"88298d9ad3fffff":{confidence:43.375,power:35.962500000000006,Elevation:1317,personnel:0},"88298d98c5fffff":{confidence:77.1,power:171.29000000000002,Elevation:1666,personnel:0},"88298d98a5fffff":{confidence:100,power:396.4,Elevation:1684,personnel:0},"88298d9999fffff":{confidence:100,power:104.62,Elevation:1684,personnel:0},"88298d99d5fffff":{confidence:61.75,power:96,Elevation:1817,personnel:0},"88298d9addfffff":{confidence:100,power:138.20000000000002,Elevation:1594,personnel:0},"88298d98a3fffff":{confidence:62.333333333333336,power:68.60000000000001,Elevation:1684,personnel:0},"88298d998bfffff":{confidence:27.285714285714285,power:124.04285714285713,Elevation:1779,personnel:0},"88298d98b9fffff":{confidence:39.333333333333336,power:25.76666666666667,Elevation:1555,personnel:0},"88298d928bfffff":{confidence:31.666666666666668,power:102.96666666666665,Elevation:1156,personnel:0},"88298d92a3fffff":{confidence:88,power:97.25,Elevation:1069,personnel:0},"88298d8363fffff":{confidence:77,power:110.6,Elevation:1359,personnel:0},"88298d98d1fffff":{confidence:55.125,power:510.5875000000001,Elevation:1479,personnel:.860161037286291},"88298d9283fffff":{confidence:88.71428571428571,power:37.98571428571428,Elevation:1156,personnel:0},"88298d92b9fffff":{confidence:56,power:24,Elevation:1069,personnel:0},"88298d8369fffff":{confidence:91,power:46.349999999999994,Elevation:1317,personnel:0},"88298d92d7fffff":{confidence:74,power:171,Elevation:1156,personnel:0},"88298d92a7fffff":{confidence:83,power:389.6,Elevation:1261,personnel:0},"88298d90c1fffff":{confidence:42.5,power:179.9,Elevation:1261,personnel:0},"88298d8345fffff":{confidence:94,power:534.6,Elevation:1317,personnel:0},"88298d989dfffff":{confidence:43.75,power:62.875,Elevation:1479,personnel:0},"88298d98abfffff":{confidence:84.57142857142857,power:63.39999999999999,Elevation:1684,personnel:0},"88298d98a7fffff":{confidence:81.625,power:100.38749999999999,Elevation:1684,personnel:0},"88298d929dfffff":{confidence:45,power:7.6,Elevation:1156,personnel:0},"88298d999bfffff":{confidence:90.28571428571429,power:205.8785714285714,Elevation:1684,personnel:0},"88298d9a03fffff":{confidence:86,power:430.59999999999997,Elevation:1922,personnel:0},"88298d9a29fffff":{confidence:0,power:116.7,Elevation:2207,personnel:0},"88298d8011fffff":{confidence:87,power:47.75,Elevation:1491,personnel:0},"88298d9013fffff":{confidence:100,power:229.6,Elevation:1261,personnel:0},"88298d90e9fffff":{confidence:73,power:135.4,Elevation:1261,personnel:0},"88298d92a1fffff":{confidence:76.42857142857143,power:66.25714285714285,Elevation:1261,personnel:0},"88298d91ddfffff":{confidence:77.66666666666667,power:309.2,Elevation:1254,personnel:0},"88298d9a97fffff":{confidence:99,power:644.75,Elevation:1317,personnel:0},"88298d928dfffff":{confidence:62.5,power:18.25,Elevation:1156,personnel:0},"88298d9281fffff":{confidence:95.5,power:62.6,Elevation:1156,personnel:0},"88298d92a9fffff":{confidence:63.9,power:33.17,Elevation:1156,personnel:0},"88298d9007fffff":{confidence:56.5,power:376.98333333333335,Elevation:1388,personnel:0},"88298d9ad9fffff":{confidence:95,power:56.75,Elevation:1376,personnel:0},"88298d900bfffff":{confidence:91.42857142857143,power:140.91428571428568,Elevation:1261,personnel:0},"88298d81c7fffff":{confidence:99,power:101.6,Elevation:1625,personnel:0},"88298d8ad9fffff":{confidence:97.33333333333333,power:80.81666666666666,Elevation:1882,personnel:0},"88298d81e3fffff":{confidence:90.5,power:59.5,Elevation:1794,personnel:0},"88298d818dfffff":{confidence:93,power:67.85,Elevation:1794,personnel:0},"88298d8185fffff":{confidence:57.75,power:54.1375,Elevation:1794,personnel:0},"88298d8743fffff":{confidence:100,power:404.15,Elevation:1323,personnel:0},"88298d8755fffff":{confidence:63.142857142857146,power:56.471428571428575,Elevation:1431,personnel:0},"88298d8751fffff":{confidence:40,power:27.6,Elevation:1431,personnel:0},"88298d870bfffff":{confidence:61.375,power:172.48749999999998,Elevation:1431,personnel:0},"88298d8703fffff":{confidence:96,power:32.8,Elevation:1419,personnel:0},"88298d8753fffff":{confidence:88.75,power:103.2625,Elevation:1431,personnel:0},"88298d8731fffff":{confidence:82,power:60.650000000000006,Elevation:1550,personnel:0},"88298d8569fffff":{confidence:16,power:14.7,Elevation:1741,personnel:0},"88298d8757fffff":{confidence:100,power:72.95,Elevation:1431,personnel:0},"88298d8709fffff":{confidence:76.8,power:94.98,Elevation:1419,personnel:0},"88298d8707fffff":{confidence:92,power:162.9,Elevation:1419,personnel:0},"88298d8093fffff":{confidence:83,power:37.9,Elevation:1741,personnel:0},"88298d8a9dfffff":{confidence:80,power:38.8,Elevation:1882,personnel:0},"88298d8a91fffff":{confidence:49.111111111111114,power:36.34444444444444,Elevation:2062,personnel:0},"88298d81ebfffff":{confidence:100,power:107.5,Elevation:1625,personnel:0},"88298d8ad1fffff":{confidence:53,power:28.8,Elevation:1882,personnel:0},"88298d81e7fffff":{confidence:48,power:60.7,Elevation:1882,personnel:0},"88298d8a99fffff":{confidence:60.5,power:59.824999999999996,Elevation:1882,personnel:0},"88298d81e5fffff":{confidence:94.5,power:58.25,Elevation:1882,personnel:0},"88298d8121fffff":{confidence:90.42857142857143,power:42.55714285714286,Elevation:1734,personnel:0},"88298d8129fffff":{confidence:53,power:20.666666666666668,Elevation:1734,personnel:0},"88298d8125fffff":{confidence:85.8,power:84.22,Elevation:1734,personnel:0},"88298d8a1bfffff":{confidence:100,power:79.15,Elevation:1734,personnel:0},"88298d8a57fffff":{confidence:97.4,power:69.67999999999999,Elevation:1734,personnel:0},"88298d876bfffff":{confidence:60.5,power:14.649999999999999,Elevation:1419,personnel:0},"88298d80e7fffff":{confidence:69.75,power:41.575,Elevation:1694,personnel:0},"88298d80a9fffff":{confidence:69.625,power:45.162499999999994,Elevation:1694,personnel:0},"88298d80adfffff":{confidence:99.57142857142857,power:279.7285714285714,Elevation:1811,personnel:0},"88298d80abfffff":{confidence:100,power:194.6,Elevation:1811,personnel:0},"88298d8e49fffff":{confidence:73,power:107.72857142857141,Elevation:1811,personnel:0},"88298d81dbfffff":{confidence:65.16666666666667,power:34.199999999999996,Elevation:1694,personnel:0},"88298d8e6bfffff":{confidence:27,power:21.95,Elevation:1882,personnel:0},"88298d8199fffff":{confidence:100,power:164.5,Elevation:1811,personnel:0},"88298d8001fffff":{confidence:60,power:16.5,Elevation:1457,personnel:0},"88298d8137fffff":{confidence:42,power:14.2,Elevation:1654,personnel:0},"88298d98ddfffff":{confidence:95,power:687.9666666666667,Elevation:1479,personnel:0},"88298d988dfffff":{confidence:100,power:277.02000000000004,Elevation:1666,personnel:0},"88298d901bfffff":{confidence:63,power:15.5,Elevation:1261,personnel:0},"88298d98a9fffff":{confidence:84.25,power:121.55,Elevation:1666,personnel:0},"88298d98e7fffff":{confidence:100,power:1218.125,Elevation:1666,personnel:0},"88298d9adbfffff":{confidence:94.25,power:67.5,Elevation:1376,personnel:0},"88298d98ebfffff":{confidence:100,power:110.175,Elevation:1666,personnel:0},"88298d99d7fffff":{confidence:76,power:100.15000000000002,Elevation:1779,personnel:0},"88298d9031fffff":{confidence:97.8,power:339.53999999999996,Elevation:1388,personnel:0},"88298d91c7fffff":{confidence:100,power:732.75,Elevation:1254,personnel:0},"88298d9ad1fffff":{confidence:59.25,power:83.775,Elevation:1376,personnel:0},"88298d9ad7fffff":{confidence:61,power:47.25,Elevation:1317,personnel:0},"88298d92e3fffff":{confidence:95,power:63.099999999999994,Elevation:1156,personnel:0},"88298d9057fffff":{confidence:93.5,power:55.1,Elevation:1354,personnel:0},"88298d99d9fffff":{confidence:84,power:167.18,Elevation:1666,personnel:0},"88298d98e5fffff":{confidence:99.2,power:190.76,Elevation:1666,personnel:0},"88298d9983fffff":{confidence:26,power:31.3,Elevation:1779,personnel:0},"88298d9995fffff":{confidence:39.666666666666664,power:30.066666666666666,Elevation:1779,personnel:0},"88298d98e1fffff":{confidence:94,power:180.7,Elevation:1666,personnel:.16636374579324753},"88298d999dfffff":{confidence:66.5,power:31.6,Elevation:1779,personnel:0},"88298d985bfffff":{confidence:70.66666666666667,power:175.16666666666666,Elevation:1781,personnel:0},"88298d9aadfffff":{confidence:97.25,power:589.15,Elevation:1781,personnel:0},"88298d9853fffff":{confidence:100,power:774.5571428571428,Elevation:1781,personnel:0},"88298d9819fffff":{confidence:55.833333333333336,power:48.083333333333336,Elevation:1781,personnel:0},"88298d9063fffff":{confidence:63,power:83.7,Elevation:1466,personnel:0},"88298d9aebfffff":{confidence:65.8,power:211.9,Elevation:1594,personnel:0},"88298d9857fffff":{confidence:84,power:102.7,Elevation:1781,personnel:0},"88298d9ae7fffff":{confidence:82.54545454545455,power:101.32727272727274,Elevation:1781,personnel:0},"88298d9aa1fffff":{confidence:94.1,power:710.8900000000001,Elevation:1504,personnel:0},"88298d983bfffff":{confidence:90,power:173.82500000000002,Elevation:1666,personnel:0},"88298d9803fffff":{confidence:56.833333333333336,power:305.7666666666667,Elevation:1781,personnel:0},"88298d9831fffff":{confidence:67.66666666666667,power:149.83333333333334,Elevation:1817,personnel:0},"88298d9835fffff":{confidence:91,power:133.7,Elevation:1817,personnel:0},"88298d8a9bfffff":{confidence:3.5,power:63,Elevation:1882,personnel:0},"88298d8033fffff":{confidence:79,power:20.4,Elevation:1694,personnel:0},"88298d8031fffff":{confidence:91.5,power:45.8,Elevation:1625,personnel:0},"88298d8a97fffff":{confidence:34,power:36.166666666666664,Elevation:2062,personnel:0},"88298d81b1fffff":{confidence:64,power:152.16666666666666,Elevation:1794,personnel:0},"88298d9ae9fffff":{confidence:82.4,power:496.68,Elevation:1594,personnel:0},"88298d9a33fffff":{confidence:45,power:12.1,Elevation:1922,personnel:0},"88298d8567fffff":{confidence:34.4,power:22.360000000000003,Elevation:1802,personnel:0},"88298d8e0bfffff":{confidence:64.33333333333333,power:52.77777777777777,Elevation:1882,personnel:0},"88298d8e5dfffff":{confidence:74.5,power:65.86666666666667,Elevation:1811,personnel:0},"88298d8e59fffff":{confidence:72,power:77.60000000000001,Elevation:1741,personnel:0},"88298d8e3dfffff":{confidence:55,power:16.7,Elevation:1882,personnel:0},"88298d8e51fffff":{confidence:84.71428571428571,power:49.92857142857143,Elevation:1802,personnel:0},"88298d8e5bfffff":{confidence:76.5,power:122.25,Elevation:1802,personnel:0},"88298d8e09fffff":{confidence:72.8,power:114.9,Elevation:1882,personnel:0},"88298d852dfffff":{confidence:100,power:119.45,Elevation:1802,personnel:0},"88298d8e57fffff":{confidence:77.57142857142857,power:126.85714285714286,Elevation:1802,personnel:0},"88298d8e05fffff":{confidence:73,power:19.1,Elevation:1882,personnel:0},"88298d8e53fffff":{confidence:64.71428571428571,power:145.25714285714287,Elevation:1802,personnel:0},"88298d8e1dfffff":{confidence:41,power:39.3,Elevation:1882,personnel:0},"88298d8e15fffff":{confidence:41,power:39.3,Elevation:1882,personnel:0},"88298d9ae1fffff":{confidence:96.4,power:1203.58,Elevation:1594,personnel:0},"88298d9ac3fffff":{confidence:100,power:361.1,Elevation:1594,personnel:0},"88298d9005fffff":{confidence:93.2,power:95.5,Elevation:1388,personnel:0},"88298d911bfffff":{confidence:95,power:64.05,Elevation:1485,personnel:0},"88298d915bfffff":{confidence:8,power:70.8,Elevation:1485,personnel:0},"88298d9051fffff":{confidence:22.333333333333332,power:28.766666666666666,Elevation:1354,personnel:0},"88298d902dfffff":{confidence:82,power:69.10000000000001,Elevation:1388,personnel:0},"88298d9119fffff":{confidence:68,power:49.13333333333333,Elevation:1485,personnel:0},"88298d9025fffff":{confidence:88,power:72.25,Elevation:1388,personnel:0},"88298d9ac9fffff":{confidence:100,power:222.20000000000002,Elevation:1594,personnel:0},"88298d871bfffff":{confidence:93,power:23.7,Elevation:1431,personnel:0},"88298d873bfffff":{confidence:92.2,power:140.90000000000003,Elevation:1431,personnel:0},"88298d846dfffff":{confidence:100,power:56.35,Elevation:1530,personnel:0},"88298d8713fffff":{confidence:96,power:211.95,Elevation:1431,personnel:0},"88298d8665fffff":{confidence:89,power:111.55,Elevation:1366,personnel:0},"88298d8661fffff":{confidence:74.83333333333333,power:193.25000000000003,Elevation:1366,personnel:0},"88298d8625fffff":{confidence:85.5,power:120.88749999999999,Elevation:1431,personnel:0},"88298d8629fffff":{confidence:71.42857142857143,power:60.18571428571429,Elevation:1389,personnel:0},"88298d875bfffff":{confidence:100,power:295.35,Elevation:1366,personnel:0},"88298d862dfffff":{confidence:90,power:342.225,Elevation:1431,personnel:0},"88298d862bfffff":{confidence:100,power:1509.6999999999998,Elevation:1389,personnel:0},"88298d8623fffff":{confidence:90,power:94.26666666666667,Elevation:1389,personnel:0},"88298d874dfffff":{confidence:81,power:19.700000000000003,Elevation:1323,personnel:0},"88298d8741fffff":{confidence:81,power:23,Elevation:1323,personnel:0},"88298d8e41fffff":{confidence:75,power:97.63333333333333,Elevation:1811,personnel:0},"88298d80e1fffff":{confidence:62.57142857142857,power:25.128571428571426,Elevation:1694,personnel:0},"88298d80a1fffff":{confidence:98,power:155.175,Elevation:1811,personnel:0},"88298d8e4bfffff":{confidence:96.2,power:71.18,Elevation:1811,personnel:0},"88298d80a7fffff":{confidence:94,power:189.4,Elevation:1811,personnel:0},"88298d8085fffff":{confidence:58,power:21,Elevation:1694,personnel:0},"88298d80b7fffff":{confidence:64.5,power:41.15,Elevation:1741,personnel:0},"88298d819bfffff":{confidence:45.5,power:79.375,Elevation:1811,personnel:0},"88298d8191fffff":{confidence:98,power:152.1,Elevation:1794,personnel:0},"88298d8711fffff":{confidence:73.5,power:76.23333333333333,Elevation:1431,personnel:0},"88298d8e55fffff":{confidence:71.2,power:30.119999999999997,Elevation:1882,personnel:0},"88298d80b3fffff":{confidence:60,power:25.75,Elevation:1741,personnel:0},"8828364b2dfffff":{confidence:78,power:23.53333333333333,Elevation:898,personnel:0},"88298d8165fffff":{confidence:53.2,power:46.18,Elevation:1555,personnel:0},"88298d902bfffff":{confidence:100,power:152.84,Elevation:1388,personnel:0},"88298d98bbfffff":{confidence:16,power:59.349999999999994,Elevation:1555,personnel:0},"88298d9899fffff":{confidence:79,power:212.4,Elevation:1479,personnel:0},"88298d8a53fffff":{confidence:43,power:215.92,Elevation:1734,personnel:0},"88298d98b3fffff":{confidence:72.5,power:43,Elevation:1555,personnel:0},"8828364b15fffff":{confidence:92.33333333333333,power:210.86666666666667,Elevation:636,personnel:0},"88298d801bfffff":{confidence:53,power:28.45,Elevation:1491,personnel:0},"88298d9035fffff":{confidence:73,power:178.36666666666667,Elevation:1388,personnel:0},"88298d91c9fffff":{confidence:92,power:516.85,Elevation:1388,personnel:0},"88298d91e3fffff":{confidence:100,power:217.95,Elevation:1376,personnel:0},"88298d9a9dfffff":{confidence:80.25,power:585.175,Elevation:1317,personnel:0},"88298d9aa3fffff":{confidence:100,power:1110.275,Elevation:1504,personnel:0},"88298d9ae3fffff":{confidence:93,power:203.625,Elevation:1504,personnel:0},"88298d9a85fffff":{confidence:83.16666666666667,power:444.33333333333326,Elevation:1504,personnel:0},"88298d9a83fffff":{confidence:100,power:4849.1,Elevation:1504,personnel:0},"88298d9811fffff":{confidence:88,power:277.06666666666666,Elevation:1781,personnel:0},"88298d9021fffff":{confidence:37,power:62.27499999999999,Elevation:1388,personnel:0},"88298d9111fffff":{confidence:91,power:88.73333333333333,Elevation:1485,personnel:0},"88298d9295fffff":{confidence:51,power:64.35,Elevation:1156,personnel:0},"88298d9891fffff":{confidence:91.5,power:75.35,Elevation:1555,personnel:0},"88298d8161fffff":{confidence:27,power:16.8,Elevation:1555,personnel:0},"88298d8a59fffff":{confidence:56.333333333333336,power:21.399999999999995,Elevation:1555,personnel:0},"88298d9897fffff":{confidence:35.333333333333336,power:21.1,Elevation:1555,personnel:0},"88298d8167fffff":{confidence:69.66666666666667,power:34.5,Elevation:1734,personnel:0},"88298d8169fffff":{confidence:82,power:22.25,Elevation:1555,personnel:0},"88298d816dfffff":{confidence:100,power:118.9,Elevation:1555,personnel:0},"88298d98b1fffff":{confidence:95,power:56.2,Elevation:1555,personnel:0},"88298d8645fffff":{confidence:84,power:110.28,Elevation:1300,personnel:0},"88298d94dbfffff":{confidence:95,power:69.85,Elevation:814,personnel:0},"88298d94d3fffff":{confidence:75,power:29.299999999999994,Elevation:898,personnel:0},"8828364b03fffff":{confidence:68,power:148.4,Elevation:702,personnel:0},"8828364b35fffff":{confidence:67,power:29.275000000000002,Elevation:702,personnel:0},"8828364b07fffff":{confidence:71.33333333333333,power:72.53333333333332,Elevation:702,personnel:0},"8828364b3dfffff":{confidence:73.8,power:144,Elevation:702,personnel:0},"88298d94b7fffff":{confidence:80.8,power:43.36,Elevation:1300,personnel:0},"88298d8a5bfffff":{confidence:48.142857142857146,power:42.785714285714285,Elevation:1734,personnel:0},"88298d8a19fffff":{confidence:79.2,power:102.26,Elevation:1734,personnel:0},"88298d99dbfffff":{confidence:71.25,power:37.35,Elevation:1666,personnel:0},"88298d8187fffff":{confidence:68,power:67.2,Elevation:1794,personnel:0},"88298d81d7fffff":{confidence:35,power:47.5,Elevation:1794,personnel:0},"88298d98c3fffff":{confidence:95,power:57.9,Elevation:1479,personnel:0},"88298d8631fffff":{confidence:44,power:29.45,Elevation:1389,personnel:0},"88298d8639fffff":{confidence:45,power:29.7,Elevation:1389,personnel:0},"88298d8a51fffff":{confidence:54,power:19.1,Elevation:1734,personnel:0},"88298d8a11fffff":{confidence:42,power:22.3,Elevation:1734,personnel:0},"88298d812dfffff":{confidence:100,power:103.35,Elevation:1734,personnel:0},"88298d8669fffff":{confidence:100,power:259.15,Elevation:1366,personnel:0},"88298d91c5fffff":{confidence:8,power:53.849999999999994,Elevation:1254,personnel:0},"88298d91cbfffff":{confidence:100,power:173.45,Elevation:1254,personnel:0},"88298d8715fffff":{confidence:95.75,power:110.45,Elevation:1431,personnel:0},"88298d9001fffff":{confidence:100,power:228.85,Elevation:1388,personnel:.7755127010728279},"88298d9ac1fffff":{confidence:100,power:3150.566666666667,Elevation:1594,personnel:0},"8828364b17fffff":{confidence:89,power:155.20000000000002,Elevation:636,personnel:0},"88298d94b5fffff":{confidence:56,power:138.2,Elevation:1300,personnel:0},"88298d80a3fffff":{confidence:97,power:35,Elevation:1811,personnel:0},"88298d8565fffff":{confidence:97,power:71.1,Elevation:1741,personnel:0},"88298d8525fffff":{confidence:62,power:12.1,Elevation:1802,personnel:0},"88298d91a1fffff":{Elevation:0,confidence:0,power:0,personnel:.941002271395834},"88298d9291fffff":{Elevation:0,confidence:0,power:0,personnel:.45573485868103825},"88298d8181fffff":{Elevation:0,confidence:0,power:0,personnel:.7125732007896374},"88298d8091fffff":{Elevation:0,confidence:0,power:0,personnel:.44805592600101607},"88298d9061fffff":{Elevation:0,confidence:0,power:0,personnel:.48938611652176434},"88298d9801fffff":{Elevation:0,confidence:0,power:0,personnel:.002830426682370324},"8828364b11fffff":{Elevation:0,confidence:0,power:0,personnel:.09274340534219172},"88298d94d1fffff":{Elevation:0,confidence:0,power:0,personnel:.4540783303488197}},{"89298d866d3ffff":{confidence:100,power:228.2,Elevation:1366,personnel:0},"8928364b05bffff":{confidence:87,power:36.849999999999994,Elevation:725,personnel:0},"8928364b22bffff":{confidence:52,power:33.099999999999994,Elevation:702,personnel:0},"89298d866cfffff":{confidence:85.5,power:35.2,Elevation:1366,personnel:0},"8928364b637ffff":{confidence:27,power:79.75,Elevation:725,personnel:0},"89298d8666bffff":{confidence:38.5,power:92.57499999999999,Elevation:1366,personnel:0},"89298d8662fffff":{confidence:100,power:52.43333333333334,Elevation:1300,personnel:0},"89298d8621bffff":{confidence:5,power:15.199999999999998,Elevation:1431,personnel:0},"89298d864bbffff":{confidence:100,power:160.45999999999998,Elevation:1300,personnel:0},"89298d871d3ffff":{confidence:100,power:69.26666666666667,Elevation:1431,personnel:0},"89298d87397ffff":{confidence:97.33333333333333,power:34.93333333333333,Elevation:1419,personnel:0},"89298d87007ffff":{confidence:98,power:31.099999999999998,Elevation:1419,personnel:0},"89298d8718bffff":{confidence:100,power:260.77500000000003,Elevation:1431,personnel:0},"89298d86473ffff":{confidence:83,power:56.51428571428572,Elevation:1300,personnel:0},"89298d866c7ffff":{confidence:66,power:13.8,Elevation:1366,personnel:0},"89298d866bbffff":{confidence:93.5,power:89.325,Elevation:1300,personnel:0},"89298d8662bffff":{confidence:100,power:115.1,Elevation:1366,personnel:0},"8928364b2b3ffff":{confidence:55,power:51.05,Elevation:702,personnel:0},"89298d86047ffff":{confidence:13,power:24.566666666666666,Elevation:1389,personnel:0},"89298d87177ffff":{confidence:70.33333333333333,power:44.53333333333333,Elevation:1431,personnel:0},"89298d84697ffff":{confidence:45,power:31.600000000000005,Elevation:1530,personnel:0},"89298d86423ffff":{confidence:84.85714285714286,power:94.95714285714287,Elevation:1300,personnel:0},"89298d86077ffff":{confidence:64.66666666666667,power:59.36666666666667,Elevation:1389,personnel:0},"89298d860c3ffff":{confidence:57.666666666666664,power:52.53333333333333,Elevation:1300,personnel:0},"89298d9ab27ffff":{confidence:83,power:260.18333333333334,Elevation:1479,personnel:0},"89298d9abc7ffff":{confidence:100,power:1098.5500000000002,Elevation:1504,personnel:0},"89298d9aab7ffff":{confidence:100,power:645.5,Elevation:1504,personnel:0},"89298d9ab13ffff":{confidence:100,power:166,Elevation:1504,personnel:0},"89298d98dbbffff":{confidence:93.33333333333333,power:776.2666666666668,Elevation:1479,personnel:0},"89298d9a8d3ffff":{confidence:87.5,power:128.86666666666665,Elevation:1594,personnel:0},"89298d9a80bffff":{confidence:100,power:109.55999999999999,Elevation:1504,personnel:0},"89298d98d8bffff":{confidence:51.5,power:49.1,Elevation:1479,personnel:0},"89298d98d8fffff":{confidence:64,power:39.6,Elevation:1479,personnel:0},"89298d81337ffff":{confidence:83,power:27.55,Elevation:1654,personnel:0},"89298d81e2fffff":{confidence:87,power:40.599999999999994,Elevation:1794,personnel:0},"89298d9ac4bffff":{confidence:97.5,power:73.44999999999999,Elevation:1594,personnel:0},"89298d9ac7bffff":{confidence:100,power:236.4,Elevation:1594,personnel:0},"89298d9a8c3ffff":{confidence:100,power:256.8,Elevation:1504,personnel:0},"89298d81a23ffff":{confidence:60,power:144.66666666666666,Elevation:1794,personnel:0},"89298d9284bffff":{confidence:81,power:87.7,Elevation:1156,personnel:0},"89298d92bcbffff":{confidence:75.5,power:80.65,Elevation:1069,personnel:0},"89298d901bbffff":{confidence:93.5,power:159.925,Elevation:1261,personnel:0},"89298d90227ffff":{confidence:96.5,power:407.225,Elevation:1388,personnel:0},"89298d92abbffff":{confidence:22,power:64,Elevation:1156,personnel:0},"89298d9039bffff":{confidence:71.75,power:94.65,Elevation:1388,personnel:0},"89298d903afffff":{confidence:100,power:125.65,Elevation:1261,personnel:0},"89298d92e6fffff":{confidence:79,power:44.475,Elevation:1354,personnel:0},"89298d9287bffff":{confidence:75.625,power:33.675,Elevation:1156,personnel:0},"89298d90143ffff":{confidence:97.33333333333333,power:44.9,Elevation:1261,personnel:0},"89298d90183ffff":{confidence:100,power:41.65,Elevation:1261,personnel:0},"89298d9010fffff":{confidence:79,power:17.3,Elevation:1261,personnel:0},"89298d90153ffff":{confidence:100,power:36.900000000000006,Elevation:1261,personnel:0},"89298d92e7bffff":{confidence:89,power:78.7,Elevation:1354,personnel:0},"89298d90527ffff":{confidence:66,power:49.75,Elevation:1354,personnel:0},"89298d92ad7ffff":{confidence:75.33333333333333,power:39.73333333333334,Elevation:1354,personnel:0},"89298d91e4fffff":{confidence:100,power:102.25,Elevation:1376,personnel:0},"89298d91a8bffff":{confidence:100,power:159.75,Elevation:1376,personnel:0},"89298d8e4c3ffff":{confidence:75,power:26.233333333333334,Elevation:1811,personnel:0},"89298d80377ffff":{confidence:83,power:20.1,Elevation:1625,personnel:0},"89298d80a5bffff":{confidence:22,power:19.5,Elevation:1811,personnel:0},"89298d91edbffff":{confidence:76,power:106.8,Elevation:1376,personnel:0},"89298d91323ffff":{confidence:100,power:915.9,Elevation:1376,personnel:0},"89298d8e4d3ffff":{confidence:78,power:87.77499999999999,Elevation:1811,personnel:0},"89298d913bbffff":{confidence:100,power:106.55,Elevation:1376,personnel:0},"89298d81d2bffff":{confidence:100,power:136.14999999999998,Elevation:1811,personnel:0},"89298d8e457ffff":{confidence:100,power:99.15,Elevation:1811,personnel:0},"89298d8e00fffff":{confidence:70.5,power:33.35,Elevation:1882,personnel:0},"89298d9592fffff":{confidence:96,power:112.80000000000001,Elevation:1300,personnel:0},"89298d95907ffff":{confidence:34.5,power:63.55,Elevation:1366,personnel:0},"89298d864cfffff":{confidence:19.5,power:15.2,Elevation:1300,personnel:0},"89298d86463ffff":{confidence:100,power:56.43333333333334,Elevation:1300,personnel:0},"89298d86417ffff":{confidence:100,power:46.06666666666666,Elevation:1300,personnel:0},"89298d8648bffff":{confidence:96,power:102.8,Elevation:1300,personnel:0},"89298d9815bffff":{confidence:96,power:221.7,Elevation:1781,personnel:0},"89298d91ecfffff":{confidence:100,power:174.7,Elevation:1376,personnel:0},"89298d91adbffff":{confidence:51,power:60.22500000000001,Elevation:1376,personnel:0},"89298d9a8a7ffff":{confidence:100,power:1575.1,Elevation:1504,personnel:0},"89298d91e73ffff":{confidence:92.75,power:606.7249999999999,Elevation:1376,personnel:0},"89298d91d8bffff":{confidence:47,power:202.8,Elevation:1254,personnel:0},"89298d91e1bffff":{confidence:100,power:713.0400000000001,Elevation:1376,personnel:0},"89298d91ccbffff":{confidence:96,power:45.325,Elevation:1388,personnel:0},"89298d91e93ffff":{confidence:100,power:45.6,Elevation:1376,personnel:0},"89298d91ebbffff":{confidence:51.5,power:52.2,Elevation:1376,personnel:0},"89298d860d3ffff":{confidence:100,power:81.2,Elevation:1300,personnel:0},"89298d8650bffff":{confidence:75,power:63.349999999999994,Elevation:1300,personnel:0},"89298d860c7ffff":{confidence:100,power:815.65,Elevation:1300,personnel:0},"89298d8608bffff":{confidence:95,power:96.94999999999999,Elevation:1300,personnel:0},"89298d8600fffff":{confidence:79.5,power:76.55,Elevation:1389,personnel:0},"89298d8654bffff":{confidence:64.2,power:43.8,Elevation:1300,personnel:0},"89298d86553ffff":{confidence:54.666666666666664,power:42,Elevation:1300,personnel:0},"89298d8608fffff":{confidence:99,power:172.73333333333335,Elevation:1300,personnel:0},"89298d860b3ffff":{confidence:92,power:102.5,Elevation:1300,personnel:0},"89298d87583ffff":{confidence:60,power:64.95,Elevation:1366,personnel:0},"89298d864dbffff":{confidence:93,power:61.95,Elevation:1300,personnel:0},"89298d866c3ffff":{confidence:63,power:105.5,Elevation:1366,personnel:0},"89298d91133ffff":{confidence:13,power:18.75,Elevation:1485,personnel:0},"89298d9026fffff":{confidence:93.33333333333333,power:79.96666666666667,Elevation:1388,personnel:0},"89298d918cfffff":{confidence:27,power:90.35,Elevation:1254,personnel:0},"89298d91a53ffff":{confidence:54,power:95.9,Elevation:1317,personnel:0},"89298d9ab83ffff":{confidence:100,power:1576.1,Elevation:1504,personnel:0},"89298d9a94bffff":{confidence:100,power:898,Elevation:1504,personnel:0},"89298d98c8fffff":{confidence:100,power:175.14999999999998,Elevation:1479,personnel:0},"89298d98cb7ffff":{confidence:100,power:1011.1,Elevation:1479,personnel:0},"89298d90ed3ffff":{confidence:100,power:162.95,Elevation:1261,personnel:0},"89298d98123ffff":{confidence:100,power:245.89999999999998,Elevation:1666,personnel:0},"89298d9ab6fffff":{confidence:100,power:815.1,Elevation:1479,personnel:0},"89298d901cfffff":{confidence:100,power:224.9,Elevation:1261,personnel:0},"89298d91c23ffff":{confidence:100,power:193.14999999999998,Elevation:1254,personnel:0},"89298d91e17ffff":{confidence:100,power:123.9,Elevation:1376,personnel:0},"89298d9ad53ffff":{confidence:94.57142857142857,power:101.3714285714286,Elevation:1594,personnel:0},"89298d9a8c7ffff":{confidence:100,power:504.8,Elevation:1504,personnel:0},"89298d9a8a3ffff":{confidence:100,power:443.25,Elevation:1504,personnel:0},"89298d9aa13ffff":{confidence:100,power:266.4,Elevation:1504,personnel:0},"89298d9a943ffff":{confidence:89,power:35.400000000000006,Elevation:1504,personnel:0},"89298d9aba7ffff":{confidence:100,power:396.05,Elevation:1504,personnel:0},"89298d981abffff":{confidence:100,power:156.04000000000002,Elevation:1781,personnel:0},"89298d9ab4bffff":{confidence:100,power:1277.2,Elevation:1504,personnel:0},"89298d9812fffff":{confidence:84,power:52.46666666666666,Elevation:1666,personnel:0},"89298d90103ffff":{confidence:93.5,power:349.75,Elevation:1261,personnel:.7678378139439905},"89298d9117bffff":{confidence:90.5,power:293.75,Elevation:1376,personnel:0},"89298d9116bffff":{confidence:100,power:592.8,Elevation:1376,personnel:0},"89298d9a897ffff":{confidence:100,power:724.3999999999999,Elevation:1594,personnel:0},"89298d98c93ffff":{confidence:100,power:1977.6999999999998,Elevation:1504,personnel:0},"89298d9a863ffff":{confidence:100,power:4754.5,Elevation:1504,personnel:0},"89298d90037ffff":{confidence:88.33333333333333,power:34.86666666666667,Elevation:1261,personnel:0},"89298d9aa47ffff":{confidence:100,power:649.7,Elevation:1781,personnel:0},"89298d9aa6fffff":{confidence:100,power:278.1,Elevation:1781,personnel:0},"89298d98c03ffff":{confidence:26.333333333333332,power:37.26666666666667,Elevation:1479,personnel:.5672354768631239},"89298d98e83ffff":{confidence:19.666666666666668,power:17.766666666666666,Elevation:1666,personnel:0},"89298d98d5bffff":{confidence:74.66666666666667,power:45.93333333333334,Elevation:1479,personnel:0},"89298d98c6fffff":{confidence:97.8,power:182.34,Elevation:1666,personnel:0},"89298d98e33ffff":{confidence:98.66666666666667,power:140.35,Elevation:1666,personnel:0},"89298d98803ffff":{confidence:18,power:21.766666666666666,Elevation:1479,personnel:0},"89298d98a97ffff":{confidence:79,power:106.48333333333333,Elevation:1666,personnel:0},"89298d98ad3ffff":{confidence:100,power:169.06666666666666,Elevation:1666,personnel:0},"89298d98a0bffff":{confidence:100,power:465.2,Elevation:1684,personnel:0},"89298d92a53ffff":{confidence:100,power:67.66666666666667,Elevation:1354,personnel:0},"89298d9aaafffff":{confidence:40,power:44.2,Elevation:1504,personnel:0},"89298d98cd7ffff":{confidence:100,power:558.75,Elevation:1781,personnel:0},"89298d9133bffff":{confidence:100,power:87.95,Elevation:1376,personnel:0},"89298d9a88bffff":{confidence:100,power:167.75,Elevation:1504,personnel:0},"89298d9aa77ffff":{confidence:78,power:19.35,Elevation:1504,personnel:0},"89298d98c6bffff":{confidence:82.5,power:91.8,Elevation:1666,personnel:0},"89298d98893ffff":{confidence:83.5,power:25.95,Elevation:1479,personnel:0},"89298d98a03ffff":{confidence:100,power:465.05,Elevation:1684,personnel:0},"89298d90523ffff":{confidence:100,power:77.6,Elevation:1354,personnel:0},"89298d91ecbffff":{confidence:100,power:104.2,Elevation:1376,personnel:0},"89298d9adafffff":{confidence:53.75,power:22.849999999999998,Elevation:1376,personnel:0},"89298d98c0bffff":{confidence:52.5,power:17.9,Elevation:1666,personnel:0},"89298d98a53ffff":{confidence:100,power:396.4,Elevation:1684,personnel:0},"89298d9998bffff":{confidence:100,power:42.2,Elevation:1779,personnel:0},"89298d9a81bffff":{confidence:100,power:253.61999999999998,Elevation:1504,personnel:0},"89298d9aa4fffff":{confidence:100,power:429.625,Elevation:1781,personnel:0},"89298d98137ffff":{confidence:100,power:1070.3,Elevation:1666,personnel:0},"89298d98cabffff":{confidence:84.5,power:116.65,Elevation:1479,personnel:0},"89298d98e8fffff":{confidence:100,power:441.4,Elevation:1666,personnel:0},"89298d99d0bffff":{confidence:16,power:43.3,Elevation:1817,personnel:0},"89298d9aa73ffff":{confidence:100,power:152.75,Elevation:1781,personnel:0},"89298d9aa87ffff":{confidence:98,power:64,Elevation:1504,personnel:0},"89298d9ad33ffff":{confidence:41,power:53.43333333333334,Elevation:1376,personnel:0},"89298d98a23ffff":{confidence:62.333333333333336,power:68.60000000000001,Elevation:1684,personnel:0},"89298d98acbffff":{confidence:100,power:181.5,Elevation:1684,personnel:0},"89298d998b3ffff":{confidence:20,power:133.85,Elevation:1779,personnel:0},"89298d98a1bffff":{confidence:98.66666666666667,power:137.29999999999998,Elevation:1684,personnel:0},"89298d99d43ffff":{confidence:77,power:113.56666666666666,Elevation:1817,personnel:0},"89298d98b87ffff":{confidence:38,power:31.049999999999997,Elevation:1555,personnel:0},"89298d929dbffff":{confidence:9,power:53,Elevation:1156,personnel:0},"89298d92a37ffff":{confidence:88,power:97.25,Elevation:1069,personnel:0},"89298d98dabffff":{confidence:47,power:68.8,Elevation:1479,personnel:0},"89298d83607ffff":{confidence:77,power:110.6,Elevation:1359,personnel:0},"89298d98d43ffff":{confidence:86,power:123.85,Elevation:1479,personnel:0},"89298d98d0fffff":{confidence:26,power:61.9,Elevation:1479,personnel:0},"89298d9283bffff":{confidence:95,power:72.65,Elevation:1156,personnel:0},"89298d92b9bffff":{confidence:56,power:24,Elevation:1069,personnel:0},"89298d8369bffff":{confidence:91,power:46.349999999999994,Elevation:1317,personnel:0},"89298d92d6fffff":{confidence:74,power:171,Elevation:1156,personnel:0},"89298d92a77ffff":{confidence:83,power:389.6,Elevation:1261,personnel:0},"89298d90c03ffff":{confidence:55,power:162.5,Elevation:1261,personnel:0},"89298d8344fffff":{confidence:94,power:534.6,Elevation:1317,personnel:0},"89298d98d13ffff":{confidence:64.83333333333333,power:660.1500000000001,Elevation:1479,personnel:0},"89298d989dbffff":{confidence:78,power:199,Elevation:1479,personnel:0},"89298d92823ffff":{confidence:77,power:22.866666666666664,Elevation:1156,personnel:0},"89298d98aa7ffff":{confidence:99,power:32.96666666666667,Elevation:1684,personnel:0},"89298d98d4fffff":{confidence:20,power:15.5,Elevation:1479,personnel:0},"89298d98a63ffff":{confidence:100,power:80.3,Elevation:1684,personnel:0},"89298d9282bffff":{confidence:100,power:26,Elevation:1156,personnel:0},"89298d98aafffff":{confidence:44,power:121.7,Elevation:1684,personnel:0},"89298d928a7ffff":{confidence:45,power:7.6,Elevation:1156,personnel:0},"89298d98ab7ffff":{confidence:83.66666666666667,power:74.39999999999999,Elevation:1684,personnel:0},"89298d98a6bffff":{confidence:100,power:110.3,Elevation:1684,personnel:0},"89298d999afffff":{confidence:87,power:129.86666666666667,Elevation:1684,personnel:0},"89298d98a77ffff":{confidence:51,power:103.86666666666667,Elevation:1684,personnel:0},"89298d9a033ffff":{confidence:86,power:430.59999999999997,Elevation:1922,personnel:0},"89298d9a287ffff":{confidence:0,power:116.7,Elevation:1922,personnel:0},"89298d8011bffff":{confidence:87,power:47.75,Elevation:1491,personnel:0},"89298d90e93ffff":{confidence:100,power:229.6,Elevation:1261,personnel:0},"89298d91dd7ffff":{confidence:95,power:117.05000000000001,Elevation:1254,personnel:0},"89298d90113ffff":{confidence:100,power:137.55,Elevation:1261,personnel:0},"89298d90e9bffff":{confidence:73,power:135.4,Elevation:1261,personnel:0},"89298d92847ffff":{confidence:88.33333333333333,power:71.4,Elevation:1156,personnel:0},"89298d92a13ffff":{confidence:82.5,power:92.85,Elevation:1354,personnel:0},"89298d91ca7ffff":{confidence:94,power:361.70000000000005,Elevation:1254,personnel:0},"89298d9a973ffff":{confidence:99,power:644.75,Elevation:1317,personnel:0},"89298d91dc7ffff":{confidence:45,power:204.2,Elevation:1254,personnel:0},"89298d92a17ffff":{confidence:68.33333333333333,power:30.799999999999997,Elevation:1156,personnel:0},"89298d90117ffff":{confidence:100,power:67.16,Elevation:1261,personnel:0},"89298d92acfffff":{confidence:100,power:55.3,Elevation:1354,personnel:0},"89298d92843ffff":{confidence:85,power:109.4,Elevation:1156,personnel:0},"89298d928c3ffff":{confidence:62.5,power:18.25,Elevation:1156,personnel:0},"89298d92a4bffff":{confidence:94,power:57.85,Elevation:1261,personnel:0},"89298d92807ffff":{confidence:95.5,power:62.6,Elevation:1156,personnel:0},"89298d92a87ffff":{confidence:73,power:16.3,Elevation:1156,personnel:0},"89298d9a817ffff":{confidence:100,power:846.1,Elevation:1504,personnel:0},"89298d90073ffff":{confidence:40.5,power:159.8,Elevation:1388,personnel:0},"89298d91127ffff":{confidence:68,power:39.733333333333334,Elevation:1376,personnel:0},"89298d9ad8bffff":{confidence:95,power:56.75,Elevation:1376,personnel:0},"89298d900a3ffff":{confidence:88,power:57.64,Elevation:1261,personnel:0},"89298d81c6fffff":{confidence:99,power:101.6,Elevation:1625,personnel:0},"89298d8ad93ffff":{confidence:93,power:65.8,Elevation:1882,personnel:0},"89298d81e3bffff":{confidence:90.5,power:59.5,Elevation:1882,personnel:0},"89298d818cfffff":{confidence:93,power:67.85,Elevation:1794,personnel:0},"89298d8ad83ffff":{confidence:99.5,power:88.32499999999999,Elevation:1882,personnel:0},"89298d8185bffff":{confidence:38,power:19,Elevation:1794,personnel:0},"89298d8742bffff":{confidence:100,power:404.15,Elevation:1323,personnel:0},"89298d87553ffff":{confidence:95,power:86.375,Elevation:1431,personnel:0},"89298d87507ffff":{confidence:40,power:27.6,Elevation:1431,personnel:0},"89298d8719bffff":{confidence:94,power:72.5,Elevation:1431,personnel:0},"89298d870b3ffff":{confidence:40.5,power:194.75,Elevation:1431,personnel:0},"89298d87543ffff":{confidence:20.5,power:16.6,Elevation:1431,personnel:0},"89298d8754fffff":{confidence:21,power:16.6,Elevation:1431,personnel:0},"89298d87193ffff":{confidence:100,power:49.53333333333333,Elevation:1431,personnel:0},"89298d8703bffff":{confidence:96,power:32.9,Elevation:1419,personnel:0},"89298d8752bffff":{confidence:100,power:107.175,Elevation:1431,personnel:0},"89298d87067ffff":{confidence:56.5,power:25.8,Elevation:1419,personnel:0},"89298d87313ffff":{confidence:82,power:60.650000000000006,Elevation:1419,personnel:0},"89298d85683ffff":{confidence:16,power:14.7,Elevation:1741,personnel:0},"89298d8757bffff":{confidence:100,power:72.95,Elevation:1431,personnel:0},"89298d871dbffff":{confidence:100,power:91.2,Elevation:1431,personnel:0},"89298d87087ffff":{confidence:71.33333333333333,power:135.01666666666668,Elevation:1419,personnel:0},"89298d870b7ffff":{confidence:100,power:408.9,Elevation:1431,personnel:0},"89298d87077ffff":{confidence:92,power:162.9,Elevation:1419,personnel:0},"89298d87093ffff":{confidence:94,power:52.1,Elevation:1419,personnel:0},"89298d87383ffff":{confidence:53,power:43.4,Elevation:1419,personnel:0},"89298d80937ffff":{confidence:83,power:37.9,Elevation:1741,personnel:0},"89298d871cbffff":{confidence:92.5,power:77.9,Elevation:1431,personnel:0},"89298d8708fffff":{confidence:82,power:49.15,Elevation:1419,personnel:0},"89298d8a9c7ffff":{confidence:80,power:38.8,Elevation:1882,personnel:0},"89298d8a91bffff":{confidence:44.25,power:33.3,Elevation:1882,personnel:0},"89298d81ebbffff":{confidence:100,power:107.5,Elevation:1654,personnel:0},"89298d8ad03ffff":{confidence:53,power:28.8,Elevation:1882,personnel:0},"89298d81ad3ffff":{confidence:48,power:60.7,Elevation:1882,personnel:0},"89298d8a99bffff":{confidence:91,power:47.05,Elevation:1882,personnel:0},"89298d81e4fffff":{confidence:94.5,power:58.25,Elevation:1882,personnel:0},"89298d8a903ffff":{confidence:90,power:46.150000000000006,Elevation:2062,personnel:0},"89298d8121bffff":{confidence:72.5,power:32.75,Elevation:1734,personnel:0},"89298d81203ffff":{confidence:100,power:38.76666666666667,Elevation:1734,personnel:0},"89298d8129bffff":{confidence:53,power:20.666666666666668,Elevation:1734,personnel:0},"89298d81253ffff":{confidence:100,power:43.85,Elevation:1734,personnel:0},"89298d8a1a3ffff":{confidence:100,power:79.15,Elevation:1734,personnel:0},"89298d8a577ffff":{confidence:96,power:71,Elevation:1734,personnel:0},"89298d8a56fffff":{confidence:98.33333333333333,power:68.8,Elevation:1734,personnel:0},"89298d876b7ffff":{confidence:60.5,power:14.649999999999999,Elevation:1419,personnel:0},"89298d80e6fffff":{confidence:55,power:35.9,Elevation:1694,personnel:0},"89298d80a97ffff":{confidence:86.5,power:43,Elevation:1694,personnel:0},"89298d80acfffff":{confidence:100,power:562.55,Elevation:1811,personnel:0},"89298d80aabffff":{confidence:100,power:194.6,Elevation:1811,personnel:0},"89298d8e48fffff":{confidence:100,power:153.1,Elevation:1811,personnel:0},"89298d81db3ffff":{confidence:37.333333333333336,power:20.666666666666668,Elevation:1694,personnel:0},"89298d80a8fffff":{confidence:46,power:18.866666666666667,Elevation:1811,personnel:0},"89298d8e497ffff":{confidence:37,power:22.266666666666666,Elevation:1811,personnel:0},"89298d81dafffff":{confidence:100,power:41.2,Elevation:1694,personnel:0},"89298d8e453ffff":{confidence:16,power:18.3,Elevation:1811,personnel:0},"89298d8e6b7ffff":{confidence:27,power:21.95,Elevation:1882,personnel:0},"89298d81983ffff":{confidence:100,power:164.5,Elevation:1811,personnel:0},"89298d80a43ffff":{confidence:100,power:1075.75,Elevation:1811,personnel:0},"89298d8e4cbffff":{confidence:17.333333333333332,power:46.9,Elevation:1811,personnel:0},"89298d8001bffff":{confidence:60,power:16.5,Elevation:1457,personnel:0},"89298d81377ffff":{confidence:42,power:14.2,Elevation:1654,personnel:0},"89298d98dc7ffff":{confidence:94,power:197.75,Elevation:1479,personnel:0},"89298d99997ffff":{confidence:100,power:146.10000000000002,Elevation:1684,personnel:0},"89298d99987ffff":{confidence:100,power:146.5,Elevation:1684,personnel:0},"89298d901b7ffff":{confidence:63,power:15.5,Elevation:1261,personnel:0},"89298d98e3bffff":{confidence:100,power:208.6,Elevation:1666,personnel:0},"89298d9884fffff":{confidence:92,power:26.75,Elevation:1684,personnel:0},"89298d999b3ffff":{confidence:100,power:383,Elevation:1684,personnel:0},"89298d92a83ffff":{confidence:100,power:27.6,Elevation:1156,personnel:0},"89298d9038fffff":{confidence:57,power:15.4,Elevation:1388,personnel:0},"89298d988cbffff":{confidence:100,power:254.05,Elevation:1666,personnel:0},"89298d98a9bffff":{confidence:100,power:92.1,Elevation:1666,personnel:0},"89298d98e73ffff":{confidence:100,power:1295.4,Elevation:1666,personnel:0},"89298d98e67ffff":{confidence:100,power:1140.85,Elevation:1666,personnel:0},"89298d98acfffff":{confidence:100,power:310.75,Elevation:1684,personnel:0},"89298d98dcbffff":{confidence:97,power:67.25,Elevation:1479,personnel:0},"89298d98e2fffff":{confidence:100,power:460.6,Elevation:1666,personnel:0},"89298d9ad27ffff":{confidence:62,power:34.266666666666666,Elevation:1317,personnel:0},"89298d98adbffff":{confidence:100,power:182.35,Elevation:1666,personnel:0},"89298d99d67ffff":{confidence:100,power:89.5,Elevation:1779,personnel:0},"89298d98a4fffff":{confidence:100,power:108.10000000000001,Elevation:1684,personnel:0},"89298d92a8fffff":{confidence:54.333333333333336,power:31.7,Elevation:1156,personnel:0},"89298d98a87ffff":{confidence:100,power:125.7,Elevation:1684,personnel:0},"89298d9881bffff":{confidence:79.33333333333333,power:57.43333333333334,Elevation:1666,personnel:0},"89298d999b7ffff":{confidence:51.5,power:52.900000000000006,Elevation:1684,personnel:0},"89298d91a5bffff":{confidence:28,power:142.9,Elevation:1317,personnel:0},"89298d9022fffff":{confidence:100,power:154.4,Elevation:1388,personnel:0},"89298d92a93ffff":{confidence:43.333333333333336,power:49.6,Elevation:1156,personnel:0},"89298d90303ffff":{confidence:100,power:119,Elevation:1388,personnel:0},"89298d91e97ffff":{confidence:45.5,power:26.200000000000003,Elevation:1376,personnel:0},"89298d91c73ffff":{confidence:100,power:732.75,Elevation:1254,personnel:0},"89298d918d3ffff":{confidence:73,power:32.85,Elevation:1254,personnel:0},"89298d9ad03ffff":{confidence:29.5,power:40.9,Elevation:1376,personnel:0},"89298d9ad67ffff":{confidence:61,power:47.25,Elevation:1317,personnel:0},"89298d901dbffff":{confidence:94.5,power:405.79999999999995,Elevation:1261,personnel:0},"89298d9038bffff":{confidence:46,power:31.53333333333333,Elevation:1388,personnel:0},"89298d91eb3ffff":{confidence:98.33333333333333,power:43.833333333333336,Elevation:1376,personnel:0},"89298d91acbffff":{confidence:46.333333333333336,power:26.53333333333333,Elevation:1376,personnel:0},"89298d92ad3ffff":{confidence:58,power:18.7,Elevation:1354,personnel:0},"89298d91e03ffff":{confidence:25,power:20.9,Elevation:1376,personnel:.004055144158407464},"89298d92e63ffff":{confidence:77,power:73.15,Elevation:1354,personnel:0},"89298d900abffff":{confidence:100,power:349.1,Elevation:1388,personnel:0},"89298d92e3bffff":{confidence:95,power:63.099999999999994,Elevation:1156,personnel:0},"89298d90077ffff":{confidence:100,power:897.2,Elevation:1388,personnel:0},"89298d90383ffff":{confidence:38.5,power:13.4,Elevation:1388,personnel:0},"89298d91e87ffff":{confidence:41.6,power:55.620000000000005,Elevation:1376,personnel:0},"89298d90563ffff":{confidence:93.5,power:55.1,Elevation:1354,personnel:0},"89298d9018bffff":{confidence:100,power:108.25,Elevation:1261,personnel:0},"89298d901cbffff":{confidence:98,power:77.6,Elevation:1261,personnel:0},"89298d90193ffff":{confidence:59,power:50.63333333333333,Elevation:1261,personnel:0},"89298d99d83ffff":{confidence:71,power:121.45,Elevation:1666,personnel:0},"89298d998abffff":{confidence:71,power:65.2,Elevation:1779,personnel:0},"89298d98e57ffff":{confidence:98,power:77.65,Elevation:1666,personnel:0},"89298d99827ffff":{confidence:26,power:31.3,Elevation:1779,personnel:0},"89298d99957ffff":{confidence:39.666666666666664,power:30.066666666666666,Elevation:1779,personnel:0},"89298d99d8bffff":{confidence:92.66666666666667,power:197.66666666666666,Elevation:1817,personnel:0},"89298d99d7bffff":{confidence:52,power:110.8,Elevation:1779,personnel:0},"89298d98e13ffff":{confidence:90,power:78.6,Elevation:1666,personnel:0},"89298d999c7ffff":{confidence:66.5,power:31.6,Elevation:1779,personnel:0},"89298d9ae2fffff":{confidence:100,power:174.8,Elevation:1504,personnel:0},"89298d985abffff":{confidence:59.5,power:77.15,Elevation:1781,personnel:0},"89298d9aa5bffff":{confidence:69.5,power:30.05,Elevation:1781,personnel:0},"89298d9aacfffff":{confidence:100,power:1068.3999999999999,Elevation:1781,personnel:0},"89298d98533ffff":{confidence:100,power:1932,Elevation:1781,personnel:0},"89298d98187ffff":{confidence:14.333333333333334,power:24.666666666666668,Elevation:1781,personnel:0},"89298d9aa83ffff":{confidence:100,power:102.3,Elevation:1504,personnel:0},"89298d9aac7ffff":{confidence:100,power:32.65,Elevation:1781,personnel:0},"89298d9ac77ffff":{confidence:66.5,power:359.6,Elevation:1594,personnel:0},"89298d90637ffff":{confidence:63,power:83.7,Elevation:1466,personnel:0},"89298d9aeb7ffff":{confidence:65.8,power:211.9,Elevation:1594,personnel:0},"89298d9aa9bffff":{confidence:93,power:144.53333333333333,Elevation:1504,personnel:0},"89298d981bbffff":{confidence:100,power:551.6333333333333,Elevation:1781,personnel:0},"89298d985a3ffff":{confidence:93,power:371.20000000000005,Elevation:1781,personnel:0},"89298d98577ffff":{confidence:100,power:1297.4,Elevation:1781,personnel:0},"89298d9856bffff":{confidence:84,power:102.7,Elevation:1781,personnel:0},"89298d98e93ffff":{confidence:100,power:885.8,Elevation:1666,personnel:0},"89298d981b3ffff":{confidence:100,power:422.8,Elevation:1781,personnel:0},"89298d9ae67ffff":{confidence:100,power:114.76666666666667,Elevation:1504,personnel:0},"89298d9aa03ffff":{confidence:90.16666666666667,power:66.64999999999999,Elevation:1504,personnel:0},"89298d9814bffff":{confidence:73.33333333333333,power:54.86666666666667,Elevation:1666,personnel:0},"89298d98e97ffff":{confidence:100,power:152.73333333333335,Elevation:1666,personnel:0},"89298d983afffff":{confidence:100,power:217.9,Elevation:1666,personnel:0},"89298d98193ffff":{confidence:97.33333333333333,power:71.5,Elevation:1781,personnel:0},"89298d98027ffff":{confidence:13.666666666666666,power:97.33333333333333,Elevation:1781,personnel:0},"89298d98143ffff":{confidence:51,power:139.03333333333333,Elevation:1781,personnel:0},"89298d983abffff":{confidence:65.75,power:122.775,Elevation:1666,personnel:0},"89298d9852fffff":{confidence:100,power:186.5,Elevation:1781,personnel:0},"89298d983b3ffff":{confidence:99,power:153,Elevation:1666,personnel:0},"89298d9812bffff":{confidence:96,power:126.86666666666667,Elevation:1666,personnel:0},"89298d98343ffff":{confidence:91,power:133.7,Elevation:1817,personnel:0},"89298d8184bffff":{confidence:38,power:87.65,Elevation:1794,personnel:0},"89298d8a987ffff":{confidence:30,power:72.6,Elevation:1882,personnel:0},"89298d8a9b3ffff":{confidence:3.5,power:63,Elevation:1882,personnel:0},"89298d81a8bffff":{confidence:58,power:30.9,Elevation:1882,personnel:0},"89298d80327ffff":{confidence:79,power:20.4,Elevation:1694,personnel:0},"89298d80307ffff":{confidence:91.5,power:45.8,Elevation:1694,personnel:0},"89298d81857ffff":{confidence:88,power:43.25,Elevation:1794,personnel:0},"89298d8184fffff":{confidence:67,power:66.65,Elevation:1794,personnel:0},"89298d8a917ffff":{confidence:28.333333333333332,power:33.86666666666667,Elevation:1882,personnel:0},"89298d8a90fffff":{confidence:34,power:36.166666666666664,Elevation:2062,personnel:0},"89298d81b13ffff":{confidence:64,power:152.16666666666666,Elevation:1794,personnel:0},"89298d9ae97ffff":{confidence:100,power:793.8666666666667,Elevation:1594,personnel:0},"89298d9ae5bffff":{confidence:45,power:12.1,Elevation:1922,personnel:0},"89298d9ae93ffff":{confidence:56,power:50.9,Elevation:1594,personnel:0},"89298d8567bffff":{confidence:42,power:28.133333333333336,Elevation:1741,personnel:0},"89298d8e0b7ffff":{confidence:57,power:28.4,Elevation:1882,personnel:0},"89298d8e0a7ffff":{confidence:57,power:28.4,Elevation:1882,personnel:0},"89298d8e5dbffff":{confidence:62.25,power:56.3,Elevation:1811,personnel:0},"89298d8e58bffff":{confidence:44,power:25.75,Elevation:1741,personnel:0},"89298d8e3d3ffff":{confidence:55,power:16.7,Elevation:1882,personnel:0},"89298d8566fffff":{confidence:23,power:13.7,Elevation:1802,personnel:0},"89298d8e50bffff":{confidence:67.5,power:32.5,Elevation:1802,personnel:0},"89298d8e517ffff":{confidence:79.5,power:187.1,Elevation:1802,personnel:0},"89298d8e5a3ffff":{confidence:86,power:153.5,Elevation:1802,personnel:0},"89298d8e083ffff":{confidence:54.666666666666664,power:61.93333333333333,Elevation:1882,personnel:0},"89298d8e0b3ffff":{confidence:60,power:90.35,Elevation:1882,personnel:0},"89298d8e587ffff":{confidence:100,power:129.45,Elevation:1741,personnel:0},"89298d8e5c3ffff":{confidence:99,power:85,Elevation:1811,personnel:0},"89298d852d3ffff":{confidence:100,power:119.45,Elevation:1802,personnel:0},"89298d8e573ffff":{confidence:100,power:281.1,Elevation:1802,personnel:0},"89298d8e087ffff":{confidence:100,power:194.35000000000002,Elevation:1882,personnel:0},"89298d8e0afffff":{confidence:96,power:69.7,Elevation:1882,personnel:0},"89298d8e04fffff":{confidence:73,power:19.1,Elevation:1882,personnel:0},"89298d8e533ffff":{confidence:100,power:216.85000000000002,Elevation:1802,personnel:0},"89298d8e56fffff":{confidence:99,power:89.05000000000001,Elevation:1802,personnel:0},"89298d8e523ffff":{confidence:17.666666666666668,power:49.79999999999999,Elevation:1802,personnel:0},"89298d8e1cbffff":{confidence:41,power:39.3,Elevation:1882,personnel:0},"89298d8e153ffff":{confidence:41,power:39.3,Elevation:1882,personnel:0},"89298d9ae0fffff":{confidence:100,power:305.8,Elevation:1594,personnel:0},"89298d9027bffff":{confidence:100,power:171.75,Elevation:1388,personnel:0},"89298d9ac27ffff":{confidence:100,power:506.675,Elevation:1594,personnel:0},"89298d90053ffff":{confidence:89,power:41.2,Elevation:1388,personnel:0},"89298d9022bffff":{confidence:90,power:47.75,Elevation:1388,personnel:0},"89298d911bbffff":{confidence:95,power:64.05,Elevation:1485,personnel:0},"89298d91e9bffff":{confidence:100,power:195.6,Elevation:1376,personnel:0},"89298d9ac33ffff":{confidence:100,power:167,Elevation:1594,personnel:0},"89298d9ac4fffff":{confidence:98,power:73.7,Elevation:1594,personnel:0},"89298d9ae73ffff":{confidence:78,power:51,Elevation:1781,personnel:0},"89298d9ae63ffff":{confidence:59,power:154.13333333333333,Elevation:1781,personnel:0},"89298d915a7ffff":{confidence:8,power:70.8,Elevation:1485,personnel:0},"89298d9007bffff":{confidence:29,power:73.95,Elevation:1388,personnel:0},"89298d90507ffff":{confidence:22,power:28.65,Elevation:1354,personnel:0},"89298d902d7ffff":{confidence:82,power:69.10000000000001,Elevation:1388,personnel:0},"89298d91193ffff":{confidence:68,power:49.13333333333333,Elevation:1485,personnel:0},"89298d9020bffff":{confidence:88,power:72.26666666666667,Elevation:1388,personnel:0},"89298d9ac83ffff":{confidence:100,power:222.20000000000002,Elevation:1594,personnel:0},"89298d9ae07ffff":{confidence:94,power:1802.0999999999997,Elevation:1594,personnel:0},"89298d871a3ffff":{confidence:93,power:23.7,Elevation:1431,personnel:0},"89298d873a3ffff":{confidence:100,power:275.6,Elevation:1431,personnel:0},"89298d8716fffff":{confidence:100,power:56.35,Elevation:1530,personnel:0},"89298d87197ffff":{confidence:100,power:506.25,Elevation:1431,personnel:0},"89298d87133ffff":{confidence:96,power:211.95,Elevation:1431,personnel:0},"89298d8738fffff":{confidence:74.33333333333333,power:42.266666666666666,Elevation:1419,personnel:0},"89298d866abffff":{confidence:89.2,power:76.5,Elevation:1300,personnel:0},"89298d866afffff":{confidence:51,power:58.3,Elevation:1300,personnel:0},"89298d86667ffff":{confidence:17,power:75.45,Elevation:1366,personnel:0},"89298d8664fffff":{confidence:89,power:111.55,Elevation:1366,personnel:0},"89298d8667bffff":{confidence:73,power:36.4,Elevation:1366,personnel:0},"89298d8660fffff":{confidence:34,power:174.3,Elevation:1366,personnel:0},"89298d86647ffff":{confidence:100,power:39.05,Elevation:1366,personnel:0},"89298d86253ffff":{confidence:75,power:16.4,Elevation:1431,personnel:0},"89298d86283ffff":{confidence:100,power:70.775,Elevation:1389,personnel:0},"89298d8661bffff":{confidence:100,power:368.6,Elevation:1366,personnel:0},"89298d875a7ffff":{confidence:100,power:295.35,Elevation:1431,personnel:0},"89298d862d3ffff":{confidence:77,power:278.98,Elevation:1431,personnel:0},"89298d862b7ffff":{confidence:100,power:1509.6999999999998,Elevation:1389,personnel:0},"89298d8607bffff":{confidence:100,power:1231.5500000000002,Elevation:1389,personnel:0},"89298d86243ffff":{confidence:83.5,power:169.25,Elevation:1431,personnel:0},"89298d86613ffff":{confidence:90.5,power:36.85,Elevation:1366,personnel:0},"89298d86677ffff":{confidence:100,power:213.9,Elevation:1366,personnel:0},"89298d86043ffff":{confidence:100,power:379.3,Elevation:1389,personnel:0},"89298d86637ffff":{confidence:100,power:516.2,Elevation:1300,personnel:0},"89298d86287ffff":{confidence:32.5,power:45.85,Elevation:1389,personnel:0},"89298d86233ffff":{confidence:90,power:94.26666666666667,Elevation:1389,personnel:0},"89298d874cfffff":{confidence:81,power:19.700000000000003,Elevation:1323,personnel:0},"89298d87417ffff":{confidence:81,power:23,Elevation:1323,personnel:0},"89298d8e417ffff":{confidence:25,power:206.2,Elevation:1811,personnel:0},"89298d80ec7ffff":{confidence:43,power:26.833333333333332,Elevation:1694,personnel:0},"89298d80acbffff":{confidence:99.25,power:198.1,Elevation:1811,personnel:0},"89298d80a07ffff":{confidence:96,power:34.8,Elevation:1811,personnel:0},"89298d8e4afffff":{confidence:93.66666666666667,power:34.13333333333333,Elevation:1811,personnel:0},"89298d8e40bffff":{confidence:100,power:43.349999999999994,Elevation:1811,personnel:0},"89298d80a4fffff":{confidence:100,power:55.6,Elevation:1811,personnel:0},"89298d8e447ffff":{confidence:100,power:43.7,Elevation:1811,personnel:0},"89298d80e1bffff":{confidence:71,power:18.1,Elevation:1694,personnel:0},"89298d80adbffff":{confidence:100,power:40.6,Elevation:1694,personnel:0},"89298d80a13ffff":{confidence:51,power:87.2,Elevation:1811,personnel:0},"89298d80a63ffff":{confidence:94,power:189.4,Elevation:1811,personnel:0},"89298d8e4cfffff":{confidence:24.5,power:43.75,Elevation:1811,personnel:0},"89298d8084bffff":{confidence:58,power:21,Elevation:1694,personnel:0},"89298d80a8bffff":{confidence:97.5,power:65.75,Elevation:1811,personnel:0},"89298d80a0fffff":{confidence:100,power:275.55,Elevation:1811,personnel:0},"89298d8e493ffff":{confidence:100,power:190.55,Elevation:1811,personnel:0},"89298d8e4bbffff":{confidence:100,power:126.75,Elevation:1811,personnel:0},"89298d80e17ffff":{confidence:83.5,power:29.6,Elevation:1694,personnel:0},"89298d81dbbffff":{confidence:89.5,power:51,Elevation:1694,personnel:0},"89298d80b6bffff":{confidence:64.5,power:41.15,Elevation:1811,personnel:0},"89298d819abffff":{confidence:45.5,power:79.375,Elevation:1811,personnel:0},"89298d81917ffff":{confidence:98,power:152.1,Elevation:1811,personnel:0},"89298d8640fffff":{confidence:100,power:421.2,Elevation:1300,personnel:0},"89298d87013ffff":{confidence:16,power:34.9,Elevation:1419,personnel:0},"89298d8e513ffff":{confidence:91.6,power:56.9,Elevation:1802,personnel:0},"89298d8710bffff":{confidence:96.33333333333333,power:40.333333333333336,Elevation:1431,personnel:0},"89298d87173ffff":{confidence:26,power:17,Elevation:1431,personnel:0},"89298d8e5b3ffff":{confidence:64,power:26.15,Elevation:1741,personnel:0},"89298d8e55bffff":{confidence:71.2,power:30.119999999999997,Elevation:1882,personnel:0},"89298d8e0a3ffff":{confidence:48,power:34.849999999999994,Elevation:1882,personnel:0},"89298d80b2bffff":{confidence:60,power:25.75,Elevation:1741,personnel:0},"89298d866b3ffff":{confidence:99,power:77.75,Elevation:1300,personnel:0},"8928364b2d7ffff":{confidence:78,power:23.53333333333333,Elevation:725,personnel:0},"89298d91ec3ffff":{confidence:100,power:438.8,Elevation:1376,personnel:0},"89298d988cfffff":{confidence:100,power:369.20000000000005,Elevation:1666,personnel:0},"89298d81257ffff":{confidence:52.666666666666664,power:48.5,Elevation:1734,personnel:0},"89298d81653ffff":{confidence:24,power:30.8,Elevation:1555,personnel:0},"89298d9004fffff":{confidence:96,power:131.70000000000002,Elevation:1388,personnel:0},"89298d98037ffff":{confidence:100,power:514.2,Elevation:1781,personnel:0},"89298d86483ffff":{confidence:89,power:121.1,Elevation:1300,personnel:0},"89298d902b7ffff":{confidence:100,power:152.84,Elevation:1388,personnel:0},"89298d98ba3ffff":{confidence:16,power:59.349999999999994,Elevation:1555,personnel:0},"89298d90c0bffff":{confidence:30,power:197.3,Elevation:1261,personnel:0},"89298d989d7ffff":{confidence:79,power:212.4,Elevation:1479,personnel:0},"89298d989cfffff":{confidence:32.333333333333336,power:17.5,Elevation:1555,personnel:0},"89298d8a537ffff":{confidence:43,power:215.92,Elevation:1734,personnel:0},"89298d98b3bffff":{confidence:48,power:15.4,Elevation:1555,personnel:0},"89298d98857ffff":{confidence:100,power:558.85,Elevation:1666,personnel:0},"89298d870bbffff":{confidence:60.666666666666664,power:24.96666666666667,Elevation:1419,personnel:0},"8928364b14fffff":{confidence:92.33333333333333,power:210.86666666666667,Elevation:636,personnel:0},"8928364b237ffff":{confidence:91.33333333333333,power:194.66666666666666,Elevation:702,personnel:0},"89298d801afffff":{confidence:53,power:28.45,Elevation:1491,personnel:0},"89298d8e563ffff":{confidence:48.333333333333336,power:49.23333333333333,Elevation:1802,personnel:0},"89298d8753bffff":{confidence:92.5,power:107.1,Elevation:1431,personnel:0},"89298d87523ffff":{confidence:62.5,power:91.6,Elevation:1431,personnel:0},"89298d8624bffff":{confidence:100,power:128.65,Elevation:1431,personnel:0},"89298d91cd7ffff":{confidence:100,power:534.05,Elevation:1388,personnel:0},"89298d90357ffff":{confidence:89,power:453,Elevation:1388,personnel:0},"89298d91c97ffff":{confidence:84,power:24.3,Elevation:1388,personnel:0},"89298d86433ffff":{confidence:96,power:55.93333333333333,Elevation:1300,personnel:0},"89298d9284fffff":{confidence:92,power:109.4,Elevation:1156,personnel:0},"89298d9ab23ffff":{confidence:100,power:389.05,Elevation:1479,personnel:0},"89298d92acbffff":{confidence:41.5,power:22.95,Elevation:1354,personnel:0},"89298d9014fffff":{confidence:100,power:246.9,Elevation:1261,personnel:0},"89298d9035bffff":{confidence:65,power:41.05,Elevation:1388,personnel:0},"89298d91e2bffff":{confidence:100,power:217.95,Elevation:1376,personnel:0},"89298d9ab93ffff":{confidence:99,power:87.3,Elevation:1504,personnel:0},"89298d9034bffff":{confidence:100,power:1009.4000000000001,Elevation:1388,personnel:0},"89298d91c27ffff":{confidence:61.5,power:205.65,Elevation:1254,personnel:0},"89298d9a837ffff":{confidence:100,power:1135.35,Elevation:1504,personnel:0},"89298d90313ffff":{confidence:89,power:394.4,Elevation:1388,personnel:0},"89298d98c47ffff":{confidence:86,power:61.333333333333336,Elevation:1666,personnel:0},"89298d98ebbffff":{confidence:100,power:63.349999999999994,Elevation:1666,personnel:0},"89298d98c17ffff":{confidence:98,power:242.95,Elevation:1479,personnel:0},"89298d92ac3ffff":{confidence:89,power:40.3,Elevation:1354,personnel:0},"89298d98c43ffff":{confidence:100,power:647.7,Elevation:1666,personnel:0},"89298d9aa0fffff":{confidence:100,power:1677.25,Elevation:1504,personnel:0},"89298d9aa33ffff":{confidence:100,power:1755.1,Elevation:1504,personnel:0},"89298d9a80fffff":{confidence:100,power:424.79999999999995,Elevation:1504,personnel:0},"89298d9aa4bffff":{confidence:100,power:1169.35,Elevation:1781,personnel:0},"89298d9ac67ffff":{confidence:92,power:305.75,Elevation:1594,personnel:0},"89298d9ae37ffff":{confidence:86,power:40.35,Elevation:1504,personnel:0},"89298d9a853ffff":{confidence:100,power:1185.1,Elevation:1504,personnel:0},"89298d9a807ffff":{confidence:100,power:692.6,Elevation:1504,personnel:0},"89298d9aa27ffff":{confidence:100,power:465.45000000000005,Elevation:1504,personnel:0},"89298d9a83bffff":{confidence:100,power:4849.1,Elevation:1504,personnel:0},"89298d9aaabffff":{confidence:40,power:44.45,Elevation:1504,personnel:0},"89298d98133ffff":{confidence:100,power:720.24,Elevation:1781,personnel:0},"89298d98c4bffff":{confidence:69.33333333333333,power:65.9,Elevation:1666,personnel:0},"89298d9a8dbffff":{confidence:100,power:64.25,Elevation:1594,personnel:0},"89298d9a85bffff":{confidence:100,power:124.35,Elevation:1504,personnel:0},"89298d9aabbffff":{confidence:100,power:37.8,Elevation:1504,personnel:0},"89298d981afffff":{confidence:100,power:155.7,Elevation:1781,personnel:0},"89298d9002bffff":{confidence:100,power:44,Elevation:1388,personnel:0},"89298d98103ffff":{confidence:100,power:29.1,Elevation:1781,personnel:0},"89298d91137ffff":{confidence:91,power:152.3,Elevation:1485,personnel:0},"89298d91ccfffff":{confidence:86.5,power:113.25,Elevation:1254,personnel:0},"89298d913abffff":{confidence:56.5,power:78.94999999999999,Elevation:1376,personnel:0},"89298d9ad0fffff":{confidence:89,power:126.65,Elevation:1376,personnel:0},"89298d9aad7ffff":{confidence:89,power:187.15,Elevation:1781,personnel:0},"89298d98e8bffff":{confidence:100,power:695.8499999999999,Elevation:1666,personnel:0},"89298d9112bffff":{confidence:100,power:120.45,Elevation:1376,personnel:0},"89298d9a88fffff":{confidence:94,power:49.3,Elevation:1504,personnel:0},"89298d9a847ffff":{confidence:49.5,power:23.549999999999997,Elevation:1504,personnel:0},"89298d98113ffff":{confidence:64,power:21.7,Elevation:1781,personnel:0},"89298d9810fffff":{confidence:100,power:780.4,Elevation:1666,personnel:0},"89298d90257ffff":{confidence:20,power:58.93333333333334,Elevation:1388,personnel:0},"89298d91103ffff":{confidence:91,power:88.73333333333333,Elevation:1485,personnel:0},"89298d9294fffff":{confidence:51,power:64.35,Elevation:1069,personnel:0},"89298d98907ffff":{confidence:91.5,power:75.35,Elevation:1555,personnel:0},"89298d98bbbffff":{confidence:40.333333333333336,power:20.333333333333332,Elevation:1555,personnel:0},"89298d8160bffff":{confidence:27,power:16.8,Elevation:1555,personnel:0},"89298d8a587ffff":{confidence:56.333333333333336,power:21.399999999999995,Elevation:1555,personnel:0},"89298d9897bffff":{confidence:35.333333333333336,power:21.1,Elevation:1555,personnel:0},"89298d81673ffff":{confidence:27,power:16.8,Elevation:1555,personnel:0},"89298d81693ffff":{confidence:82,power:22.25,Elevation:1555,personnel:0},"89298d816d3ffff":{confidence:100,power:118.9,Elevation:1555,personnel:0},"89298d81657ffff":{confidence:97,power:69.25,Elevation:1555,personnel:0},"89298d98b07ffff":{confidence:95,power:56.2,Elevation:1555,personnel:0},"89298d98b2fffff":{confidence:97,power:70.6,Elevation:1555,personnel:0},"89298d98b97ffff":{confidence:39,power:31.5,Elevation:1555,personnel:0},"89298d928a3ffff":{confidence:77,power:202.9,Elevation:1156,personnel:0},"89298d87107ffff":{confidence:100,power:302.4,Elevation:1431,personnel:0},"89298d92aa7ffff":{confidence:48,power:20.4,Elevation:1156,personnel:0},"89298d864a3ffff":{confidence:74,power:75.75,Elevation:1300,personnel:0},"89298d8645bffff":{confidence:100,power:134.075,Elevation:1300,personnel:0},"89298d94dbbffff":{confidence:95,power:69.85,Elevation:814,personnel:0},"89298d94d23ffff":{confidence:71,power:32.43333333333333,Elevation:898,personnel:0},"8928364b077ffff":{confidence:68,power:148.4,Elevation:702,personnel:0},"89298d94d33ffff":{confidence:81,power:24.6,Elevation:898,personnel:0},"8928364b3cfffff":{confidence:94,power:22.3,Elevation:702,personnel:0},"8928364b353ffff":{confidence:40,power:36.25,Elevation:702,personnel:0},"8928364b07bffff":{confidence:70,power:26.2,Elevation:702,personnel:0},"89298d8641bffff":{confidence:85,power:24.1,Elevation:1300,personnel:0},"8928364b3d7ffff":{confidence:45,power:23.95,Elevation:702,personnel:0},"89298d94b7bffff":{confidence:95,power:57.95,Elevation:1300,personnel:0},"89298d864c7ffff":{confidence:59,power:24,Elevation:1300,personnel:0},"89298d94b6bffff":{confidence:71.33333333333333,power:33.63333333333333,Elevation:1300,personnel:0},"8928364b3cbffff":{confidence:93,power:224.0333333333333,Elevation:702,personnel:0},"89298d98a83ffff":{confidence:100,power:92.1,Elevation:1666,personnel:0},"89298d8a5afffff":{confidence:31,power:15.3,Elevation:1734,personnel:0},"89298d8a18bffff":{confidence:76.66666666666667,power:50.43333333333334,Elevation:1734,personnel:0},"89298d8a19bffff":{confidence:83,power:180,Elevation:1734,personnel:0},"89298d9888fffff":{confidence:75,power:27.55,Elevation:1479,personnel:0},"89298d99dabffff":{confidence:42.5,power:16.65,Elevation:1666,personnel:0},"89298d8a5bbffff":{confidence:100,power:89.4,Elevation:1734,personnel:0},"89298d98e4bffff":{confidence:100,power:266.1666666666667,Elevation:1666,personnel:0},"89298d9a9c3ffff":{confidence:60.5,power:35,Elevation:1317,personnel:0},"89298d9ad4bffff":{confidence:99,power:75.43333333333334,Elevation:1594,personnel:0},"89298d8187bffff":{confidence:68,power:67.2,Elevation:1794,personnel:0},"89298d81d6bffff":{confidence:35,power:47.5,Elevation:1794,personnel:0},"89298d8124bffff":{confidence:100,power:121.8,Elevation:1734,personnel:0},"89298d9889bffff":{confidence:79,power:114.1,Elevation:1479,personnel:0},"89298d98c2bffff":{confidence:95,power:57.9,Elevation:1479,personnel:0},"89298d98523ffff":{confidence:100,power:816.5,Elevation:1781,personnel:0},"89298d98e17ffff":{confidence:100,power:333.85,Elevation:1666,personnel:0},"89298d86313ffff":{confidence:44,power:29.45,Elevation:1389,personnel:0},"89298d86457ffff":{confidence:20,power:15.1,Elevation:1300,personnel:0},"89298d86297ffff":{confidence:35,power:46.5,Elevation:1389,personnel:0},"89298d8638bffff":{confidence:45,power:29.7,Elevation:1389,personnel:0},"89298d8a503ffff":{confidence:54,power:19.1,Elevation:1734,personnel:0},"89298d8a113ffff":{confidence:42,power:22.3,Elevation:1734,personnel:0},"89298d81663ffff":{confidence:91,power:43.35,Elevation:1734,personnel:0},"89298d8120fffff":{confidence:94,power:58.05,Elevation:1734,personnel:0},"89298d812d7ffff":{confidence:100,power:103.35,Elevation:1734,personnel:0},"89298d8a5a7ffff":{confidence:25,power:30.03333333333333,Elevation:1734,personnel:0},"89298d8668fffff":{confidence:100,power:259.15,Elevation:1366,personnel:0},"89298d86497ffff":{confidence:48,power:135.7,Elevation:1300,personnel:0},"89298d91c47ffff":{confidence:8,power:53.849999999999994,Elevation:1254,personnel:0},"89298d91cb3ffff":{confidence:100,power:173.45,Elevation:1388,personnel:0},"89298d91c8bffff":{confidence:100,power:41.1,Elevation:1388,personnel:0},"89298d99da7ffff":{confidence:100,power:58.05,Elevation:1666,personnel:0},"89298d999bbffff":{confidence:100,power:265.29999999999995,Elevation:1684,personnel:0},"89298d92877ffff":{confidence:99,power:61.199999999999996,Elevation:1156,personnel:0},"89298d9031bffff":{confidence:100,power:532.65,Elevation:1388,personnel:0},"89298d92a7bffff":{confidence:91,power:452.8,Elevation:1261,personnel:0},"89298d873afffff":{confidence:87,power:51.1,Elevation:1530,personnel:0},"89298d9003bffff":{confidence:15,power:22.3,Elevation:1388,personnel:0},"89298d98847ffff":{confidence:93,power:251.35000000000002,Elevation:1666,personnel:0},"89298d98c9bffff":{confidence:73,power:41.349999999999994,Elevation:1504,personnel:0},"89298d8715bffff":{confidence:100,power:110.19999999999999,Elevation:1431,personnel:0},"89298d846d3ffff":{confidence:79,power:54.1,Elevation:1530,personnel:0},"89298d87147ffff":{confidence:91.5,power:110.7,Elevation:1431,personnel:0},"89298d90013ffff":{confidence:100,power:228.85,Elevation:1466,personnel:0},"89298d9adb3ffff":{confidence:100,power:101.6,Elevation:1376,personnel:0},"89298d9a8cbffff":{confidence:100,power:502.95,Elevation:1504,personnel:0},"89298d9ac3bffff":{confidence:100,power:3150.566666666667,Elevation:1594,personnel:0},"89298d9ae6bffff":{confidence:98.5,power:77.45,Elevation:1781,personnel:0},"8928364b2b7ffff":{confidence:72,power:47.95,Elevation:702,personnel:0},"8928364b173ffff":{confidence:89,power:155.20000000000002,Elevation:636,personnel:0},"89298d9018fffff":{confidence:100,power:191,Elevation:1261,personnel:0},"89298d90517ffff":{confidence:23,power:29,Elevation:1354,personnel:0},"89298d80e7bffff":{confidence:84.5,power:47.25,Elevation:1694,personnel:0},"8928364b073ffff":{confidence:74,power:165.2,Elevation:725,personnel:0},"89298d94b4fffff":{confidence:56,power:138.2,Elevation:1300,personnel:0},"89298d98ddbffff":{confidence:94,power:1798.9,Elevation:1479,personnel:0},"89298d9ae2bffff":{confidence:100,power:366.9,Elevation:1504,personnel:0},"89298d91a83ffff":{confidence:96,power:409.6,Elevation:1376,personnel:0},"89298d91e8bffff":{confidence:62,power:311.8,Elevation:1376,personnel:0},"89298d91ec7ffff":{confidence:31,power:241.9,Elevation:1376,personnel:0},"89298d80a3bffff":{confidence:97,power:35,Elevation:1811,personnel:0},"89298d85647ffff":{confidence:97,power:71.1,Elevation:1741,personnel:0},"89298d8e197ffff":{confidence:62,power:12.1,Elevation:1802,personnel:0},"89298d98d03ffff":{Elevation:0,confidence:0,power:0,personnel:.860161037286291},"89298d91a03ffff":{Elevation:0,confidence:0,power:0,personnel:.941002271395834},"89298d95903ffff":{Elevation:0,confidence:0,power:0,personnel:.5845462257019302},"89298d86503ffff":{Elevation:0,confidence:0,power:0,personnel:.4966034986165482},"89298d90003ffff":{Elevation:0,confidence:0,power:0,personnel:.7755127010728279},"89298d98e03ffff":{Elevation:0,confidence:0,power:0,personnel:.16636374579324753},"89298d92903ffff":{Elevation:0,confidence:0,power:0,personnel:.45573485868103825},"89298d81803ffff":{Elevation:0,confidence:0,power:0,personnel:.7125732007896374},"89298d80903ffff":{Elevation:0,confidence:0,power:0,personnel:.44805592600101607},"89298d90603ffff":{Elevation:0,confidence:0,power:0,personnel:.48938611652176434},"89298d98003ffff":{Elevation:0,confidence:0,power:0,personnel:.002830426682370324},"8928364b103ffff":{Elevation:0,confidence:0,power:0,personnel:.09274340534219172},"89298d94d03ffff":{Elevation:0,confidence:0,power:0,personnel:.4540783303488197}}],vG="modulepreload",xG=function(t){return"/"+t},A8={},wG=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(c=>{if(c=xG(c),c in A8)return;A8[c]=!0;const p=c.endsWith(".css"),a=p?'[rel="stylesheet"]':"";if(!!i)for(let z=r.length-1;z>=0;z--){const B=r[z];if(B.href===c&&(!p||B.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${a}`))return;const k=document.createElement("link");if(k.rel=p?"stylesheet":vG,p||(k.as="script",k.crossOrigin=""),k.href=c,document.head.appendChild(k),p)return new Promise((z,B)=>{k.addEventListener("load",z),k.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${c}`)))})})).then(()=>e()).catch(c=>{const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=c,window.dispatchEvent(p),!p.defaultPrevented)throw c})},bG=Dt.createContext(null);function EG(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,c=Array.isArray(e)?e[1]:e?e.y:0;return n===r&&i===c}function fl(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!fl(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const r of n)if(!e.hasOwnProperty(r)||!fl(t[r],e[r]))return!1;return!0}return!1}function TG(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function p8(t,e){if(!t.getProjection)return;const n=t.getProjection(),i=e.getProjection();fl(n,i)||e.setProjection(n)}function m8(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function g8(t,e){const n=e.viewState||e;let i=!1;if("longitude"in n&&"latitude"in n){const r=t.center;t.center=new r.constructor(n.longitude,n.latitude),i=i||r!==t.center}if("zoom"in n){const r=t.zoom;t.zoom=n.zoom,i=i||r!==t.zoom}if("bearing"in n){const r=t.bearing;t.bearing=n.bearing,i=i||r!==t.bearing}if("pitch"in n){const r=t.pitch;t.pitch=n.pitch,i=i||r!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(i=!0,t.padding=n.padding),i}const SG=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function _8(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const i of t.layers)e[i.id]=i;const n=t.layers.map(i=>{let r=null;"interactive"in i&&(r=Object.assign({},i),delete r.interactive);const c=e[i.ref];if(c){r=r||Object.assign({},i),delete r.ref;for(const p of SG)p in c&&(r[p]=c[p])}return r||i});return{...t,layers:n}}const y8={version:8,sources:{},layers:[]},v8={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},k1={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},x8={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},MG=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],IG=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class ph{constructor(e,n,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const c=this.props[x8[r.type]];c?c(r):r.type==="error"&&console.error(r.error)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const c=this.props[v8[r.type]];c&&(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"&&(r.features=this._hoveredFeatures||this._queryRenderedFeatures(r.point)),c(r),delete r.features)},this._onCameraEvent=r=>{if(!this._internalUpdate){const c=this.props[k1[r.type]];c&&c(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=e,this.props=n,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const i=this._updateSettings(e,n);i&&this._createShadowTransform(this._map);const r=this._updateSize(e),c=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(i||r||c&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const i=ph.savedMaps.pop();if(!i)return null;const r=i.map,c=r.getContainer();for(n.className=c.className;c.childNodes.length>0;)n.appendChild(c.childNodes[0]);r._container=n;const p=r._resizeObserver;p&&(p.disconnect(),p.observe(n)),i.setProps({...e,styleDiffing:!1}),r.resize();const{initialViewState:a}=e;return a&&(a.bounds?r.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):i._updateViewState(a,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),r._update(),i}_initialize(e){const{props:n}=this,{mapStyle:i=y8}=n,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||CG()||null,container:e,style:_8(i)},c=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[c.longitude||0,c.latitude||0],zoom:c.zoom||0,pitch:c.pitch||0,bearing:c.bearing||0}),n.gl){const z=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=z,n.gl)}const p=new this._MapClass(r);c.padding&&p.setPadding(c.padding),n.cursor&&(p.getCanvas().style.cursor=n.cursor),this._createShadowTransform(p);const a=p._render;p._render=z=>{this._inRender=!0,a.call(p,z),this._inRender=!1};const T=p._renderTaskQueue.run;p._renderTaskQueue.run=z=>{T.call(p._renderTaskQueue,z),this._onBeforeRepaint()},p.on("render",()=>this._onAfterRepaint());const k=p.fire;p.fire=this._fireEvent.bind(this,k),p.on("resize",()=>{this._renderTransform.resize(p.transform.width,p.transform.height)}),p.on("styledata",()=>{this._updateStyleComponents(this.props,{}),p8(p.transform,this._renderTransform)}),p.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const z in v8)p.on(z,this._onPointerEvent);for(const z in k1)p.on(z,this._onCameraEvent);for(const z in x8)p.on(z,this._onEvent);this._map=p}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),ph.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=TG(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const i=this._map;if(n.width!==i.transform.width||n.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const i=this._map,r=this._renderTransform,{zoom:c,pitch:p,bearing:a}=r,T=i.isMoving();T&&(r.cameraElevationReference="sea");const k=g8(r,{...m8(i.transform),...e});if(T&&(r.cameraElevationReference="ground"),k&&n){const z=this._deferredEvents;z.move=!0,z.zoom||(z.zoom=c!==r.zoom),z.rotate||(z.rotate=a!==r.bearing),z.pitch||(z.pitch=p!==r.pitch)}return T||g8(i.transform,e),k}_updateSettings(e,n){const i=this._map;let r=!1;for(const c of MG)if(c in e&&!fl(e[c],n[c])){r=!0;const p=i[`set${c[0].toUpperCase()}${c.slice(1)}`];p==null||p.call(i,e[c])}return r}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==n.mapStyle){const{mapStyle:i=y8,styleDiffing:r=!0}=e,c={diff:r};return"localIdeographFontFamily"in e&&(c.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(_8(i),c),!0}return!1}_updateStyleComponents(e,n){const i=this._map;let r=!1;return i.isStyleLoaded()&&("light"in e&&i.setLight&&!fl(e.light,n.light)&&(r=!0,i.setLight(e.light)),"fog"in e&&i.setFog&&!fl(e.fog,n.fog)&&(r=!0,i.setFog(e.fog)),"terrain"in e&&i.setTerrain&&!fl(e.terrain,n.terrain)&&(!e.terrain||i.getSource(e.terrain.source))&&(r=!0,i.setTerrain(e.terrain))),r}_updateHandlers(e,n){var i,r;const c=this._map;let p=!1;for(const a of IG){const T=(i=e[a])!==null&&i!==void 0?i:!0,k=(r=n[a])!==null&&r!==void 0?r:!0;fl(T,k)||(p=!0,T?c[a].enable(T):c[a].disable())}return p}_queryRenderedFeatures(e){const n=this._map,{interactiveLayerIds:i=[]}=this.props;try{return n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(e){var n;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const c=e.type,p=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),T=a.length>0;!T&&p&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,T&&!p&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=c}else this._hoveredFeatures=null}_fireEvent(e,n,i){const r=this._map,c=r.transform,p=typeof n=="string"?n:n.type;return p==="move"&&this._updateViewState(this.props,!1),p in k1&&(typeof n=="object"&&(n.viewState=m8(c)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,n,i),r.transform=c,r):(e.call(r,n,i),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&e.fire(i);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{p8(this._renderTransform,n),e.transform=n}}}ph.savedMaps=[];function CG(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const kG=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function PG(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>{const r=e.transform;e.transform=t.transform;const c=e.project(i);return e.transform=r,c},unproject:i=>{const r=e.transform;e.transform=t.transform;const c=e.unproject(i);return e.transform=r,c},queryTerrainElevation:(i,r)=>{const c=e.transform;e.transform=t.transform;const p=e.queryTerrainElevation(i,r);return e.transform=c,p}};for(const i of LG(e))!(i in n)&&!kG.includes(i)&&(n[i]=e[i].bind(e));return n}function LG(t){const e=new Set;let n=t;for(;n;){for(const i of Object.getOwnPropertyNames(n))i[0]!=="_"&&typeof t[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&e.add(i);n=Object.getPrototypeOf(n)}return Array.from(e)}const RG=typeof document<"u"?Dt.useLayoutEffect:Dt.useEffect,DG=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function zG(t,e){for(const i of DG)i in e&&(t[i]=e[i]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,i=>{i&&console.error(i)},!1)}const zm=Dt.createContext(null);function BG(t,e,n){const i=Dt.useContext(bG),[r,c]=Dt.useState(null),p=Dt.useRef(),{current:a}=Dt.useRef({mapLib:null,map:null});Dt.useEffect(()=>{const z=t.mapLib;let B=!0,D;return Promise.resolve(z||n).then(K=>{if(!B)return;if(!K)throw new Error("Invalid mapLib");const ee="Map"in K?K:K.default;if(!ee.Map)throw new Error("Invalid mapLib");if(zG(ee,t),!ee.supported||ee.supported(t))t.reuseMaps&&(D=ph.reuse(t,p.current)),D||(D=new ph(ee.Map,t,p.current)),a.map=PG(D),a.mapLib=ee,c(D),i==null||i.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(K=>{const{onError:ee}=t;ee?ee({type:"error",target:null,originalEvent:null,error:K}):console.error(K)}),()=>{B=!1,D&&(i==null||i.onMapUnmount(t.id),t.reuseMaps?D.recycle():D.destroy())}},[]),RG(()=>{r&&r.setProps(t)}),Dt.useImperativeHandle(e,()=>a.map,[r]);const T=Dt.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),k={height:"100%"};return Dt.createElement("div",{id:t.id,ref:p,style:T},r&&Dt.createElement(zm.Provider,{value:a},Dt.createElement("div",{"mapboxgl-children":"",style:k},t.children)))}const OG=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Su(t,e){if(!t||!e)return;const n=t.style;for(const i in e){const r=e[i];Number.isFinite(r)&&!OG.test(i)?n[i]=`${r}px`:n[i]=r}}function FG(t,e){const{map:n,mapLib:i}=Dt.useContext(zm),r=Dt.useRef({props:t});r.current.props=t;const c=Dt.useMemo(()=>{let le=!1;Dt.Children.forEach(t.children,ne=>{ne&&(le=!0)});const Ce={...t,element:le?document.createElement("div"):null},se=new i.Marker(Ce);return se.setLngLat([t.longitude,t.latitude]),se.getElement().addEventListener("click",ne=>{var te,xe;(xe=(te=r.current.props).onClick)===null||xe===void 0||xe.call(te,{type:"click",target:se,originalEvent:ne})}),se.on("dragstart",ne=>{var te,xe;const Le=ne;Le.lngLat=c.getLngLat(),(xe=(te=r.current.props).onDragStart)===null||xe===void 0||xe.call(te,Le)}),se.on("drag",ne=>{var te,xe;const Le=ne;Le.lngLat=c.getLngLat(),(xe=(te=r.current.props).onDrag)===null||xe===void 0||xe.call(te,Le)}),se.on("dragend",ne=>{var te,xe;const Le=ne;Le.lngLat=c.getLngLat(),(xe=(te=r.current.props).onDragEnd)===null||xe===void 0||xe.call(te,Le)}),se},[]);Dt.useEffect(()=>(c.addTo(n.getMap()),()=>{c.remove()}),[]);const{longitude:p,latitude:a,offset:T,style:k,draggable:z=!1,popup:B=null,rotation:D=0,rotationAlignment:K="auto",pitchAlignment:ee="auto"}=t;return Dt.useEffect(()=>{Su(c.getElement(),k)},[k]),Dt.useImperativeHandle(e,()=>c,[]),(c.getLngLat().lng!==p||c.getLngLat().lat!==a)&&c.setLngLat([p,a]),T&&!EG(c.getOffset(),T)&&c.setOffset(T),c.isDraggable()!==z&&c.setDraggable(z),c.getRotation()!==D&&c.setRotation(D),c.getRotationAlignment()!==K&&c.setRotationAlignment(K),c.getPitchAlignment()!==ee&&c.setPitchAlignment(ee),c.getPopup()!==B&&c.setPopup(B),G2.createPortal(t.children,c.getElement())}Dt.memo(Dt.forwardRef(FG));function w8(t){return new Set(t?t.trim().split(/\s+/):[])}function NG(t,e){const{map:n,mapLib:i}=Dt.useContext(zm),r=Dt.useMemo(()=>document.createElement("div"),[]),c=Dt.useRef({props:t});c.current.props=t;const p=Dt.useMemo(()=>{const a={...t},T=new i.Popup(a);return T.setLngLat([t.longitude,t.latitude]),T.once("open",k=>{var z,B;(B=(z=c.current.props).onOpen)===null||B===void 0||B.call(z,k)}),T},[]);if(Dt.useEffect(()=>{const a=T=>{var k,z;(z=(k=c.current.props).onClose)===null||z===void 0||z.call(k,T)};return p.on("close",a),p.setDOMContent(r).addTo(n.getMap()),()=>{p.off("close",a),p.isOpen()&&p.remove()}},[]),Dt.useEffect(()=>{Su(p.getElement(),t.style)},[t.style]),Dt.useImperativeHandle(e,()=>p,[]),p.isOpen()&&((p.getLngLat().lng!==t.longitude||p.getLngLat().lat!==t.latitude)&&p.setLngLat([t.longitude,t.latitude]),t.offset&&!fl(p.options.offset,t.offset)&&p.setOffset(t.offset),(p.options.anchor!==t.anchor||p.options.maxWidth!==t.maxWidth)&&(p.options.anchor=t.anchor,p.setMaxWidth(t.maxWidth)),p.options.className!==t.className)){const a=w8(p.options.className),T=w8(t.className);for(const k of a)T.has(k)||p.removeClassName(k);for(const k of T)a.has(k)||p.addClassName(k);p.options.className=t.className}return G2.createPortal(t.children,r)}Dt.memo(Dt.forwardRef(NG));function SA(t,e,n,i){const r=Dt.useContext(zm),c=Dt.useMemo(()=>t(r),[]);return Dt.useEffect(()=>{const p=i||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,T=typeof n=="function"?n:typeof e=="function"?e:null,{map:k}=r;return k.hasControl(c)||(k.addControl(c,p==null?void 0:p.position),a&&a(r)),()=>{T&&T(r),k.hasControl(c)&&k.removeControl(c)}},[]),c}function UG(t){const e=SA(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return Dt.useEffect(()=>{Su(e._container,t.style)},[t.style]),null}Dt.memo(UG);function VG(t){const e=SA(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return Dt.useEffect(()=>{Su(e._controlContainer,t.style)},[t.style]),null}Dt.memo(VG);function jG(t,e){const n=Dt.useRef({props:t}),i=SA(({mapLib:r})=>{const c=new r.GeolocateControl(t),p=c._setupUI;return c._setupUI=a=>{c._container.hasChildNodes()||p(a)},c.on("geolocate",a=>{var T,k;(k=(T=n.current.props).onGeolocate)===null||k===void 0||k.call(T,a)}),c.on("error",a=>{var T,k;(k=(T=n.current.props).onError)===null||k===void 0||k.call(T,a)}),c.on("outofmaxbounds",a=>{var T,k;(k=(T=n.current.props).onOutOfMaxBounds)===null||k===void 0||k.call(T,a)}),c.on("trackuserlocationstart",a=>{var T,k;(k=(T=n.current.props).onTrackUserLocationStart)===null||k===void 0||k.call(T,a)}),c.on("trackuserlocationend",a=>{var T,k;(k=(T=n.current.props).onTrackUserLocationEnd)===null||k===void 0||k.call(T,a)}),c},{position:t.position});return n.current.props=t,Dt.useImperativeHandle(e,()=>i,[]),Dt.useEffect(()=>{Su(i._container,t.style)},[t.style]),null}Dt.memo(Dt.forwardRef(jG));function GG(t){const e=SA(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return Dt.useEffect(()=>{Su(e._container,t.style)},[t.style]),null}Dt.memo(GG);function HG(t){const e=SA(({mapLib:c})=>new c.ScaleControl(t),{position:t.position}),n=Dt.useRef(t),i=n.current;n.current=t;const{style:r}=t;return t.maxWidth!==void 0&&t.maxWidth!==i.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==i.unit&&e.setUnit(t.unit),Dt.useEffect(()=>{Su(e._container,r)},[r]),null}Dt.memo(HG);const $G=wG(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),WG=(()=>Dt.forwardRef(function(e,n){return BG(e,n,$G)}))();function y5(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ZG(t){return t.length===1&&(t=qG(t)),{left:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var c=i+r>>>1;t(e[c],n)<0?i=c+1:r=c}return i},right:function(e,n,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var c=i+r>>>1;t(e[c],n)>0?r=c:i=c+1}return i}}}function qG(t){return function(e,n){return y5(t(e),n)}}var QG=ZG(y5),XG=QG.right,cy=Math.sqrt(50),uy=Math.sqrt(10),fy=Math.sqrt(2);function YG(t,e,n){var i,r=-1,c,p,a;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((i=e<t)&&(c=t,t=e,e=c),(a=ip(t,e,n))===0||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),p=new Array(c=Math.ceil(e-t+1));++r<c;)p[r]=(t+r)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),p=new Array(c=Math.ceil(t-e+1));++r<c;)p[r]=(t-r)/a;return i&&p.reverse(),p}function ip(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),c=i/Math.pow(10,r);return r>=0?(c>=cy?10:c>=uy?5:c>=fy?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(c>=cy?10:c>=uy?5:c>=fy?2:1)}function KG(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),c=i/r;return c>=cy?r*=10:c>=uy?r*=5:c>=fy&&(r*=2),e<t?-r:r}function JG(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var As="$";function rm(){}rm.prototype=v5.prototype={constructor:rm,has:function(t){return As+t in this},get:function(t){return this[As+t]},set:function(t,e){return this[As+t]=e,this},remove:function(t){var e=As+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===As&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===As&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===As&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===As&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===As&&++t;return t},empty:function(){for(var t in this)if(t[0]===As)return!1;return!0},each:function(t){for(var e in this)e[0]===As&&t(this[e],e.slice(1),this)}};function v5(t,e){var n=new rm;if(t instanceof rm)t.each(function(a,T){n.set(T,a)});else if(Array.isArray(t)){var i=-1,r=t.length,c;if(e==null)for(;++i<r;)n.set(i,t[i]);else for(;++i<r;)n.set(e(c=t[i],i,t),c)}else if(t)for(var p in t)n.set(p,t[p]);return n}function b8(){}var Jc=v5.prototype;b8.prototype={constructor:b8,has:Jc.has,add:function(t){return t+="",this[As+t]=t,this},remove:Jc.remove,clear:Jc.clear,values:Jc.keys,size:Jc.size,empty:Jc.empty,each:Jc.each};var x5=Array.prototype,eH=x5.map,E8=x5.slice;function tH(t){return function(){return t}}function nH(t){return+t}var T8=[0,1];function Of(t){return t}function hy(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:tH(isNaN(e)?NaN:.5)}function S8(t){var e=t[0],n=t[t.length-1],i;return e>n&&(i=e,e=n,n=i),function(r){return Math.max(e,Math.min(n,r))}}function iH(t,e,n){var i=t[0],r=t[1],c=e[0],p=e[1];return r<i?(i=hy(r,i),c=n(p,c)):(i=hy(i,r),c=n(c,p)),function(a){return c(i(a))}}function rH(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),c=new Array(i),p=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++p<i;)r[p]=hy(t[p],t[p+1]),c[p]=n(e[p],e[p+1]);return function(a){var T=XG(t,a,1,i)-1;return c[T](r[T](a))}}function oH(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function sH(){var t=T8,e=T8,n=W2,i,r,c,p=Of,a,T,k;function z(){return a=Math.min(t.length,e.length)>2?rH:iH,T=k=null,B}function B(D){return isNaN(D=+D)?c:(T||(T=a(t.map(i),e,n)))(i(p(D)))}return B.invert=function(D){return p(r((k||(k=a(e,t.map(i),Qp)))(D)))},B.domain=function(D){return arguments.length?(t=eH.call(D,nH),p===Of||(p=S8(t)),z()):t.slice()},B.range=function(D){return arguments.length?(e=E8.call(D),z()):e.slice()},B.rangeRound=function(D){return e=E8.call(D),n=ZV,z()},B.clamp=function(D){return arguments.length?(p=D?S8(t):Of,B):p!==Of},B.interpolate=function(D){return arguments.length?(n=D,z()):n},B.unknown=function(D){return arguments.length?(c=D,B):c},function(D,K){return i=D,r=K,z()}}function aH(t,e){return sH()(t,e)}function lH(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function om(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function mh(t){return t=om(Math.abs(t)),t?t[1]:NaN}function cH(t,e){return function(n,i){for(var r=n.length,c=[],p=0,a=t[0],T=0;r>0&&a>0&&(T+a+1>i&&(a=Math.max(1,i-T)),c.push(n.substring(r-=a,r+a)),!((T+=a+1)>i));)a=t[p=(p+1)%t.length];return c.reverse().join(e)}}function uH(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var fH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function sm(t){if(!(e=fH.exec(t)))throw new Error("invalid format: "+t);var e;return new J2({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}sm.prototype=J2.prototype;function J2(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}J2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function hH(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var w5;function dH(t,e){var n=om(t,e);if(!n)return t+"";var i=n[0],r=n[1],c=r-(w5=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,p=i.length;return c===p?i:c>p?i+new Array(c-p+1).join("0"):c>0?i.slice(0,c)+"."+i.slice(c):"0."+new Array(1-c).join("0")+om(t,Math.max(0,e+c-1))[0]}function M8(t,e){var n=om(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const I8={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:lH,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return M8(t*100,e)},r:M8,s:dH,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function C8(t){return t}var k8=Array.prototype.map,P8=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function AH(t){var e=t.grouping===void 0||t.thousands===void 0?C8:cH(k8.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",c=t.numerals===void 0?C8:uH(k8.call(t.numerals,String)),p=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"-":t.minus+"",T=t.nan===void 0?"NaN":t.nan+"";function k(B){B=sm(B);var D=B.fill,K=B.align,ee=B.sign,le=B.symbol,Ce=B.zero,se=B.width,ne=B.comma,te=B.precision,xe=B.trim,Le=B.type;Le==="n"?(ne=!0,Le="g"):I8[Le]||(te===void 0&&(te=12),xe=!0,Le="g"),(Ce||D==="0"&&K==="=")&&(Ce=!0,D="0",K="=");var Ge=le==="$"?n:le==="#"&&/[boxX]/.test(Le)?"0"+Le.toLowerCase():"",nt=le==="$"?i:/[%p]/.test(Le)?p:"",it=I8[Le],dt=/[defgprs%]/.test(Le);te=te===void 0?6:/[gprs]/.test(Le)?Math.max(1,Math.min(21,te)):Math.max(0,Math.min(20,te));function ct(Xe){var Bt=Ge,Rt=nt,jt,_n,Mt;if(Le==="c")Rt=it(Xe)+Rt,Xe="";else{Xe=+Xe;var Sn=Xe<0||1/Xe<0;if(Xe=isNaN(Xe)?T:it(Math.abs(Xe),te),xe&&(Xe=hH(Xe)),Sn&&+Xe==0&&ee!=="+"&&(Sn=!1),Bt=(Sn?ee==="("?ee:a:ee==="-"||ee==="("?"":ee)+Bt,Rt=(Le==="s"?P8[8+w5/3]:"")+Rt+(Sn&&ee==="("?")":""),dt){for(jt=-1,_n=Xe.length;++jt<_n;)if(Mt=Xe.charCodeAt(jt),48>Mt||Mt>57){Rt=(Mt===46?r+Xe.slice(jt+1):Xe.slice(jt))+Rt,Xe=Xe.slice(0,jt);break}}}ne&&!Ce&&(Xe=e(Xe,1/0));var pt=Bt.length+Xe.length+Rt.length,It=pt<se?new Array(se-pt+1).join(D):"";switch(ne&&Ce&&(Xe=e(It+Xe,It.length?se-Rt.length:1/0),It=""),K){case"<":Xe=Bt+Xe+Rt+It;break;case"=":Xe=Bt+It+Xe+Rt;break;case"^":Xe=It.slice(0,pt=It.length>>1)+Bt+Xe+Rt+It.slice(pt);break;default:Xe=It+Bt+Xe+Rt;break}return c(Xe)}return ct.toString=function(){return B+""},ct}function z(B,D){var K=k((B=sm(B),B.type="f",B)),ee=Math.max(-8,Math.min(8,Math.floor(mh(D)/3)))*3,le=Math.pow(10,-ee),Ce=P8[8+ee/3];return function(se){return K(le*se)+Ce}}return{format:k,formatPrefix:z}}var D0,b5,E5;pH({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function pH(t){return D0=AH(t),b5=D0.format,E5=D0.formatPrefix,D0}function mH(t){return Math.max(0,-mh(Math.abs(t)))}function gH(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(mh(e)/3)))*3-mh(Math.abs(t)))}function _H(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,mh(e)-mh(t))+1}function yH(t,e,n,i){var r=KG(t,e,n),c;switch(i=sm(i??",f"),i.type){case"s":{var p=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(c=gH(r,p))&&(i.precision=c),E5(i,p)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(c=_H(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=c-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(c=mH(r))&&(i.precision=c-(i.type==="%")*2);break}}return b5(i)}function vH(t){var e=t.domain;return t.ticks=function(n){var i=e();return YG(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return yH(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,c=i.length-1,p=i[r],a=i[c],T;return a<p&&(T=p,p=a,a=T,T=r,r=c,c=T),T=ip(p,a,n),T>0?(p=Math.floor(p/T)*T,a=Math.ceil(a/T)*T,T=ip(p,a,n)):T<0&&(p=Math.ceil(p*T)/T,a=Math.floor(a*T)/T,T=ip(p,a,n)),T>0?(i[r]=Math.floor(p/T)*T,i[c]=Math.ceil(a/T)*T,e(i)):T<0&&(i[r]=Math.ceil(p*T)/T,i[c]=Math.floor(a*T)/T,e(i)),t},t}function bh(){var t=aH(Of,Of);return t.copy=function(){return oH(t,bh())},JG.apply(t,arguments),vH(t)}const xH=8,wH="Positron",bH={},EH={carto:{type:"vector",url:"https://tiles.basemaps.cartocdn.com/vector/carto.streets/v1/tiles.json"}},TH="https://tiles.basemaps.cartocdn.com/gl/positron-gl-style/sprite",SH="https://tiles.basemaps.cartocdn.com/fonts/{fontstack}/{range}.pbf",MH=[{id:"background",type:"background",layout:{visibility:"visible"},paint:{"background-color":"#fafaf8","background-opacity":1}},{id:"landcover",type:"fill",source:"carto","source-layer":"landcover",filter:["any",["==","class","wood"],["==","class","grass"],["==","subclass","recreation_ground"]],paint:{"fill-color":{stops:[[8,"rgba(234, 241, 233, 0.5)"],[9,"rgba(234, 241, 233, 0.5)"],[11,"rgba(234, 241, 233, 0.5)"],[13,"rgba(234, 241, 233, 0.5)"],[15,"rgba(234, 241, 233, 0.5)"]]},"fill-opacity":1}},{id:"park_national_park",type:"fill",source:"carto","source-layer":"park",minzoom:9,filter:["all",["==","class","national_park"]],layout:{visibility:"visible"},paint:{"fill-color":{stops:[[8,"rgba(234, 241, 233, 0.5)"],[9,"rgba(234, 241, 233, 0.5)"],[11,"rgba(234, 241, 233, 0.5)"],[13,"rgba(234, 241, 233, 0.5)"],[15,"rgba(234, 241, 233, 0.5)"]]},"fill-opacity":1,"fill-translate-anchor":"map"}},{id:"park_nature_reserve",type:"fill",source:"carto","source-layer":"park",minzoom:0,filter:["all",["==","class","nature_reserve"]],layout:{visibility:"visible"},paint:{"fill-color":{stops:[[8,"rgba(234, 241, 233, 0.5)"],[9,"rgba(234, 241, 233, 0.5)"],[11,"rgba(234, 241, 233, 0.5)"],[13,"rgba(234, 241, 233, 0.5)"],[15,"rgba(234, 241, 233, 0.5)"]]},"fill-antialias":!0,"fill-opacity":{stops:[[6,.7],[9,.9]]}}},{id:"landuse_residential",type:"fill",source:"carto","source-layer":"landuse",minzoom:6,filter:["any",["==","class","residential"]],paint:{"fill-color":{stops:[[5,"rgba(237, 237, 237, 0.5)"],[8,"rgba(237, 237, 237, 0.45)"],[9,"rgba(237, 237, 237, 0.4)"],[11,"rgba(237, 237, 237, 0.35)"],[13,"rgba(237, 237, 237, 0.3)"],[15,"rgba(237, 237, 237, 0.25)"],[16,"rgba(237, 237, 237, 0.25)"]]},"fill-opacity":{stops:[[6,.6],[9,1]]}}},{id:"landuse",type:"fill",source:"carto","source-layer":"landuse",filter:["any",["==","class","cemetery"],["==","class","stadium"]],paint:{"fill-color":{stops:[[8,"rgba(234, 241, 233, 0.5)"],[9,"rgba(234, 241, 233, 0.5)"],[11,"rgba(234, 241, 233, 0.5)"],[13,"rgba(234, 241, 233, 0.5)"],[15,"rgba(234, 241, 233, 0.5)"]]}}},{id:"waterway",type:"line",source:"carto","source-layer":"waterway",paint:{"line-color":"#d1dbdf","line-width":{stops:[[8,.5],[9,1],[15,2],[16,3]]}}},{id:"boundary_county",type:"line",source:"carto","source-layer":"boundary",minzoom:9,maxzoom:24,filter:["all",["==","admin_level",6],["==","maritime",0]],paint:{"line-color":{stops:[[4,"#ead5d7"],[5,"#ead5d7"],[6,"#e1c5c7"]]},"line-width":{stops:[[4,.5],[7,1]]},"line-dasharray":{stops:[[6,[1]],[7,[2,2]]]}}},{id:"boundary_state",type:"line",source:"carto","source-layer":"boundary",minzoom:4,filter:["all",["==","admin_level",4],["==","maritime",0]],paint:{"line-color":{stops:[[4,"#ead5d7"],[5,"#ead5d7"],[6,"#e1c5c7"]]},"line-width":{stops:[[4,.5],[7,1],[8,1],[9,1.2]]},"line-dasharray":{stops:[[6,[1]],[7,[2,2]]]}}},{id:"water",type:"fill",source:"carto","source-layer":"water",minzoom:0,maxzoom:24,filter:["all",["==","$type","Polygon"]],layout:{visibility:"visible"},paint:{"fill-color":"#d4dadc","fill-antialias":!0,"fill-translate-anchor":"map","fill-opacity":1}},{id:"water_shadow",type:"fill",source:"carto","source-layer":"water",minzoom:0,filter:["all",["==","$type","Polygon"]],layout:{visibility:"visible"},paint:{"fill-color":"transparent","fill-antialias":!0,"fill-translate-anchor":"map","fill-opacity":1,"fill-translate":{stops:[[0,[0,2]],[6,[0,1]],[14,[0,1]],[17,[0,2]]]}}},{id:"aeroway-runway",type:"line",source:"carto","source-layer":"aeroway",minzoom:12,filter:["all",["==","class","runway"]],layout:{"line-cap":"square"},paint:{"line-width":{stops:[[11,1],[13,4],[14,6],[15,8],[16,10]]},"line-color":"#e8e8e8"}},{id:"aeroway-taxiway",type:"line",source:"carto","source-layer":"aeroway",minzoom:13,filter:["all",["==","class","taxiway"]],paint:{"line-color":"#e8e8e8","line-width":{stops:[[13,.5],[14,1],[15,2],[16,4]]}}},{id:"waterway_label",type:"symbol",source:"carto","source-layer":"waterway",filter:["all",["has","name"],["==","class","river"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-placement":"line","symbol-spacing":300,"symbol-avoid-edges":!1,"text-size":{stops:[[9,8],[10,9]]},"text-padding":2,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-offset":{stops:[[6,[0,-.2]],[11,[0,-.4]],[12,[0,-.6]]]},"text-letter-spacing":0,"text-keep-upright":!0},paint:{"text-color":"#7a96a0","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"tunnel_service_case",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","service"],["==","brunnel","tunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[15,1],[16,3],[17,6],[18,8]]},"line-opacity":1,"line-color":"#ddd"}},{id:"tunnel_minor_case",type:"line",source:"carto","source-layer":"transportation",minzoom:13,maxzoom:24,filter:["all",["==","class","minor"],["==","brunnel","tunnel"]],layout:{"line-cap":"butt","line-join":"miter"},paint:{"line-width":{stops:[[11,.5],[12,.5],[14,2],[15,4],[16,6],[17,10],[18,14]]},"line-opacity":1,"line-color":"#ddd"}},{id:"tunnel_sec_case",type:"line",source:"carto","source-layer":"transportation",minzoom:11,maxzoom:24,filter:["all",["in","class","secondary","tertiary"],["==","brunnel","tunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[11,.5],[12,1],[13,2],[14,5],[15,6],[16,8],[17,12],[18,16]]},"line-opacity":1,"line-color":"#ddd"}},{id:"tunnel_pri_case",type:"line",source:"carto","source-layer":"transportation",minzoom:8,maxzoom:24,filter:["all",["==","class","primary"],["!=","ramp",1],["==","brunnel","tunnel"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[6,.5],[7,.8],[8,1],[11,3],[13,4],[14,6],[15,8],[16,10],[17,14],[18,18]]},"line-opacity":{stops:[[5,.5],[7,1]]},"line-color":"#ddd"}},{id:"tunnel_trunk_case",type:"line",source:"carto","source-layer":"transportation",minzoom:5,maxzoom:24,filter:["all",["==","class","trunk"],["!=","ramp",1],["==","brunnel","tunnel"]],layout:{"line-cap":"butt","line-join":"round",visibility:"visible"},paint:{"line-width":{stops:[[6,.5],[7,.8],[8,1],[11,3],[13,4],[14,6],[15,8],[16,10],[17,14],[18,18]]},"line-opacity":{stops:[[5,.5],[7,1]]},"line-color":"#ddd"}},{id:"tunnel_mot_case",type:"line",source:"carto","source-layer":"transportation",minzoom:5,maxzoom:24,filter:["all",["==","class","motorway"],["!=","ramp",1],["==","brunnel","tunnel"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[6,.5],[7,.8],[8,1],[11,3],[12,4],[13,5],[14,7],[15,9],[16,11],[17,13],[18,22]]},"line-opacity":{stops:[[6,.5],[7,1]]},"line-color":"#ddd"}},{id:"tunnel_path",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","path"],["==","brunnel","tunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[15,.5],[16,1],[18,3]]},"line-opacity":1,"line-color":"#d5d5d5","line-dasharray":{stops:[[15,[2,2]],[18,[3,3]]]}}},{id:"tunnel_service_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","service"],["==","brunnel","tunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[15,2],[16,2],[17,4],[18,6]]},"line-opacity":1,"line-color":"#eee"}},{id:"tunnel_minor_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","minor"],["==","brunnel","tunnel"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[15,3],[16,4],[17,8],[18,12]]},"line-opacity":1,"line-color":"rgba(238, 238, 238, 1)"}},{id:"tunnel_sec_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:13,maxzoom:24,filter:["all",["in","class","secondary","tertiary"],["==","brunnel","tunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[11,2],[13,2],[14,3],[15,4],[16,6],[17,10],[18,14]]},"line-opacity":1,"line-color":"#eee"}},{id:"tunnel_pri_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:11,maxzoom:24,filter:["all",["==","class","primary"],["!=","ramp",1],["==","brunnel","tunnel"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[11,1],[13,2],[14,4],[15,6],[16,8],[17,12],[18,16]]},"line-opacity":1,"line-color":"#eee"}},{id:"tunnel_trunk_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:11,maxzoom:24,filter:["all",["==","class","trunk"],["!=","ramp",1],["==","brunnel","tunnel"]],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},paint:{"line-width":{stops:[[11,1],[13,2],[14,4],[15,6],[16,8],[17,12],[18,16]]},"line-opacity":1,"line-color":"#eee"}},{id:"tunnel_mot_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:10,maxzoom:24,filter:["all",["==","class","motorway"],["!=","ramp",1],["==","brunnel","tunnel"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[10,1],[12,2],[13,3],[14,5],[15,7],[16,9],[17,11],[18,20]]},"line-opacity":1,"line-color":"#eee"}},{id:"tunnel_rail",type:"line",source:"carto","source-layer":"transportation",minzoom:13,filter:["all",["==","class","rail"],["==","brunnel","tunnel"]],layout:{visibility:"visible","line-join":"round"},paint:{"line-color":"#dddddd","line-width":{base:1.3,stops:[[13,.5],[14,1],[15,1],[16,3],[21,7]]},"line-opacity":.5}},{id:"tunnel_rail_dash",type:"line",source:"carto","source-layer":"transportation",minzoom:15,filter:["all",["==","class","rail"],["==","brunnel","tunnel"]],layout:{visibility:"visible","line-join":"round"},paint:{"line-color":"#ffffff","line-width":{base:1.3,stops:[[15,.5],[16,1],[20,5]]},"line-dasharray":{stops:[[15,[5,5]],[16,[6,6]]]},"line-opacity":.5}},{id:"road_service_case",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","service"],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[15,1],[16,3],[17,6],[18,8]]},"line-opacity":1,"line-color":"#ddd"}},{id:"road_minor_case",type:"line",source:"carto","source-layer":"transportation",minzoom:13,maxzoom:24,filter:["all",["==","class","minor"],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[11,.5],[12,.5],[14,2],[15,3],[16,4.3],[17,10],[18,14]]},"line-opacity":1,"line-color":{stops:[[13,"#e6e6e6"],[15.7,"#e6e6e6"],[16,"#ddd"]]}}},{id:"road_pri_case_ramp",type:"line",source:"carto","source-layer":"transportation",minzoom:12,maxzoom:24,filter:["all",["==","class","primary"],["==","ramp",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[12,2],[13,3],[14,4],[15,5],[16,8],[17,10]]},"line-opacity":{stops:[[5,.5],[7,1]]},"line-color":"#ddd"}},{id:"road_trunk_case_ramp",type:"line",source:"carto","source-layer":"transportation",minzoom:12,maxzoom:24,filter:["all",["==","class","trunk"],["==","ramp",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[12,2],[13,3],[14,4],[15,5],[16,8],[17,10]]},"line-opacity":1,"line-color":{stops:[[12,"#e6e6e6"],[14,"#ddd"]]}}},{id:"road_mot_case_ramp",type:"line",source:"carto","source-layer":"transportation",minzoom:12,maxzoom:24,filter:["all",["==","class","motorway"],["==","ramp",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[12,2],[13,3],[14,4],[15,5],[16,8],[17,10]]},"line-opacity":1,"line-color":{stops:[[12,"#e6e6e6"],[14,"#ddd"]]}}},{id:"road_sec_case_noramp",type:"line",source:"carto","source-layer":"transportation",minzoom:11,maxzoom:24,filter:["all",["in","class","secondary","tertiary"],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[11,.5],[12,1.5],[13,3],[14,5],[15,6],[16,8],[17,12],[18,16]]},"line-opacity":1,"line-color":{stops:[[11,"#e6e6e6"],[12.99,"#e6e6e6"],[13,"#ddd"]]}}},{id:"road_pri_case_noramp",type:"line",source:"carto","source-layer":"transportation",minzoom:7,maxzoom:24,filter:["all",["==","class","primary"],["!=","ramp",1],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[6,.5],[7,.8],[8,1],[11,3],[13,4],[14,6],[15,8],[16,10],[17,14],[18,18]]},"line-opacity":{stops:[[5,.5],[7,1]]},"line-color":{stops:[[7,"#e6e6e6"],[12,"#ddd"]]}}},{id:"road_trunk_case_noramp",type:"line",source:"carto","source-layer":"transportation",minzoom:5,maxzoom:24,filter:["all",["==","class","trunk"],["!=","ramp",1],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[6,.5],[7,.8],[8,1],[11,3],[13,4],[14,6],[15,8],[16,10],[17,14],[18,18]]},"line-opacity":{stops:[[5,.5],[7,1]]},"line-color":{stops:[[5,"#e6e6e6"],[12,"#ddd"]]}}},{id:"road_mot_case_noramp",type:"line",source:"carto","source-layer":"transportation",minzoom:5,maxzoom:24,filter:["all",["==","class","motorway"],["!=","ramp",1],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[6,.5],[7,.7],[8,.8],[11,3],[12,4],[13,5],[14,7],[15,9],[16,11],[17,13],[18,22]]},"line-opacity":{stops:[[6,.5],[7,1]]},"line-color":{stops:[[5,"#e6e6e6"],[12,"#ddd"]]}}},{id:"road_path",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["in","class","path","track"],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[15,.5],[16,1],[18,3]]},"line-opacity":1,"line-color":"#d5d5d5","line-dasharray":{stops:[[15,[2,2]],[18,[3,3]]]}}},{id:"road_service_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","service"],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[15,2],[16,2],[17,4],[18,6]]},"line-opacity":1,"line-color":"#fdfdfd"}},{id:"road_minor_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","minor"],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[15,3],[16,4],[17,8],[18,12]]},"line-opacity":1,"line-color":"#fdfdfd"}},{id:"road_pri_fill_ramp",type:"line",source:"carto","source-layer":"transportation",minzoom:12,maxzoom:24,filter:["all",["==","class","primary"],["==","ramp",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[12,1],[13,1.5],[14,2],[15,3],[16,6],[17,8]]},"line-opacity":1,"line-color":"#fff"}},{id:"road_trunk_fill_ramp",type:"line",source:"carto","source-layer":"transportation",minzoom:12,maxzoom:24,filter:["all",["==","class","trunk"],["==","ramp",1]],layout:{"line-cap":"square","line-join":"round"},paint:{"line-width":{stops:[[12,1],[13,1.5],[14,2],[15,3],[16,6],[17,8]]},"line-opacity":1,"line-color":"#fff"}},{id:"road_mot_fill_ramp",type:"line",source:"carto","source-layer":"transportation",minzoom:12,maxzoom:24,filter:["all",["==","class","motorway"],["==","ramp",1]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[12,1],[13,1.5],[14,2],[15,3],[16,6],[17,8]]},"line-opacity":1,"line-color":"#fff"}},{id:"road_sec_fill_noramp",type:"line",source:"carto","source-layer":"transportation",minzoom:13,maxzoom:24,filter:["all",["in","class","secondary","tertiary"],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[11,2],[13,2],[14,3],[15,4],[16,6],[17,10],[18,14]]},"line-opacity":1,"line-color":"#fff"}},{id:"road_pri_fill_noramp",type:"line",source:"carto","source-layer":"transportation",minzoom:10,maxzoom:24,filter:["all",["==","class","primary"],["!=","ramp",1],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[10,.3],[13,2],[14,4],[15,6],[16,8],[17,12],[18,16]]},"line-opacity":1,"line-color":"#fff"}},{id:"road_trunk_fill_noramp",type:"line",source:"carto","source-layer":"transportation",minzoom:10,maxzoom:24,filter:["all",["==","class","trunk"],["!=","ramp",1],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[11,1],[13,2],[14,4],[15,6],[16,8],[17,12],[18,16]]},"line-opacity":1,"line-color":"#fff"}},{id:"road_mot_fill_noramp",type:"line",source:"carto","source-layer":"transportation",minzoom:10,maxzoom:24,filter:["all",["==","class","motorway"],["!=","ramp",1],["!has","brunnel"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[10,1],[12,2],[13,3],[14,5],[15,7],[16,9],[17,11],[18,20]]},"line-opacity":1,"line-color":"#fff"}},{id:"rail",type:"line",source:"carto","source-layer":"transportation",minzoom:13,filter:["all",["==","class","rail"],["!=","brunnel","tunnel"]],layout:{visibility:"visible","line-join":"round"},paint:{"line-color":"#dddddd","line-width":{base:1.3,stops:[[13,.5],[14,1],[15,1],[16,3],[21,7]]}}},{id:"rail_dash",type:"line",source:"carto","source-layer":"transportation",minzoom:15,filter:["all",["==","class","rail"],["!=","brunnel","tunnel"]],layout:{visibility:"visible","line-join":"round"},paint:{"line-color":"#ffffff","line-width":{base:1.3,stops:[[15,.5],[16,1],[20,5]]},"line-dasharray":{stops:[[15,[5,5]],[16,[6,6]]]}}},{id:"bridge_service_case",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","service"],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[15,1],[16,3],[17,6],[18,8]]},"line-opacity":1,"line-color":"#ddd"}},{id:"bridge_minor_case",type:"line",source:"carto","source-layer":"transportation",minzoom:13,maxzoom:24,filter:["all",["==","class","minor"],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"miter"},paint:{"line-width":{stops:[[11,.5],[12,.5],[14,2],[15,3],[16,4.3],[17,10],[18,14]]},"line-opacity":1,"line-color":{stops:[[13,"#e6e6e6"],[15.7,"#e6e6e6"],[16,"#ddd"]]}}},{id:"bridge_sec_case",type:"line",source:"carto","source-layer":"transportation",minzoom:11,maxzoom:24,filter:["all",["in","class","secondary","tertiary"],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"miter"},paint:{"line-width":{stops:[[11,.5],[12,1.5],[13,3],[14,5],[15,6],[16,8],[17,12],[18,16]]},"line-opacity":1,"line-color":{stops:[[11,"#e6e6e6"],[12.99,"#e6e6e6"],[13,"#ddd"]]}}},{id:"bridge_pri_case",type:"line",source:"carto","source-layer":"transportation",minzoom:8,maxzoom:24,filter:["all",["==","class","primary"],["!=","ramp",1],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[6,.5],[7,.8],[8,1],[11,3],[13,4],[14,6],[15,8],[16,10],[17,14],[18,18]]},"line-opacity":{stops:[[5,.5],[7,1]]},"line-color":{stops:[[8,"#e6e6e6"],[12,"#ddd"]]}}},{id:"bridge_trunk_case",type:"line",source:"carto","source-layer":"transportation",minzoom:5,maxzoom:24,filter:["all",["==","class","trunk"],["!=","ramp",1],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"round",visibility:"visible"},paint:{"line-width":{stops:[[6,.5],[7,.8],[8,1],[11,3],[13,4],[14,6],[15,8],[16,10],[17,14],[18,18]]},"line-opacity":{stops:[[5,.5],[7,1]]},"line-color":{stops:[[5,"#e6e6e6"],[12,"#ddd"]]}}},{id:"bridge_mot_case",type:"line",source:"carto","source-layer":"transportation",minzoom:5,maxzoom:24,filter:["all",["==","class","motorway"],["!=","ramp",1],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[6,.5],[7,.8],[8,1],[11,3],[12,4],[13,5],[14,7],[15,9],[16,11],[17,13],[18,22]]},"line-opacity":{stops:[[6,.5],[7,1]]},"line-color":{stops:[[5,"#e6e6e6"],[10,"#ddd"]]}}},{id:"bridge_path",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","path"],["==","brunnel","bridge"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[15,.5],[16,1],[18,3]]},"line-opacity":1,"line-color":"#d5d5d5","line-dasharray":{stops:[[15,[2,2]],[18,[3,3]]]}}},{id:"bridge_service_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","service"],["==","brunnel","bridge"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[15,2],[16,2],[17,4],[18,6]]},"line-opacity":1,"line-color":"#fdfdfd"}},{id:"bridge_minor_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:15,maxzoom:24,filter:["all",["==","class","minor"],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[15,3],[16,4],[17,8],[18,12]]},"line-opacity":1,"line-color":"#fdfdfd"}},{id:"bridge_sec_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:13,maxzoom:24,filter:["all",["in","class","secondary","tertiary"],["==","brunnel","bridge"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{stops:[[11,2],[13,2],[14,3],[15,4],[16,6],[17,10],[18,14]]},"line-opacity":1,"line-color":"#fff"}},{id:"bridge_pri_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:11,maxzoom:24,filter:["all",["==","class","primary"],["!=","ramp",1],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[11,1],[13,2],[14,4],[15,6],[16,8],[17,12],[18,16]]},"line-opacity":1,"line-color":"#fff"}},{id:"bridge_trunk_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:11,maxzoom:24,filter:["all",["==","class","trunk"],["!=","ramp",1],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"round",visibility:"visible"},paint:{"line-width":{stops:[[11,1],[13,2],[14,4],[15,6],[16,8],[17,12],[18,16]]},"line-opacity":1,"line-color":"#fff"}},{id:"bridge_mot_fill",type:"line",source:"carto","source-layer":"transportation",minzoom:10,maxzoom:24,filter:["all",["==","class","motorway"],["!=","ramp",1],["==","brunnel","bridge"]],layout:{"line-cap":"butt","line-join":"round"},paint:{"line-width":{stops:[[10,1],[12,2],[13,3],[14,5],[15,7],[16,9],[17,11],[18,20]]},"line-opacity":1,"line-color":"#fff"}},{id:"building",type:"fill",source:"carto","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-color":{base:1,stops:[[15.5,"#dfdfdf"],[16,"#dfdfdf"]]},"fill-antialias":!0}},{id:"building-top",type:"fill",source:"carto","source-layer":"building",layout:{visibility:"visible"},paint:{"fill-translate":{base:1,stops:[[14,[0,0]],[16,[-2,-2]]]},"fill-outline-color":"#dfdfdf","fill-color":"#ededed","fill-opacity":{base:1,stops:[[13,0],[16,1]]}}},{id:"boundary_country_outline",type:"line",source:"carto","source-layer":"boundary",minzoom:6,maxzoom:24,filter:["all",["==","admin_level",2],["==","maritime",0]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#f3efed","line-opacity":.5,"line-width":8,"line-offset":0}},{id:"boundary_country_inner",type:"line",source:"carto","source-layer":"boundary",minzoom:0,filter:["all",["==","admin_level",2],["==","maritime",0]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":{stops:[[4,"#f2e6e7"],[5,"#ebd6d8"],[6,"#ebd6d8"]]},"line-opacity":1,"line-width":{stops:[[3,1],[6,1.5]]},"line-offset":0}},{id:"watername_ocean",type:"symbol",source:"carto","source-layer":"water_name",minzoom:0,maxzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","ocean"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":{stops:[[0,13],[2,14],[4,18]]},"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#abb6be","text-halo-color":"#d4dadc","text-halo-width":1,"text-halo-blur":0}},{id:"watername_sea",type:"symbol",source:"carto","source-layer":"water_name",minzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","sea"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":12,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#abb6be","text-halo-color":"#d4dadc","text-halo-width":1,"text-halo-blur":0}},{id:"watername_lake",type:"symbol",source:"carto","source-layer":"water_name",minzoom:4,filter:["all",["has","name"],["==","$type","Point"],["==","class","lake"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"point","text-size":{stops:[[13,9],[14,10],[15,11],[16,12],[17,13]]},"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto"},paint:{"text-color":"#7a96a0","text-halo-color":"#f5f5f3","text-halo-width":1,"text-halo-blur":1}},{id:"watername_lake_line",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","LineString"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"line","text-size":{stops:[[13,9],[14,10],[15,11],[16,12],[17,13]]},"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-spacing":350,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-line-height":1.2},paint:{"text-color":"#7a96a0","text-halo-color":"#f5f5f3","text-halo-width":1,"text-halo-blur":1}},{id:"place_hamlet",type:"symbol",source:"carto","source-layer":"place",minzoom:12,maxzoom:16,filter:["any",["==","class","neighbourhood"],["==","class","hamlet"]],layout:{"text-field":{stops:[[8,"{name_en}"],[14,"{name}"]]},"text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[13,8],[14,10],[16,11]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":{stops:[[12,"none"],[14,"uppercase"]]}},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_suburbs",type:"symbol",source:"carto","source-layer":"place",minzoom:12,maxzoom:16,filter:["all",["==","class","suburb"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[12,9],[13,10],[14,11],[15,12],[16,13]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":{stops:[[8,"none"],[12,"uppercase"]]}},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_villages",type:"symbol",source:"carto","source-layer":"place",minzoom:10,maxzoom:16,filter:["all",["==","class","village"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[10,9],[12,10],[13,11],[14,12],[16,13]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"none"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_town",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:14,filter:["all",["==","class","town"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,10],[9,10],[10,11],[13,14],[14,15]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"none"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_country_2",type:"symbol",source:"carto","source-layer":"place",minzoom:3,maxzoom:10,filter:["all",["==","class","country"],[">=","rank",3],["has","iso_a2"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[3,10],[5,11],[6,12],[7,13],[8,14]]},"text-transform":"uppercase"},paint:{"text-color":{stops:[[3,"#8a99a4"],[5,"#a1adb6"],[6,"#b9c2c9"]]},"text-halo-color":"#fafaf8","text-halo-width":1}},{id:"place_country_1",type:"symbol",source:"carto","source-layer":"place",minzoom:2,maxzoom:7,filter:["all",["==","class","country"],["<=","rank",2]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[3,11],[4,12],[5,13],[6,14]]},"text-transform":"uppercase","text-max-width":{stops:[[2,6],[3,6],[4,9],[5,12]]}},paint:{"text-color":{stops:[[3,"#8a99a4"],[5,"#a1adb6"],[6,"#b9c2c9"]]},"text-halo-color":"#fafaf8","text-halo-width":1}},{id:"place_state",type:"symbol",source:"carto","source-layer":"place",minzoom:5,maxzoom:10,filter:["all",["==","class","state"],["<=","rank",4]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[5,12],[7,14]]},"text-transform":"uppercase","text-max-width":9},paint:{"text-color":"#97a4ae","text-halo-color":"#fafaf8","text-halo-width":0}},{id:"place_continent",type:"symbol",source:"carto","source-layer":"place",minzoom:0,maxzoom:2,filter:["all",["==","class","continent"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-transform":"uppercase","text-size":14,"text-letter-spacing":.1,"text-max-width":9,"text-justify":"center","text-keep-upright":!1},paint:{"text-color":"#697b89","text-halo-color":"#fafaf8","text-halo-width":1}},{id:"place_city_r6",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",6]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,12],[9,13],[10,14],[13,17],[14,20]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_r5",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",0],["<=","rank",5]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,14],[10,16],[13,19],[14,22]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_r7",type:"symbol",source:"carto","source-layer":"place",minzoom:6,maxzoom:7,filter:["all",["==","class","city"],["<=","rank",7]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_r4",type:"symbol",source:"carto","source-layer":"place",minzoom:5,maxzoom:7,filter:["all",["==","class","city"],["<=","rank",4]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_r2",type:"symbol",source:"carto","source-layer":"place",minzoom:4,maxzoom:7,filter:["all",["==","class","city"],["<=","rank",2]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",["!has","capital"],["!in","class","country","state"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_capital_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",[">","capital",0]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"poi_stadium",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["in","class","stadium","cemetery","attraction"],["<=","rank",3]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"poi_park",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["==","class","park"]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"roadname_minor",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:16,filter:["all",["in","class","minor","service"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":9,"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_sec",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:15,filter:["all",["in","class","secondary","tertiary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,9],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_pri",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:14,filter:["all",["in","class","primary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[14,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_major",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:13,filter:["all",["in","class","trunk","motorway"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[13,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"housenumber",type:"symbol",source:"carto","source-layer":"housenumber",minzoom:17,maxzoom:24,layout:{"text-field":"{housenumber}","text-size":{stops:[[17,9],[18,11]]},"text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"]},paint:{"text-halo-color":"transparent","text-color":"transparent","text-halo-width":.75}}],IH="voyager",CH="Carto",kH={version:xH,name:wH,metadata:bH,sources:EH,sprite:TH,glyphs:SH,layers:MH,id:IH,owner:CH};var PH={exports:{}};(function(t){(function(e){function n(k){function z(B,D,K){this.x=B,this.y=D,this.z=K}z.prototype.dot2=function(B,D){return this.x*B+this.y*D},z.prototype.dot3=function(B,D,K){return this.x*B+this.y*D+this.z*K},this.grad3=[new z(1,1,0),new z(-1,1,0),new z(1,-1,0),new z(-1,-1,0),new z(1,0,1),new z(-1,0,1),new z(1,0,-1),new z(-1,0,-1),new z(0,1,1),new z(0,-1,1),new z(0,1,-1),new z(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=new Array(512),this.gradP=new Array(512),this.seed(k||0)}n.prototype.seed=function(k){k>0&&k<1&&(k*=65536),k=Math.floor(k),k<256&&(k|=k<<8);for(var z=this.p,B=0;B<256;B++){var D;B&1?D=z[B]^k&255:D=z[B]^k>>8&255;var K=this.perm,ee=this.gradP;K[B]=K[B+256]=D,ee[B]=ee[B+256]=this.grad3[D%12]}};var i=.5*(Math.sqrt(3)-1),r=(3-Math.sqrt(3))/6,c=1/3,p=1/6;n.prototype.simplex2=function(k,z){var B,D,K,ee=(k+z)*i,le=Math.floor(k+ee),Ce=Math.floor(z+ee),se=(le+Ce)*r,ne=k-le+se,te=z-Ce+se,xe,Le;ne>te?(xe=1,Le=0):(xe=0,Le=1);var Ge=ne-xe+r,nt=te-Le+r,it=ne-1+2*r,dt=te-1+2*r;le&=255,Ce&=255;var ct=this.perm,Xe=this.gradP,Bt=Xe[le+ct[Ce]],Rt=Xe[le+xe+ct[Ce+Le]],jt=Xe[le+1+ct[Ce+1]],_n=.5-ne*ne-te*te;_n<0?B=0:(_n*=_n,B=_n*_n*Bt.dot2(ne,te));var Mt=.5-Ge*Ge-nt*nt;Mt<0?D=0:(Mt*=Mt,D=Mt*Mt*Rt.dot2(Ge,nt));var Sn=.5-it*it-dt*dt;return Sn<0?K=0:(Sn*=Sn,K=Sn*Sn*jt.dot2(it,dt)),70*(B+D+K)},n.prototype.simplex3=function(k,z,B){var D,K,ee,le,Ce=(k+z+B)*c,se=Math.floor(k+Ce),ne=Math.floor(z+Ce),te=Math.floor(B+Ce),xe=(se+ne+te)*p,Le=k-se+xe,Ge=z-ne+xe,nt=B-te+xe,it,dt,ct,Xe,Bt,Rt;Le>=Ge?Ge>=nt?(it=1,dt=0,ct=0,Xe=1,Bt=1,Rt=0):Le>=nt?(it=1,dt=0,ct=0,Xe=1,Bt=0,Rt=1):(it=0,dt=0,ct=1,Xe=1,Bt=0,Rt=1):Ge<nt?(it=0,dt=0,ct=1,Xe=0,Bt=1,Rt=1):Le<nt?(it=0,dt=1,ct=0,Xe=0,Bt=1,Rt=1):(it=0,dt=1,ct=0,Xe=1,Bt=1,Rt=0);var jt=Le-it+p,_n=Ge-dt+p,Mt=nt-ct+p,Sn=Le-Xe+2*p,pt=Ge-Bt+2*p,It=nt-Rt+2*p,Jt=Le-1+3*p,kn=Ge-1+3*p,Mn=nt-1+3*p;se&=255,ne&=255,te&=255;var ri=this.perm,oi=this.gradP,Ri=oi[se+ri[ne+ri[te]]],Ai=oi[se+it+ri[ne+dt+ri[te+ct]]],Nn=oi[se+Xe+ri[ne+Bt+ri[te+Rt]]],Di=oi[se+1+ri[ne+1+ri[te+1]]],yn=.5-Le*Le-Ge*Ge-nt*nt;yn<0?D=0:(yn*=yn,D=yn*yn*Ri.dot3(Le,Ge,nt));var qn=.5-jt*jt-_n*_n-Mt*Mt;qn<0?K=0:(qn*=qn,K=qn*qn*Ai.dot3(jt,_n,Mt));var Xi=.5-Sn*Sn-pt*pt-It*It;Xi<0?ee=0:(Xi*=Xi,ee=Xi*Xi*Nn.dot3(Sn,pt,It));var pi=.5-Jt*Jt-kn*kn-Mn*Mn;return pi<0?le=0:(pi*=pi,le=pi*pi*Di.dot3(Jt,kn,Mn)),32*(D+K+ee+le)};function a(k){return k*k*k*(k*(k*6-15)+10)}function T(k,z,B){return(1-B)*k+B*z}n.prototype.perlin2=function(k,z){var B=Math.floor(k),D=Math.floor(z);k=k-B,z=z-D,B=B&255,D=D&255;var K=this.perm,ee=this.gradP,le=ee[B+K[D]].dot2(k,z),Ce=ee[B+K[D+1]].dot2(k,z-1),se=ee[B+1+K[D]].dot2(k-1,z),ne=ee[B+1+K[D+1]].dot2(k-1,z-1),te=a(k);return T(T(le,se,te),T(Ce,ne,te),a(z))},n.prototype.perlin3=function(k,z,B){var D=Math.floor(k),K=Math.floor(z),ee=Math.floor(B);k=k-D,z=z-K,B=B-ee,D=D&255,K=K&255,ee=ee&255;var le=this.perm,Ce=this.gradP,se=Ce[D+le[K+le[ee]]].dot3(k,z,B),ne=Ce[D+le[K+le[ee+1]]].dot3(k,z,B-1),te=Ce[D+le[K+1+le[ee]]].dot3(k,z-1,B),xe=Ce[D+le[K+1+le[ee+1]]].dot3(k,z-1,B-1),Le=Ce[D+1+le[K+le[ee]]].dot3(k-1,z,B),Ge=Ce[D+1+le[K+le[ee+1]]].dot3(k-1,z,B-1),nt=Ce[D+1+le[K+1+le[ee]]].dot3(k-1,z-1,B),it=Ce[D+1+le[K+1+le[ee+1]]].dot3(k-1,z-1,B-1),dt=a(k),ct=a(z),Xe=a(B);return T(T(T(se,Le,dt),T(ne,Ge,dt),Xe),T(T(te,nt,dt),T(xe,it,dt),Xe),ct)},e.Noise=n})(t.exports)})(PH);const dy={longitude:-119.99582643167989,latitude:37.88453894208306,zoom:10.364947995424346,pitch:49.903969287830776,bearing:28.126875},LH=function(t){let e,n,i,r,c,p;e=t[0],n=t[1],i=t[2];let a=Math.min(e,n,i),T=Math.max(e,n,i);p=T;let k=T-a;if(T!=0)c=k/T;else return c=0,r=-1,[r,c,void 0];return e===T?r=(n-i)/k:n===T?r=2+(i-e)/k:r=4+(e-n)/k,r*=60,r<0&&(r+=360),isNaN(r)&&(r=0),[r,c,p]},RH=function(t){let e,n,i,r,c,p,a;if(n=t[0],i=t[1],r=t[2],i===0)return c=p=a=r,[c,p,a];n/=60,e=Math.floor(n);let T=n-e,k=r*(1-i),z=r*(1-i*T),B=r*(1-i*(1-T));switch(e){case 0:c=r,p=B,a=k;break;case 1:c=z,p=r,a=k;break;case 2:c=k,p=r,a=B;break;case 3:c=k,p=z,a=r;break;case 4:c=B,p=k,a=r;break;default:c=r,p=k,a=z;break}return[c,p,a]},DH=t=>{let e=LH(t);return e[1]*=2,RH(e)};bh().domain([-250,10]).range([1,0]).clamp(!0);const zH=t=>DH(Vj(bh().domain([0,300]).range([0,1])(t)).replace(/[^\d,]/g,"").split(",").map(e=>Number(e)));bh().domain([-50,50]).range([0,1]).clamp(!0);const BH=bh().domain([dy.zoom-1,dy.zoom+4]).range([0,1]).clamp(!0);bh().domain([-.6,-.45,-.3,-.15,0,.15,.3,.45,.6,.75,.9,1.05,1.2]).range([[65,182,196],[127,205,187],[199,233,180],[237,248,177],[255,255,204],[255,237,160],[254,217,118],[254,178,76],[253,141,60],[252,78,42],[227,26,28],[189,0,38],[128,0,38]]);const OH=new HE({color:[255,255,255],intensity:1}),FH=new TD({timestamp:Date.UTC(2019,7,1,22),color:[255,255,255],intensity:1});function NH({object:t}){return t&&{html:`      <div><b>Average Property Value</b></div>
      <div>${t.properties.valuePerSqm} / m<sup>2</sup></div>
      <div><b>Growth</b></div>
      <div>${Math.round(t.properties.growth*100)}%</div>
  `}}f5(mV(Object.values(im[im.length-1]).map(t=>t.Elevation)),[0,1500]);function UH({mapStyle:t=kH}){const[e]=Dt.useState(()=>{const T=new Fy({ambientLight:OH,dirLight:FH});return T.shadowColor=[0,0,0,.5],[T]}),[n,i]=Dt.useState(1),[r,c]=Dt.useState(0);Dt.useEffect(()=>{setTimeout(()=>c(T=>T+1),500)},[r]);let p=BH(n);const a=[new Y2({id:"PowerLayer",data:im,thicknessRange:[0,1],filled:!0,getValue:(T,k)=>T.properties.confidence/100,resolution:p,getFillColor:T=>zH(T.properties.power),resRange:[7,9],opacity:.9}),new K2({id:"PersonnelIcons",data:im,loaders:[DO],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",resolution:p,getColor:T=>[0,188,242],getValue:T=>T.properties.personnel,sizeScale:400,resRange:[7,9]})];return ud.createElement(ud.Fragment,null,ud.createElement(KF,{layers:a,effects:e,initialViewState:dy,controller:!0,onViewStateChange:({viewState:T})=>{i(T.zoom),console.log(T)},getTooltip:NH},ud.createElement(WG,{reuseMaps:!0,mapLib:eN,mapStyle:t,preventStyleDiffing:!0})))}function VH(t){Y4(t).render(ud.createElement(UH,null))}VH(document.getElementById("app"));
